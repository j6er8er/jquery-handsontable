/*!
 * Handsontable 0.15.1
 * Handsontable is a JavaScript library for editable tables with basic copy-paste compatibility with Excel and Google Docs
 *
 * Copyright (c) 2012-2014 Marcin Warpechowski
 * Copyright 2015 Handsoncode sp. z o.o. <hello@handsontable.com>
 * Licensed under the MIT license.
 * http://handsontable.com/
 *
<<<<<<< HEAD
 * Date: Wed Jun 03 2015 13:38:59 GMT-0700 (PDT)
 */
window.Handsontable={version:"0.15.0-beta5",buildDate:"Wed Jun 03 2015 13:38:59 GMT-0700 (PDT)"};require=function outer(modules,cache,entry){var previousRequire=typeof require=="function"&&require;var globalNS=JSON.parse('{"zeroclipboard":"ZeroClipboard","copyPaste":"copyPaste","SheetClip":"SheetClip","jsonpatch":"jsonpatch","moment":"moment","numeral":"numeral","autoResize":"autoResize","pikaday":"Pikaday"}')||{};function newRequire(name,jumped){if(!cache[name]){if(!modules[name]){var currentRequire=typeof require=="function"&&require;if(!jumped&&currentRequire)return currentRequire(name,true);if(previousRequire)return previousRequire(name,true);if(globalNS[name]&&typeof window[globalNS[name]]!=="undefined"){return window[globalNS[name]]}var err=new Error("Cannot find module '"+name+"'");err.code="MODULE_NOT_FOUND";throw err}var m=cache[name]={exports:{}};modules[name][0].call(m.exports,function(x){var id=modules[name][1][x];return newRequire(id?id:x)},m,m.exports,outer,modules,cache,entry)}return cache[name].exports}for(var i=0;i<entry.length;i++)newRequire(entry[i]);return newRequire}({1:[function(require,module,exports){"use strict";if(window.jQuery){(function(window,$,Handsontable){$.fn.handsontable=function(action){var i,ilen,args,output,userSettings,$this=this.first(),instance=$this.data("handsontable");if(typeof action!=="string"){userSettings=action||{};if(instance){instance.updateSettings(userSettings)}else{instance=new Handsontable.Core($this[0],userSettings);$this.data("handsontable",instance);instance.init()}return $this}else{args=[];if(arguments.length>1){for(i=1,ilen=arguments.length;i<ilen;i++){args.push(arguments[i])}}if(instance){if(typeof instance[action]!=="undefined"){output=instance[action].apply(instance,args);if(action==="destroy"){$this.removeData()}}else{throw new Error("Handsontable do not provide action: "+action)}}return output}}})(window,jQuery,Handsontable)}},{}],2:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableBorder:{get:function(){return WalkontableBorder}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47__46__46__47_eventManager_46_js__,$__cell_47_coords_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47__46__46__47_eventManager_46_js__=require("./../../../eventManager.js"),$___46__46__47__46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_eventManager_46_js__}).eventManager;var WalkontableCellCoords=($__cell_47_coords_46_js__=require("./cell/coords.js"),$__cell_47_coords_46_js__&&$__cell_47_coords_46_js__.__esModule&&$__cell_47_coords_46_js__||{"default":$__cell_47_coords_46_js__}).WalkontableCellCoords;function WalkontableBorder(instance,settings){var style;var createMultipleSelectorHandles=function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var width=10,hitAreaWidth=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var hitAreaStyle={position:"absolute",height:hitAreaWidth+"px",width:hitAreaWidth+"px","border-radius":parseInt(hitAreaWidth/1.5,10)+"px"};for(var prop in hitAreaStyle){if(hitAreaStyle.hasOwnProperty(prop)){this.selectionHandles.styles.bottomRightHitArea[prop]=hitAreaStyle[prop];this.selectionHandles.styles.topLeftHitArea[prop]=hitAreaStyle[prop]}}var handleStyle={position:"absolute",height:width+"px",width:width+"px","border-radius":parseInt(width/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var prop in handleStyle){if(handleStyle.hasOwnProperty(prop)){this.selectionHandles.styles.bottomRight[prop]=handleStyle[prop];this.selectionHandles.styles.topLeft[prop]=handleStyle[prop]}}this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)};if(!settings){return}var eventManager=eventManagerObject(instance);this.instance=instance;this.settings=settings;this.main=document.createElement("div");style=this.main.style;style.position="absolute";style.top=0;style.left=0;var borderDivs=["top","left","bottom","right","corner"];for(var i=0;i<5;i++){var position=borderDivs[i];var DIV=document.createElement("DIV");DIV.className="wtBorder "+(this.settings.className||"");if(this.settings[position]&&this.settings[position].hide){DIV.className+=" hidden"}style=DIV.style;style.backgroundColor=this.settings[position]&&this.settings[position].color?this.settings[position].color:settings.border.color;style.height=this.settings[position]&&this.settings[position].width?this.settings[position].width+"px":settings.border.width+"px";style.width=this.settings[position]&&this.settings[position].width?this.settings[position].width+"px":settings.border.width+"px";this.main.appendChild(DIV)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"};this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");if(Handsontable.mobileBrowser){createMultipleSelectorHandles.call(this)}this.disappear();if(!instance.wtTable.bordersHolder){instance.wtTable.bordersHolder=document.createElement("div");instance.wtTable.bordersHolder.className="htBorders";instance.wtTable.spreader.appendChild(instance.wtTable.bordersHolder)}instance.wtTable.bordersHolder.insertBefore(this.main,instance.wtTable.bordersHolder.firstChild);var down=false;eventManager.addEventListener(document.body,"mousedown",function(){down=true});eventManager.addEventListener(document.body,"mouseup",function(){down=false});for(var c=0,len=this.main.childNodes.length;c<len;c++){eventManager.addEventListener(this.main.childNodes[c],"mouseenter",function(event){if(!down||!instance.getSetting("hideBorderOnMouseDownOver")){return}event.preventDefault();event.stopImmediatePropagation();var bounds=this.getBoundingClientRect();this.style.display="none";var isOutside=function(event){if(event.clientY<Math.floor(bounds.top)){return true}if(event.clientY>Math.ceil(bounds.top+bounds.height)){return true}if(event.clientX<Math.floor(bounds.left)){return true}if(event.clientX>Math.ceil(bounds.left+bounds.width)){return true}};var handler=function(event){if(isOutside(event)){eventManager.removeEventListener(document.body,"mousemove",handler);this.style.display="block"}};eventManager.addEventListener(document.body,"mousemove",handler)})}}WalkontableBorder.prototype.appear=function(corners){if(this.disabled){return}var instance=this.instance;var isMultiple,fromTD,toTD,fromOffset,toOffset,containerOffset,top,minTop,left,minLeft,height,width,fromRow,fromColumn,toRow,toColumn,i,ilen,s;var isPartRange=function(){if(this.instance.selections.area.cellRange){if(toRow!=this.instance.selections.area.cellRange.to.row||toColumn!=this.instance.selections.area.cellRange.to.col){return true}}return false};var updateMultipleSelectionHandlesPosition=function(top,left,width,height){var handleWidth=parseInt(this.selectionHandles.styles.topLeft.width,10),hitAreaWidth=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(top-handleWidth,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(left-handleWidth,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(top-hitAreaWidth/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(left-hitAreaWidth/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(top+height,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(left+width,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=parseInt(top+height-hitAreaWidth/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(left+width-hitAreaWidth/4,10)+"px";if(this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()){this.selectionHandles.styles.topLeft.display="block";this.selectionHandles.styles.topLeftHitArea.display="block";if(!isPartRange.call(this)){this.selectionHandles.styles.bottomRight.display="block";this.selectionHandles.styles.bottomRightHitArea.display="block"}else{this.selectionHandles.styles.bottomRight.display="none";this.selectionHandles.styles.bottomRightHitArea.display="none"}}else{this.selectionHandles.styles.topLeft.display="none";this.selectionHandles.styles.bottomRight.display="none";this.selectionHandles.styles.topLeftHitArea.display="none";this.selectionHandles.styles.bottomRightHitArea.display="none"}if(fromRow==this.instance.wtSettings.getSetting("fixedRowsTop")||fromColumn==this.instance.wtSettings.getSetting("fixedColumnsLeft")){this.selectionHandles.styles.topLeft.zIndex="9999";this.selectionHandles.styles.topLeftHitArea.zIndex="9999"}else{this.selectionHandles.styles.topLeft.zIndex="";this.selectionHandles.styles.topLeftHitArea.zIndex=""}};if(instance.cloneOverlay instanceof WalkontableTopOverlay||instance.cloneOverlay instanceof WalkontableCornerOverlay){ilen=instance.getSetting("fixedRowsTop")}else{ilen=instance.wtTable.getRenderedRowsCount()}for(i=0;i<ilen;i++){s=instance.wtTable.rowFilter.renderedToSource(i);if(s>=corners[0]&&s<=corners[2]){fromRow=s;break}}for(i=ilen-1;i>=0;i--){s=instance.wtTable.rowFilter.renderedToSource(i);if(s>=corners[0]&&s<=corners[2]){toRow=s;break}}ilen=instance.wtTable.getRenderedColumnsCount();for(i=0;i<ilen;i++){s=instance.wtTable.columnFilter.renderedToSource(i);if(s>=corners[1]&&s<=corners[3]){fromColumn=s;break}}for(i=ilen-1;i>=0;i--){s=instance.wtTable.columnFilter.renderedToSource(i);if(s>=corners[1]&&s<=corners[3]){toColumn=s;break}}if(fromRow!==void 0&&fromColumn!==void 0){isMultiple=fromRow!==toRow||fromColumn!==toColumn;fromTD=instance.wtTable.getCell(new WalkontableCellCoords(fromRow,fromColumn));toTD=isMultiple?instance.wtTable.getCell(new WalkontableCellCoords(toRow,toColumn)):fromTD;fromOffset=dom.offset(fromTD);toOffset=isMultiple?dom.offset(toTD):fromOffset;containerOffset=dom.offset(instance.wtTable.TABLE);minTop=fromOffset.top;height=toOffset.top+dom.outerHeight(toTD)-minTop;minLeft=fromOffset.left;width=toOffset.left+dom.outerWidth(toTD)-minLeft;top=minTop-containerOffset.top-1;left=minLeft-containerOffset.left-1;var style=dom.getComputedStyle(fromTD);if(parseInt(style.borderTopWidth,10)>0){top+=1;height=height>0?height-1:0}if(parseInt(style.borderLeftWidth,10)>0){left+=1;width=width>0?width-1:0}}else{this.disappear();return}this.topStyle.top=top+"px";this.topStyle.left=left+"px";this.topStyle.width=width+"px";this.topStyle.display="block";this.leftStyle.top=top+"px";this.leftStyle.left=left+"px";this.leftStyle.height=height+"px";this.leftStyle.display="block";var delta=Math.floor(this.settings.border.width/2);this.bottomStyle.top=top+height-delta+"px";this.bottomStyle.left=left+"px";this.bottomStyle.width=width+"px";this.bottomStyle.display="block";this.rightStyle.top=top+"px";this.rightStyle.left=left+width-delta+"px";this.rightStyle.height=height+1+"px";this.rightStyle.display="block";if(Handsontable.mobileBrowser||(!this.hasSetting(this.settings.border.cornerVisible)||isPartRange.call(this))){this.cornerStyle.display="none"}else{this.cornerStyle.top=top+height-4+"px";this.cornerStyle.left=left+width-4+"px";this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.display="block";if(toColumn===this.instance.getSetting("totalColumns")-1){var trimmingContainer=dom.getTrimmingContainer(instance.wtTable.TABLE),cornerOverlappingContainer=toTD.offsetLeft+dom.outerWidth(toTD)>=dom.innerWidth(trimmingContainer);if(cornerOverlappingContainer){this.cornerStyle.left=Math.floor(left+width-3-parseInt(this.cornerDefaultStyle.width)/2)+"px";this.cornerStyle.borderRightWidth=0}}}if(Handsontable.mobileBrowser){updateMultipleSelectionHandlesPosition.call(this,top,left,width,height)}};WalkontableBorder.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";if(Handsontable.mobileBrowser){this.selectionHandles.styles.topLeft.display="none";this.selectionHandles.styles.bottomRight.display="none"}};WalkontableBorder.prototype.hasSetting=function(setting){if(typeof setting==="function"){return setting()}return!!setting};window.WalkontableBorder=WalkontableBorder},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./cell/coords.js":5}],3:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableViewportColumnsCalculator:{get:function(){return WalkontableViewportColumnsCalculator}},__esModule:{value:true}});var privatePool=new WeakMap;var WalkontableViewportColumnsCalculator=function WalkontableViewportColumnsCalculator(viewportWidth,scrollOffset,totalColumns,columnWidthFn,overrideFn,onlyFullyVisible,stretchH){privatePool.set(this,{viewportWidth:viewportWidth,scrollOffset:scrollOffset,totalColumns:totalColumns,columnWidthFn:columnWidthFn,overrideFn:overrideFn,onlyFullyVisible:onlyFullyVisible});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=stretchH;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=true;this.stretchAllColumnsWidth=[];this.calculate()};var $WalkontableViewportColumnsCalculator=WalkontableViewportColumnsCalculator;$traceurRuntime.createClass(WalkontableViewportColumnsCalculator,{calculate:function(){var sum=0;var needReverse=true;var startPositions=[];var columnWidth;var priv=privatePool.get(this);var onlyFullyVisible=priv.onlyFullyVisible;var overrideFn=priv.overrideFn;var scrollOffset=priv.scrollOffset;var totalColumns=priv.totalColumns;var viewportWidth=priv.viewportWidth;for(var i=0;i<totalColumns;i++){columnWidth=this._getColumnWidth(i);if(sum<=scrollOffset&&!onlyFullyVisible){this.startColumn=i}if(sum>=scrollOffset&&sum+columnWidth<=scrollOffset+viewportWidth){if(this.startColumn==null){this.startColumn=i}this.endColumn=i}startPositions.push(sum);sum+=columnWidth;if(!onlyFullyVisible){this.endColumn=i}if(sum>=scrollOffset+viewportWidth){needReverse=false;break}}if(this.endColumn===totalColumns-1&&needReverse){this.startColumn=this.endColumn;while(this.startColumn>0){var viewportSum=startPositions[this.endColumn]+columnWidth-startPositions[this.startColumn-1];if(viewportSum<=viewportWidth||!onlyFullyVisible){this.startColumn--}if(viewportSum>viewportWidth){break}}}if(this.startColumn!==null&&overrideFn){overrideFn(this)}this.startPosition=startPositions[this.startColumn];if(this.startPosition==void 0){this.startPosition=null}if(this.startColumn!==null){this.count=this.endColumn-this.startColumn+1}},refreshStretching:function(totalWidth){if(this.stretch==="none"){return}var sumAll=0;var columnWidth;var remainingSize;var priv=privatePool.get(this);var totalColumns=priv.totalColumns;for(var i=0;i<totalColumns;i++){columnWidth=this._getColumnWidth(i);sumAll+=columnWidth}this.totalTargetWidth=totalWidth;remainingSize=sumAll-totalWidth;if(this.stretch==="all"&&remainingSize<0){this.stretchAllRatio=totalWidth/sumAll;this.stretchAllColumnsWidth=[];this.needVerifyLastColumnWidth=true}else if(this.stretch==="last"&&totalWidth!==Infinity){this.stretchLastWidth=-remainingSize+this._getColumnWidth(totalColumns-1)}},getStretchedColumnWidth:function(column,baseWidth){var result=null;if(this.stretch==="all"&&this.stretchAllRatio!==0){result=this._getStretchedAllColumnWidth(column,baseWidth)}else if(this.stretch==="last"&&this.stretchLastWidth!==0){result=this._getStretchedLastColumnWidth(column)}return result},_getStretchedAllColumnWidth:function(column,baseWidth){var sumRatioWidth=0;var priv=privatePool.get(this);var totalColumns=priv.totalColumns;if(!this.stretchAllColumnsWidth[column]){this.stretchAllColumnsWidth[column]=Math.round(baseWidth*this.stretchAllRatio)}if(this.stretchAllColumnsWidth.length===totalColumns&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=false;for(var i=0;i<this.stretchAllColumnsWidth.length;i++){sumRatioWidth+=this.stretchAllColumnsWidth[i]}if(sumRatioWidth!==this.totalTargetWidth){this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-sumRatioWidth}}return this.stretchAllColumnsWidth[column]},_getStretchedLastColumnWidth:function(column){var priv=privatePool.get(this);var totalColumns=priv.totalColumns;if(column===totalColumns-1){return this.stretchLastWidth}return null},_getColumnWidth:function(column){var width=privatePool.get(this).columnWidthFn(column);if(width===undefined){width=$WalkontableViewportColumnsCalculator.DEFAULT_WIDTH}return width}},{get DEFAULT_WIDTH(){return 50}});window.WalkontableViewportColumnsCalculator=WalkontableViewportColumnsCalculator},{}],4:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableViewportRowsCalculator:{get:function(){return WalkontableViewportRowsCalculator}},__esModule:{value:true}});var privatePool=new WeakMap;var WalkontableViewportRowsCalculator=function WalkontableViewportRowsCalculator(viewportHeight,scrollOffset,totalRows,rowHeightFn,overrideFn,onlyFullyVisible){privatePool.set(this,{viewportHeight:viewportHeight,scrollOffset:scrollOffset,totalRows:totalRows,rowHeightFn:rowHeightFn,overrideFn:overrideFn,onlyFullyVisible:onlyFullyVisible});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate()};var $WalkontableViewportRowsCalculator=WalkontableViewportRowsCalculator;$traceurRuntime.createClass(WalkontableViewportRowsCalculator,{calculate:function(){var sum=0;var needReverse=true;var startPositions=[];var priv=privatePool.get(this);var onlyFullyVisible=priv.onlyFullyVisible;var overrideFn=priv.overrideFn;var rowHeightFn=priv.rowHeightFn;var scrollOffset=priv.scrollOffset;var totalRows=priv.totalRows;var viewportHeight=priv.viewportHeight;for(var i=0;i<totalRows;i++){var rowHeight=rowHeightFn(i);if(rowHeight===undefined){rowHeight=$WalkontableViewportRowsCalculator.DEFAULT_HEIGHT}if(sum<=scrollOffset&&!onlyFullyVisible){this.startRow=i}if(sum>=scrollOffset&&sum+rowHeight<=scrollOffset+viewportHeight){if(this.startRow===null){this.startRow=i}this.endRow=i}startPositions.push(sum);sum+=rowHeight;if(!onlyFullyVisible){this.endRow=i}if(sum>=scrollOffset+viewportHeight){needReverse=false;break}}if(this.endRow===totalRows-1&&needReverse){this.startRow=this.endRow;while(this.startRow>0){var viewportSum=startPositions[this.endRow]+rowHeight-startPositions[this.startRow-1];if(viewportSum<=viewportHeight||!onlyFullyVisible){this.startRow--}if(viewportSum>=viewportHeight){break}}}if(this.startRow!==null&&overrideFn){overrideFn(this)}this.startPosition=startPositions[this.startRow];if(this.startPosition==void 0){this.startPosition=null}if(this.startRow!==null){this.count=this.endRow-this.startRow+1}}},{get DEFAULT_HEIGHT(){return 23}});window.WalkontableViewportRowsCalculator=WalkontableViewportRowsCalculator},{}],5:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableCellCoords:{get:function(){return WalkontableCellCoords}},__esModule:{value:true}});var WalkontableCellCoords=function WalkontableCellCoords(row,col){if(typeof row!=="undefined"&&typeof col!=="undefined"){this.row=row;this.col=col}else{this.row=null;this.col=null}};$traceurRuntime.createClass(WalkontableCellCoords,{isValid:function(wotInstance){if(this.row<0||this.col<0){return false}if(this.row>=wotInstance.getSetting("totalRows")||this.col>=wotInstance.getSetting("totalColumns")){return false}return true},isEqual:function(cellCoords){if(cellCoords===this){return true}return this.row===cellCoords.row&&this.col===cellCoords.col},isSouthEastOf:function(testedCoords){return this.row>=testedCoords.row&&this.col>=testedCoords.col},isNorthWestOf:function(testedCoords){return this.row<=testedCoords.row&&this.col<=testedCoords.col},isSouthWestOf:function(testedCoords){return this.row>=testedCoords.row&&this.col<=testedCoords.col},isNorthEastOf:function(testedCoords){return this.row<=testedCoords.row&&this.col>=testedCoords.col}},{});window.WalkontableCellCoords=WalkontableCellCoords},{}],6:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableCellRange:{get:function(){return WalkontableCellRange}},__esModule:{value:true}});var $___46__46__47_cell_47_coords_46_js__;var WalkontableCellCoords=($___46__46__47_cell_47_coords_46_js__=require("./../cell/coords.js"),$___46__46__47_cell_47_coords_46_js__&&$___46__46__47_cell_47_coords_46_js__.__esModule&&$___46__46__47_cell_47_coords_46_js__||{"default":$___46__46__47_cell_47_coords_46_js__}).WalkontableCellCoords;var WalkontableCellRange=function WalkontableCellRange(highlight,from,to){this.highlight=highlight;this.from=from;this.to=to};var $WalkontableCellRange=WalkontableCellRange;$traceurRuntime.createClass(WalkontableCellRange,{isValid:function(wotInstance){return this.from.isValid(wotInstance)&&this.to.isValid(wotInstance)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(cellCoords){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();if(cellCoords.row<0){cellCoords.row=0}if(cellCoords.col<0){cellCoords.col=0}return topLeft.row<=cellCoords.row&&bottomRight.row>=cellCoords.row&&topLeft.col<=cellCoords.col&&bottomRight.col>=cellCoords.col},includesRange:function(testedRange){return this.includes(testedRange.getTopLeftCorner())&&this.includes(testedRange.getBottomRightCorner())},isEqual:function(testedRange){return Math.min(this.from.row,this.to.row)==Math.min(testedRange.from.row,testedRange.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(testedRange.from.row,testedRange.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(testedRange.from.col,testedRange.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(testedRange.from.col,testedRange.to.col)},overlaps:function(testedRange){return testedRange.isSouthEastOf(this.getTopLeftCorner())&&testedRange.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(testedCoords){return this.getTopLeftCorner().isSouthEastOf(testedCoords)||this.getBottomRightCorner().isSouthEastOf(testedCoords)},isNorthWestOf:function(testedCoords){return this.getTopLeftCorner().isNorthWestOf(testedCoords)||this.getBottomRightCorner().isNorthWestOf(testedCoords)},expand:function(cellCoords){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();if(cellCoords.row<topLeft.row||cellCoords.col<topLeft.col||cellCoords.row>bottomRight.row||cellCoords.col>bottomRight.col){this.from=new WalkontableCellCoords(Math.min(topLeft.row,cellCoords.row),Math.min(topLeft.col,cellCoords.col));this.to=new WalkontableCellCoords(Math.max(bottomRight.row,cellCoords.row),Math.max(bottomRight.col,cellCoords.col));return true}return false},expandByRange:function(expandingRange){if(this.includesRange(expandingRange)||!this.overlaps(expandingRange)){return false}var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();var topRight=this.getTopRightCorner();var bottomLeft=this.getBottomLeftCorner();var expandingTopLeft=expandingRange.getTopLeftCorner();var expandingBottomRight=expandingRange.getBottomRightCorner();var resultTopRow=Math.min(topLeft.row,expandingTopLeft.row);var resultTopCol=Math.min(topLeft.col,expandingTopLeft.col);var resultBottomRow=Math.max(bottomRight.row,expandingBottomRight.row);var resultBottomCol=Math.max(bottomRight.col,expandingBottomRight.col);var finalFrom=new WalkontableCellCoords(resultTopRow,resultTopCol),finalTo=new WalkontableCellCoords(resultBottomRow,resultBottomCol);var isCorner=new $WalkontableCellRange(finalFrom,finalFrom,finalTo).isCorner(this.from,expandingRange),onlyMerge=expandingRange.isEqual(new $WalkontableCellRange(finalFrom,finalFrom,finalTo));if(isCorner&&!onlyMerge){if(this.from.col>finalFrom.col){finalFrom.col=resultBottomCol;finalTo.col=resultTopCol}if(this.from.row>finalFrom.row){finalFrom.row=resultBottomRow;finalTo.row=resultTopRow}}this.from=finalFrom;this.to=finalTo;return true},getDirection:function(){if(this.from.isNorthWestOf(this.to)){return"NW-SE"}else if(this.from.isNorthEastOf(this.to)){return"NE-SW"}else if(this.from.isSouthEastOf(this.to)){return"SE-NW"}else if(this.from.isSouthWestOf(this.to)){return"SW-NE"}},setDirection:function(direction){switch(direction){case"NW-SE":this.from=this.getTopLeftCorner();this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner();this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner();this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner();this.to=this.getTopRightCorner();break}},getTopLeftCorner:function(){return new WalkontableCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new WalkontableCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new WalkontableCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new WalkontableCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(coords,expandedRange){if(expandedRange){if(expandedRange.includes(coords)){if(this.getTopLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row,expandedRange.from.col))||this.getTopRightCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row,expandedRange.to.col))||this.getBottomLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row,expandedRange.from.col))||this.getBottomRightCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row,expandedRange.to.col))){return true}}}return coords.isEqual(this.getTopLeftCorner())||coords.isEqual(this.getTopRightCorner())||coords.isEqual(this.getBottomLeftCorner())||coords.isEqual(this.getBottomRightCorner())},getOppositeCorner:function(coords,expandedRange){if(!(coords instanceof WalkontableCellCoords)){return false}if(expandedRange){if(expandedRange.includes(coords)){if(this.getTopLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row,expandedRange.from.col))){return this.getBottomRightCorner()}if(this.getTopRightCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row,expandedRange.to.col))){return this.getBottomLeftCorner()}if(this.getBottomLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row,expandedRange.from.col))){return this.getTopRightCorner()}if(this.getBottomRightCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row,expandedRange.to.col))){return this.getTopLeftCorner()}}}if(coords.isEqual(this.getBottomRightCorner())){return this.getTopLeftCorner()}else if(coords.isEqual(this.getTopLeftCorner())){return this.getBottomRightCorner()}else if(coords.isEqual(this.getTopRightCorner())){return this.getBottomLeftCorner()}else if(coords.isEqual(this.getBottomLeftCorner())){return this.getTopRightCorner()}},getBordersSharedWith:function(range){if(!this.includesRange(range)){return[]}var thisBorders={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)};var rangeBorders={top:Math.min(range.from.row,range.to.row),bottom:Math.max(range.from.row,range.to.row),left:Math.min(range.from.col,range.to.col),right:Math.max(range.from.col,range.to.col)};var result=[];if(thisBorders.top==rangeBorders.top){result.push("top")}if(thisBorders.right==rangeBorders.right){result.push("right")}if(thisBorders.bottom==rangeBorders.bottom){result.push("bottom")}if(thisBorders.left==rangeBorders.left){result.push("left")}return result},getInner:function(){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();var out=[];for(var r=topLeft.row;r<=bottomRight.row;r++){for(var c=topLeft.col;c<=bottomRight.col;c++){if(!(this.from.row===r&&this.from.col===c)&&!(this.to.row===r&&this.to.col===c)){out.push(new WalkontableCellCoords(r,c))}}}return out},getAll:function(){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();var out=[];for(var r=topLeft.row;r<=bottomRight.row;r++){for(var c=topLeft.col;c<=bottomRight.col;c++){if(topLeft.row===r&&topLeft.col===c){out.push(topLeft)}else if(bottomRight.row===r&&bottomRight.col===c){out.push(bottomRight)}else{out.push(new WalkontableCellCoords(r,c))}}}return out},forAll:function(callback){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();for(var r=topLeft.row;r<=bottomRight.row;r++){for(var c=topLeft.col;c<=bottomRight.col;c++){var breakIteration=callback(r,c);if(breakIteration===false){return}}}}},{});window.WalkontableCellRange=WalkontableCellRange},{"./../cell/coords.js":5}],7:[function(require,module,exports){"use strict";Object.defineProperties(exports,{Walkontable:{get:function(){return Walkontable}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47__46__46__47_helpers_46_js__,$__event_46_js__,$__overlays_46_js__,$__scroll_46_js__,$__settings_46_js__,$__table_46_js__,$__viewport_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var randomString=($___46__46__47__46__46__47__46__46__47_helpers_46_js__=require("./../../../helpers.js"),$___46__46__47__46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_helpers_46_js__}).randomString;var WalkontableEvent=($__event_46_js__=require("./event.js"),$__event_46_js__&&$__event_46_js__.__esModule&&$__event_46_js__||{"default":$__event_46_js__
}).WalkontableEvent;var WalkontableOverlays=($__overlays_46_js__=require("./overlays.js"),$__overlays_46_js__&&$__overlays_46_js__.__esModule&&$__overlays_46_js__||{"default":$__overlays_46_js__}).WalkontableOverlays;var WalkontableScroll=($__scroll_46_js__=require("./scroll.js"),$__scroll_46_js__&&$__scroll_46_js__.__esModule&&$__scroll_46_js__||{"default":$__scroll_46_js__}).WalkontableScroll;var WalkontableSettings=($__settings_46_js__=require("./settings.js"),$__settings_46_js__&&$__settings_46_js__.__esModule&&$__settings_46_js__||{"default":$__settings_46_js__}).WalkontableSettings;var WalkontableTable=($__table_46_js__=require("./table.js"),$__table_46_js__&&$__table_46_js__.__esModule&&$__table_46_js__||{"default":$__table_46_js__}).WalkontableTable;var WalkontableViewport=($__viewport_46_js__=require("./viewport.js"),$__viewport_46_js__&&$__viewport_46_js__.__esModule&&$__viewport_46_js__||{"default":$__viewport_46_js__}).WalkontableViewport;var Walkontable=function Walkontable(settings){var originalHeaders=[];this.guid="wt_"+randomString();if(settings.cloneSource){this.cloneSource=settings.cloneSource;this.cloneOverlay=settings.cloneOverlay;this.wtSettings=settings.cloneSource.wtSettings;this.wtTable=new WalkontableTable(this,settings.table,settings.wtRootElement);this.wtScroll=new WalkontableScroll(this);this.wtViewport=settings.cloneSource.wtViewport;this.wtEvent=new WalkontableEvent(this);this.selections=this.cloneSource.selections}else{this.wtSettings=new WalkontableSettings(this,settings);this.wtTable=new WalkontableTable(this,settings.table);this.wtScroll=new WalkontableScroll(this);this.wtViewport=new WalkontableViewport(this);this.wtEvent=new WalkontableEvent(this);this.selections=this.getSetting("selections");this.wtOverlays=new WalkontableOverlays(this)}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var c=0,clen=this.wtTable.THEAD.childNodes[0].childNodes.length;c<clen;c++){originalHeaders.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(column,TH){dom.fastInnerText(TH,originalHeaders[column])}])}}this.drawn=false;this.drawInterrupted=false};$traceurRuntime.createClass(Walkontable,{draw:function(){var fastDraw=arguments[0]!==void 0?arguments[0]:false;this.drawInterrupted=false;if(!fastDraw&&!dom.isVisible(this.wtTable.TABLE)){this.drawInterrupted=true}else{this.wtTable.draw(fastDraw)}return this},getCell:function(coords){var topmost=arguments[1]!==void 0?arguments[1]:false;if(!topmost){return this.wtTable.getCell(coords)}var fixedRows=this.wtSettings.getSetting("fixedRowsTop");var fixedColumns=this.wtSettings.getSetting("fixedColumnsLeft");if(coords.row<fixedRows&&coords.col<fixedColumns){return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(coords)}else if(coords.row<fixedRows){return this.wtOverlays.topOverlay.clone.wtTable.getCell(coords)}else if(coords.col<fixedColumns){return this.wtOverlays.leftOverlay.clone.wtTable.getCell(coords)}return this.wtTable.getCell(coords)},update:function(settings,value){return this.wtSettings.update(settings,value)},scrollVertical:function(row){this.wtOverlays.topOverlay.scrollTo(row);this.getSetting("onScrollVertically");return this},scrollHorizontal:function(column){this.wtOverlays.leftOverlay.scrollTo(column);this.getSetting("onScrollHorizontally");return this},scrollViewport:function(coords){this.wtScroll.scrollViewport(coords);return this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},getSetting:function(key,param1,param2,param3,param4){return this.wtSettings.getSetting(key,param1,param2,param3,param4)},hasSetting:function(key){return this.wtSettings.has(key)},destroy:function(){this.wtOverlays.destroy();if(this.wtEvent){this.wtEvent.destroy()}}},{});window.Walkontable=Walkontable},{"./../../../dom.js":27,"./../../../helpers.js":42,"./event.js":8,"./overlays.js":16,"./scroll.js":17,"./settings.js":19,"./table.js":20,"./viewport.js":22}],8:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableEvent:{get:function(){return WalkontableEvent}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47__46__46__47_eventManager_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47__46__46__47_eventManager_46_js__=require("./../../../eventManager.js"),$___46__46__47__46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_eventManager_46_js__}).eventManager;function WalkontableEvent(instance){var that=this;var eventManager=eventManagerObject(instance);this.instance=instance;var dblClickOrigin=[null,null];this.dblClickTimeout=[null,null];var onMouseDown=function(event){var cell=that.parentCell(event.realTarget);if(dom.hasClass(event.realTarget,"corner")){that.instance.getSetting("onCellCornerMouseDown",event,event.realTarget)}else if(cell.TD){if(that.instance.hasSetting("onCellMouseDown")){that.instance.getSetting("onCellMouseDown",event,cell.coords,cell.TD,that.instance)}}if(event.button!==2){if(cell.TD){dblClickOrigin[0]=cell.TD;clearTimeout(that.dblClickTimeout[0]);that.dblClickTimeout[0]=setTimeout(function(){dblClickOrigin[0]=null},1e3)}}};var onTouchMove=function(event){that.instance.touchMoving=true};var longTouchTimeout;var onTouchStart=function(event){var container=this;eventManager.addEventListener(this,"touchmove",onTouchMove);that.checkIfTouchMove=setTimeout(function(){if(that.instance.touchMoving===true){that.instance.touchMoving=void 0;eventManager.removeEventListener("touchmove",onTouchMove,false);return}else{onMouseDown(event)}},30)};var lastMouseOver;var onMouseOver=function(event){var table,td;if(that.instance.hasSetting("onCellMouseOver")){table=that.instance.wtTable.TABLE;td=dom.closest(event.realTarget,["TD","TH"],table);if(td&&td!==lastMouseOver&&dom.isChildOf(td,table)){lastMouseOver=td;that.instance.getSetting("onCellMouseOver",event,that.instance.wtTable.getCoords(td),td,that.instance)}}};var onMouseUp=function(event){if(event.button!==2){var cell=that.parentCell(event.realTarget);if(cell.TD===dblClickOrigin[0]&&cell.TD===dblClickOrigin[1]){if(dom.hasClass(event.realTarget,"corner")){that.instance.getSetting("onCellCornerDblClick",event,cell.coords,cell.TD,that.instance)}else{that.instance.getSetting("onCellDblClick",event,cell.coords,cell.TD,that.instance)}dblClickOrigin[0]=null;dblClickOrigin[1]=null}else if(cell.TD===dblClickOrigin[0]){dblClickOrigin[1]=cell.TD;clearTimeout(that.dblClickTimeout[1]);that.dblClickTimeout[1]=setTimeout(function(){dblClickOrigin[1]=null},500)}}};var onTouchEnd=function(event){clearTimeout(longTouchTimeout);event.preventDefault();onMouseUp(event)};eventManager.addEventListener(this.instance.wtTable.holder,"mousedown",onMouseDown);eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",onMouseOver);eventManager.addEventListener(this.instance.wtTable.holder,"mouseup",onMouseUp);if(this.instance.wtTable.holder.parentNode.parentNode&&Handsontable.mobileBrowser&&!that.instance.wtTable.isWorkingOnClone()){var classSelector="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");eventManager.addEventListener(this.instance.wtTable.holder,"touchstart",function(event){that.instance.touchApplied=true;if(dom.isChildOf(event.target,classSelector)){onTouchStart.call(event.target,event)}});eventManager.addEventListener(this.instance.wtTable.holder,"touchend",function(event){that.instance.touchApplied=false;if(dom.isChildOf(event.target,classSelector)){onTouchEnd.call(event.target,event)}});if(!that.instance.momentumScrolling){that.instance.momentumScrolling={}}eventManager.addEventListener(this.instance.wtTable.holder,"scroll",function(event){clearTimeout(that.instance.momentumScrolling._timeout);if(!that.instance.momentumScrolling.ongoing){that.instance.getSetting("onBeforeTouchScroll")}that.instance.momentumScrolling.ongoing=true;that.instance.momentumScrolling._timeout=setTimeout(function(){if(!that.instance.touchApplied){that.instance.momentumScrolling.ongoing=false;that.instance.getSetting("onAfterMomentumScroll")}},200)})}eventManager.addEventListener(window,"resize",function(){if(that.instance.getSetting("stretchH")!=="none"){that.instance.draw()}});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);eventManager.clear()}}WalkontableEvent.prototype.parentCell=function(elem){var cell={};var TABLE=this.instance.wtTable.TABLE;var TD=dom.closest(elem,["TD","TH"],TABLE);if(TD&&dom.isChildOf(TD,TABLE)){cell.coords=this.instance.wtTable.getCoords(TD);cell.TD=TD}else if(dom.hasClass(elem,"wtBorder")&&dom.hasClass(elem,"current")){cell.coords=this.instance.selections.current.cellRange.highlight;cell.TD=this.instance.wtTable.getCell(cell.coords)}else if(dom.hasClass(elem,"wtBorder")&&dom.hasClass(elem,"area")){if(this.instance.selections.area.cellRange){cell.coords=this.instance.selections.area.cellRange.to;cell.TD=this.instance.wtTable.getCell(cell.coords)}}return cell};window.WalkontableEvent=WalkontableEvent},{"./../../../dom.js":27,"./../../../eventManager.js":41}],9:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableColumnFilter:{get:function(){return WalkontableColumnFilter}},__esModule:{value:true}});var WalkontableColumnFilter=function WalkontableColumnFilter(offset,total,countTH){this.offset=offset;this.total=total;this.countTH=countTH};$traceurRuntime.createClass(WalkontableColumnFilter,{offsetted:function(index){return index+this.offset},unOffsetted:function(index){return index-this.offset},renderedToSource:function(index){return this.offsetted(index)},sourceToRendered:function(index){return this.unOffsetted(index)},offsettedTH:function(index){return index-this.countTH},unOffsettedTH:function(index){return index+this.countTH},visibleRowHeadedColumnToSourceColumn:function(index){return this.renderedToSource(this.offsettedTH(index))},sourceColumnToVisibleRowHeadedColumn:function(index){return this.unOffsettedTH(this.sourceToRendered(index))}},{});window.WalkontableColumnFilter=WalkontableColumnFilter},{}],10:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableRowFilter:{get:function(){return WalkontableRowFilter}},__esModule:{value:true}});var WalkontableRowFilter=function WalkontableRowFilter(offset,total,countTH){this.offset=offset;this.total=total;this.countTH=countTH};$traceurRuntime.createClass(WalkontableRowFilter,{offsetted:function(index){return index+this.offset},unOffsetted:function(index){return index-this.offset},renderedToSource:function(index){return this.offsetted(index)},sourceToRendered:function(index){return this.unOffsetted(index)},offsettedTH:function(index){return index-this.countTH},unOffsettedTH:function(index){return index+this.countTH},visibleColHeadedRowToSourceRow:function(index){return this.renderedToSource(this.offsettedTH(index))},sourceRowToVisibleColHeadedRow:function(index){return this.unOffsettedTH(this.sourceToRendered(index))}},{});window.WalkontableRowFilter=WalkontableRowFilter},{}],11:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableOverlay:{get:function(){return WalkontableOverlay}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47__46__46__47__46__46__47_helpers_46_js__,$___46__46__47__46__46__47__46__46__47__46__46__47_eventManager_46_js__;var dom=($___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../../dom.js"),$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__});var defineGetter=($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_46_js__=require("./../../../../helpers.js"),$___46__46__47__46__46__47__46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47__46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47__46__46__47__46__46__47_helpers_46_js__}).defineGetter;var eventManagerObject=($___46__46__47__46__46__47__46__46__47__46__46__47_eventManager_46_js__=require("./../../../../eventManager.js"),$___46__46__47__46__46__47__46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47__46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47__46__46__47__46__46__47_eventManager_46_js__}).eventManager;var WalkontableOverlay=function WalkontableOverlay(wotInstance){defineGetter(this,"wot",wotInstance,{writable:false});this.instance=this.wot;this.type="";this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=dom.getTrimmingContainer(this.hider.parentNode.parentNode);this.mainTableScrollableElement=dom.getScrollableElement(this.wot.wtTable.TABLE);this.needFullRender=this.shouldBeRendered();this.isElementSizesAdjusted=false};var $WalkontableOverlay=WalkontableOverlay;$traceurRuntime.createClass(WalkontableOverlay,{shouldBeRendered:function(){return true},makeClone:function(direction){if($WalkontableOverlay.CLONE_TYPES.indexOf(direction)===-1){throw new Error('Clone type "'+direction+'" is not supported.')}var clone=document.createElement("DIV");var clonedTable=document.createElement("TABLE");clone.className="ht_clone_"+direction+" handsontable";clone.style.position="absolute";clone.style.top=0;clone.style.left=0;clone.style.overflow="hidden";clonedTable.className=this.wot.wtTable.TABLE.className;clone.appendChild(clonedTable);this.type=direction;this.wot.wtTable.wtRootElement.parentNode.appendChild(clone);return new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:clonedTable})},refresh:function(){var fastDraw=arguments[0]!==void 0?arguments[0]:false;var nextCycleRenderFlag=this.shouldBeRendered();if(this.clone&&(this.needFullRender||nextCycleRenderFlag)){this.clone.draw(fastDraw)}this.needFullRender=nextCycleRenderFlag},destroy:function(){eventManagerObject(this.clone).clear()}},{get CLONE_TOP(){return"top"},get CLONE_LEFT(){return"left"},get CLONE_CORNER(){return"corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[$WalkontableOverlay.CLONE_TOP,$WalkontableOverlay.CLONE_LEFT,$WalkontableOverlay.CLONE_CORNER,$WalkontableOverlay.CLONE_DEBUG]}});window.WalkontableOverlay=WalkontableOverlay},{"./../../../../dom.js":27,"./../../../../eventManager.js":41,"./../../../../helpers.js":42}],12:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableCornerOverlay:{get:function(){return WalkontableCornerOverlay}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__,$___95_base_46_js__;var dom=($___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../../dom.js"),$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__});var WalkontableOverlay=($___95_base_46_js__=require("./_base.js"),$___95_base_46_js__&&$___95_base_46_js__.__esModule&&$___95_base_46_js__||{"default":$___95_base_46_js__}).WalkontableOverlay;var WalkontableCornerOverlay=function WalkontableCornerOverlay(wotInstance){$traceurRuntime.superConstructor($WalkontableCornerOverlay).call(this,wotInstance);this.clone=this.makeClone(WalkontableOverlay.CLONE_CORNER)};var $WalkontableCornerOverlay=WalkontableCornerOverlay;$traceurRuntime.createClass(WalkontableCornerOverlay,{shouldBeRendered:function(){return(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?true:false},resetFixedPosition:function(){if(!this.wot.wtTable.holder.parentNode){return}var overlayRoot=this.clone.wtTable.holder.parentNode;var tableHeight=dom.outerHeight(this.clone.wtTable.TABLE);var tableWidth=dom.outerWidth(this.clone.wtTable.TABLE);if(this.trimmingContainer===window){var box=this.wot.wtTable.hider.getBoundingClientRect();var top=Math.ceil(box.top);var left=Math.ceil(box.left);var bottom=Math.ceil(box.bottom);var right=Math.ceil(box.right);var finalLeft;var finalTop;if(left<0&&right-overlayRoot.offsetWidth>0){finalLeft=-left+"px"}else{finalLeft="0"}if(top<0&&bottom-overlayRoot.offsetHeight>0){finalTop=-top+"px"}else{finalTop="0"}dom.setOverlayPosition(overlayRoot,finalLeft,finalTop)}overlayRoot.style.height=(tableHeight===0?tableHeight:tableHeight+4)+"px";overlayRoot.style.width=(tableWidth===0?tableWidth:tableWidth+4)+"px"}},{},WalkontableOverlay);window.WalkontableCornerOverlay=WalkontableCornerOverlay},{"./../../../../dom.js":27,"./_base.js":11}],13:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableDebugOverlay:{get:function(){return WalkontableDebugOverlay}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__,$___95_base_46_js__;var dom=($___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../../dom.js"),$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__});var WalkontableOverlay=($___95_base_46_js__=require("./_base.js"),$___95_base_46_js__&&$___95_base_46_js__.__esModule&&$___95_base_46_js__||{"default":$___95_base_46_js__}).WalkontableOverlay;var WalkontableDebugOverlay=function WalkontableDebugOverlay(wotInstance){$traceurRuntime.superConstructor($WalkontableDebugOverlay).call(this,wotInstance);this.clone=this.makeClone(WalkontableOverlay.CLONE_DEBUG);this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";dom.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")};var $WalkontableDebugOverlay=WalkontableDebugOverlay;$traceurRuntime.createClass(WalkontableDebugOverlay,{},{},WalkontableOverlay);window.WalkontableDebugOverlay=WalkontableDebugOverlay},{"./../../../../dom.js":27,"./_base.js":11}],14:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableLeftOverlay:{get:function(){return WalkontableLeftOverlay}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__,$___95_base_46_js__;var dom=($___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../../dom.js"),$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__});var WalkontableOverlay=($___95_base_46_js__=require("./_base.js"),$___95_base_46_js__&&$___95_base_46_js__.__esModule&&$___95_base_46_js__||{"default":$___95_base_46_js__}).WalkontableOverlay;var WalkontableLeftOverlay=function WalkontableLeftOverlay(wotInstance){$traceurRuntime.superConstructor($WalkontableLeftOverlay).call(this,wotInstance);this.clone=this.makeClone(WalkontableOverlay.CLONE_LEFT)};var $WalkontableLeftOverlay=WalkontableLeftOverlay;$traceurRuntime.createClass(WalkontableLeftOverlay,{shouldBeRendered:function(){return this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length?true:false},resetFixedPosition:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return}var overlayRoot=this.clone.wtTable.holder.parentNode;var headerPosition=0;if(this.trimmingContainer===window){var box=this.wot.wtTable.hider.getBoundingClientRect();var left=Math.ceil(box.left);var right=Math.ceil(box.right);var finalLeft;var finalTop;finalTop=this.wot.wtTable.hider.style.top;finalTop=finalTop===""?0:finalTop;if(left<0&&right-overlayRoot.offsetWidth>0){finalLeft=-left}else{finalLeft=0}headerPosition=finalLeft;finalLeft=finalLeft+"px";dom.setOverlayPosition(overlayRoot,finalLeft,finalTop)}else{headerPosition=this.getScrollPosition()}this.adjustHeaderBordersPosition(headerPosition)},setScrollPosition:function(pos){if(this.mainTableScrollableElement===window){window.scrollTo(pos,dom.getWindowScrollTop())}else{this.mainTableScrollableElement.scrollLeft=pos}},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(from,to){var sum=0;var defaultColumnWidth=this.wot.wtSettings.defaultColumnWidth;while(from<to){sum+=this.wot.wtTable.getStretchedColumnWidth(from)||defaultColumnWidth;from++}return sum},adjustElementsSize:function(){if(this.needFullRender){this.adjustRootElementSize();this.adjustRootChildsSize();this.isElementSizesAdjusted=true}},adjustRootElementSize:function(){var masterHolder=this.wot.wtTable.holder;var scrollbarHeight=masterHolder.clientHeight!==masterHolder.offsetHeight?dom.getScrollbarWidth():0;var overlayRoot=this.clone.wtTable.holder.parentNode;var overlayRootStyle=overlayRoot.style;var tableWidth;if(this.trimmingContainer!==window){overlayRootStyle.height=this.wot.wtViewport.getWorkspaceHeight()-scrollbarHeight+"px"}this.clone.wtTable.holder.style.height=overlayRootStyle.height;tableWidth=dom.outerWidth(this.clone.wtTable.TABLE);overlayRootStyle.width=(tableWidth===0?tableWidth:tableWidth+4)+"px"},adjustRootChildsSize:function(){var scrollbarWidth=dom.getScrollbarWidth();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;if(scrollbarWidth===0){scrollbarWidth=30}this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+scrollbarWidth+"px"},applyToDOM:function(){var total=this.wot.getSetting("totalColumns");if(!this.isElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px"}else if(total===0){this.spreader.style.left="0"}else{throw new Error("Incorrect value of the columnsRenderCalculator")}this.spreader.style.right="";if(this.needFullRender){this.syncOverlayOffset()}},syncOverlayOffset:function(){if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px"}else{this.clone.wtTable.spreader.style.top=""}},scrollTo:function(sourceCol,beyondRendered){var newX=this.getTableParentOffset();var sourceInstance=this.wot.cloneSource?this.wot.cloneSource:this.wot;var mainHolder=sourceInstance.wtTable.holder;var scrollbarCompensation=0;if(beyondRendered&&mainHolder.offsetWidth!==mainHolder.clientWidth){scrollbarCompensation=dom.getScrollbarWidth()}if(beyondRendered){newX+=this.sumCellSizes(0,sourceCol+1);newX-=this.wot.wtViewport.getViewportWidth()}else{newX+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),sourceCol)}newX+=scrollbarCompensation;this.setScrollPosition(newX)},getTableParentOffset:function(){if(this.trimmingContainer===window){return this.wot.wtTable.holderOffset.left}else{return 0}},getScrollPosition:function(){return dom.getScrollLeft(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(position){if(this.wot.getSetting("fixedColumnsLeft")===0&&this.wot.getSetting("rowHeaders").length>0){var masterParent=this.wot.wtTable.holder.parentNode;var previousState=dom.hasClass(masterParent,"innerBorderLeft");if(position){dom.addClass(masterParent,"innerBorderLeft")}else{dom.removeClass(masterParent,"innerBorderLeft")}if(!previousState&&position||previousState&&!position){this.wot.wtOverlays.adjustElementsSize()}}}},{},WalkontableOverlay);window.WalkontableLeftOverlay=WalkontableLeftOverlay},{"./../../../../dom.js":27,"./_base.js":11}],15:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableTopOverlay:{get:function(){return WalkontableTopOverlay}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__,$___95_base_46_js__;var dom=($___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../../dom.js"),$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47__46__46__47_dom_46_js__});var WalkontableOverlay=($___95_base_46_js__=require("./_base.js"),$___95_base_46_js__&&$___95_base_46_js__.__esModule&&$___95_base_46_js__||{"default":$___95_base_46_js__}).WalkontableOverlay;var WalkontableTopOverlay=function WalkontableTopOverlay(wotInstance){$traceurRuntime.superConstructor($WalkontableTopOverlay).call(this,wotInstance);this.clone=this.makeClone(WalkontableOverlay.CLONE_TOP)};var $WalkontableTopOverlay=WalkontableTopOverlay;$traceurRuntime.createClass(WalkontableTopOverlay,{shouldBeRendered:function(){return this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length?true:false},resetFixedPosition:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return}var overlayRoot=this.clone.wtTable.holder.parentNode;var headerPosition=0;if(this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var box=this.wot.wtTable.hider.getBoundingClientRect();var top=Math.ceil(box.top);var bottom=Math.ceil(box.bottom);var finalLeft;var finalTop;finalLeft=this.wot.wtTable.hider.style.left;finalLeft=finalLeft===""?0:finalLeft;if(top<0&&bottom-overlayRoot.offsetHeight>0){finalTop=-top}else{finalTop=0}headerPosition=finalTop;finalTop=finalTop+"px";dom.setOverlayPosition(overlayRoot,finalLeft,finalTop)}else{headerPosition=this.getScrollPosition()}this.adjustHeaderBordersPosition(headerPosition)},setScrollPosition:function(pos){if(this.mainTableScrollableElement===window){window.scrollTo(dom.getWindowScrollLeft(),pos)}else{this.mainTableScrollableElement.scrollTop=pos}},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(from,to){var sum=0;var defaultRowHeight=this.wot.wtSettings.settings.defaultRowHeight;while(from<to){sum+=this.wot.wtTable.getRowHeight(from)||defaultRowHeight;from++}return sum},adjustElementsSize:function(){if(this.needFullRender){this.adjustRootElementSize();this.adjustRootChildsSize();this.isElementSizesAdjusted=true}},adjustRootElementSize:function(){var masterHolder=this.wot.wtTable.holder;var scrollbarWidth=masterHolder.clientWidth!==masterHolder.offsetWidth?dom.getScrollbarWidth():0;var overlayRoot=this.clone.wtTable.holder.parentNode;var overlayRootStyle=overlayRoot.style;var tableHeight;if(this.trimmingContainer!==window){overlayRootStyle.width=this.wot.wtViewport.getWorkspaceWidth()-scrollbarWidth+"px"}this.clone.wtTable.holder.style.width=overlayRootStyle.width;tableHeight=dom.outerHeight(this.clone.wtTable.TABLE);overlayRootStyle.height=(tableHeight===0?tableHeight:tableHeight+4)+"px"},adjustRootChildsSize:function(){var scrollbarWidth=dom.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;if(scrollbarWidth===0){scrollbarWidth=30}this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+scrollbarWidth+"px"},applyToDOM:function(){var total=this.wot.getSetting("totalRows");if(!this.isElementSizesAdjusted){this.adjustElementsSize()}if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==="number"){this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px"}else if(total===0){this.spreader.style.top="0"}else{throw new Error("Incorrect value of the rowsRenderCalculator")}this.spreader.style.bottom="";if(this.needFullRender){this.syncOverlayOffset()}},syncOverlayOffset:function(){if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==="number"){this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px"}else{this.clone.wtTable.spreader.style.left=""}},scrollTo:function(sourceRow,bottomEdge){var newY=this.getTableParentOffset();var sourceInstance=this.wot.cloneSource?this.wot.cloneSource:this.wot;var mainHolder=sourceInstance.wtTable.holder;var scrollbarCompensation=0;if(bottomEdge&&mainHolder.offsetHeight!==mainHolder.clientHeight){scrollbarCompensation=dom.getScrollbarWidth()}if(bottomEdge){newY+=this.sumCellSizes(0,sourceRow+1);newY-=this.wot.wtViewport.getViewportHeight();newY+=1}else{newY+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),sourceRow)}newY+=scrollbarCompensation;this.setScrollPosition(newY)},getTableParentOffset:function(){if(this.mainTableScrollableElement===window){return this.wot.wtTable.holderOffset.top}else{return 0}},getScrollPosition:function(){return dom.getScrollTop(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(position){if(this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0){var masterParent=this.wot.wtTable.holder.parentNode;var previousState=dom.hasClass(masterParent,"innerBorderTop");if(position){dom.addClass(masterParent,"innerBorderTop")}else{dom.removeClass(masterParent,"innerBorderTop")}if(!previousState&&position||previousState&&!position){this.wot.wtOverlays.adjustElementsSize()}}if(this.wot.getSetting("rowHeaders").length===0){var secondHeaderCell=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");if(secondHeaderCell){secondHeaderCell.style["border-left-width"]=0}}}},{},WalkontableOverlay);window.WalkontableTopOverlay=WalkontableTopOverlay},{"./../../../../dom.js":27,"./_base.js":11}],16:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableOverlays:{get:function(){return WalkontableOverlays}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47__46__46__47_eventManager_46_js__,$__overlay_47_corner_46_js__,$__overlay_47_debug_46_js__,$__overlay_47_left_46_js__,$__overlay_47_top_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var EventManager=($___46__46__47__46__46__47__46__46__47_eventManager_46_js__=require("./../../../eventManager.js"),$___46__46__47__46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__||{
"default":$___46__46__47__46__46__47__46__46__47_eventManager_46_js__}).EventManager;var WalkontableCornerOverlay=($__overlay_47_corner_46_js__=require("./overlay/corner.js"),$__overlay_47_corner_46_js__&&$__overlay_47_corner_46_js__.__esModule&&$__overlay_47_corner_46_js__||{"default":$__overlay_47_corner_46_js__}).WalkontableCornerOverlay;var WalkontableDebugOverlay=($__overlay_47_debug_46_js__=require("./overlay/debug.js"),$__overlay_47_debug_46_js__&&$__overlay_47_debug_46_js__.__esModule&&$__overlay_47_debug_46_js__||{"default":$__overlay_47_debug_46_js__}).WalkontableDebugOverlay;var WalkontableLeftOverlay=($__overlay_47_left_46_js__=require("./overlay/left.js"),$__overlay_47_left_46_js__&&$__overlay_47_left_46_js__.__esModule&&$__overlay_47_left_46_js__||{"default":$__overlay_47_left_46_js__}).WalkontableLeftOverlay;var WalkontableTopOverlay=($__overlay_47_top_46_js__=require("./overlay/top.js"),$__overlay_47_top_46_js__&&$__overlay_47_top_46_js__.__esModule&&$__overlay_47_top_46_js__||{"default":$__overlay_47_top_46_js__}).WalkontableTopOverlay;var WalkontableOverlays=function WalkontableOverlays(wotInstance){this.wot=wotInstance;this.instance=this.wot;this.eventManager=new EventManager(this.wot);this.wot.update("scrollbarWidth",dom.getScrollbarWidth());this.wot.update("scrollbarHeight",dom.getScrollbarWidth());this.mainTableScrollableElement=dom.getScrollableElement(this.wot.wtTable.TABLE);this.topOverlay=new WalkontableTopOverlay(this.wot);this.leftOverlay=new WalkontableLeftOverlay(this.wot);if(this.topOverlay.needFullRender&&this.leftOverlay.needFullRender){this.topLeftCornerOverlay=new WalkontableCornerOverlay(this.wot)}if(this.wot.getSetting("debug")){this.debug=new WalkontableDebugOverlay(this.wot)}this.destroyed=false;this.keyPressed=false;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},left:{top:0,left:null}};this.registerListeners()};$traceurRuntime.createClass(WalkontableOverlays,{refreshAll:function(){if(!this.wot.drawn){return}if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(true);this.topOverlay.onScroll();this.leftOverlay.onScroll()},registerListeners:function(){var $__5=this;this.eventManager.addEventListener(document.documentElement,"keydown",function(){return $__5.onKeyDown()});this.eventManager.addEventListener(document.documentElement,"keyup",function(){return $__5.onKeyUp()});this.eventManager.addEventListener(this.mainTableScrollableElement,"scroll",function(event){return $__5.onTableScroll(event)});if(this.topOverlay.needFullRender){this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"scroll",function(event){return $__5.onTableScroll(event)});this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"wheel",function(event){return $__5.onTableScroll(event)})}if(this.leftOverlay.needFullRender){this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"scroll",function(event){return $__5.onTableScroll(event)});this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"wheel",function(event){return $__5.onTableScroll(event)})}if(this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window){this.eventManager.addEventListener(window,"wheel",function(event){var overlay;var deltaY=event.wheelDeltaY||event.deltaY;var deltaX=event.wheelDeltaX||event.deltaX;if($__5.topOverlay.clone.wtTable.holder.contains(event.target)){overlay="top"}else if($__5.leftOverlay.clone.wtTable.holder.contains(event.target)){overlay="left"}if(overlay=="top"&&deltaY!==0){event.preventDefault()}else if(overlay=="left"&&deltaX!==0){event.preventDefault()}})}},onTableScroll:function(event){if(Handsontable.mobileBrowser){return}if(this.keyPressed&&this.mainTableScrollableElement!==window&&!event.target.contains(this.mainTableScrollableElement)){return}if(event.type==="scroll"){this.syncScrollPositions(event)}else{this.translateMouseWheelToScroll(event)}},onKeyDown:function(){this.keyPressed=true},onKeyUp:function(){this.keyPressed=false},translateMouseWheelToScroll:function(event){var topOverlay=this.topOverlay.clone.wtTable.holder;var leftOverlay=this.leftOverlay.clone.wtTable.holder;var eventMockup={type:"wheel"};var tempElem=event.target;var deltaY=event.wheelDeltaY||-1*event.deltaY;var deltaX=event.wheelDeltaX||-1*event.deltaX;var parentHolder;while(tempElem!=document&&tempElem!=null){if(tempElem.className.indexOf("wtHolder")>-1){parentHolder=tempElem;break}tempElem=tempElem.parentNode}eventMockup.target=parentHolder;if(parentHolder==topOverlay){this.syncScrollPositions(eventMockup,-.2*deltaY)}else if(parentHolder==leftOverlay){this.syncScrollPositions(eventMockup,-.2*deltaX)}return false},syncScrollPositions:function(event){var fakeScrollValue=arguments[1]!==void 0?arguments[1]:null;if(this.destroyed){return}if(arguments.length===0){this.syncScrollWithMaster();return}var master=this.mainTableScrollableElement;var target=event.target;var tempScrollValue=0;var scrollValueChanged=false;var topOverlay;var leftOverlay;if(this.topOverlay.needFullRender){topOverlay=this.topOverlay.clone.wtTable.holder}if(this.leftOverlay.needFullRender){leftOverlay=this.leftOverlay.clone.wtTable.holder}if(target===document){target=window}if(target===master){tempScrollValue=dom.getScrollLeft(target);if(this.overlayScrollPositions.master.left!==tempScrollValue){this.overlayScrollPositions.master.left=tempScrollValue;scrollValueChanged=true;if(topOverlay){topOverlay.scrollLeft=tempScrollValue}}tempScrollValue=dom.getScrollTop(target);if(this.overlayScrollPositions.master.top!==tempScrollValue){this.overlayScrollPositions.master.top=tempScrollValue;scrollValueChanged=true;if(leftOverlay){leftOverlay.scrollTop=tempScrollValue}}}else if(target===topOverlay){tempScrollValue=dom.getScrollLeft(target);if(this.overlayScrollPositions.top.left!==tempScrollValue){this.overlayScrollPositions.top.left=tempScrollValue;scrollValueChanged=true;master.scrollLeft=tempScrollValue}if(fakeScrollValue!==null){scrollValueChanged=true;master.scrollTop+=fakeScrollValue}}else if(target===leftOverlay){tempScrollValue=dom.getScrollTop(target);if(this.overlayScrollPositions.left.top!==tempScrollValue){this.overlayScrollPositions.left.top=tempScrollValue;scrollValueChanged=true;master.scrollTop=tempScrollValue}if(fakeScrollValue!==null){scrollValueChanged=true;master.scrollLeft+=fakeScrollValue}}if(!this.keyPressed&&scrollValueChanged&&event.type==="scroll"){this.refreshAll()}},syncScrollWithMaster:function(){var master=this.topOverlay.mainTableScrollableElement;if(this.topOverlay.needFullRender){this.topOverlay.clone.wtTable.holder.scrollLeft=master.scrollLeft}if(this.leftOverlay.needFullRender){this.leftOverlay.clone.wtTable.holder.scrollTop=master.scrollTop}},destroy:function(){this.eventManager.clear();this.topOverlay.destroy();this.leftOverlay.destroy();if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.destroy()}if(this.debug){this.debug.destroy()}this.destroyed=true},refresh:function(){var fastDraw=arguments[0]!==void 0?arguments[0]:false;if(this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted){var container=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement;var width=container.clientWidth;var height=container.clientHeight;if(width!==this.spreaderLastSize.width||height!==this.spreaderLastSize.height){this.spreaderLastSize.width=width;this.spreaderLastSize.height=height;this.adjustElementsSize()}}this.leftOverlay.refresh(fastDraw);this.topOverlay.refresh(fastDraw);if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.refresh(fastDraw)}if(this.debug){this.debug.refresh(fastDraw)}},adjustElementsSize:function(){var totalColumns=this.wot.getSetting("totalColumns");var totalRows=this.wot.getSetting("totalRows");var headerRowSize=this.wot.wtViewport.getRowHeaderWidth();var headerColumnSize=this.wot.wtViewport.getColumnHeaderHeight();var hiderStyle=this.wot.wtTable.hider.style;hiderStyle.width=headerRowSize+this.leftOverlay.sumCellSizes(0,totalColumns)+"px";hiderStyle.height=headerColumnSize+this.topOverlay.sumCellSizes(0,totalRows)+1+"px";this.topOverlay.adjustElementsSize();this.leftOverlay.adjustElementsSize()},applyToDOM:function(){if(!this.topOverlay.isElementSizesAdjusted||!this.leftOverlay.isElementSizesAdjusted){this.adjustElementsSize()}this.topOverlay.applyToDOM();this.leftOverlay.applyToDOM()}},{});window.WalkontableOverlays=WalkontableOverlays},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15}],17:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableScroll:{get:function(){return WalkontableScroll}},__esModule:{value:true}});var WalkontableScroll=function WalkontableScroll(wotInstance){this.wot=wotInstance;this.instance=wotInstance};$traceurRuntime.createClass(WalkontableScroll,{scrollViewport:function(coords){if(!this.wot.drawn){return}var totalRows=this.wot.getSetting("totalRows");var totalColumns=this.wot.getSetting("totalColumns");if(coords.row<0||coords.row>totalRows-1){throw new Error("row "+coords.row+" does not exist")}if(coords.col<0||coords.col>totalColumns-1){throw new Error("column "+coords.col+" does not exist")}if(coords.row>this.instance.wtTable.getLastVisibleRow()){this.wot.wtOverlays.topOverlay.scrollTo(coords.row,true)}else if(coords.row>=this.instance.getSetting("fixedRowsTop")&&coords.row<this.instance.wtTable.getFirstVisibleRow()){this.wot.wtOverlays.topOverlay.scrollTo(coords.row)}if(coords.col>this.instance.wtTable.getLastVisibleColumn()){this.wot.wtOverlays.leftOverlay.scrollTo(coords.col,true)}else if(coords.col>=this.instance.getSetting("fixedColumnsLeft")&&coords.col<this.instance.wtTable.getFirstVisibleColumn()){this.wot.wtOverlays.leftOverlay.scrollTo(coords.col)}}},{});window.WalkontableScroll=WalkontableScroll},{}],18:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableSelection:{get:function(){return WalkontableSelection}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__,$__border_46_js__,$__cell_47_coords_46_js__,$__cell_47_range_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var WalkontableBorder=($__border_46_js__=require("./border.js"),$__border_46_js__&&$__border_46_js__.__esModule&&$__border_46_js__||{"default":$__border_46_js__}).WalkontableBorder;var WalkontableCellCoords=($__cell_47_coords_46_js__=require("./cell/coords.js"),$__cell_47_coords_46_js__&&$__cell_47_coords_46_js__.__esModule&&$__cell_47_coords_46_js__||{"default":$__cell_47_coords_46_js__}).WalkontableCellCoords;var WalkontableCellRange=($__cell_47_range_46_js__=require("./cell/range.js"),$__cell_47_range_46_js__&&$__cell_47_range_46_js__.__esModule&&$__cell_47_range_46_js__||{"default":$__cell_47_range_46_js__}).WalkontableCellRange;var WalkontableSelection=function WalkontableSelection(settings,cellRange){this.settings=settings;this.cellRange=cellRange||null;this.instanceBorders={}};$traceurRuntime.createClass(WalkontableSelection,{getBorder:function(wotInstance){if(this.instanceBorders[wotInstance.guid]){return this.instanceBorders[wotInstance.guid]}this.instanceBorders[wotInstance.guid]=new WalkontableBorder(wotInstance,this.settings)},isEmpty:function(){return this.cellRange===null},add:function(coords){if(this.isEmpty()){this.cellRange=new WalkontableCellRange(coords,coords,coords)}else{this.cellRange.expand(coords)}},replace:function(oldCoords,newCoords){if(!this.isEmpty()){if(this.cellRange.from.isEqual(oldCoords)){this.cellRange.from=newCoords;return true}if(this.cellRange.to.isEqual(oldCoords)){this.cellRange.to=newCoords;return true}}return false},clear:function(){this.cellRange=null},getCorners:function(){var topLeft=this.cellRange.getTopLeftCorner();var bottomRight=this.cellRange.getBottomRightCorner();return[topLeft.row,topLeft.col,bottomRight.row,bottomRight.col]},addClassAtCoords:function(wotInstance,sourceRow,sourceColumn,className){var TD=wotInstance.wtTable.getCell(new WalkontableCellCoords(sourceRow,sourceColumn));if(typeof TD==="object"){dom.addClass(TD,className)}},draw:function(wotInstance){if(this.isEmpty()){if(this.settings.border){var border=this.getBorder(wotInstance);if(border){border.disappear()}}return}var renderedRows=wotInstance.wtTable.getRenderedRowsCount();var renderedColumns=wotInstance.wtTable.getRenderedColumnsCount();var corners=this.getCorners();var sourceRow,sourceCol,TH;for(var column=0;column<renderedColumns;column++){sourceCol=wotInstance.wtTable.columnFilter.renderedToSource(column);if(sourceCol>=corners[1]&&sourceCol<=corners[3]){TH=wotInstance.wtTable.getColumnHeader(sourceCol);if(TH&&this.settings.highlightColumnClassName){dom.addClass(TH,this.settings.highlightColumnClassName)}}}for(var row=0;row<renderedRows;row++){sourceRow=wotInstance.wtTable.rowFilter.renderedToSource(row);if(sourceRow>=corners[0]&&sourceRow<=corners[2]){TH=wotInstance.wtTable.getRowHeader(sourceRow);if(TH&&this.settings.highlightRowClassName){dom.addClass(TH,this.settings.highlightRowClassName)}}for(var column$__4=0;column$__4<renderedColumns;column$__4++){sourceCol=wotInstance.wtTable.columnFilter.renderedToSource(column$__4);if(sourceRow>=corners[0]&&sourceRow<=corners[2]&&sourceCol>=corners[1]&&sourceCol<=corners[3]){if(this.settings.className){this.addClassAtCoords(wotInstance,sourceRow,sourceCol,this.settings.className)}}else if(sourceRow>=corners[0]&&sourceRow<=corners[2]){if(this.settings.highlightRowClassName){this.addClassAtCoords(wotInstance,sourceRow,sourceCol,this.settings.highlightRowClassName)}}else if(sourceCol>=corners[1]&&sourceCol<=corners[3]){if(this.settings.highlightColumnClassName){this.addClassAtCoords(wotInstance,sourceRow,sourceCol,this.settings.highlightColumnClassName)}}}}wotInstance.getSetting("onBeforeDrawBorders",corners,this.settings.className);if(this.settings.border){var border$__5=this.getBorder(wotInstance);if(border$__5){border$__5.appear(corners)}}}},{});window.WalkontableSelection=WalkontableSelection},{"./../../../dom.js":27,"./border.js":2,"./cell/coords.js":5,"./cell/range.js":6}],19:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableSettings:{get:function(){return WalkontableSettings}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var WalkontableSettings=function WalkontableSettings(wotInstance,settings){var $__0=this;this.wot=wotInstance;this.instance=wotInstance;this.defaults={table:void 0,debug:false,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(row,column,TD){var cellData=$__0.getSetting("data",row,column);dom.fastInnerText(TD,cellData===void 0||cellData===null?"":cellData)},columnWidth:function(col){return},rowHeight:function(row){return},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:false,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:false,groups:false};this.settings={};for(var i in this.defaults){if(this.defaults.hasOwnProperty(i)){if(settings[i]!==void 0){this.settings[i]=settings[i]}else if(this.defaults[i]===void 0){throw new Error('A required setting "'+i+'" was not provided')}else{this.settings[i]=this.defaults[i]}}}};$traceurRuntime.createClass(WalkontableSettings,{update:function(settings,value){if(value===void 0){for(var i in settings){if(settings.hasOwnProperty(i)){this.settings[i]=settings[i]}}}else{this.settings[settings]=value}return this.wot},getSetting:function(key,param1,param2,param3,param4){if(typeof this.settings[key]==="function"){return this.settings[key](param1,param2,param3,param4)}else if(param1!==void 0&&Array.isArray(this.settings[key])){return this.settings[key][param1]}else{return this.settings[key]}},has:function(key){return!!this.settings[key]}},{});window.WalkontableSettings=WalkontableSettings},{"./../../../dom.js":27}],20:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableTable:{get:function(){return WalkontableTable}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__,$__cell_47_coords_46_js__,$__cell_47_range_46_js__,$__filter_47_column_46_js__,$__overlay_47_corner_46_js__,$__overlay_47_debug_46_js__,$__overlay_47_left_46_js__,$__filter_47_row_46_js__,$__tableRenderer_46_js__,$__overlay_47_top_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var WalkontableCellCoords=($__cell_47_coords_46_js__=require("./cell/coords.js"),$__cell_47_coords_46_js__&&$__cell_47_coords_46_js__.__esModule&&$__cell_47_coords_46_js__||{"default":$__cell_47_coords_46_js__}).WalkontableCellCoords;var WalkontableCellRange=($__cell_47_range_46_js__=require("./cell/range.js"),$__cell_47_range_46_js__&&$__cell_47_range_46_js__.__esModule&&$__cell_47_range_46_js__||{"default":$__cell_47_range_46_js__}).WalkontableCellRange;var WalkontableColumnFilter=($__filter_47_column_46_js__=require("./filter/column.js"),$__filter_47_column_46_js__&&$__filter_47_column_46_js__.__esModule&&$__filter_47_column_46_js__||{"default":$__filter_47_column_46_js__}).WalkontableColumnFilter;var WalkontableCornerOverlay=($__overlay_47_corner_46_js__=require("./overlay/corner.js"),$__overlay_47_corner_46_js__&&$__overlay_47_corner_46_js__.__esModule&&$__overlay_47_corner_46_js__||{"default":$__overlay_47_corner_46_js__}).WalkontableCornerOverlay;var WalkontableDebugOverlay=($__overlay_47_debug_46_js__=require("./overlay/debug.js"),$__overlay_47_debug_46_js__&&$__overlay_47_debug_46_js__.__esModule&&$__overlay_47_debug_46_js__||{"default":$__overlay_47_debug_46_js__}).WalkontableDebugOverlay;var WalkontableLeftOverlay=($__overlay_47_left_46_js__=require("./overlay/left.js"),$__overlay_47_left_46_js__&&$__overlay_47_left_46_js__.__esModule&&$__overlay_47_left_46_js__||{"default":$__overlay_47_left_46_js__}).WalkontableLeftOverlay;var WalkontableRowFilter=($__filter_47_row_46_js__=require("./filter/row.js"),$__filter_47_row_46_js__&&$__filter_47_row_46_js__.__esModule&&$__filter_47_row_46_js__||{"default":$__filter_47_row_46_js__}).WalkontableRowFilter;var WalkontableTableRenderer=($__tableRenderer_46_js__=require("./tableRenderer.js"),$__tableRenderer_46_js__&&$__tableRenderer_46_js__.__esModule&&$__tableRenderer_46_js__||{"default":$__tableRenderer_46_js__}).WalkontableTableRenderer;var WalkontableTopOverlay=($__overlay_47_top_46_js__=require("./overlay/top.js"),$__overlay_47_top_46_js__&&$__overlay_47_top_46_js__.__esModule&&$__overlay_47_top_46_js__||{"default":$__overlay_47_top_46_js__}).WalkontableTopOverlay;function WalkontableTable(instance,table){this.instance=instance;this.TABLE=table;dom.removeTextNodes(this.TABLE);var parent=this.TABLE.parentNode;if(!parent||parent.nodeType!==1||!dom.hasClass(parent,"wtHolder")){var spreader=document.createElement("DIV");spreader.className="wtSpreader";if(parent){parent.insertBefore(spreader,this.TABLE)}spreader.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;this.spreader.style.position="relative";parent=this.spreader.parentNode;if(!parent||parent.nodeType!==1||!dom.hasClass(parent,"wtHolder")){var hider=document.createElement("DIV");hider.className="wtHider";if(parent){parent.insertBefore(hider,this.spreader)}hider.appendChild(this.spreader)}this.hider=this.spreader.parentNode;parent=this.hider.parentNode;if(!parent||parent.nodeType!==1||!dom.hasClass(parent,"wtHolder")){var holder=document.createElement("DIV");holder.style.position="relative";holder.className="wtHolder";if(parent){parent.insertBefore(holder,this.hider)}if(!instance.cloneSource){holder.parentNode.className+="ht_master handsontable"}holder.appendChild(this.hider)}this.holder=this.hider.parentNode;this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.instance.getSetting("columnHeaders").length){if(!this.THEAD.childNodes.length){var TR=document.createElement("TR");this.THEAD.appendChild(TR)}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null}WalkontableTable.prototype.alignOverlaysWithTrimmingContainer=function(){var trimmingElement=dom.getTrimmingContainer(this.wtRootElement);if(!this.isWorkingOnClone()){this.holder.parentNode.style.position="relative";if(trimmingElement!==window){this.holder.style.width=dom.getStyle(trimmingElement,"width");this.holder.style.height=dom.getStyle(trimmingElement,"height");this.holder.style.overflow=""}else{this.holder.style.overflow="visible";this.wtRootElement.style.overflow="visible"}}};WalkontableTable.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource};WalkontableTable.prototype.draw=function(fastDraw){if(!this.isWorkingOnClone()){this.holderOffset=dom.offset(this.holder);fastDraw=this.instance.wtViewport.createRenderCalculators(fastDraw)}if(!fastDraw){if(this.isWorkingOnClone()){this.tableOffset=this.instance.cloneSource.wtTable.tableOffset}else{this.tableOffset=dom.offset(this.TABLE)}var startRow;if(this.instance.cloneOverlay instanceof WalkontableDebugOverlay||this.instance.cloneOverlay instanceof WalkontableTopOverlay||this.instance.cloneOverlay instanceof WalkontableCornerOverlay){startRow=0}else{startRow=this.instance.wtViewport.rowsRenderCalculator.startRow}var startColumn;if(this.instance.cloneOverlay instanceof WalkontableDebugOverlay||this.instance.cloneOverlay instanceof WalkontableLeftOverlay||this.instance.cloneOverlay instanceof WalkontableCornerOverlay){startColumn=0}else{startColumn=this.instance.wtViewport.columnsRenderCalculator.startColumn}this.rowFilter=new WalkontableRowFilter(startRow,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length);this.columnFilter=new WalkontableColumnFilter(startColumn,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length);this._doDraw();this.alignOverlaysWithTrimmingContainer()}else{if(!this.isWorkingOnClone()){this.instance.wtViewport.createVisibleCalculators()}if(this.instance.wtOverlays){this.instance.wtOverlays.refresh(true)}}this.refreshSelections(fastDraw);if(!this.isWorkingOnClone()){this.instance.wtOverlays.topOverlay.resetFixedPosition();this.instance.wtOverlays.leftOverlay.resetFixedPosition();if(this.instance.wtOverlays.topLeftCornerOverlay){this.instance.wtOverlays.topLeftCornerOverlay.resetFixedPosition()}}this.instance.drawn=true;return this};WalkontableTable.prototype._doDraw=function(){var wtRenderer=new WalkontableTableRenderer(this);wtRenderer.render()};WalkontableTable.prototype.removeClassFromCells=function(className){var nodes=this.TABLE.querySelectorAll("."+className);for(var i=0,ilen=nodes.length;i<ilen;i++){dom.removeClass(nodes[i],className)}};WalkontableTable.prototype.refreshSelections=function(fastDraw){var i,len;if(!this.instance.selections){return}len=this.instance.selections.length;if(fastDraw){for(i=0;i<len;i++){if(this.instance.selections[i].settings.className){this.removeClassFromCells(this.instance.selections[i].settings.className)}if(this.instance.selections[i].settings.highlightRowClassName){this.removeClassFromCells(this.instance.selections[i].settings.highlightRowClassName)}if(this.instance.selections[i].settings.highlightColumnClassName){this.removeClassFromCells(this.instance.selections[i].settings.highlightColumnClassName)}}}for(i=0;i<len;i++){this.instance.selections[i].draw(this.instance,fastDraw)}};WalkontableTable.prototype.getCell=function(coords){if(this.isRowBeforeRenderedRows(coords.row)){return-1}else if(this.isRowAfterRenderedRows(coords.row)){return-2}var TR=this.TBODY.childNodes[this.rowFilter.sourceToRendered(coords.row)];if(TR){return TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(coords.col)]}};WalkontableTable.prototype.getColumnHeader=function(col,level){if(!level){level=0}var TR=this.THEAD.childNodes[level];if(TR){return TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)]}};WalkontableTable.prototype.getRowHeader=function(row){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0){return null}var TR=this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)];if(TR){return TR.childNodes[0]}};WalkontableTable.prototype.getCoords=function(TD){var TR=TD.parentNode;var row=dom.index(TR);if(TR.parentNode===this.THEAD){row=this.rowFilter.visibleColHeadedRowToSourceRow(row)}else{row=this.rowFilter.renderedToSource(row)}return new WalkontableCellCoords(row,this.columnFilter.visibleRowHeadedColumnToSourceColumn(TD.cellIndex))};WalkontableTable.prototype.getTrForRow=function(row){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)]};WalkontableTable.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow};WalkontableTable.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow};WalkontableTable.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn};WalkontableTable.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn};WalkontableTable.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow};WalkontableTable.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow};WalkontableTable.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn};WalkontableTable.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn};WalkontableTable.prototype.isRowBeforeRenderedRows=function(r){return this.rowFilter.sourceToRendered(r)<0&&r>=0};WalkontableTable.prototype.isRowAfterViewport=function(r){return r>this.getLastVisibleRow()};WalkontableTable.prototype.isRowAfterRenderedRows=function(r){return r>this.getLastRenderedRow()};WalkontableTable.prototype.isColumnBeforeViewport=function(c){return this.columnFilter.sourceToRendered(c)<0&&c>=0};WalkontableTable.prototype.isColumnAfterViewport=function(c){return c>this.getLastVisibleColumn()};WalkontableTable.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()};WalkontableTable.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn};WalkontableTable.prototype.getRenderedColumnsCount=function(){if(this.instance.cloneOverlay instanceof WalkontableDebugOverlay){return this.instance.getSetting("totalColumns")}else if(this.instance.cloneOverlay instanceof WalkontableLeftOverlay||this.instance.cloneOverlay instanceof WalkontableCornerOverlay){return this.instance.getSetting("fixedColumnsLeft")}else{return this.instance.wtViewport.columnsRenderCalculator.count}};WalkontableTable.prototype.getRenderedRowsCount=function(){if(this.instance.cloneOverlay instanceof WalkontableDebugOverlay){return this.instance.getSetting("totalRows")}else if(this.instance.cloneOverlay instanceof WalkontableTopOverlay||this.instance.cloneOverlay instanceof WalkontableCornerOverlay){return this.instance.getSetting("fixedRowsTop")}return this.instance.wtViewport.rowsRenderCalculator.count};WalkontableTable.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count};WalkontableTable.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()};WalkontableTable.prototype.getRowHeight=function(sourceRow){var height=this.instance.wtSettings.settings.rowHeight(sourceRow),oversizedHeight=this.instance.wtViewport.oversizedRows[sourceRow];if(oversizedHeight!==void 0){height=height?Math.max(height,oversizedHeight):oversizedHeight}return height};WalkontableTable.prototype.getColumnHeaderHeight=function(level){var height=this.instance.wtSettings.settings.defaultRowHeight,oversizedHeight=this.instance.wtViewport.oversizedColumnHeaders[level];if(oversizedHeight!==void 0){height=height?Math.max(height,oversizedHeight):oversizedHeight}return height};WalkontableTable.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count};WalkontableTable.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()};WalkontableTable.prototype.getColumnWidth=function(sourceColumn){var width=this.instance.wtSettings.settings.columnWidth;if(typeof width==="function"){width=width(sourceColumn)}else if(typeof width==="object"){width=width[sourceColumn]}var oversizedWidth=this.instance.wtViewport.oversizedCols[sourceColumn];if(oversizedWidth!==void 0){width=width?Math.max(width,oversizedWidth):oversizedWidth}return width};WalkontableTable.prototype.getStretchedColumnWidth=function(sourceColumn){var width=this.getColumnWidth(sourceColumn)||this.instance.wtSettings.settings.defaultColumnWidth,calculator=this.instance.wtViewport.columnsRenderCalculator,stretchedWidth;if(calculator){stretchedWidth=calculator.getStretchedColumnWidth(sourceColumn,width);if(stretchedWidth){width=stretchedWidth}}return width};window.WalkontableTable=WalkontableTable},{"./../../../dom.js":27,"./cell/coords.js":5,"./cell/range.js":6,"./filter/column.js":9,"./filter/row.js":10,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15,"./tableRenderer.js":21}],21:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableTableRenderer:{get:function(){return WalkontableTableRenderer}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__
});var isRenderedColumnHeaders={};var WalkontableTableRenderer=function WalkontableTableRenderer(wtTable){this.wtTable=wtTable;this.wot=wtTable.instance;this.instance=wtTable.instance;this.rowFilter=wtTable.rowFilter;this.columnFilter=wtTable.columnFilter;this.TABLE=wtTable.TABLE;this.THEAD=wtTable.THEAD;this.TBODY=wtTable.TBODY;this.COLGROUP=wtTable.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.columnHeaderCount=0;this.fixedRowsTop=0};$traceurRuntime.createClass(WalkontableTableRenderer,{render:function(){if(!this.wtTable.isWorkingOnClone()){this.wot.getSetting("beforeDraw",true)}this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.columnHeaders=this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var columnsToRender=this.wtTable.getRenderedColumnsCount();var rowsToRender=this.wtTable.getRenderedRowsCount();var totalColumns=this.wot.getSetting("totalColumns");var totalRows=this.wot.getSetting("totalRows");var workspaceWidth;var adjusted=false;if(totalColumns>0){this.adjustAvailableNodes();adjusted=true;this.renderColGroups();this.renderColumnHeaders();this.renderRows(totalRows,rowsToRender,columnsToRender);if(!this.wtTable.isWorkingOnClone()){workspaceWidth=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtViewport.containerWidth=null}else{this.adjustColumnHeaderHeights()}this.adjustColumnWidths(columnsToRender)}if(!adjusted){this.adjustAvailableNodes()}this.removeRedundantRows(rowsToRender);if(!this.wtTable.isWorkingOnClone()){this.markOversizedRows();this.wot.wtViewport.createVisibleCalculators();this.wot.wtOverlays.refresh(false);this.wot.wtOverlays.applyToDOM();if(workspaceWidth!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var firstRendered=this.wtTable.getFirstRenderedColumn();var lastRendered=this.wtTable.getLastRenderedColumn();for(var i=firstRendered;i<lastRendered;i++){var width=this.wtTable.getStretchedColumnWidth(i);var renderedIndex=this.columnFilter.sourceToRendered(i);this.COLGROUP.childNodes[renderedIndex+this.rowHeaderCount].style.width=width+"px"}}this.wot.getSetting("onDraw",true)}},removeRedundantRows:function(renderedRowsCount){while(this.wtTable.tbodyChildrenLength>renderedRowsCount){this.TBODY.removeChild(this.TBODY.lastChild);this.wtTable.tbodyChildrenLength--}},renderRows:function(totalRows,rowsToRender,columnsToRender){var lastTD,TR;var visibleRowIndex=0;var sourceRowIndex=this.rowFilter.renderedToSource(visibleRowIndex);var isWorkingOnClone=this.wtTable.isWorkingOnClone();while(sourceRowIndex<totalRows&&sourceRowIndex>=0){if(visibleRowIndex>1e3){throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.")}if(rowsToRender!==void 0&&visibleRowIndex===rowsToRender){break}TR=this.getOrCreateTrForRow(visibleRowIndex,TR);this.renderRowHeaders(sourceRowIndex,TR);this.adjustColumns(TR,columnsToRender+this.rowHeaderCount);lastTD=this.renderCells(sourceRowIndex,TR,columnsToRender);if(!isWorkingOnClone){this.resetOversizedRow(sourceRowIndex)}if(TR.firstChild){var height=this.wot.wtTable.getRowHeight(sourceRowIndex);if(height){TR.firstChild.style.height=height+"px"}else{TR.firstChild.style.height=""}}visibleRowIndex++;sourceRowIndex=this.rowFilter.renderedToSource(visibleRowIndex)}},resetOversizedRow:function(sourceRow){if(this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[sourceRow]){this.wot.wtViewport.oversizedRows[sourceRow]=void 0}},markOversizedRows:function(){var rowCount=this.instance.wtTable.TBODY.childNodes.length;var expectedTableHeight=rowCount*this.instance.wtSettings.settings.defaultRowHeight;var actualTableHeight=dom.innerHeight(this.instance.wtTable.TBODY)-1;var previousRowHeight;var rowInnerHeight;var sourceRowIndex;var currentTr;var rowHeader;if(expectedTableHeight===actualTableHeight){return}while(rowCount){rowCount--;sourceRowIndex=this.instance.wtTable.rowFilter.renderedToSource(rowCount);previousRowHeight=this.instance.wtTable.getRowHeight(sourceRowIndex);currentTr=this.instance.wtTable.getTrForRow(sourceRowIndex);rowHeader=currentTr.querySelector("th");if(rowHeader){rowInnerHeight=dom.innerHeight(rowHeader)}else{rowInnerHeight=dom.innerHeight(currentTr)-1}if(!previousRowHeight&&this.instance.wtSettings.settings.defaultRowHeight<rowInnerHeight||previousRowHeight<rowInnerHeight){this.instance.wtViewport.oversizedRows[sourceRowIndex]=rowInnerHeight}}},adjustColumnHeaderHeights:function(){var columnHeaders=this.wot.getSetting("columnHeaders");var childs=this.wot.wtTable.THEAD.childNodes;var oversizedCols=this.wot.wtViewport.oversizedColumnHeaders;for(var i=0,len=columnHeaders.length;i<len;i++){if(oversizedCols[i]){if(childs[i].childNodes.length===0){return}childs[i].childNodes[0].style.height=oversizedCols[i]+"px"}}},markIfOversizedColumnHeader:function(col){var level=this.wot.getSetting("columnHeaders").length;var defaultRowHeight=this.wot.wtSettings.settings.defaultRowHeight;var sourceColIndex;var previousColHeaderHeight;var currentHeader;var currentHeaderHeight;sourceColIndex=this.wot.wtTable.columnFilter.renderedToSource(col);while(level){level--;previousColHeaderHeight=this.wot.wtTable.getColumnHeaderHeight(level);currentHeader=this.wot.wtTable.getColumnHeader(sourceColIndex,level);if(!currentHeader){continue}currentHeaderHeight=dom.innerHeight(currentHeader);if(!previousColHeaderHeight&&defaultRowHeight<currentHeaderHeight||previousColHeaderHeight<currentHeaderHeight){this.wot.wtViewport.oversizedColumnHeaders[level]=currentHeaderHeight}}},renderCells:function(sourceRowIndex,TR,columnsToRender){var TD;var sourceColIndex;for(var visibleColIndex=0;visibleColIndex<columnsToRender;visibleColIndex++){sourceColIndex=this.columnFilter.renderedToSource(visibleColIndex);if(visibleColIndex===0){TD=TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(sourceColIndex)]}else{TD=TD.nextSibling}if(TD.nodeName=="TH"){TD=replaceThWithTd(TD,TR)}if(!dom.hasClass(TD,"hide")){TD.className=""}TD.removeAttribute("style");this.wot.wtSettings.settings.cellRenderer(sourceRowIndex,sourceColIndex,TD)}return TD},adjustColumnWidths:function(columnsToRender){var scrollbarCompensation=0;var sourceInstance=this.wot.cloneSource?this.wot.cloneSource:this.wot;var mainHolder=sourceInstance.wtTable.holder;if(mainHolder.offsetHeight<mainHolder.scrollHeight){scrollbarCompensation=dom.getScrollbarWidth()}this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-scrollbarCompensation);for(var renderedColIndex=0;renderedColIndex<columnsToRender;renderedColIndex++){var width=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(renderedColIndex));this.COLGROUP.childNodes[renderedColIndex+this.rowHeaderCount].style.width=width+"px"}},appendToTbody:function(TR){this.TBODY.appendChild(TR);this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(rowIndex,currentTr){var TR;if(rowIndex>=this.wtTable.tbodyChildrenLength){TR=this.createRow();this.appendToTbody(TR)}else if(rowIndex===0){TR=this.TBODY.firstChild}else{TR=currentTr.nextSibling}return TR},createRow:function(){var TR=document.createElement("TR");for(var visibleColIndex=0;visibleColIndex<this.rowHeaderCount;visibleColIndex++){TR.appendChild(document.createElement("TH"))}return TR},renderRowHeader:function(row,col,TH){TH.className="";TH.removeAttribute("style");this.rowHeaders[col](row,TH,col)},renderRowHeaders:function(row,TR){for(var TH=TR.firstChild,visibleColIndex=0;visibleColIndex<this.rowHeaderCount;visibleColIndex++){if(!TH){TH=document.createElement("TH");TR.appendChild(TH)}else if(TH.nodeName=="TD"){TH=replaceTdWithTh(TH,TR)}this.renderRowHeader(row,visibleColIndex,TH);TH=TH.nextSibling}},adjustAvailableNodes:function(){this.adjustColGroups();this.adjustThead()},renderColumnHeaders:function(){var overlayName=this.wot.getOverlayName();if(!this.columnHeaderCount){return}var columnCount=this.wtTable.getRenderedColumnsCount();for(var i=0;i<this.columnHeaderCount;i++){var TR=this.getTrForColumnHeaders(i);for(var renderedColumnIndex=-1*this.rowHeaderCount;renderedColumnIndex<columnCount;renderedColumnIndex++){var sourceCol=this.columnFilter.renderedToSource(renderedColumnIndex);this.renderColumnHeader(i,sourceCol,TR.childNodes[renderedColumnIndex+this.rowHeaderCount]);if(!isRenderedColumnHeaders[overlayName]&&!this.wtTable.isWorkingOnClone()){this.markIfOversizedColumnHeader(renderedColumnIndex)}}}isRenderedColumnHeaders[overlayName]=true},adjustColGroups:function(){var columnCount=this.wtTable.getRenderedColumnsCount();while(this.wtTable.colgroupChildrenLength<columnCount+this.rowHeaderCount){this.COLGROUP.appendChild(document.createElement("COL"));this.wtTable.colgroupChildrenLength++}while(this.wtTable.colgroupChildrenLength>columnCount+this.rowHeaderCount){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.wtTable.colgroupChildrenLength--}},adjustThead:function(){var columnCount=this.wtTable.getRenderedColumnsCount();var TR=this.THEAD.firstChild;if(this.columnHeaders.length){for(var i=0,len=this.columnHeaders.length;i<len;i++){TR=this.THEAD.childNodes[i];if(!TR){TR=document.createElement("TR");this.THEAD.appendChild(TR)}this.theadChildrenLength=TR.childNodes.length;while(this.theadChildrenLength<columnCount+this.rowHeaderCount){TR.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>columnCount+this.rowHeaderCount){TR.removeChild(TR.lastChild);this.theadChildrenLength--}}var theadChildrenLength=this.THEAD.childNodes.length;if(theadChildrenLength>this.columnHeaders.length){for(var i$__1=this.columnHeaders.length;i$__1<theadChildrenLength;i$__1++){this.THEAD.removeChild(this.THEAD.lastChild)}}}else if(TR){dom.empty(TR)}},getTrForColumnHeaders:function(index){return this.THEAD.childNodes[index]},renderColumnHeader:function(row,col,TH){TH.className="";TH.removeAttribute("style");return this.columnHeaders[row](col,TH,row)},renderColGroups:function(){for(var colIndex=0;colIndex<this.wtTable.colgroupChildrenLength;colIndex++){if(colIndex<this.rowHeaderCount){dom.addClass(this.COLGROUP.childNodes[colIndex],"rowHeader")}else{dom.removeClass(this.COLGROUP.childNodes[colIndex],"rowHeader")}}},adjustColumns:function(TR,desiredCount){var count=TR.childNodes.length;while(count<desiredCount){var TD=document.createElement("TD");TR.appendChild(TD);count++}while(count>desiredCount){TR.removeChild(TR.lastChild);count--}},removeRedundantColumns:function(columnsToRender){while(this.wtTable.tbodyChildrenLength>columnsToRender){this.TBODY.removeChild(this.TBODY.lastChild);this.wtTable.tbodyChildrenLength--}}},{});function replaceTdWithTh(TD,TR){var TH=document.createElement("TH");TR.insertBefore(TH,TD);TR.removeChild(TD);return TH}function replaceThWithTd(TH,TR){var TD=document.createElement("TD");TR.insertBefore(TD,TH);TR.removeChild(TH);return TD}window.WalkontableTableRenderer=WalkontableTableRenderer},{"./../../../dom.js":27}],22:[function(require,module,exports){"use strict";Object.defineProperties(exports,{WalkontableViewport:{get:function(){return WalkontableViewport}},__esModule:{value:true}});var $___46__46__47__46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47__46__46__47_eventManager_46_js__,$__calculator_47_viewportColumns_46_js__,$__calculator_47_viewportRows_46_js__;var dom=($___46__46__47__46__46__47__46__46__47_dom_46_js__=require("./../../../dom.js"),$___46__46__47__46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47__46__46__47_eventManager_46_js__=require("./../../../eventManager.js"),$___46__46__47__46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47__46__46__47_eventManager_46_js__}).eventManager;var WalkontableViewportColumnsCalculator=($__calculator_47_viewportColumns_46_js__=require("./calculator/viewportColumns.js"),$__calculator_47_viewportColumns_46_js__&&$__calculator_47_viewportColumns_46_js__.__esModule&&$__calculator_47_viewportColumns_46_js__||{"default":$__calculator_47_viewportColumns_46_js__}).WalkontableViewportColumnsCalculator;var WalkontableViewportRowsCalculator=($__calculator_47_viewportRows_46_js__=require("./calculator/viewportRows.js"),$__calculator_47_viewportRows_46_js__&&$__calculator_47_viewportRows_46_js__.__esModule&&$__calculator_47_viewportRows_46_js__||{"default":$__calculator_47_viewportRows_46_js__}).WalkontableViewportRowsCalculator;var WalkontableViewport=function WalkontableViewport(wotInstance){var $__3=this;this.wot=wotInstance;this.instance=this.wot;this.oversizedRows=[];this.oversizedCols=[];this.oversizedColumnHeaders=[];this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;var eventManager=eventManagerObject(wotInstance);eventManager.addEventListener(window,"resize",function(){$__3.clientHeight=$__3.getWorkspaceHeight()})};$traceurRuntime.createClass(WalkontableViewport,{getWorkspaceHeight:function(){var trimmingContainer=this.instance.wtOverlays.topOverlay.trimmingContainer;var elemHeight;var height=0;if(trimmingContainer===window){height=document.documentElement.clientHeight}else{elemHeight=dom.outerHeight(trimmingContainer);height=elemHeight>0&&trimmingContainer.clientHeight>0?trimmingContainer.clientHeight:Infinity}return height},getWorkspaceWidth:function(){var width;var totalColumns=this.instance.getSetting("totalColumns");var trimmingContainer=this.instance.wtOverlays.leftOverlay.trimmingContainer;var overflow;var stretchSetting=this.instance.getSetting("stretchH");var docOffsetWidth=document.documentElement.offsetWidth;if(Handsontable.freezeOverlays){width=Math.min(docOffsetWidth-this.getWorkspaceOffset().left,docOffsetWidth)}else{width=Math.min(this.getContainerFillWidth(),docOffsetWidth-this.getWorkspaceOffset().left,docOffsetWidth)}if(trimmingContainer===window&&totalColumns>0&&this.sumColumnWidths(0,totalColumns-1)>width){return document.documentElement.clientWidth}if(trimmingContainer!==window){overflow=dom.getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow");if(overflow=="scroll"||overflow=="hidden"||overflow=="auto"){return Math.max(width,trimmingContainer.clientWidth)}}if(stretchSetting==="none"||!stretchSetting){return Math.max(width,dom.outerWidth(this.instance.wtTable.TABLE))}else{return width}},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(from,length){var sum=0;var defaultColumnWidth=this.instance.wtSettings.defaultColumnWidth;while(from<length){sum+=this.wot.wtTable.getColumnWidth(from)||defaultColumnWidth;from++}return sum},getContainerFillWidth:function(){if(this.containerWidth){return this.containerWidth}var mainContainer=this.instance.wtTable.holder;var fillWidth;var dummyElement;dummyElement=document.createElement("DIV");dummyElement.style.width="100%";dummyElement.style.height="1px";mainContainer.appendChild(dummyElement);fillWidth=dummyElement.offsetWidth;this.containerWidth=fillWidth;mainContainer.removeChild(dummyElement);return fillWidth},getWorkspaceOffset:function(){return dom.offset(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return dom.outerHeight(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return dom.outerWidth(this.wot.wtTable.TABLE)||dom.outerWidth(this.wot.wtTable.TBODY)||dom.outerWidth(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){if(isNaN(this.columnHeaderHeight)){this.columnHeaderHeight=dom.outerHeight(this.wot.wtTable.THEAD)}return this.columnHeaderHeight},getViewportHeight:function(){var containerHeight=this.getWorkspaceHeight();var columnHeaderHeight;if(containerHeight===Infinity){return containerHeight}columnHeaderHeight=this.getColumnHeaderHeight();if(columnHeaderHeight>0){containerHeight-=columnHeaderHeight}return containerHeight},getRowHeaderWidth:function(){if(this.wot.cloneSource){return this.wot.cloneSource.wtViewport.getRowHeaderWidth()}if(isNaN(this.rowHeaderWidth)){var rowHeaders=this.instance.getSetting("rowHeaders");if(rowHeaders.length){var TH=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,len=rowHeaders.length;i<len;i++){if(TH){this.rowHeaderWidth+=dom.outerWidth(TH);TH=TH.nextSibling}else{this.rowHeaderWidth+=50}}}else{this.rowHeaderWidth=0}}return this.rowHeaderWidth},getViewportWidth:function(){var containerWidth=this.getWorkspaceWidth();var rowHeaderWidth;if(containerWidth===Infinity){return containerWidth}rowHeaderWidth=this.getRowHeaderWidth();if(rowHeaderWidth>0){return containerWidth-rowHeaderWidth}return containerWidth},createRowsCalculator:function(){var visible=arguments[0]!==void 0?arguments[0]:false;var $__3=this;var height;var pos;var fixedRowsTop;this.rowHeaderWidth=NaN;if(this.wot.wtSettings.settings.renderAllRows){height=Infinity}else{height=this.getViewportHeight()}pos=dom.getScrollTop(this.wot.wtOverlays.mainTableScrollableElement)-this.wot.wtOverlays.topOverlay.getTableParentOffset();if(pos<0){pos=0}fixedRowsTop=this.wot.getSetting("fixedRowsTop");if(fixedRowsTop){var fixedRowsHeight=this.wot.wtOverlays.topOverlay.sumCellSizes(0,fixedRowsTop);pos+=fixedRowsHeight;height-=fixedRowsHeight}return new WalkontableViewportRowsCalculator(height,pos,this.wot.getSetting("totalRows"),function(sourceRow){return $__3.wot.wtTable.getRowHeight(sourceRow)},visible?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,visible)},createColumnsCalculator:function(){var visible=arguments[0]!==void 0?arguments[0]:false;var $__3=this;var width=this.getViewportWidth();var pos;var fixedColumnsLeft;this.columnHeaderHeight=NaN;pos=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset();if(pos<0){pos=0}fixedColumnsLeft=this.wot.getSetting("fixedColumnsLeft");if(fixedColumnsLeft){var fixedColumnsWidth=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,fixedColumnsLeft);pos+=fixedColumnsWidth;width-=fixedColumnsWidth}if(this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth){width-=dom.getScrollbarWidth()}return new WalkontableViewportColumnsCalculator(width,pos,this.wot.getSetting("totalColumns"),function(sourceCol){return $__3.wot.wtTable.getColumnWidth(sourceCol)},visible?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,visible,this.wot.getSetting("stretchH"))},createRenderCalculators:function(){var fastDraw=arguments[0]!==void 0?arguments[0]:false;if(fastDraw){var proposedRowsVisibleCalculator=this.createRowsCalculator(true);var proposedColumnsVisibleCalculator=this.createColumnsCalculator(true);if(!(this.areAllProposedVisibleRowsAlreadyRendered(proposedRowsVisibleCalculator)&&this.areAllProposedVisibleColumnsAlreadyRendered(proposedColumnsVisibleCalculator))){fastDraw=false}}if(!fastDraw){this.rowsRenderCalculator=this.createRowsCalculator();this.columnsRenderCalculator=this.createColumnsCalculator()}this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;return fastDraw},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(true);this.columnsVisibleCalculator=this.createColumnsCalculator(true)},areAllProposedVisibleRowsAlreadyRendered:function(proposedRowsVisibleCalculator){if(this.rowsVisibleCalculator){if(proposedRowsVisibleCalculator.startRow<this.rowsRenderCalculator.startRow||proposedRowsVisibleCalculator.startRow===this.rowsRenderCalculator.startRow&&proposedRowsVisibleCalculator.startRow>0){return false}else if(proposedRowsVisibleCalculator.endRow>this.rowsRenderCalculator.endRow||proposedRowsVisibleCalculator.endRow===this.rowsRenderCalculator.endRow&&proposedRowsVisibleCalculator.endRow<this.wot.getSetting("totalRows")-1){return false}else{return true}}return false},areAllProposedVisibleColumnsAlreadyRendered:function(proposedColumnsVisibleCalculator){if(this.columnsVisibleCalculator){if(proposedColumnsVisibleCalculator.startColumn<this.columnsRenderCalculator.startColumn||proposedColumnsVisibleCalculator.startColumn===this.columnsRenderCalculator.startColumn&&proposedColumnsVisibleCalculator.startColumn>0){return false}else if(proposedColumnsVisibleCalculator.endColumn>this.columnsRenderCalculator.endColumn||proposedColumnsVisibleCalculator.endColumn===this.columnsRenderCalculator.endColumn&&proposedColumnsVisibleCalculator.endColumn<this.wot.getSetting("totalColumns")-1){return false}else{return true}}return false}},{});window.WalkontableViewport=WalkontableViewport},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./calculator/viewportColumns.js":3,"./calculator/viewportRows.js":4}],23:[function(require,module,exports){"use strict";var $__shims_47_array_46_filter_46_js__,$__shims_47_array_46_indexOf_46_js__,$__shims_47_array_46_isArray_46_js__,$__shims_47_classes_46_js__,$__shims_47_object_46_keys_46_js__,$__shims_47_string_46_trim_46_js__,$__shims_47_weakmap_46_js__,$__pluginHooks_46_js__,$__core_46_js__,$__renderers_47__95_cellDecorator_46_js__,$__cellTypes_46_js__,$___46__46__47_plugins_47_jqueryHandsontable_46_js__;var version=Handsontable.version;var buildDate=Handsontable.buildDate;window.Handsontable=function(rootElement,userSettings){var instance=new Handsontable.Core(rootElement,userSettings||{});instance.init();return instance};Handsontable.version=version;Handsontable.buildDate=buildDate;$__shims_47_array_46_filter_46_js__=require("./shims/array.filter.js"),$__shims_47_array_46_filter_46_js__&&$__shims_47_array_46_filter_46_js__.__esModule&&$__shims_47_array_46_filter_46_js__||{"default":$__shims_47_array_46_filter_46_js__};$__shims_47_array_46_indexOf_46_js__=require("./shims/array.indexOf.js"),$__shims_47_array_46_indexOf_46_js__&&$__shims_47_array_46_indexOf_46_js__.__esModule&&$__shims_47_array_46_indexOf_46_js__||{"default":$__shims_47_array_46_indexOf_46_js__};$__shims_47_array_46_isArray_46_js__=require("./shims/array.isArray.js"),$__shims_47_array_46_isArray_46_js__&&$__shims_47_array_46_isArray_46_js__.__esModule&&$__shims_47_array_46_isArray_46_js__||{"default":$__shims_47_array_46_isArray_46_js__};$__shims_47_classes_46_js__=require("./shims/classes.js"),$__shims_47_classes_46_js__&&$__shims_47_classes_46_js__.__esModule&&$__shims_47_classes_46_js__||{"default":$__shims_47_classes_46_js__};$__shims_47_object_46_keys_46_js__=require("./shims/object.keys.js"),$__shims_47_object_46_keys_46_js__&&$__shims_47_object_46_keys_46_js__.__esModule&&$__shims_47_object_46_keys_46_js__||{"default":$__shims_47_object_46_keys_46_js__};$__shims_47_string_46_trim_46_js__=require("./shims/string.trim.js"),$__shims_47_string_46_trim_46_js__&&$__shims_47_string_46_trim_46_js__.__esModule&&$__shims_47_string_46_trim_46_js__||{"default":$__shims_47_string_46_trim_46_js__};$__shims_47_weakmap_46_js__=require("./shims/weakmap.js"),$__shims_47_weakmap_46_js__&&$__shims_47_weakmap_46_js__.__esModule&&$__shims_47_weakmap_46_js__||{"default":$__shims_47_weakmap_46_js__};Handsontable.plugins={};var Hooks=($__pluginHooks_46_js__=require("./pluginHooks.js"),$__pluginHooks_46_js__&&$__pluginHooks_46_js__.__esModule&&$__pluginHooks_46_js__||{"default":$__pluginHooks_46_js__}).Hooks;if(!Handsontable.hooks){Handsontable.hooks=new Hooks}$__core_46_js__=require("./core.js"),$__core_46_js__&&$__core_46_js__.__esModule&&$__core_46_js__||{"default":$__core_46_js__};$__renderers_47__95_cellDecorator_46_js__=require("./renderers/_cellDecorator.js"),$__renderers_47__95_cellDecorator_46_js__&&$__renderers_47__95_cellDecorator_46_js__.__esModule&&$__renderers_47__95_cellDecorator_46_js__||{"default":$__renderers_47__95_cellDecorator_46_js__};$__cellTypes_46_js__=require("./cellTypes.js"),$__cellTypes_46_js__&&$__cellTypes_46_js__.__esModule&&$__cellTypes_46_js__||{"default":$__cellTypes_46_js__};$___46__46__47_plugins_47_jqueryHandsontable_46_js__=require("./../plugins/jqueryHandsontable.js"),$___46__46__47_plugins_47_jqueryHandsontable_46_js__&&$___46__46__47_plugins_47_jqueryHandsontable_46_js__.__esModule&&$___46__46__47_plugins_47_jqueryHandsontable_46_js__||{"default":$___46__46__47_plugins_47_jqueryHandsontable_46_js__}},{"./../plugins/jqueryHandsontable.js":1,"./cellTypes.js":24,"./core.js":25,"./pluginHooks.js":44,"./renderers/_cellDecorator.js":71,"./shims/array.filter.js":78,"./shims/array.indexOf.js":79,"./shims/array.isArray.js":80,"./shims/classes.js":81,"./shims/object.keys.js":82,"./shims/string.trim.js":83,"./shims/weakmap.js":84}],24:[function(require,module,exports){"use strict";var $__helpers_46_js__,$__editors_46_js__,$__renderers_46_js__,$__editors_47_autocompleteEditor_46_js__,$__editors_47_checkboxEditor_46_js__,$__editors_47_dateEditor_46_js__,$__editors_47_dropdownEditor_46_js__,$__editors_47_handsontableEditor_46_js__,$__editors_47_mobileTextEditor_46_js__,$__editors_47_numericEditor_46_js__,$__editors_47_passwordEditor_46_js__,$__editors_47_selectEditor_46_js__,$__editors_47_textEditor_46_js__,$__renderers_47_autocompleteRenderer_46_js__,$__renderers_47_checkboxRenderer_46_js__,$__renderers_47_htmlRenderer_46_js__,$__renderers_47_numericRenderer_46_js__,$__renderers_47_passwordRenderer_46_js__,$__renderers_47_textRenderer_46_js__,$__validators_47_autocompleteValidator_46_js__,$__validators_47_dateValidator_46_js__,$__validators_47_numericValidator_46_js__;var helper=($__helpers_46_js__=require("./helpers.js"),$__helpers_46_js__&&$__helpers_46_js__.__esModule&&$__helpers_46_js__||{"default":$__helpers_46_js__});var getEditorConstructor=($__editors_46_js__=require("./editors.js"),$__editors_46_js__&&$__editors_46_js__.__esModule&&$__editors_46_js__||{"default":$__editors_46_js__}).getEditorConstructor;var getRenderer=($__renderers_46_js__=require("./renderers.js"),$__renderers_46_js__&&$__renderers_46_js__.__esModule&&$__renderers_46_js__||{"default":$__renderers_46_js__}).getRenderer;var AutocompleteEditor=($__editors_47_autocompleteEditor_46_js__=require("./editors/autocompleteEditor.js"),$__editors_47_autocompleteEditor_46_js__&&$__editors_47_autocompleteEditor_46_js__.__esModule&&$__editors_47_autocompleteEditor_46_js__||{"default":$__editors_47_autocompleteEditor_46_js__}).AutocompleteEditor;var CheckboxEditor=($__editors_47_checkboxEditor_46_js__=require("./editors/checkboxEditor.js"),$__editors_47_checkboxEditor_46_js__&&$__editors_47_checkboxEditor_46_js__.__esModule&&$__editors_47_checkboxEditor_46_js__||{"default":$__editors_47_checkboxEditor_46_js__}).CheckboxEditor;var DateEditor=($__editors_47_dateEditor_46_js__=require("./editors/dateEditor.js"),$__editors_47_dateEditor_46_js__&&$__editors_47_dateEditor_46_js__.__esModule&&$__editors_47_dateEditor_46_js__||{"default":$__editors_47_dateEditor_46_js__}).DateEditor;var DropdownEditor=($__editors_47_dropdownEditor_46_js__=require("./editors/dropdownEditor.js"),$__editors_47_dropdownEditor_46_js__&&$__editors_47_dropdownEditor_46_js__.__esModule&&$__editors_47_dropdownEditor_46_js__||{"default":$__editors_47_dropdownEditor_46_js__}).DropdownEditor;var HandsontableEditor=($__editors_47_handsontableEditor_46_js__=require("./editors/handsontableEditor.js"),$__editors_47_handsontableEditor_46_js__&&$__editors_47_handsontableEditor_46_js__.__esModule&&$__editors_47_handsontableEditor_46_js__||{"default":$__editors_47_handsontableEditor_46_js__}).HandsontableEditor;var MobileTextEditor=($__editors_47_mobileTextEditor_46_js__=require("./editors/mobileTextEditor.js"),$__editors_47_mobileTextEditor_46_js__&&$__editors_47_mobileTextEditor_46_js__.__esModule&&$__editors_47_mobileTextEditor_46_js__||{"default":$__editors_47_mobileTextEditor_46_js__}).MobileTextEditor;var NumericEditor=($__editors_47_numericEditor_46_js__=require("./editors/numericEditor.js"),$__editors_47_numericEditor_46_js__&&$__editors_47_numericEditor_46_js__.__esModule&&$__editors_47_numericEditor_46_js__||{"default":$__editors_47_numericEditor_46_js__}).NumericEditor;var PasswordEditor=($__editors_47_passwordEditor_46_js__=require("./editors/passwordEditor.js"),$__editors_47_passwordEditor_46_js__&&$__editors_47_passwordEditor_46_js__.__esModule&&$__editors_47_passwordEditor_46_js__||{"default":$__editors_47_passwordEditor_46_js__}).PasswordEditor;var SelectEditor=($__editors_47_selectEditor_46_js__=require("./editors/selectEditor.js"),$__editors_47_selectEditor_46_js__&&$__editors_47_selectEditor_46_js__.__esModule&&$__editors_47_selectEditor_46_js__||{"default":$__editors_47_selectEditor_46_js__}).SelectEditor;var TextEditor=($__editors_47_textEditor_46_js__=require("./editors/textEditor.js"),$__editors_47_textEditor_46_js__&&$__editors_47_textEditor_46_js__.__esModule&&$__editors_47_textEditor_46_js__||{"default":$__editors_47_textEditor_46_js__}).TextEditor;var AutocompleteRenderer=($__renderers_47_autocompleteRenderer_46_js__=require("./renderers/autocompleteRenderer.js"),$__renderers_47_autocompleteRenderer_46_js__&&$__renderers_47_autocompleteRenderer_46_js__.__esModule&&$__renderers_47_autocompleteRenderer_46_js__||{"default":$__renderers_47_autocompleteRenderer_46_js__}).AutocompleteRenderer;var CheckboxRenderer=($__renderers_47_checkboxRenderer_46_js__=require("./renderers/checkboxRenderer.js"),$__renderers_47_checkboxRenderer_46_js__&&$__renderers_47_checkboxRenderer_46_js__.__esModule&&$__renderers_47_checkboxRenderer_46_js__||{"default":$__renderers_47_checkboxRenderer_46_js__}).CheckboxRenderer;var HtmlRenderer=($__renderers_47_htmlRenderer_46_js__=require("./renderers/htmlRenderer.js"),$__renderers_47_htmlRenderer_46_js__&&$__renderers_47_htmlRenderer_46_js__.__esModule&&$__renderers_47_htmlRenderer_46_js__||{"default":$__renderers_47_htmlRenderer_46_js__}).HtmlRenderer;var NumericRenderer=($__renderers_47_numericRenderer_46_js__=require("./renderers/numericRenderer.js"),$__renderers_47_numericRenderer_46_js__&&$__renderers_47_numericRenderer_46_js__.__esModule&&$__renderers_47_numericRenderer_46_js__||{"default":$__renderers_47_numericRenderer_46_js__}).NumericRenderer;var PasswordRenderer=($__renderers_47_passwordRenderer_46_js__=require("./renderers/passwordRenderer.js"),$__renderers_47_passwordRenderer_46_js__&&$__renderers_47_passwordRenderer_46_js__.__esModule&&$__renderers_47_passwordRenderer_46_js__||{"default":$__renderers_47_passwordRenderer_46_js__}).PasswordRenderer;var TextRenderer=($__renderers_47_textRenderer_46_js__=require("./renderers/textRenderer.js"),$__renderers_47_textRenderer_46_js__&&$__renderers_47_textRenderer_46_js__.__esModule&&$__renderers_47_textRenderer_46_js__||{"default":$__renderers_47_textRenderer_46_js__}).TextRenderer;var AutocompleteValidator=($__validators_47_autocompleteValidator_46_js__=require("./validators/autocompleteValidator.js"),$__validators_47_autocompleteValidator_46_js__&&$__validators_47_autocompleteValidator_46_js__.__esModule&&$__validators_47_autocompleteValidator_46_js__||{"default":$__validators_47_autocompleteValidator_46_js__}).AutocompleteValidator;var DateValidator=($__validators_47_dateValidator_46_js__=require("./validators/dateValidator.js"),$__validators_47_dateValidator_46_js__&&$__validators_47_dateValidator_46_js__.__esModule&&$__validators_47_dateValidator_46_js__||{"default":$__validators_47_dateValidator_46_js__}).DateValidator;var NumericValidator=($__validators_47_numericValidator_46_js__=require("./validators/numericValidator.js"),$__validators_47_numericValidator_46_js__&&$__validators_47_numericValidator_46_js__.__esModule&&$__validators_47_numericValidator_46_js__||{"default":$__validators_47_numericValidator_46_js__}).NumericValidator;
Handsontable.mobileBrowser=helper.isMobileBrowser();Handsontable.AutocompleteCell={editor:getEditorConstructor("autocomplete"),renderer:getRenderer("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:getEditorConstructor("checkbox"),renderer:getRenderer("checkbox")};Handsontable.TextCell={editor:Handsontable.mobileBrowser?getEditorConstructor("mobile"):getEditorConstructor("text"),renderer:getRenderer("text")};Handsontable.NumericCell={editor:getEditorConstructor("numeric"),renderer:getRenderer("numeric"),validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:getEditorConstructor("date"),validator:Handsontable.DateValidator,renderer:getRenderer("autocomplete")};Handsontable.HandsontableCell={editor:getEditorConstructor("handsontable"),renderer:getRenderer("autocomplete")};Handsontable.PasswordCell={editor:getEditorConstructor("password"),renderer:getRenderer("password"),copyable:false};Handsontable.DropdownCell={editor:getEditorConstructor("dropdown"),renderer:getRenderer("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell};Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}}},{"./editors.js":29,"./editors/autocompleteEditor.js":31,"./editors/checkboxEditor.js":32,"./editors/dateEditor.js":33,"./editors/dropdownEditor.js":34,"./editors/handsontableEditor.js":35,"./editors/mobileTextEditor.js":36,"./editors/numericEditor.js":37,"./editors/passwordEditor.js":38,"./editors/selectEditor.js":39,"./editors/textEditor.js":40,"./helpers.js":42,"./renderers.js":70,"./renderers/autocompleteRenderer.js":72,"./renderers/checkboxRenderer.js":73,"./renderers/htmlRenderer.js":74,"./renderers/numericRenderer.js":75,"./renderers/passwordRenderer.js":76,"./renderers/textRenderer.js":77,"./validators/autocompleteValidator.js":86,"./validators/dateValidator.js":87,"./validators/numericValidator.js":88}],25:[function(require,module,exports){"use strict";var $__dom_46_js__,$__helpers_46_js__,$__numeral__,$__dataMap_46_js__,$__editorManager_46_js__,$__eventManager_46_js__,$__plugins_46_js__,$__renderers_46_js__,$__tableView_46_js__,$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__,$__3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__,$__3rdparty_47_walkontable_47_src_47_selection_46_js__;var dom=($__dom_46_js__=require("./dom.js"),$__dom_46_js__&&$__dom_46_js__.__esModule&&$__dom_46_js__||{"default":$__dom_46_js__});var helper=($__helpers_46_js__=require("./helpers.js"),$__helpers_46_js__&&$__helpers_46_js__.__esModule&&$__helpers_46_js__||{"default":$__helpers_46_js__});var numeral=($__numeral__=require("numeral"),$__numeral__&&$__numeral__.__esModule&&$__numeral__||{"default":$__numeral__}).default;var DataMap=($__dataMap_46_js__=require("./dataMap.js"),$__dataMap_46_js__&&$__dataMap_46_js__.__esModule&&$__dataMap_46_js__||{"default":$__dataMap_46_js__}).DataMap;var EditorManager=($__editorManager_46_js__=require("./editorManager.js"),$__editorManager_46_js__&&$__editorManager_46_js__.__esModule&&$__editorManager_46_js__||{"default":$__editorManager_46_js__}).EditorManager;var eventManagerObject=($__eventManager_46_js__=require("./eventManager.js"),$__eventManager_46_js__&&$__eventManager_46_js__.__esModule&&$__eventManager_46_js__||{"default":$__eventManager_46_js__}).eventManager;var getPlugin=($__plugins_46_js__=require("./plugins.js"),$__plugins_46_js__&&$__plugins_46_js__.__esModule&&$__plugins_46_js__||{"default":$__plugins_46_js__}).getPlugin;var getRenderer=($__renderers_46_js__=require("./renderers.js"),$__renderers_46_js__&&$__renderers_46_js__.__esModule&&$__renderers_46_js__||{"default":$__renderers_46_js__}).getRenderer;var TableView=($__tableView_46_js__=require("./tableView.js"),$__tableView_46_js__&&$__tableView_46_js__.__esModule&&$__tableView_46_js__||{"default":$__tableView_46_js__}).TableView;var WalkontableCellCoords=($__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./3rdparty/walkontable/src/cell/coords.js"),$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;var WalkontableCellRange=($__3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__=require("./3rdparty/walkontable/src/cell/range.js"),$__3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__&&$__3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__.__esModule&&$__3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__||{"default":$__3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__}).WalkontableCellRange;var WalkontableSelection=($__3rdparty_47_walkontable_47_src_47_selection_46_js__=require("./3rdparty/walkontable/src/selection.js"),$__3rdparty_47_walkontable_47_src_47_selection_46_js__&&$__3rdparty_47_walkontable_47_src_47_selection_46_js__.__esModule&&$__3rdparty_47_walkontable_47_src_47_selection_46_js__||{"default":$__3rdparty_47_walkontable_47_src_47_selection_46_js__}).WalkontableSelection;Handsontable.activeGuid=null;Handsontable.Core=function Core(rootElement,userSettings){var priv,datamap,grid,selection,editorManager,instance=this,GridSettings=function(){},eventManager=eventManagerObject(instance);helper.extend(GridSettings.prototype,DefaultSettings.prototype);helper.extend(GridSettings.prototype,userSettings);helper.extend(GridSettings.prototype,expandType(userSettings));this.rootElement=rootElement;this.isHotTableEnv=dom.isChildOfWebComponentTable(this.rootElement);Handsontable.eventManager.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("DIV");rootElement.insertBefore(this.container,rootElement.firstChild);this.guid="ht_"+helper.randomString();if(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_"){this.rootElement.id=this.guid}priv={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new GridSettings,selRange:null,isPopulated:null,scrollable:null,firstRun:true};grid={alter:function(action,index,amount,source,keepEmptyRows){var delta;amount=amount||1;switch(action){case"insert_row":if(instance.getSettings().maxRows===instance.countRows()){return}delta=datamap.createRow(index,amount);if(delta){if(selection.isSelected()&&priv.selRange.from.row>=index){priv.selRange.from.row=priv.selRange.from.row+delta;selection.transformEnd(delta,0)}else{selection.refreshBorders()}}break;case"insert_col":delta=datamap.createCol(index,amount);if(delta){if(Array.isArray(instance.getSettings().colHeaders)){var spliceArray=[index,0];spliceArray.length+=delta;Array.prototype.splice.apply(instance.getSettings().colHeaders,spliceArray)}if(selection.isSelected()&&priv.selRange.from.col>=index){priv.selRange.from.col=priv.selRange.from.col+delta;selection.transformEnd(0,delta)}else{selection.refreshBorders()}}break;case"remove_row":index=instance.runHooks("modifyCol",index);datamap.removeRow(index,amount);priv.cellSettings.splice(index,amount);var fixedRowsTop=instance.getSettings().fixedRowsTop;if(fixedRowsTop>=index+1){instance.getSettings().fixedRowsTop-=Math.min(amount,fixedRowsTop-index)}grid.adjustRowsAndCols();selection.refreshBorders();break;case"remove_col":datamap.removeCol(index,amount);for(var row=0,len=datamap.getAll().length;row<len;row++){if(row in priv.cellSettings){priv.cellSettings[row].splice(index,amount)}}var fixedColumnsLeft=instance.getSettings().fixedColumnsLeft;if(fixedColumnsLeft>=index+1){instance.getSettings().fixedColumnsLeft-=Math.min(amount,fixedColumnsLeft-index)}if(Array.isArray(instance.getSettings().colHeaders)){if(typeof index=="undefined"){index=-1}instance.getSettings().colHeaders.splice(index,amount)}grid.adjustRowsAndCols();selection.refreshBorders();break;default:throw new Error('There is no such action "'+action+'"');break}if(!keepEmptyRows){grid.adjustRowsAndCols()}},adjustRowsAndCols:function(){var r,rlen,emptyRows,emptyCols;rlen=instance.countRows();if(rlen<priv.settings.minRows){for(r=0;r<priv.settings.minRows-rlen;r++){datamap.createRow(instance.countRows(),1,true)}}emptyRows=instance.countEmptyRows(true);if(emptyRows<priv.settings.minSpareRows){for(;emptyRows<priv.settings.minSpareRows&&instance.countRows()<priv.settings.maxRows;emptyRows++){datamap.createRow(instance.countRows(),1,true)}}emptyCols=instance.countEmptyCols(true);if(!priv.settings.columns&&instance.countCols()<priv.settings.minCols){for(;instance.countCols()<priv.settings.minCols;emptyCols++){datamap.createCol(instance.countCols(),1,true)}}if(!priv.settings.columns&&instance.dataType==="array"&&emptyCols<priv.settings.minSpareCols){for(;emptyCols<priv.settings.minSpareCols&&instance.countCols()<priv.settings.maxCols;emptyCols++){datamap.createCol(instance.countCols(),1,true)}}var rowCount=instance.countRows();var colCount=instance.countCols();if(rowCount===0||colCount===0){selection.deselect()}if(selection.isSelected()){var selectionChanged;var fromRow=priv.selRange.from.row;var fromCol=priv.selRange.from.col;var toRow=priv.selRange.to.row;var toCol=priv.selRange.to.col;if(fromRow>rowCount-1){fromRow=rowCount-1;selectionChanged=true;if(toRow>fromRow){toRow=fromRow}}else if(toRow>rowCount-1){toRow=rowCount-1;selectionChanged=true;if(fromRow>toRow){fromRow=toRow}}if(fromCol>colCount-1){fromCol=colCount-1;selectionChanged=true;if(toCol>fromCol){toCol=fromCol}}else if(toCol>colCount-1){toCol=colCount-1;selectionChanged=true;if(fromCol>toCol){fromCol=toCol}}if(selectionChanged){instance.selectCell(fromRow,fromCol,toRow,toCol)}}if(instance.view){instance.view.wt.wtOverlays.adjustElementsSize()}},populateFromArray:function(start,input,end,source,method,direction,deltas){var r,rlen,c,clen,setData=[],current={};rlen=input.length;if(rlen===0){return false}var repeatCol,repeatRow,cmax,rmax;switch(method){case"shift_down":repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;input=helper.translateRowsToColumns(input);for(c=0,clen=input.length,cmax=Math.max(clen,repeatCol);c<cmax;c++){if(c<clen){for(r=0,rlen=input[c].length;r<repeatRow-rlen;r++){input[c].push(input[c][r%rlen])}input[c].unshift(start.col+c,start.row,0);instance.spliceCol.apply(instance,input[c])}else{input[c%clen][0]=start.col+c;instance.spliceCol.apply(instance,input[c%clen])}}break;case"shift_right":repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;for(r=0,rlen=input.length,rmax=Math.max(rlen,repeatRow);r<rmax;r++){if(r<rlen){for(c=0,clen=input[r].length;c<repeatCol-clen;c++){input[r].push(input[r][c%clen])}input[r].unshift(start.row+r,start.col,0);instance.spliceRow.apply(instance,input[r])}else{input[r%rlen][0]=start.row+r;instance.spliceRow.apply(instance,input[r%rlen])}}break;case"overwrite":default:current.row=start.row;current.col=start.col;var iterators={row:0,col:0},selected={row:end&&start?end.row-start.row+1:1,col:end&&start?end.col-start.col+1:1},pushData=true;if(["up","left"].indexOf(direction)!==-1){iterators={row:Math.ceil(selected.row/rlen)||1,col:Math.ceil(selected.col/input[0].length)||1}}else if(["down","right"].indexOf(direction)!==-1){iterators={row:1,col:1}}for(r=0;r<rlen;r++){if(end&&current.row>end.row||!priv.settings.allowInsertRow&&current.row>instance.countRows()-1||current.row>=priv.settings.maxRows){break}current.col=start.col;clen=input[r]?input[r].length:0;for(c=0;c<clen;c++){if(end&&current.col>end.col||!priv.settings.allowInsertColumn&&current.col>instance.countCols()-1||current.col>=priv.settings.maxCols){break}if(!instance.getCellMeta(current.row,current.col).readOnly){var result,value=input[r][c],orgValue=instance.getDataAtCell(current.row,current.col),index={row:r,col:c},valueSchema,orgValueSchema;if(source==="autofill"){result=instance.runHooks("beforeAutofillInsidePopulate",index,direction,input,deltas,iterators,selected);if(result){iterators=typeof result.iterators!=="undefined"?result.iterators:iterators;value=typeof result.value!=="undefined"?result.value:value}}if(value!==null&&typeof value==="object"){if(orgValue===null||typeof orgValue!=="object"){pushData=false}else{orgValueSchema=Handsontable.helper.duckSchema(orgValue[0]||orgValue);valueSchema=Handsontable.helper.duckSchema(value[0]||value);if(Handsontable.helper.isObjectEquals(orgValueSchema,valueSchema)){value=Handsontable.helper.deepClone(value)}else{pushData=false}}}else if(orgValue!==null&&typeof orgValue==="object"){pushData=false}if(pushData){setData.push([current.row,current.col,value])}pushData=true}current.col++;if(end&&c===clen-1){c=-1;if(["down","right"].indexOf(direction)!==-1){iterators.col++}else if(["up","left"].indexOf(direction)!==-1){if(iterators.col>1){iterators.col--}}}}current.row++;iterators.col=1;if(end&&r===rlen-1){r=-1;if(["down","right"].indexOf(direction)!==-1){iterators.row++}else if(["up","left"].indexOf(direction)!==-1){if(iterators.row>1){iterators.row--}}}}instance.setDataAtCell(setData,null,null,source||"populateFromArray");break}}};this.selection=selection={inProgress:false,selectedHeader:{cols:false,rows:false},setSelectedHeaders:function(rows,cols){instance.selection.selectedHeader.rows=rows;instance.selection.selectedHeader.cols=cols},begin:function(){instance.selection.inProgress=true},finish:function(){var sel=instance.getSelected();Handsontable.hooks.run(instance,"afterSelectionEnd",sel[0],sel[1],sel[2],sel[3]);Handsontable.hooks.run(instance,"afterSelectionEndByProp",sel[0],instance.colToProp(sel[1]),sel[2],instance.colToProp(sel[3]));instance.selection.inProgress=false},isInProgress:function(){return instance.selection.inProgress},setRangeStart:function(coords,keepEditorOpened){Handsontable.hooks.run(instance,"beforeSetRangeStart",coords);priv.selRange=new WalkontableCellRange(coords,coords,coords);selection.setRangeEnd(coords,null,keepEditorOpened)},setRangeEnd:function(coords,scrollToCell,keepEditorOpened){if(priv.selRange===null){return}var disableVisualSelection;Handsontable.hooks.run(instance,"beforeSetRangeEnd",coords);instance.selection.begin();priv.selRange.to=new WalkontableCellCoords(coords.row,coords.col);if(!priv.settings.multiSelect){priv.selRange.from=coords}instance.view.wt.selections.current.clear();disableVisualSelection=instance.getCellMeta(priv.selRange.highlight.row,priv.selRange.highlight.col).disableVisualSelection;if(typeof disableVisualSelection==="string"){disableVisualSelection=[disableVisualSelection]}if(disableVisualSelection===false||Array.isArray(disableVisualSelection)&&disableVisualSelection.indexOf("current")===-1){instance.view.wt.selections.current.add(priv.selRange.highlight)}instance.view.wt.selections.area.clear();if((disableVisualSelection===false||Array.isArray(disableVisualSelection)&&disableVisualSelection.indexOf("area")===-1)&&selection.isMultiple()){instance.view.wt.selections.area.add(priv.selRange.from);instance.view.wt.selections.area.add(priv.selRange.to)}if(priv.settings.currentRowClassName||priv.settings.currentColClassName){instance.view.wt.selections.highlight.clear();instance.view.wt.selections.highlight.add(priv.selRange.from);instance.view.wt.selections.highlight.add(priv.selRange.to)}Handsontable.hooks.run(instance,"afterSelection",priv.selRange.from.row,priv.selRange.from.col,priv.selRange.to.row,priv.selRange.to.col);Handsontable.hooks.run(instance,"afterSelectionByProp",priv.selRange.from.row,datamap.colToProp(priv.selRange.from.col),priv.selRange.to.row,datamap.colToProp(priv.selRange.to.col));if(scrollToCell!==false&&instance.view.mainViewIsActive()){if(priv.selRange.from&&!selection.isMultiple()){instance.view.scrollViewport(priv.selRange.from)}else{instance.view.scrollViewport(coords)}}selection.refreshBorders(null,keepEditorOpened)},refreshBorders:function(revertOriginal,keepEditor){if(!keepEditor){editorManager.destroyEditor(revertOriginal)}instance.view.render();if(selection.isSelected()&&!keepEditor){editorManager.prepareEditor()}},isMultiple:function(){var isMultiple=!(priv.selRange.to.col===priv.selRange.from.col&&priv.selRange.to.row===priv.selRange.from.row),modifier=Handsontable.hooks.run(instance,"afterIsMultipleSelection",isMultiple);if(isMultiple){return modifier}},transformStart:function(rowDelta,colDelta,force,keepEditorOpened){var delta=new WalkontableCellCoords(rowDelta,colDelta),rowTransformDir=0,colTransformDir=0,totalRows,totalCols,coords;instance.runHooks("modifyTransformStart",delta);totalRows=instance.countRows();totalCols=instance.countCols();if(priv.selRange.highlight.row+rowDelta>totalRows-1){if(force&&priv.settings.minSpareRows>0){instance.alter("insert_row",totalRows);totalRows=instance.countRows()}else if(priv.settings.autoWrapCol){delta.row=1-totalRows;delta.col=priv.selRange.highlight.col+delta.col==totalCols-1?1-totalCols:1}}else if(priv.settings.autoWrapCol&&priv.selRange.highlight.row+delta.row<0&&priv.selRange.highlight.col+delta.col>=0){delta.row=totalRows-1;delta.col=priv.selRange.highlight.col+delta.col==0?totalCols-1:-1}if(priv.selRange.highlight.col+delta.col>totalCols-1){if(force&&priv.settings.minSpareCols>0){instance.alter("insert_col",totalCols);totalCols=instance.countCols()}else if(priv.settings.autoWrapRow){delta.row=priv.selRange.highlight.row+delta.row==totalRows-1?1-totalRows:1;delta.col=1-totalCols}}else if(priv.settings.autoWrapRow&&priv.selRange.highlight.col+delta.col<0&&priv.selRange.highlight.row+delta.row>=0){delta.row=priv.selRange.highlight.row+delta.row==0?totalRows-1:-1;delta.col=totalCols-1}coords=new WalkontableCellCoords(priv.selRange.highlight.row+delta.row,priv.selRange.highlight.col+delta.col);if(coords.row<0){rowTransformDir=-1;coords.row=0}else if(coords.row>0&&coords.row>=totalRows){rowTransformDir=1;coords.row=totalRows-1}if(coords.col<0){colTransformDir=-1;coords.col=0}else if(coords.col>0&&coords.col>=totalCols){colTransformDir=1;coords.col=totalCols-1}instance.runHooks("afterModifyTransformStart",coords,rowTransformDir,colTransformDir);selection.setRangeStart(coords,keepEditorOpened)},transformEnd:function(rowDelta,colDelta){var delta=new WalkontableCellCoords(rowDelta,colDelta),rowTransformDir=0,colTransformDir=0,totalRows,totalCols,coords;instance.runHooks("modifyTransformEnd",delta);totalRows=instance.countRows();totalCols=instance.countCols();coords=new WalkontableCellCoords(priv.selRange.to.row+delta.row,priv.selRange.to.col+delta.col);if(coords.row<0){rowTransformDir=-1;coords.row=0}else if(coords.row>0&&coords.row>=totalRows){rowTransformDir=1;coords.row=totalRows-1}if(coords.col<0){colTransformDir=-1;coords.col=0}else if(coords.col>0&&coords.col>=totalCols){colTransformDir=1;coords.col=totalCols-1}instance.runHooks("afterModifyTransformEnd",coords,rowTransformDir,colTransformDir);selection.setRangeEnd(coords,true)},isSelected:function(){return priv.selRange!==null},inInSelection:function(coords){if(!selection.isSelected()){return false}return priv.selRange.includes(coords)},deselect:function(){if(!selection.isSelected()){return}instance.selection.inProgress=false;priv.selRange=null;instance.view.wt.selections.current.clear();instance.view.wt.selections.area.clear();if(priv.settings.currentRowClassName||priv.settings.currentColClassName){instance.view.wt.selections.highlight.clear()}editorManager.destroyEditor();selection.refreshBorders();Handsontable.hooks.run(instance,"afterDeselect")},selectAll:function(){if(!priv.settings.multiSelect){return}selection.setRangeStart(new WalkontableCellCoords(0,0));selection.setRangeEnd(new WalkontableCellCoords(instance.countRows()-1,instance.countCols()-1),false)},empty:function(){if(!selection.isSelected()){return}var topLeft=priv.selRange.getTopLeftCorner();var bottomRight=priv.selRange.getBottomRightCorner();var r,c,changes=[];for(r=topLeft.row;r<=bottomRight.row;r++){for(c=topLeft.col;c<=bottomRight.col;c++){if(!instance.getCellMeta(r,c).readOnly){changes.push([r,c,""])}}}instance.setDataAtCell(changes)}};this.init=function(){Handsontable.hooks.run(instance,"beforeInit");if(Handsontable.mobileBrowser){dom.addClass(instance.rootElement,"mobile")}this.updateSettings(priv.settings,true);this.view=new TableView(this);editorManager=new EditorManager(instance,priv,selection,datamap);this.forceFullRender=true;this.view.render();if(typeof priv.firstRun==="object"){Handsontable.hooks.run(instance,"afterChange",priv.firstRun[0],priv.firstRun[1]);priv.firstRun=false}Handsontable.hooks.run(instance,"afterInit")};function ValidatorsQueue(){var resolved=false;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;resolved=false},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&resolved==false){resolved=true;this.onQueueEmpty()}}}}function validateChanges(changes,source,callback){var waitingForValidator=new ValidatorsQueue;waitingForValidator.onQueueEmpty=resolve;for(var i=changes.length-1;i>=0;i--){if(changes[i]===null){changes.splice(i,1)}else{var row=changes[i][0];var col=datamap.propToCol(changes[i][1]);var logicalCol=instance.runHooks("modifyCol",col);var cellProperties=instance.getCellMeta(row,logicalCol);if(cellProperties.type==="numeric"&&typeof changes[i][3]==="string"){if(changes[i][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(changes[i][3])||cellProperties.format)){var len=changes[i][3].length;if(typeof cellProperties.language=="undefined"){numeral.language("en")}else if(changes[i][3].indexOf(".")===len-3&&changes[i][3].indexOf(",")===-1){numeral.language("en")}else{numeral.language(cellProperties.language)}if(numeral.validate(changes[i][3])){changes[i][3]=numeral().unformat(changes[i][3])}}}if(instance.getCellValidator(cellProperties)){waitingForValidator.addValidatorToQueue();instance.validateCell(changes[i][3],cellProperties,function(i,cellProperties){return function(result){if(typeof result!=="boolean"){throw new Error("Validation error: result is not boolean")}if(result===false&&cellProperties.allowInvalid===false){changes.splice(i,1);cellProperties.valid=true;--i}waitingForValidator.removeValidatorFormQueue()}}(i,cellProperties),source)}}}waitingForValidator.checkIfQueueIsEmpty();function resolve(){var beforeChangeResult;if(changes.length){beforeChangeResult=Handsontable.hooks.run(instance,"beforeChange",changes,source);if(typeof beforeChangeResult==="function"){console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed).")}else if(beforeChangeResult===false){changes.splice(0,changes.length)}}callback()}}function applyChanges(changes,source){var i=changes.length-1;if(i<0){return}for(;0<=i;i--){if(changes[i]===null){changes.splice(i,1);continue}if(changes[i][2]==null&&changes[i][3]==null){continue}if(priv.settings.allowInsertRow){while(changes[i][0]>instance.countRows()-1){datamap.createRow()}}if(instance.dataType==="array"&&priv.settings.allowInsertColumn){while(datamap.propToCol(changes[i][1])>instance.countCols()-1){datamap.createCol()}}datamap.set(changes[i][0],changes[i][1],changes[i][3])}instance.forceFullRender=true;grid.adjustRowsAndCols();Handsontable.hooks.run(instance,"beforeChangeRender",changes,source);selection.refreshBorders(null,true);Handsontable.hooks.run(instance,"afterChange",changes,source||"edit")}this.validateCell=function(value,cellProperties,callback,source){var validator=instance.getCellValidator(cellProperties);function done(valid){var col=cellProperties.col,row=cellProperties.row,td=instance.getCell(row,col,true);if(td){instance.view.wt.wtSettings.settings.cellRenderer(row,col,td)}callback(valid)}if(Object.prototype.toString.call(validator)==="[object RegExp]"){validator=function(validator){return function(value,callback){callback(validator.test(value))}}(validator)}if(typeof validator=="function"){value=Handsontable.hooks.run(instance,"beforeValidate",value,cellProperties.row,cellProperties.prop,source);instance._registerTimeout(setTimeout(function(){validator.call(cellProperties,value,function(valid){valid=Handsontable.hooks.run(instance,"afterValidate",valid,value,cellProperties.row,cellProperties.prop,source);cellProperties.valid=valid;done(valid);Handsontable.hooks.run(instance,"postAfterValidate",valid,value,cellProperties.row,cellProperties.prop,source)})},0))}else{cellProperties.valid=true;done(cellProperties.valid)}};function setDataInputToArray(row,propOrCol,value){if(typeof row==="object"){return row}else{return[[row,propOrCol,value]]}}this.setDataAtCell=function(row,col,value,source){var input=setDataInputToArray(row,col,value),i,ilen,changes=[],prop;for(i=0,ilen=input.length;i<ilen;i++){if(typeof input[i]!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof input[i][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}prop=datamap.colToProp(input[i][1]);changes.push([input[i][0],prop,datamap.get(input[i][0],prop),input[i][2]])}if(!source&&typeof row==="object"){source=col}validateChanges(changes,source,function(){applyChanges(changes,source)})};this.setDataAtRowProp=function(row,prop,value,source){var input=setDataInputToArray(row,prop,value),i,ilen,changes=[];for(i=0,ilen=input.length;i<ilen;i++){changes.push([input[i][0],input[i][1],datamap.get(input[i][0],input[i][1]),input[i][2]])}if(!source&&typeof row==="object"){source=prop}validateChanges(changes,source,function(){applyChanges(changes,source)})};this.listen=function(){Handsontable.activeGuid=instance.guid;if(document.activeElement&&document.activeElement!==document.body){document.activeElement.blur()}else if(!document.activeElement){document.body.focus()}};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===instance.guid};this.destroyEditor=function(revertOriginal){var editor=this.getActiveEditor();if(editor&&editor.$htContainer&&editor.$htContainer[0]){$("html").off("."+editor.$htContainer[0].id)}selection.refreshBorders(revertOriginal)};this.populateFromArray=function(row,col,input,endRow,endCol,source,method,direction,deltas){var c;if(!(typeof input==="object"&&typeof input[0]==="object")){throw new Error("populateFromArray parameter `input` must be an array of arrays")}c=typeof endRow==="number"?new WalkontableCellCoords(endRow,endCol):null;return grid.populateFromArray(new WalkontableCellCoords(row,col),input,c,source,method,direction,deltas)};this.spliceCol=function(col,index,amount){return datamap.spliceCol.apply(datamap,arguments)};this.spliceRow=function(row,index,amount){return datamap.spliceRow.apply(datamap,arguments)};this.getSelected=function(){if(selection.isSelected()){return[priv.selRange.from.row,priv.selRange.from.col,priv.selRange.to.row,priv.selRange.to.col]}};this.getSelectedRange=function(){if(selection.isSelected()){return priv.selRange}};this.render=function(){if(instance.view){instance.forceFullRender=true;selection.refreshBorders(null,true)}};this.loadData=function(data){if(typeof data==="object"&&data!==null){if(!(data.push&&data.splice)){data=[data]}}else if(data===null){data=[];var row;for(var r=0,rlen=priv.settings.startRows;r<rlen;r++){row=[];for(var c=0,clen=priv.settings.startCols;c<clen;c++){row.push(null)}data.push(row)}}else{throw new Error("loadData only accepts array of objects or array of arrays ("+typeof data+" given)")}priv.isPopulated=false;GridSettings.prototype.data=data;if(Array.isArray(priv.settings.dataSchema)||Array.isArray(data[0])){instance.dataType="array"}else if(typeof priv.settings.dataSchema==="function"){instance.dataType="function"}else{instance.dataType="object"}datamap=new DataMap(instance,priv,GridSettings);clearCellSettingCache();grid.adjustRowsAndCols();Handsontable.hooks.run(instance,"afterLoadData");if(priv.firstRun){priv.firstRun=[null,"loadData"]}else{Handsontable.hooks.run(instance,"afterChange",null,"loadData");instance.render()}priv.isPopulated=true;function clearCellSettingCache(){priv.cellSettings.length=0}};this.getData=function(r,c,r2,c2){if(typeof r==="undefined"){return datamap.getAll()}else{return datamap.getRange(new WalkontableCellCoords(r,c),new WalkontableCellCoords(r2,c2),datamap.DESTINATION_RENDERER)}};this.getCopyableData=function(startRow,startCol,endRow,endCol){return datamap.getCopyableText(new WalkontableCellCoords(startRow,startCol),new WalkontableCellCoords(endRow,endCol))};this.getSchema=function(){return datamap.getSchema()};this.updateSettings=function(settings,init){var i,clen;if(typeof settings.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")}if(typeof settings.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")}for(i in settings){if(i==="data"){continue}else{if(Handsontable.hooks.getRegistered().indexOf(i)>-1){if(typeof settings[i]==="function"||Array.isArray(settings[i])){instance.addHook(i,settings[i])}}else{if(!init&&settings.hasOwnProperty(i)){GridSettings.prototype[i]=settings[i]}}}}if(settings.data===void 0&&priv.settings.data===void 0){instance.loadData(null)}else if(settings.data!==void 0){instance.loadData(settings.data)}else if(settings.columns!==void 0){datamap.createMap()}clen=instance.countCols();priv.cellSettings.length=0;if(clen>0){var proto,column;for(i=0;i<clen;i++){priv.columnSettings[i]=helper.columnFactory(GridSettings,priv.columnsSettingConflicts);proto=priv.columnSettings[i].prototype;if(GridSettings.prototype.columns){column=GridSettings.prototype.columns[i];helper.extend(proto,column);helper.extend(proto,expandType(column))}}}if(typeof settings.cell!=="undefined"){for(i in settings.cell){if(settings.cell.hasOwnProperty(i)){var cell=settings.cell[i];instance.setCellMetaObject(cell.row,cell.col,cell)}}}Handsontable.hooks.run(instance,"afterCellMetaReset");if(typeof settings.className!=="undefined"){if(GridSettings.prototype.className){dom.removeClass(instance.rootElement,GridSettings.prototype.className)}if(settings.className){dom.addClass(instance.rootElement,settings.className)}}if(typeof settings.height!="undefined"){var height=settings.height;if(typeof height=="function"){height=height()}instance.rootElement.style.height=height+"px"}if(typeof settings.width!="undefined"){var width=settings.width;if(typeof width=="function"){width=width()}instance.rootElement.style.width=width+"px"}if(height){instance.rootElement.style.overflow="hidden"}if(!init){Handsontable.hooks.run(instance,"afterUpdateSettings")}grid.adjustRowsAndCols();if(instance.view&&!priv.firstRun){instance.forceFullRender=true;selection.refreshBorders(null,true)}};this.getValue=function(){var sel=instance.getSelected();if(GridSettings.prototype.getValue){if(typeof GridSettings.prototype.getValue==="function"){return GridSettings.prototype.getValue.call(instance)}else if(sel){return instance.getData()[sel[0]][GridSettings.prototype.getValue]}}else if(sel){return instance.getDataAtCell(sel[0],sel[1])}};function expandType(obj){if(!obj.hasOwnProperty("type")){return}var type,expandedType={};if(typeof obj.type==="object"){type=obj.type}else if(typeof obj.type==="string"){type=Handsontable.cellTypes[obj.type];if(type===void 0){throw new Error('You declared cell type "'+obj.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}for(var i in type){if(type.hasOwnProperty(i)&&!obj.hasOwnProperty(i)){
expandedType[i]=type[i]}}return expandedType}this.getSettings=function(){return priv.settings};this.clear=function(){selection.selectAll();selection.empty()};this.alter=function(action,index,amount,source,keepEmptyRows){grid.alter(action,index,amount,source,keepEmptyRows)};this.getCell=function(row,col,topmost){return instance.view.getCellAtCoords(new WalkontableCellCoords(row,col),topmost)};this.getCoords=function(elem){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,elem)};this.colToProp=function(col){return datamap.colToProp(col)};this.propToCol=function(prop){return datamap.propToCol(prop)};this.getDataAtCell=function(row,col){return datamap.get(row,datamap.colToProp(col))};this.getDataAtRowProp=function(row,prop){return datamap.get(row,prop)};this.getDataAtCol=function(col){var out=[];return out.concat.apply(out,datamap.getRange(new WalkontableCellCoords(0,col),new WalkontableCellCoords(priv.settings.data.length-1,col),datamap.DESTINATION_RENDERER))};this.getDataAtProp=function(prop){var out=[],range;range=datamap.getRange(new WalkontableCellCoords(0,datamap.propToCol(prop)),new WalkontableCellCoords(priv.settings.data.length-1,datamap.propToCol(prop)),datamap.DESTINATION_RENDERER);return out.concat.apply(out,range)};this.getSourceDataAtCol=function(col){var out=[],data=priv.settings.data;for(var i=0;i<data.length;i++){out.push(data[i][col])}return out};this.getSourceDataAtRow=function(row){return priv.settings.data[row]};this.getDataAtRow=function(row){var data=datamap.getRange(new WalkontableCellCoords(row,0),new WalkontableCellCoords(row,this.countCols()-1),datamap.DESTINATION_RENDERER);return data[0]};this.removeCellMeta=function(row,col,key){var cellMeta=instance.getCellMeta(row,col);if(cellMeta[key]!=undefined){delete priv.cellSettings[row][col][key]}};this.setCellMetaObject=function(row,col,prop){if(typeof prop==="object"){for(var key in prop){if(prop.hasOwnProperty(key)){var value=prop[key];this.setCellMeta(row,col,key,value)}}}};this.setCellMeta=function(row,col,key,val){if(!priv.cellSettings[row]){priv.cellSettings[row]=[]}if(!priv.cellSettings[row][col]){priv.cellSettings[row][col]=new priv.columnSettings[col]}priv.cellSettings[row][col][key]=val;Handsontable.hooks.run(instance,"afterSetCellMeta",row,col,key,val)};this.getCellMeta=function(row,col){var prop=datamap.colToProp(col),cellProperties;row=translateRowIndex(row);col=translateColIndex(col);if(!priv.columnSettings[col]){priv.columnSettings[col]=helper.columnFactory(GridSettings,priv.columnsSettingConflicts)}if(!priv.cellSettings[row]){priv.cellSettings[row]=[]}if(!priv.cellSettings[row][col]){priv.cellSettings[row][col]=new priv.columnSettings[col]}cellProperties=priv.cellSettings[row][col];cellProperties.row=row;cellProperties.col=col;cellProperties.prop=prop;cellProperties.instance=instance;Handsontable.hooks.run(instance,"beforeGetCellMeta",row,col,cellProperties);helper.extend(cellProperties,expandType(cellProperties));if(cellProperties.cells){var settings=cellProperties.cells.call(cellProperties,row,col,prop);if(settings){helper.extend(cellProperties,settings);helper.extend(cellProperties,expandType(settings))}}Handsontable.hooks.run(instance,"afterGetCellMeta",row,col,cellProperties);return cellProperties};this.isColumnModificationAllowed=function(){return!(instance.dataType==="object"||instance.getSettings().columns)};function translateRowIndex(row){return Handsontable.hooks.run(instance,"modifyRow",row)}function translateColIndex(col){return Handsontable.hooks.run(instance,"modifyCol",col)}var rendererLookup=helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(row,col){var renderer=rendererLookup.call(this,row,col);return getRenderer(renderer)};this.getCellEditor=helper.cellMethodLookupFactory("editor");this.getCellValidator=helper.cellMethodLookupFactory("validator");this.validateCells=function(callback){var waitingForValidator=new ValidatorsQueue;waitingForValidator.onQueueEmpty=callback;var i=instance.countRows()-1;while(i>=0){var j=instance.countCols()-1;while(j>=0){waitingForValidator.addValidatorToQueue();instance.validateCell(instance.getDataAtCell(i,j),instance.getCellMeta(i,j),function(){waitingForValidator.removeValidatorFormQueue()},"validateCells");j--}i--}waitingForValidator.checkIfQueueIsEmpty()};this.getRowHeader=function(row){if(row===void 0){var out=[];for(var i=0,ilen=instance.countRows();i<ilen;i++){out.push(instance.getRowHeader(i))}return out}else if(Array.isArray(priv.settings.rowHeaders)&&priv.settings.rowHeaders[row]!==void 0){return priv.settings.rowHeaders[row]}else if(typeof priv.settings.rowHeaders==="function"){return priv.settings.rowHeaders(row)}else if(priv.settings.rowHeaders&&typeof priv.settings.rowHeaders!=="string"&&typeof priv.settings.rowHeaders!=="number"){return row+1}else{return priv.settings.rowHeaders}};this.hasRowHeaders=function(){return!!priv.settings.rowHeaders};this.hasColHeaders=function(){if(priv.settings.colHeaders!==void 0&&priv.settings.colHeaders!==null){return!!priv.settings.colHeaders}for(var i=0,ilen=instance.countCols();i<ilen;i++){if(instance.getColHeader(i)){return true}}return false};this.getColHeader=function(col){if(col===void 0){var out=[];for(var i=0,ilen=instance.countCols();i<ilen;i++){out.push(instance.getColHeader(i))}return out}else{var baseCol=col;col=Handsontable.hooks.run(instance,"modifyCol",col);if(priv.settings.columns&&priv.settings.columns[col]&&priv.settings.columns[col].title){return priv.settings.columns[col].title}else if(Array.isArray(priv.settings.colHeaders)&&priv.settings.colHeaders[col]!==void 0){return priv.settings.colHeaders[col]}else if(typeof priv.settings.colHeaders==="function"){return priv.settings.colHeaders(col)}else if(priv.settings.colHeaders&&typeof priv.settings.colHeaders!=="string"&&typeof priv.settings.colHeaders!=="number"){return helper.spreadsheetColumnLabel(baseCol)}else{return priv.settings.colHeaders}}};this._getColWidthFromSettings=function(col){var cellProperties=instance.getCellMeta(0,col);var width=cellProperties.width;if(width===void 0||width===priv.settings.width){width=cellProperties.colWidths}if(width!==void 0&&width!==null){switch(typeof width){case"object":width=width[col];break;case"function":width=width(col);break}if(typeof width==="string"){width=parseInt(width,10)}}return width};this.getColWidth=function(col){var width=instance._getColWidthFromSettings(col);if(!width){width=50}width=Handsontable.hooks.run(instance,"modifyColWidth",width,col);return width};this._getRowHeightFromSettings=function(row){var height=priv.settings.rowHeights;if(height!==void 0&&height!==null){switch(typeof height){case"object":height=height[row];break;case"function":height=height(row);break}if(typeof height==="string"){height=parseInt(height,10)}}return height};this.getRowHeight=function(row){var height=instance._getRowHeightFromSettings(row);height=Handsontable.hooks.run(instance,"modifyRowHeight",height,row);return height};this.countRows=function(){return priv.settings.data.length};this.countCols=function(){if(instance.dataType==="object"||instance.dataType==="function"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else{return datamap.colToPropCache.length}}else if(instance.dataType==="array"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else if(priv.settings.data&&priv.settings.data[0]&&priv.settings.data[0].length){return priv.settings.data[0].length}else{return 0}}};this.rowOffset=function(){return instance.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return instance.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(ending){var i=instance.countRows()-1,empty=0,row;while(i>=0){row=Handsontable.hooks.run(this,"modifyRow",i);if(instance.isEmptyRow(row)){empty++}else if(ending){break}i--}return empty};this.countEmptyCols=function(ending){if(instance.countRows()<1){return 0}var i=instance.countCols()-1,empty=0;while(i>=0){if(instance.isEmptyCol(i)){empty++}else if(ending){break}i--}return empty};this.isEmptyRow=function(row){return priv.settings.isEmptyRow.call(instance,row)};this.isEmptyCol=function(col){return priv.settings.isEmptyCol.call(instance,col)};this.selectCell=function(row,col,endRow,endCol,scrollToCell,changeListener){var coords;changeListener=typeof changeListener==="undefined"||changeListener===true;if(typeof row!=="number"||row<0||row>=instance.countRows()){return false}if(typeof col!=="number"||col<0||col>=instance.countCols()){return false}if(typeof endRow!=="undefined"){if(typeof endRow!=="number"||endRow<0||endRow>=instance.countRows()){return false}if(typeof endCol!=="number"||endCol<0||endCol>=instance.countCols()){return false}}coords=new WalkontableCellCoords(row,col);priv.selRange=new WalkontableCellRange(coords,coords,coords);if(document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body){document.activeElement.blur()}if(changeListener){instance.listen()}if(typeof endRow==="undefined"){selection.setRangeEnd(priv.selRange.from,scrollToCell)}else{selection.setRangeEnd(new WalkontableCellCoords(endRow,endCol),scrollToCell)}instance.selection.finish();return true};this.selectCellByProp=function(row,prop,endRow,endProp,scrollToCell){arguments[1]=datamap.propToCol(arguments[1]);if(typeof arguments[3]!=="undefined"){arguments[3]=datamap.propToCol(arguments[3])}return instance.selectCell.apply(instance,arguments)};this.deselectCell=function(){selection.deselect()};this.destroy=function(){instance._clearTimeouts();if(instance.view){instance.view.destroy()}dom.empty(instance.rootElement);eventManager.clear();Handsontable.hooks.run(instance,"afterDestroy");Handsontable.hooks.destroy(instance);for(var i in instance){if(instance.hasOwnProperty(i)){if(typeof instance[i]==="function"){if(i!=="runHooks"){instance[i]=postMortem}}else if(i!=="guid"){instance[i]=null}}}priv=null;datamap=null;grid=null;selection=null;editorManager=null;instance=null;GridSettings=null};function postMortem(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}this.getActiveEditor=function(){return editorManager.getActiveEditor()};this.getPlugin=function(pluginName){return getPlugin(this,pluginName)};this.getInstance=function(){return instance};this.addHook=function(key,callback){Handsontable.hooks.add(key,callback,instance)};this.addHookOnce=function(key,callback){Handsontable.hooks.once(key,callback,instance)};this.removeHook=function(key,callback){Handsontable.hooks.remove(key,callback,instance)};this.runHooks=function(key,p1,p2,p3,p4,p5,p6){return Handsontable.hooks.run(instance,key,p1,p2,p3,p4,p5,p6)};this.timeouts=[];this._registerTimeout=function(handle){this.timeouts.push(handle)};this._clearTimeouts=function(){for(var i=0,ilen=this.timeouts.length;i<ilen;i++){clearTimeout(this.timeouts[i])}};this.version=Handsontable.version};var DefaultSettings=function(){};DefaultSettings.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],comments:false,customBorders:false,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:true,allowInsertColumn:true,allowRemoveRow:true,allowRemoveColumn:true,multiSelect:true,fillHandle:true,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:false,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(row){var col,colLen,value,meta;for(col=0,colLen=this.countCols();col<colLen;col++){value=this.getDataAtCell(row,col);if(value!==""&&value!==null&&typeof value!=="undefined"){if(typeof value==="object"){meta=this.getCellMeta(row,col);return helper.isObjectEquals(this.getSchema()[meta.prop],value)}return false}}return true},isEmptyCol:function(col){var row,rowLen,value;for(row=0,rowLen=this.countRows();row<rowLen;row++){value=this.getDataAtCell(row,col);if(value!==""&&value!==null&&typeof value!=="undefined"){return false}}return true},observeDOMVisibility:true,allowInvalid:true,invalidCellClassName:"htInvalid",placeholder:false,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:false,readOnly:false,search:false,type:"text",copyable:true,editor:void 0,autoComplete:void 0,debug:false,wordWrap:true,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:false,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0,validator:void 0,disableVisualSelection:false,sortIndicator:false,manualColumnFreeze:void 0,trimWhitespace:true,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,format:void 0,className:void 0};Handsontable.DefaultSettings=DefaultSettings},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/cell/range.js":6,"./3rdparty/walkontable/src/selection.js":18,"./dataMap.js":26,"./dom.js":27,"./editorManager.js":28,"./eventManager.js":41,"./helpers.js":42,"./plugins.js":45,"./renderers.js":70,"./tableView.js":85,numeral:"numeral"}],26:[function(require,module,exports){"use strict";Object.defineProperties(exports,{DataMap:{get:function(){return DataMap}},__esModule:{value:true}});var $__helpers_46_js__,$__multiMap_46_js__,$__SheetClip__;var helper=($__helpers_46_js__=require("./helpers.js"),$__helpers_46_js__&&$__helpers_46_js__.__esModule&&$__helpers_46_js__||{"default":$__helpers_46_js__});var MultiMap=($__multiMap_46_js__=require("./multiMap.js"),$__multiMap_46_js__&&$__multiMap_46_js__.__esModule&&$__multiMap_46_js__||{"default":$__multiMap_46_js__}).MultiMap;var SheetClip=($__SheetClip__=require("SheetClip"),$__SheetClip__&&$__SheetClip__.__esModule&&$__SheetClip__||{"default":$__SheetClip__}).default;Handsontable.DataMap=DataMap;function DataMap(instance,priv,GridSettings){this.instance=instance;this.priv=priv;this.GridSettings=GridSettings;this.dataSource=this.instance.getSettings().data;if(this.dataSource[0]&&!this.instance.getSettings().dataSchema){this.duckSchema=this.recursiveDuckSchema(this.dataSource[0])}else{this.duckSchema={}}this.createMap()}DataMap.prototype.DESTINATION_RENDERER=1;DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;DataMap.prototype.recursiveDuckSchema=function(object){return Handsontable.helper.duckSchema(object)};DataMap.prototype.recursiveDuckColumns=function(schema,lastCol,parent){var prop,i;if(typeof lastCol==="undefined"){lastCol=0;parent=""}if(typeof schema==="object"&&!Array.isArray(schema)){for(i in schema){if(schema.hasOwnProperty(i)){if(schema[i]===null){prop=parent+i;this.colToPropCache.push(prop);this.propToColCache.set(prop,lastCol);lastCol++}else{lastCol=this.recursiveDuckColumns(schema[i],lastCol,i+".")}}}}return lastCol};DataMap.prototype.createMap=function(){var i,ilen;this.colToPropCache=[];this.propToColCache=new MultiMap;var columns=this.instance.getSettings().columns;if(columns){for(i=0,ilen=columns.length;i<ilen;i++){if(typeof columns[i].data!="undefined"){this.colToPropCache[i]=columns[i].data;this.propToColCache.set(columns[i].data,i)}}}else{var schema=this.getSchema();if(typeof schema==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}this.recursiveDuckColumns(schema)}};DataMap.prototype.colToProp=function(col){col=Handsontable.hooks.run(this.instance,"modifyCol",col);if(this.colToPropCache&&typeof this.colToPropCache[col]!=="undefined"){return this.colToPropCache[col]}return col};DataMap.prototype.propToCol=function(prop){var col;if(typeof this.propToColCache.get(prop)!=="undefined"){col=this.propToColCache.get(prop)}else{col=prop}col=Handsontable.hooks.run(this.instance,"modifyCol",col);return col};DataMap.prototype.getSchema=function(){var schema=this.instance.getSettings().dataSchema;if(schema){if(typeof schema==="function"){return schema()}return schema}return this.duckSchema};DataMap.prototype.createRow=function(index,amount,createdAutomatically){var row,colCount=this.instance.countCols(),numberOfCreatedRows=0,currentIndex;if(!amount){amount=1}if(typeof index!=="number"||index>=this.instance.countRows()){index=this.instance.countRows()}currentIndex=index;var maxRows=this.instance.getSettings().maxRows;while(numberOfCreatedRows<amount&&this.instance.countRows()<maxRows){if(this.instance.dataType==="array"){row=[];for(var c=0;c<colCount;c++){row.push(null)}}else if(this.instance.dataType==="function"){row=this.instance.getSettings().dataSchema(index)}else{row={};helper.deepExtend(row,this.getSchema())}if(index===this.instance.countRows()){this.dataSource.push(row)}else{this.dataSource.splice(index,0,row)}numberOfCreatedRows++;currentIndex++}Handsontable.hooks.run(this.instance,"afterCreateRow",index,numberOfCreatedRows,createdAutomatically);this.instance.forceFullRender=true;return numberOfCreatedRows};DataMap.prototype.createCol=function(index,amount,createdAutomatically){if(!this.instance.isColumnModificationAllowed()){throw new Error("Cannot create new column. When data source in an object, "+"you can only have as much columns as defined in first data row, data schema or in the 'columns' setting."+"If you want to be able to add new columns, you have to use array datasource.")}var rlen=this.instance.countRows(),data=this.dataSource,constructor,numberOfCreatedCols=0,currentIndex;if(!amount){amount=1}currentIndex=index;var maxCols=this.instance.getSettings().maxCols;while(numberOfCreatedCols<amount&&this.instance.countCols()<maxCols){constructor=helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts);if(typeof index!=="number"||index>=this.instance.countCols()){for(var r=0;r<rlen;r++){if(typeof data[r]==="undefined"){data[r]=[]}data[r].push(null)}this.priv.columnSettings.push(constructor)}else{for(var r=0;r<rlen;r++){data[r].splice(currentIndex,0,null)}this.priv.columnSettings.splice(currentIndex,0,constructor)}numberOfCreatedCols++;currentIndex++}Handsontable.hooks.run(this.instance,"afterCreateCol",index,numberOfCreatedCols,createdAutomatically);this.instance.forceFullRender=true;return numberOfCreatedCols};DataMap.prototype.removeRow=function(index,amount){if(!amount){amount=1}if(typeof index!=="number"){index=-amount}index=(this.instance.countRows()+index)%this.instance.countRows();var logicRows=this.physicalRowsToLogical(index,amount);var actionWasNotCancelled=Handsontable.hooks.run(this.instance,"beforeRemoveRow",index,amount);if(actionWasNotCancelled===false){return}var data=this.dataSource;var newData=data.filter(function(row,index){return logicRows.indexOf(index)==-1});data.length=0;Array.prototype.push.apply(data,newData);Handsontable.hooks.run(this.instance,"afterRemoveRow",index,amount);this.instance.forceFullRender=true};DataMap.prototype.removeCol=function(index,amount){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("cannot remove column with object data source or columns option specified")}if(!amount){amount=1}if(typeof index!=="number"){index=-amount}index=(this.instance.countCols()+index)%this.instance.countCols();var actionWasNotCancelled=Handsontable.hooks.run(this.instance,"beforeRemoveCol",index,amount);if(actionWasNotCancelled===false){return}var data=this.dataSource;for(var r=0,rlen=this.instance.countRows();r<rlen;r++){data[r].splice(index,amount)}this.priv.columnSettings.splice(index,amount);Handsontable.hooks.run(this.instance,"afterRemoveCol",index,amount);this.instance.forceFullRender=true};DataMap.prototype.spliceCol=function(col,index,amount){var elements=4<=arguments.length?[].slice.call(arguments,3):[];var colData=this.instance.getDataAtCol(col);var removed=colData.slice(index,index+amount);var after=colData.slice(index+amount);helper.extendArray(elements,after);var i=0;while(i<amount){elements.push(null);i++}helper.to2dArray(elements);this.instance.populateFromArray(index,col,elements,null,null,"spliceCol");return removed};DataMap.prototype.spliceRow=function(row,index,amount){var elements=4<=arguments.length?[].slice.call(arguments,3):[];var rowData=this.instance.getSourceDataAtRow(row);var removed=rowData.slice(index,index+amount);var after=rowData.slice(index+amount);helper.extendArray(elements,after);var i=0;while(i<amount){elements.push(null);i++}this.instance.populateFromArray(row,index,[elements],null,null,"spliceRow");return removed};DataMap.prototype.get=function(row,prop){row=Handsontable.hooks.run(this.instance,"modifyRow",row);if(typeof prop==="string"&&prop.indexOf(".")>-1){var sliced=prop.split(".");var out=this.dataSource[row];if(!out){return null}for(var i=0,ilen=sliced.length;i<ilen;i++){out=out[sliced[i]];if(typeof out==="undefined"){return null}}return out}else if(typeof prop==="function"){return prop(this.dataSource.slice(row,row+1)[0])}else{return this.dataSource[row]?this.dataSource[row][prop]:null}};var copyableLookup=helper.cellMethodLookupFactory("copyable",false);DataMap.prototype.getCopyable=function(row,prop){if(copyableLookup.call(this.instance,row,this.propToCol(prop))){return this.get(row,prop)}return""};DataMap.prototype.set=function(row,prop,value,source){row=Handsontable.hooks.run(this.instance,"modifyRow",row,source||"datamapGet");if(typeof prop==="string"&&prop.indexOf(".")>-1){var sliced=prop.split(".");var out=this.dataSource[row];for(var i=0,ilen=sliced.length-1;i<ilen;i++){if(typeof out[sliced[i]]==="undefined"){out[sliced[i]]={}}out=out[sliced[i]]}out[sliced[i]]=value}else if(typeof prop==="function"){prop(this.dataSource.slice(row,row+1)[0],value)}else{this.dataSource[row][prop]=value}};DataMap.prototype.physicalRowsToLogical=function(index,amount){var totalRows=this.instance.countRows();var physicRow=(totalRows+index)%totalRows;var logicRows=[];var rowsToRemove=amount;var row;while(physicRow<totalRows&&rowsToRemove){row=Handsontable.hooks.run(this.instance,"modifyRow",physicRow);logicRows.push(row);rowsToRemove--;physicRow++}return logicRows};DataMap.prototype.clear=function(){for(var r=0;r<this.instance.countRows();r++){for(var c=0;c<this.instance.countCols();c++){this.set(r,this.colToProp(c),"")}}};DataMap.prototype.getAll=function(){return this.dataSource};DataMap.prototype.getRange=function(start,end,destination){var r,rlen,c,clen,output=[],row;var getFn=destination===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;rlen=Math.max(start.row,end.row);clen=Math.max(start.col,end.col);for(r=Math.min(start.row,end.row);r<=rlen;r++){row=[];for(c=Math.min(start.col,end.col);c<=clen;c++){row.push(getFn.call(this,r,this.colToProp(c)))}output.push(row)}return output};DataMap.prototype.getText=function(start,end){return SheetClip.stringify(this.getRange(start,end,this.DESTINATION_RENDERER))};DataMap.prototype.getCopyableText=function(start,end){return SheetClip.stringify(this.getRange(start,end,this.DESTINATION_CLIPBOARD_GENERATOR))}},{"./helpers.js":42,"./multiMap.js":43,SheetClip:"SheetClip"}],27:[function(require,module,exports){"use strict";Object.defineProperties(exports,{enableImmediatePropagation:{get:function(){return enableImmediatePropagation}},closest:{get:function(){return closest}},isChildOf:{get:function(){return isChildOf}},isChildOfWebComponentTable:{get:function(){return isChildOfWebComponentTable}},polymerWrap:{get:function(){return polymerWrap}},polymerUnwrap:{get:function(){return polymerUnwrap}},isWebComponentSupportedNatively:{get:function(){return isWebComponentSupportedNatively}},index:{get:function(){return index}},hasClass:{get:function(){return hasClass}},addClass:{get:function(){return addClass}},removeClass:{get:function(){return removeClass}},removeTextNodes:{get:function(){return removeTextNodes}},empty:{get:function(){return empty}},HTML_CHARACTERS:{get:function(){return HTML_CHARACTERS}},fastInnerHTML:{get:function(){return fastInnerHTML}},fastInnerText:{get:function(){return fastInnerText}},isVisible:{get:function(){return isVisible}},offset:{get:function(){return offset}},getWindowScrollTop:{get:function(){return getWindowScrollTop}},getWindowScrollLeft:{get:function(){return getWindowScrollLeft}},getScrollTop:{get:function(){return getScrollTop}},getScrollLeft:{get:function(){return getScrollLeft}},getScrollableElement:{get:function(){return getScrollableElement}},getTrimmingContainer:{get:function(){return getTrimmingContainer}},getStyle:{get:function(){return getStyle}},getComputedStyle:{get:function(){return getComputedStyle}},outerWidth:{get:function(){return outerWidth}},outerHeight:{get:function(){return outerHeight}},innerHeight:{get:function(){return innerHeight}},innerWidth:{get:function(){return innerWidth}},addEvent:{get:function(){return addEvent}},removeEvent:{get:function(){return removeEvent}},hasCaptionProblem:{get:function(){return hasCaptionProblem}},getCaretPosition:{get:function(){return getCaretPosition}},getSelectionEndPosition:{get:function(){return getSelectionEndPosition}},setCaretPosition:{get:function(){return setCaretPosition}},getScrollbarWidth:{get:function(){return getScrollbarWidth}},isIE8:{get:function(){return isIE8}},isIE9:{get:function(){return isIE9}},isSafari:{get:function(){return isSafari}},setOverlayPosition:{get:function(){return setOverlayPosition}},getCssTransform:{get:function(){return getCssTransform}},resetCssTransform:{get:function(){return resetCssTransform}},__esModule:{value:true}});function enableImmediatePropagation(event){if(event!=null&&event.isImmediatePropagationEnabled==null){event.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=false;this.cancelBubble=true};event.isImmediatePropagationEnabled=true;event.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}}}function closest(element,nodes,until){while(element!=null&&element!==until){if(element.nodeType===Node.ELEMENT_NODE&&(nodes.indexOf(element.nodeName)>-1||nodes.indexOf(element)>-1)){return element}if(element.host&&element.nodeType===Node.DOCUMENT_FRAGMENT_NODE){element=element.host}else{element=element.parentNode}}return null}function isChildOf(child,parent){var node=child.parentNode;var queriedParents=[];if(typeof parent==="string"){queriedParents=Array.prototype.slice.call(document.querySelectorAll(parent),0)}else{queriedParents.push(parent)}while(node!=null){if(queriedParents.indexOf(node)>-1){return true}node=node.parentNode}return false}function isChildOfWebComponentTable(element){var hotTableName="hot-table",result=false,parentNode;parentNode=polymerWrap(element);function isHotTable(element){return element.nodeType===Node.ELEMENT_NODE&&element.nodeName===hotTableName.toUpperCase()}while(parentNode!=null){if(isHotTable(parentNode)){result=true;break}else if(parentNode.host&&parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){result=isHotTable(parentNode.host);if(result){break}parentNode=parentNode.host}parentNode=parentNode.parentNode}return result}function polymerWrap(element){return typeof Polymer!=="undefined"&&typeof wrap==="function"?wrap(element):element}function polymerUnwrap(element){return typeof Polymer!=="undefined"&&typeof unwrap==="function"?unwrap(element):element}function isWebComponentSupportedNatively(){var test=document.createElement("div");return test.createShadowRoot&&test.createShadowRoot.toString().match(/\[native code\]/)?true:false}function index(elem){var i=0;if(elem.previousSibling){while(elem=elem.previousSibling){++i}}return i}var classListSupport=document.documentElement.classList?true:false;var _hasClass,_addClass,_removeClass;function filterEmptyClassNames(classNames){var len=0,result=[];if(!classNames||!classNames.length){return result}while(classNames[len]){result.push(classNames[len]);len++}return result}if(classListSupport){var isSupportMultipleClassesArg=function(){var element=document.createElement("div");element.classList.add("test","test2");return element.classList.contains("test2")}();_hasClass=function _hasClass(element,className){if(className===""){return false}return element.classList.contains(className)};_addClass=function _addClass(element,className){var len=0;if(typeof className==="string"){className=className.split(" ")}className=filterEmptyClassNames(className);if(isSupportMultipleClassesArg){element.classList.add.apply(element.classList,className)}else{while(className&&className[len]){element.classList.add(className[len]);len++}}};_removeClass=function _removeClass(element,className){var len=0;if(typeof className==="string"){className=className.split(" ")}className=filterEmptyClassNames(className);if(isSupportMultipleClassesArg){element.classList.remove.apply(element.classList,className)}else{while(className&&className[len]){element.classList.remove(className[len]);len++}}}}else{var createClassNameRegExp=function createClassNameRegExp(className){return new RegExp("(\\s|^)"+className+"(\\s|$)")};_hasClass=function _hasClass(element,className){return element.className.match(createClassNameRegExp(className))?true:false};_addClass=function _addClass(element,className){var len=0,_className=element.className;if(typeof className==="string"){className=className.split(" ")}if(_className===""){_className=className.join(" ")}else{while(className&&className[len]){if(!createClassNameRegExp(className[len]).test(_className)){_className+=" "+className[len]}len++}}element.className=_className};_removeClass=function _removeClass(element,className){var len=0,_className=element.className;if(typeof className==="string"){className=className.split(" ")}while(className&&className[len]){_className=_className.replace(createClassNameRegExp(className[len])," ").trim();len++}if(element.className!==_className){element.className=_className}}}function hasClass(element,className){return _hasClass(element,className)}function addClass(element,className){return _addClass(element,className)}function removeClass(element,className){return _removeClass(element,className)}function removeTextNodes(elem,parent){if(elem.nodeType===3){parent.removeChild(elem)}else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(elem.nodeName)>-1){var childs=elem.childNodes;for(var i=childs.length-1;i>=0;i--){removeTextNodes(childs[i],elem)}}}function empty(element){var child;while(child=element.lastChild){element.removeChild(child)}}var HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(element,content){if(HTML_CHARACTERS.test(content)){element.innerHTML=content}else{fastInnerText(element,content)}}var textContextSupport=document.createTextNode("test").textContent?true:false;function fastInnerText(element,content){var child=element.firstChild;if(child&&child.nodeType===3&&child.nextSibling===null){if(textContextSupport){child.textContent=content}else{child.data=content}}else{empty(element);element.appendChild(document.createTextNode(content))}}function isVisible(elem){var next=elem;while(polymerUnwrap(next)!==document.documentElement){if(next===null){return false}else if(next.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(next.host){if(next.host.impl){return isVisible(next.host.impl)}else if(next.host){return isVisible(next.host)}else{throw new Error("Lost in Web Components world")}}else{return false}}else if(next.style.display==="none"){
return false}next=next.parentNode}return true}function offset(elem){var offsetLeft,offsetTop,lastElem,docElem,box;docElem=document.documentElement;if(hasCaptionProblem()&&elem.firstChild&&elem.firstChild.nodeName==="CAPTION"){box=elem.getBoundingClientRect();return{top:box.top+(window.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(window.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}}offsetLeft=elem.offsetLeft;offsetTop=elem.offsetTop;lastElem=elem;while(elem=elem.offsetParent){if(elem===document.body){break}offsetLeft+=elem.offsetLeft;offsetTop+=elem.offsetTop;lastElem=elem}if(lastElem&&lastElem.style.position==="fixed"){offsetLeft+=window.pageXOffset||docElem.scrollLeft;offsetTop+=window.pageYOffset||docElem.scrollTop}return{left:offsetLeft,top:offsetTop}}function getWindowScrollTop(){var res=window.scrollY;if(res==void 0){res=document.documentElement.scrollTop}return res}function getWindowScrollLeft(){var res=window.scrollX;if(res==void 0){res=document.documentElement.scrollLeft}return res}function getScrollTop(elem){if(elem===window){return getWindowScrollTop(elem)}else{return elem.scrollTop}}function getScrollLeft(elem){if(elem===window){return getWindowScrollLeft(elem)}else{return elem.scrollLeft}}function getScrollableElement(element){var el=element.parentNode,props=["auto","scroll"],overflow,overflowX,overflowY,computedStyle="",computedOverflow="",computedOverflowY="",computedOverflowX="";while(el&&el.style&&document.body!==el){overflow=el.style.overflow;overflowX=el.style.overflowX;overflowY=el.style.overflowY;if(overflow=="scroll"||overflowX=="scroll"||overflowY=="scroll"){return el}else if(window.getComputedStyle){computedStyle=window.getComputedStyle(el);computedOverflow=computedStyle.getPropertyValue("overflow");computedOverflowY=computedStyle.getPropertyValue("overflow-y");computedOverflowX=computedStyle.getPropertyValue("overflow-x");if(computedOverflow==="scroll"||computedOverflowX==="scroll"||computedOverflowY==="scroll"){return el}}if(el.clientHeight<=el.scrollHeight&&(props.indexOf(overflowY)!==-1||props.indexOf(overflow)!==-1||props.indexOf(computedOverflow)!==-1||props.indexOf(computedOverflowY)!==-1)){return el}if(el.clientWidth<=el.scrollWidth&&(props.indexOf(overflowX)!==-1||props.indexOf(overflow)!==-1||props.indexOf(computedOverflow)!==-1||props.indexOf(computedOverflowX)!==-1)){return el}el=el.parentNode}return window}function getTrimmingContainer(base){var el=base.parentNode;while(el&&el.style&&document.body!==el){if(el.style.overflow!=="visible"&&el.style.overflow!==""){return el}else if(window.getComputedStyle){var computedStyle=window.getComputedStyle(el);if(computedStyle.getPropertyValue("overflow")!=="visible"&&computedStyle.getPropertyValue("overflow")!==""){return el}}el=el.parentNode}return window}function getStyle(elem,prop){if(!elem){return}else if(elem===window){if(prop==="width"){return window.innerWidth+"px"}else if(prop==="height"){return window.innerHeight+"px"}return}var styleProp=elem.style[prop],computedStyle;if(styleProp!==""&&styleProp!==void 0){return styleProp}else{computedStyle=getComputedStyle(elem);if(computedStyle[prop]!==""&&computedStyle[prop]!==void 0){return computedStyle[prop]}return void 0}}function getComputedStyle(elem){return elem.currentStyle||document.defaultView.getComputedStyle(elem)}function outerWidth(elem){return elem.offsetWidth}function outerHeight(elem){if(hasCaptionProblem()&&elem.firstChild&&elem.firstChild.nodeName==="CAPTION"){return elem.offsetHeight+elem.firstChild.offsetHeight}else{return elem.offsetHeight}}function innerHeight(elem){return elem.clientHeight||elem.innerHeight}function innerWidth(elem){return elem.clientWidth||elem.innerWidth}function addEvent(element,event,callback){if(window.addEventListener){element.addEventListener(event,callback,false)}else{element.attachEvent("on"+event,callback)}}function removeEvent(element,event,callback){if(window.removeEventListener){element.removeEventListener(event,callback,false)}else{element.detachEvent("on"+event,callback)}}var _hasCaptionProblem;function detectCaptionProblem(){var TABLE=document.createElement("TABLE");TABLE.style.borderSpacing=0;TABLE.style.borderWidth=0;TABLE.style.padding=0;var TBODY=document.createElement("TBODY");TABLE.appendChild(TBODY);TBODY.appendChild(document.createElement("TR"));TBODY.firstChild.appendChild(document.createElement("TD"));TBODY.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var CAPTION=document.createElement("CAPTION");CAPTION.innerHTML="c<br>c<br>c<br>c";CAPTION.style.padding=0;CAPTION.style.margin=0;TABLE.insertBefore(CAPTION,TBODY);document.body.appendChild(TABLE);_hasCaptionProblem=TABLE.offsetHeight<2*TABLE.lastChild.offsetHeight;document.body.removeChild(TABLE)}function hasCaptionProblem(){if(_hasCaptionProblem===void 0){detectCaptionProblem()}return _hasCaptionProblem}function getCaretPosition(el){if(el.selectionStart){return el.selectionStart}else if(document.selection){el.focus();var r=document.selection.createRange();if(r==null){return 0}var re=el.createTextRange(),rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint("EndToStart",re);return rc.text.length}return 0}function getSelectionEndPosition(el){if(el.selectionEnd){return el.selectionEnd}else if(document.selection){var r=document.selection.createRange();if(r==null){return 0}var re=el.createTextRange();return re.text.indexOf(r.text)+r.text.length}}function setCaretPosition(el,pos,endPos){if(endPos===void 0){endPos=pos}if(el.setSelectionRange){el.focus();el.setSelectionRange(pos,endPos)}else if(el.createTextRange){var range=el.createTextRange();range.collapse(true);range.moveEnd("character",endPos);range.moveStart("character",pos);range.select()}}var cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){var inner=document.createElement("p");inner.style.width="100%";inner.style.height="200px";var outer=document.createElement("div");outer.style.position="absolute";outer.style.top="0px";outer.style.left="0px";outer.style.visibility="hidden";outer.style.width="200px";outer.style.height="150px";outer.style.overflow="hidden";outer.appendChild(inner);(document.body||document.documentElement).appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="scroll";var w2=inner.offsetWidth;if(w1==w2){w2=outer.clientWidth}(document.body||document.documentElement).removeChild(outer);return w1-w2}function getScrollbarWidth(){if(cachedScrollbarWidth===void 0){cachedScrollbarWidth=walkontableCalculateScrollbarWidth()}return cachedScrollbarWidth}var _isIE8=!document.createTextNode("test").textContent;function isIE8(){return isIE8}var _isIE9=!!document.documentMode;function isIE9(){return _isIE9}var _isSafari=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);function isSafari(){return _isSafari}function setOverlayPosition(overlayElem,left,top){if(_isIE8||_isIE9){overlayElem.style.top=top;overlayElem.style.left=left}else if(_isSafari){overlayElem.style["-webkit-transform"]="translate3d("+left+","+top+",0)"}else{overlayElem.style.transform="translate3d("+left+","+top+",0)"}}function getCssTransform(elem){var transform;if(elem.style["transform"]&&(transform=elem.style["transform"])!==""){return["transform",transform]}else if(elem.style["-webkit-transform"]&&(transform=elem.style["-webkit-transform"])!==""){return["-webkit-transform",transform]}return-1}function resetCssTransform(elem){if(elem["transform"]&&elem["transform"]!==""){elem["transform"]=""}else if(elem["-webkit-transform"]&&elem["-webkit-transform"]!==""){elem["-webkit-transform"]=""}}window.Handsontable=window.Handsontable||{};Handsontable.Dom={addClass:addClass,addEvent:addEvent,closest:closest,empty:empty,enableImmediatePropagation:enableImmediatePropagation,fastInnerHTML:fastInnerHTML,fastInnerText:fastInnerText,getCaretPosition:getCaretPosition,getComputedStyle:getComputedStyle,getCssTransform:getCssTransform,getScrollableElement:getScrollableElement,getScrollbarWidth:getScrollbarWidth,getScrollLeft:getScrollLeft,getScrollTop:getScrollTop,getStyle:getStyle,getSelectionEndPosition:getSelectionEndPosition,getTrimmingContainer:getTrimmingContainer,getWindowScrollLeft:getWindowScrollLeft,getWindowScrollTop:getWindowScrollTop,hasCaptionProblem:hasCaptionProblem,hasClass:hasClass,HTML_CHARACTERS:HTML_CHARACTERS,index:index,innerHeight:innerHeight,innerWidth:innerWidth,isChildOf:isChildOf,isChildOfWebComponentTable:isChildOfWebComponentTable,isIE8:isIE8,isIE9:isIE9,isSafari:isSafari,isVisible:isVisible,isWebComponentSupportedNatively:isWebComponentSupportedNatively,offset:offset,outerHeight:outerHeight,outerWidth:outerWidth,polymerUnwrap:polymerUnwrap,polymerWrap:polymerWrap,removeClass:removeClass,removeEvent:removeEvent,removeTextNodes:removeTextNodes,resetCssTransform:resetCssTransform,setCaretPosition:setCaretPosition,setOverlayPosition:setOverlayPosition}},{}],28:[function(require,module,exports){"use strict";Object.defineProperties(exports,{EditorManager:{get:function(){return EditorManager}},__esModule:{value:true}});var $__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__,$__helpers_46_js__,$__dom_46_js__,$__editors_46_js__,$__eventManager_46_js__;var WalkontableCellCoords=($__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./3rdparty/walkontable/src/cell/coords.js"),$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;var helper=($__helpers_46_js__=require("./helpers.js"),$__helpers_46_js__&&$__helpers_46_js__.__esModule&&$__helpers_46_js__||{"default":$__helpers_46_js__});var dom=($__dom_46_js__=require("./dom.js"),$__dom_46_js__&&$__dom_46_js__.__esModule&&$__dom_46_js__||{"default":$__dom_46_js__});var getEditor=($__editors_46_js__=require("./editors.js"),$__editors_46_js__&&$__editors_46_js__.__esModule&&$__editors_46_js__||{"default":$__editors_46_js__}).getEditor;var eventManagerObject=($__eventManager_46_js__=require("./eventManager.js"),$__eventManager_46_js__&&$__eventManager_46_js__.__esModule&&$__eventManager_46_js__||{"default":$__eventManager_46_js__}).eventManager;Handsontable.EditorManager=EditorManager;function EditorManager(instance,priv,selection){var _this=this,keyCodes=helper.keyCode,destroyed=false,eventManager,activeEditor;eventManager=eventManagerObject(instance);function moveSelectionAfterEnter(shiftKey){var enterMoves=typeof priv.settings.enterMoves==="function"?priv.settings.enterMoves(event):priv.settings.enterMoves;if(shiftKey){selection.transformStart(-enterMoves.row,-enterMoves.col)}else{selection.transformStart(enterMoves.row,enterMoves.col,true)}}function moveSelectionUp(shiftKey){if(shiftKey){selection.transformEnd(-1,0)}else{selection.transformStart(-1,0)}}function moveSelectionDown(shiftKey){if(shiftKey){selection.transformEnd(1,0)}else{selection.transformStart(1,0)}}function moveSelectionRight(shiftKey){if(shiftKey){selection.transformEnd(0,1)}else{selection.transformStart(0,1)}}function moveSelectionLeft(shiftKey){if(shiftKey){selection.transformEnd(0,-1)}else{selection.transformStart(0,-1)}}function onKeyDown(event){var ctrlDown,rangeModifier;if(!instance.isListening()){return}Handsontable.hooks.run(instance,"beforeKeyDown",event);if(destroyed){return}dom.enableImmediatePropagation(event);if(event.isImmediatePropagationStopped()){return}priv.lastKeyCode=event.keyCode;if(!selection.isSelected()){return}ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(activeEditor&&!activeEditor.isWaiting()){if(!helper.isMetaKey(event.keyCode)&&!ctrlDown&&!_this.isEditorOpened()){_this.openEditor("",event);return}}rangeModifier=event.shiftKey?selection.setRangeEnd:selection.setRangeStart;switch(event.keyCode){case keyCodes.A:if(ctrlDown){selection.selectAll();event.preventDefault();helper.stopPropagation(event)}break;case keyCodes.ARROW_UP:if(_this.isEditorOpened()&&activeEditor&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown)}moveSelectionUp(event.shiftKey);event.preventDefault();helper.stopPropagation(event);break;case keyCodes.ARROW_DOWN:if(_this.isEditorOpened()&&activeEditor&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown)}moveSelectionDown(event.shiftKey);event.preventDefault();helper.stopPropagation(event);break;case keyCodes.ARROW_RIGHT:if(_this.isEditorOpened()&&activeEditor&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown)}moveSelectionRight(event.shiftKey);event.preventDefault();helper.stopPropagation(event);break;case keyCodes.ARROW_LEFT:if(_this.isEditorOpened()&&activeEditor&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown)}moveSelectionLeft(event.shiftKey);event.preventDefault();helper.stopPropagation(event);break;case keyCodes.TAB:var tabMoves=typeof priv.settings.tabMoves==="function"?priv.settings.tabMoves(event):priv.settings.tabMoves;if(event.shiftKey){selection.transformStart(-tabMoves.row,-tabMoves.col)}else{selection.transformStart(tabMoves.row,tabMoves.col,true)}event.preventDefault();helper.stopPropagation(event);break;case keyCodes.BACKSPACE:case keyCodes.DELETE:selection.empty(event);_this.prepareEditor();event.preventDefault();break;case keyCodes.F2:_this.openEditor(null,event);event.preventDefault();break;case keyCodes.ENTER:if(_this.isEditorOpened()){if(activeEditor&&activeEditor.state!==Handsontable.EditorState.WAITING){_this.closeEditorAndSaveChanges(ctrlDown)}moveSelectionAfterEnter(event.shiftKey)}else{if(instance.getSettings().enterBeginsEditing){_this.openEditor(null,event)}else{moveSelectionAfterEnter(event.shiftKey)}}event.preventDefault();event.stopImmediatePropagation();break;case keyCodes.ESCAPE:if(_this.isEditorOpened()){_this.closeEditorAndRestoreOriginalValue(ctrlDown)}event.preventDefault();break;case keyCodes.HOME:if(event.ctrlKey||event.metaKey){rangeModifier(new WalkontableCellCoords(0,priv.selRange.from.col))}else{rangeModifier(new WalkontableCellCoords(priv.selRange.from.row,0))}event.preventDefault();helper.stopPropagation(event);break;case keyCodes.END:if(event.ctrlKey||event.metaKey){rangeModifier(new WalkontableCellCoords(instance.countRows()-1,priv.selRange.from.col))}else{rangeModifier(new WalkontableCellCoords(priv.selRange.from.row,instance.countCols()-1))}event.preventDefault();helper.stopPropagation(event);break;case keyCodes.PAGE_UP:selection.transformStart(-instance.countVisibleRows(),0);event.preventDefault();helper.stopPropagation(event);break;case keyCodes.PAGE_DOWN:selection.transformStart(instance.countVisibleRows(),0);event.preventDefault();helper.stopPropagation(event);break}}function init(){instance.addHook("afterDocumentKeyDown",onKeyDown);eventManager.addEventListener(document.documentElement,"keydown",function(event){instance.runHooks("afterDocumentKeyDown",event)});function onDblClick(event,coords,elem){if(elem.nodeName=="TD"){_this.openEditor()}}instance.view.wt.update("onCellDblClick",onDblClick);instance.addHook("afterDestroy",function(){destroyed=true})}this.destroyEditor=function(revertOriginal){var editor=this.getActiveEditor();if(editor&&editor.$htContainer&&editor.$htContainer[0]){$("html").off("."+editor.$htContainer[0].id)}this.closeEditor(revertOriginal)};this.getActiveEditor=function(){return activeEditor};this.prepareEditor=function(){var row,col,prop,td,originalValue,cellProperties,editorClass;if(activeEditor&&activeEditor.isWaiting()){this.closeEditor(false,false,function(dataSaved){if(dataSaved){_this.prepareEditor()}});return}row=priv.selRange.highlight.row;col=priv.selRange.highlight.col;prop=instance.colToProp(col);td=instance.getCell(row,col);originalValue=instance.getDataAtCell(row,col);cellProperties=instance.getCellMeta(row,col);editorClass=instance.getCellEditor(cellProperties);if(editorClass){activeEditor=Handsontable.editors.getEditor(editorClass,instance);activeEditor.prepare(row,col,prop,td,originalValue,cellProperties)}else{activeEditor=void 0}};this.isEditorOpened=function(){return activeEditor&&activeEditor.isOpened()};this.openEditor=function(initialValue,event){if(activeEditor&&!activeEditor.cellProperties.readOnly){activeEditor.beginEditing(initialValue,event)}else if(activeEditor&&activeEditor.cellProperties.readOnly){if(event&&event.keyCode===helper.keyCode.ENTER){moveSelectionAfterEnter()}}};this.closeEditor=function(restoreOriginalValue,ctrlDown,callback){if(!activeEditor){if(callback){callback(false)}}else{activeEditor.finishEditing(restoreOriginalValue,ctrlDown,callback)}};this.closeEditorAndSaveChanges=function(ctrlDown){return this.closeEditor(false,ctrlDown)};this.closeEditorAndRestoreOriginalValue=function(ctrlDown){return this.closeEditor(true,ctrlDown)};init()}},{"./3rdparty/walkontable/src/cell/coords.js":5,"./dom.js":27,"./editors.js":29,"./eventManager.js":41,"./helpers.js":42}],29:[function(require,module,exports){"use strict";Object.defineProperties(exports,{registerEditor:{get:function(){return registerEditor}},getEditor:{get:function(){return getEditor}},hasEditor:{get:function(){return hasEditor}},getEditorConstructor:{get:function(){return getEditorConstructor}},__esModule:{value:true}});var $__helpers_46_js__;var helper=($__helpers_46_js__=require("./helpers.js"),$__helpers_46_js__&&$__helpers_46_js__.__esModule&&$__helpers_46_js__||{"default":$__helpers_46_js__});var registeredEditorNames={},registeredEditorClasses=new WeakMap;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.registerEditor=registerEditor;Handsontable.editors.getEditor=getEditor;function RegisteredEditor(editorClass){var Clazz,instances;instances={};Clazz=editorClass;this.getConstructor=function(){return editorClass};this.getInstance=function(hotInstance){if(!(hotInstance.guid in instances)){instances[hotInstance.guid]=new Clazz(hotInstance)}return instances[hotInstance.guid]}}function registerEditor(editorName,editorClass){var editor=new RegisteredEditor(editorClass);if(typeof editorName==="string"){registeredEditorNames[editorName]=editor}registeredEditorClasses.set(editorClass,editor)}function getEditor(editorName,hotInstance){var editor;if(typeof editorName=="function"){if(!registeredEditorClasses.get(editorName)){registerEditor(null,editorName)}editor=registeredEditorClasses.get(editorName)}else if(typeof editorName=="string"){editor=registeredEditorNames[editorName]}else{throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!editor){throw Error('No editor registered under name "'+editorName+'"')}return editor.getInstance(hotInstance)}function getEditorConstructor(editorName){var editor;if(typeof editorName=="string"){editor=registeredEditorNames[editorName]}else{throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!editor){throw Error('No editor registered under name "'+editorName+'"')}return editor.getConstructor()}function hasEditor(editorName){return registeredEditorNames[editorName]?true:false}},{"./helpers.js":42}],30:[function(require,module,exports){"use strict";Object.defineProperties(exports,{BaseEditor:{get:function(){return BaseEditor}},__esModule:{value:true}});var $___46__46__47_helpers_46_js__,$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__;var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var WalkontableCellCoords=($___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./../3rdparty/walkontable/src/cell/coords.js"),$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.BaseEditor=BaseEditor;Handsontable.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};function BaseEditor(instance){this.instance=instance;this.state=Handsontable.EditorState.VIRGIN;this._opened=false;this._closeCallback=null;this.init()}BaseEditor.prototype._fireCallbacks=function(result){if(this._closeCallback){this._closeCallback(result);this._closeCallback=null}};BaseEditor.prototype.init=function(){};BaseEditor.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")};BaseEditor.prototype.setValue=function(newValue){throw Error("Editor setValue() method unimplemented")};BaseEditor.prototype.open=function(){throw Error("Editor open() method unimplemented")};BaseEditor.prototype.close=function(){throw Error("Editor close() method unimplemented")};BaseEditor.prototype.prepare=function(row,col,prop,td,originalValue,cellProperties){this.TD=td;this.row=row;this.col=col;this.prop=prop;this.originalValue=originalValue;this.cellProperties=cellProperties;this.state=Handsontable.EditorState.VIRGIN};BaseEditor.prototype.extend=function(){var baseClass=this.constructor;function Editor(){baseClass.apply(this,arguments)}function inherit(Child,Parent){function Bridge(){}Bridge.prototype=Parent.prototype;Child.prototype=new Bridge;Child.prototype.constructor=Child;return Child}return inherit(Editor,baseClass)};BaseEditor.prototype.saveValue=function(val,ctrlDown){var sel,tmp;if(ctrlDown){sel=this.instance.getSelected();if(sel[0]>sel[2]){tmp=sel[0];sel[0]=sel[2];sel[2]=tmp}if(sel[1]>sel[3]){tmp=sel[1];sel[1]=sel[3];sel[3]=tmp}this.instance.populateFromArray(sel[0],sel[1],val,sel[2],sel[3],"edit")}else{this.instance.populateFromArray(this.row,this.col,val,null,null,"edit")}};BaseEditor.prototype.beginEditing=function(initialValue,event){if(this.state!=Handsontable.EditorState.VIRGIN){return}this.instance.view.scrollViewport(new WalkontableCellCoords(this.row,this.col));this.instance.view.render();this.state=Handsontable.EditorState.EDITING;initialValue=typeof initialValue=="string"?initialValue:this.originalValue;this.setValue(helper.stringify(initialValue));this.open(event);this._opened=true;this.focus();this.instance.view.render()};BaseEditor.prototype.finishEditing=function(restoreOriginalValue,ctrlDown,callback){var _this=this,val;if(callback){var previousCloseCallback=this._closeCallback;this._closeCallback=function(result){if(previousCloseCallback){previousCloseCallback(result)}callback(result)}}if(this.isWaiting()){return}if(this.state==Handsontable.EditorState.VIRGIN){this.instance._registerTimeout(setTimeout(function(){_this._fireCallbacks(true)},0));return}if(this.state==Handsontable.EditorState.EDITING){if(restoreOriginalValue){this.cancelChanges();this.instance.view.render();return}if(this.instance.getSettings().trimWhitespace){val=[[typeof this.getValue()==="string"?String.prototype.trim.call(this.getValue()||""):this.getValue()]]}else{val=[[this.getValue()]]}this.state=Handsontable.EditorState.WAITING;this.saveValue(val,ctrlDown);if(this.instance.getCellValidator(this.cellProperties)){this.instance.addHookOnce("postAfterValidate",function(result){_this.state=Handsontable.EditorState.FINISHED;_this.discardEditor(result)})}else{this.state=Handsontable.EditorState.FINISHED;this.discardEditor(true)}}};BaseEditor.prototype.cancelChanges=function(){this.state=Handsontable.EditorState.FINISHED;this.discardEditor()};BaseEditor.prototype.discardEditor=function(result){if(this.state!==Handsontable.EditorState.FINISHED){return}if(result===false&&this.cellProperties.allowInvalid!==true){this.instance.selectCell(this.row,this.col);this.focus();this.state=Handsontable.EditorState.EDITING;this._fireCallbacks(false)}else{this.close();this._opened=false;this.state=Handsontable.EditorState.VIRGIN;this._fireCallbacks(true)}};BaseEditor.prototype.isOpened=function(){return this._opened};BaseEditor.prototype.isWaiting=function(){return this.state===Handsontable.EditorState.WAITING}},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../helpers.js":42}],31:[function(require,module,exports){"use strict";Object.defineProperties(exports,{AutocompleteEditor:{get:function(){return AutocompleteEditor}},__esModule:{value:true}});var $___46__46__47_helpers_46_js__,$___46__46__47_dom_46_js__,$___46__46__47_editors_46_js__,$__handsontableEditor_46_js__;var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var $__0=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditorConstructor=$__0.getEditorConstructor,registerEditor=$__0.registerEditor;var HandsontableEditor=($__handsontableEditor_46_js__=require("./handsontableEditor.js"),$__handsontableEditor_46_js__&&$__handsontableEditor_46_js__.__esModule&&$__handsontableEditor_46_js__||{"default":$__handsontableEditor_46_js__}).HandsontableEditor;var AutocompleteEditor=HandsontableEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.AutocompleteEditor=AutocompleteEditor;AutocompleteEditor.prototype.init=function(){HandsontableEditor.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};AutocompleteEditor.prototype.createElements=function(){HandsontableEditor.prototype.createElements.apply(this,arguments);dom.addClass(this.htContainer,"autocompleteEditor");dom.addClass(this.htContainer,window.navigator.platform.indexOf("Mac")!==-1?"htMacScroll":"")};var skipOne=false;function onBeforeKeyDown(event){skipOne=false;var editor=this.getActiveEditor();var keyCodes=helper.keyCode;if(helper.isPrintableChar(event.keyCode)||event.keyCode===keyCodes.BACKSPACE||event.keyCode===keyCodes.DELETE||event.keyCode===keyCodes.INSERT){var timeOffset=0;if(event.keyCode===keyCodes.C&&(event.ctrlKey||event.metaKey)){return}if(!editor.isOpened()){timeOffset+=10}editor.instance._registerTimeout(setTimeout(function(){editor.queryChoices(editor.TEXTAREA.value);skipOne=true},timeOffset))}}AutocompleteEditor.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",onBeforeKeyDown);HandsontableEditor.prototype.prepare.apply(this,arguments)};AutocompleteEditor.prototype.open=function(){HandsontableEditor.prototype.open.apply(this,arguments);var choicesListHot=this.htEditor.getInstance();var that=this;this.TEXTAREA.style.visibility="visible";this.focus();choicesListHot.updateSettings({colWidths:[dom.outerWidth(this.TEXTAREA)-2],width:dom.outerWidth(this.TEXTAREA)+dom.getScrollbarWidth()+2,afterRenderer:function(TD,row,col,prop,value){var caseSensitive=this.getCellMeta(row,col).filteringCaseSensitive===true,indexOfMatch,match,value=Handsontable.helper.stringify(value);if(value){indexOfMatch=caseSensitive?value.indexOf(this.query):value.toLowerCase().indexOf(that.query.toLowerCase());if(indexOfMatch!=-1){match=value.substr(indexOfMatch,that.query.length);TD.innerHTML=value.replace(match,"<strong>"+match+"</strong>")}}}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=dom.getScrollbarWidth()+2+"px";if(skipOne){skipOne=false}that.instance._registerTimeout(setTimeout(function(){that.queryChoices(that.TEXTAREA.value)},0))};AutocompleteEditor.prototype.close=function(){HandsontableEditor.prototype.close.apply(this,arguments)};AutocompleteEditor.prototype.queryChoices=function(query){this.query=query;if(typeof this.cellProperties.source=="function"){var that=this;this.cellProperties.source(query,function(choices){that.updateChoicesList(choices)})}else if(Array.isArray(this.cellProperties.source)){var choices;if(!query||this.cellProperties.filter===false){choices=this.cellProperties.source}else{var filteringCaseSensitive=this.cellProperties.filteringCaseSensitive===true;var lowerCaseQuery=query.toLowerCase();choices=this.cellProperties.source.filter(function(choice){if(filteringCaseSensitive){return choice.indexOf(query)!=-1}else{return choice.toLowerCase().indexOf(lowerCaseQuery)!=-1}})}this.updateChoicesList(choices)}else{this.updateChoicesList([])}};AutocompleteEditor.prototype.updateChoicesList=function(choices){var pos=dom.getCaretPosition(this.TEXTAREA),endPos=dom.getSelectionEndPosition(this.TEXTAREA);var orderByRelevance=AutocompleteEditor.sortByRelevance(this.getValue(),choices,this.cellProperties.filteringCaseSensitive);var highlightIndex;if(this.cellProperties.filter!=false){var sorted=[];for(var i=0,choicesCount=orderByRelevance.length;i<choicesCount;i++){sorted.push(choices[orderByRelevance[i]])}highlightIndex=0;choices=sorted}else{highlightIndex=orderByRelevance[0]}this.choices=choices;this.htEditor.loadData(helper.pivot([choices]));this.updateDropdownHeight();if(this.cellProperties.strict===true){this.highlightBestMatchingChoice(highlightIndex)}this.instance.listen();this.TEXTAREA.focus();dom.setCaretPosition(this.TEXTAREA,pos,pos!=endPos?endPos:void 0)};AutocompleteEditor.prototype.updateDropdownHeight=function(){this.htEditor.updateSettings({height:this.getDropdownHeight()});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};AutocompleteEditor.prototype.finishEditing=function(restoreOriginalValue){if(!restoreOriginalValue){this.instance.removeHook("beforeKeyDown",onBeforeKeyDown)}HandsontableEditor.prototype.finishEditing.apply(this,arguments)};AutocompleteEditor.prototype.highlightBestMatchingChoice=function(index){if(typeof index==="number"){this.htEditor.selectCell(index,0)}else{this.htEditor.deselectCell()}};AutocompleteEditor.sortByRelevance=function(value,choices,caseSensitive){var choicesRelevance=[],currentItem,valueLength=value.length,valueIndex,charsLeft,result=[],i,choicesCount;if(valueLength===0){for(i=0,choicesCount=choices.length;i<choicesCount;i++){result.push(i)}return result}for(i=0,choicesCount=choices.length;i<choicesCount;i++){currentItem=Handsontable.helper.stringify(choices[i]);if(caseSensitive){valueIndex=currentItem.indexOf(value)}else{valueIndex=currentItem.toLowerCase().indexOf(value.toLowerCase())}if(valueIndex==-1){continue}charsLeft=currentItem.length-valueIndex-valueLength;choicesRelevance.push({baseIndex:i,index:valueIndex,charsLeft:charsLeft,value:currentItem})}choicesRelevance.sort(function(a,b){if(b.index===-1){return-1}if(a.index===-1){return 1}if(a.index<b.index){return-1}else if(b.index<a.index){return 1}else if(a.index===b.index){if(a.charsLeft<b.charsLeft){return-1}else if(a.charsLeft>b.charsLeft){return 1}else{return 0}}});for(i=0,choicesCount=choicesRelevance.length;i<choicesCount;i++){result.push(choicesRelevance[i].baseIndex)}return result};AutocompleteEditor.prototype.getDropdownHeight=function(){var firstRowHeight=this.htEditor.getInstance().getRowHeight(0)||23;return this.choices.length>=10?10*firstRowHeight:this.choices.length*firstRowHeight+8};registerEditor("autocomplete",AutocompleteEditor)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./handsontableEditor.js":35}],32:[function(require,module,exports){"use strict";Object.defineProperties(exports,{CheckboxEditor:{get:function(){return CheckboxEditor}},__esModule:{value:true}});var $___46__46__47_editors_46_js__,$___95_baseEditor_46_js__;var registerEditor=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}).registerEditor;var BaseEditor=($___95_baseEditor_46_js__=require("./_baseEditor.js"),
$___95_baseEditor_46_js__&&$___95_baseEditor_46_js__.__esModule&&$___95_baseEditor_46_js__||{"default":$___95_baseEditor_46_js__}).BaseEditor;var CheckboxEditor=BaseEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.CheckboxEditor=CheckboxEditor;CheckboxEditor.prototype.beginEditing=function(){var checkbox=this.TD.querySelector('input[type="checkbox"]');if(checkbox){checkbox.click()}};CheckboxEditor.prototype.finishEditing=function(){};CheckboxEditor.prototype.init=function(){};CheckboxEditor.prototype.open=function(){};CheckboxEditor.prototype.close=function(){};CheckboxEditor.prototype.getValue=function(){};CheckboxEditor.prototype.setValue=function(){};CheckboxEditor.prototype.focus=function(){};registerEditor("checkbox",CheckboxEditor)},{"./../editors.js":29,"./_baseEditor.js":30}],33:[function(require,module,exports){"use strict";Object.defineProperties(exports,{DateEditor:{get:function(){return DateEditor}},__esModule:{value:true}});var $___46__46__47_helpers_46_js__,$___46__46__47_dom_46_js__,$___46__46__47_editors_46_js__,$__textEditor_46_js__,$___46__46__47_eventManager_46_js__,$__moment__,$__pikaday__;var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var $__0=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditor=$__0.getEditor,registerEditor=$__0.registerEditor;var TextEditor=($__textEditor_46_js__=require("./textEditor.js"),$__textEditor_46_js__&&$__textEditor_46_js__.__esModule&&$__textEditor_46_js__||{"default":$__textEditor_46_js__}).TextEditor;var eventManagerObject=($___46__46__47_eventManager_46_js__=require("./../eventManager.js"),$___46__46__47_eventManager_46_js__&&$___46__46__47_eventManager_46_js__.__esModule&&$___46__46__47_eventManager_46_js__||{"default":$___46__46__47_eventManager_46_js__}).eventManager;var moment=($__moment__=require("moment"),$__moment__&&$__moment__.__esModule&&$__moment__||{"default":$__moment__}).default;var Pikaday=($__pikaday__=require("pikaday"),$__pikaday__&&$__pikaday__.__esModule&&$__pikaday__||{"default":$__pikaday__}).default;var DateEditor=TextEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.DateEditor=DateEditor;DateEditor.prototype.init=function(){if(typeof moment!=="function"){throw new Error("You need to include moment.js to your project.")}if(typeof Pikaday!=="function"){throw new Error("You need to include Pikaday to your project.")}TextEditor.prototype.init.apply(this,arguments);this.isCellEdited=false;var that=this;this.instance.addHook("afterDestroy",function(){that.parentDestroyed=true;that.destroyElements()})};DateEditor.prototype.createElements=function(){var that=this;TextEditor.prototype.createElements.apply(this,arguments);this.defaultDateFormat="DD/MM/YYYY";this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;dom.addClass(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);var htInput=this.TEXTAREA;var defaultOptions={format:that.defaultDateFormat,field:htInput,trigger:htInput,container:that.datePicker,reposition:false,bound:false,onSelect:function(dateStr){if(!isNaN(dateStr.getTime())){dateStr=moment(dateStr).format(that.cellProperties.dateFormat||that.defaultDateFormat)}that.setValue(dateStr);that.hideDatepicker()},onClose:function(){if(!that.parentDestroyed){that.finishEditing(false)}}};this.$datePicker=new Pikaday(defaultOptions);var eventManager=eventManagerObject(this);eventManager.addEventListener(this.datePicker,"mousedown",function(event){helper.stopPropagation(event)});this.hideDatepicker()};DateEditor.prototype.destroyElements=function(){this.$datePicker.destroy()};DateEditor.prototype.prepare=function(){this._opened=false;TextEditor.prototype.prepare.apply(this,arguments)};DateEditor.prototype.open=function(event){TextEditor.prototype.open.call(this);this.showDatepicker(event)};DateEditor.prototype.close=function(){var that=this;this._opened=false;this.instance._registerTimeout(setTimeout(function(){that.instance.selection.refreshBorders()},0));TextEditor.prototype.close.apply(this,arguments)};DateEditor.prototype.finishEditing=function(isCancelled,ctrlDown){if(isCancelled){var value=this.originalValue;if(value!==void 0){this.setValue(value)}}this.hideDatepicker();TextEditor.prototype.finishEditing.apply(this,arguments)};DateEditor.prototype.showDatepicker=function(event){var offset=this.TD.getBoundingClientRect(),dateFormat=this.cellProperties.dateFormat||this.defaultDateFormat,datePickerConfig=this.$datePicker.config(),dateStr,isMouseDown=this.instance.view.isMouseDown(),isMeta=event?helper.isMetaKey(event.keyCode):false;this.datePickerStyle.top=window.pageYOffset+offset.top+dom.outerHeight(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+offset.left+"px";this.$datePicker._onInputFocus=function(){};datePickerConfig.format=dateFormat;if(this.originalValue){dateStr=this.originalValue;if(moment(dateStr,dateFormat,true).isValid()){this.$datePicker.setMoment(moment(dateStr,dateFormat),true)}if(!isMeta){if(!isMouseDown){this.setValue("")}}}else{if(this.cellProperties.defaultDate){dateStr=this.cellProperties.defaultDate;datePickerConfig.defaultDate=dateStr;if(moment(dateStr,dateFormat,true).isValid()){this.$datePicker.setMoment(moment(dateStr,dateFormat),true)}if(!isMeta){if(!isMouseDown){this.setValue("")}}}else{this.$datePicker.gotoToday()}}this.datePickerStyle.display="block";this.$datePicker.show()};DateEditor.prototype.hideDatepicker=function(){this.datePickerStyle.display="none";this.$datePicker.hide()};registerEditor("date",DateEditor)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./textEditor.js":40,moment:"moment",pikaday:"pikaday"}],34:[function(require,module,exports){"use strict";Object.defineProperties(exports,{DropdownEditor:{get:function(){return DropdownEditor}},__esModule:{value:true}});var $___46__46__47_editors_46_js__,$__autocompleteEditor_46_js__;var $__0=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditor=$__0.getEditor,registerEditor=$__0.registerEditor;var AutocompleteEditor=($__autocompleteEditor_46_js__=require("./autocompleteEditor.js"),$__autocompleteEditor_46_js__&&$__autocompleteEditor_46_js__.__esModule&&$__autocompleteEditor_46_js__||{"default":$__autocompleteEditor_46_js__}).AutocompleteEditor;var DropdownEditor=AutocompleteEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.DropdownEditor=DropdownEditor;DropdownEditor.prototype.prepare=function(){AutocompleteEditor.prototype.prepare.apply(this,arguments);this.cellProperties.filter=false;this.cellProperties.strict=true};registerEditor("dropdown",DropdownEditor)},{"./../editors.js":29,"./autocompleteEditor.js":31}],35:[function(require,module,exports){"use strict";Object.defineProperties(exports,{HandsontableEditor:{get:function(){return HandsontableEditor}},__esModule:{value:true}});var $___46__46__47_helpers_46_js__,$___46__46__47_dom_46_js__,$___46__46__47_editors_46_js__,$__textEditor_46_js__;var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var $__0=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditor=$__0.getEditor,registerEditor=$__0.registerEditor;var TextEditor=($__textEditor_46_js__=require("./textEditor.js"),$__textEditor_46_js__&&$__textEditor_46_js__.__esModule&&$__textEditor_46_js__||{"default":$__textEditor_46_js__}).TextEditor;var HandsontableEditor=TextEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.HandsontableEditor=HandsontableEditor;HandsontableEditor.prototype.createElements=function(){TextEditor.prototype.createElements.apply(this,arguments);var DIV=document.createElement("DIV");DIV.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(DIV);this.htContainer=DIV;this.htEditor=new Handsontable(DIV);this.assignHooks()};HandsontableEditor.prototype.prepare=function(td,row,col,prop,value,cellProperties){TextEditor.prototype.prepare.apply(this,arguments);var parent=this;var options={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:false,cells:function(){return{readOnly:true}},fillHandle:false,afterOnCellMouseDown:function(){var value=this.getValue();if(value!==void 0){parent.setValue(value)}parent.instance.destroyEditor()}};if(this.cellProperties.handsontable){helper.extend(options,cellProperties.handsontable)}if(this.htEditor){this.htEditor.destroy()}this.htEditor=new Handsontable(this.htContainer,options)};var onBeforeKeyDown=function(event){if(event!=null&&event.isImmediatePropagationEnabled==null){event.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=false;this.cancelBubble=true};event.isImmediatePropagationEnabled=true;event.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}}if(event.isImmediatePropagationStopped()){return}var editor=this.getActiveEditor();var innerHOT=editor.htEditor.getInstance();var rowToSelect;if(event.keyCode==helper.keyCode.ARROW_DOWN){if(!innerHOT.getSelected()){rowToSelect=0}else{var selectedRow=innerHOT.getSelected()[0];var lastRow=innerHOT.countRows()-1;rowToSelect=Math.min(lastRow,selectedRow+1)}}else if(event.keyCode==helper.keyCode.ARROW_UP){if(innerHOT.getSelected()){var selectedRow=innerHOT.getSelected()[0];rowToSelect=selectedRow-1}}if(rowToSelect!==void 0){if(rowToSelect<0){innerHOT.deselectCell()}else{innerHOT.selectCell(rowToSelect,0)}event.preventDefault();event.stopImmediatePropagation();editor.instance.listen();editor.TEXTAREA.focus()}};HandsontableEditor.prototype.open=function(){this.instance.addHook("beforeKeyDown",onBeforeKeyDown);TextEditor.prototype.open.apply(this,arguments);this.htEditor.render();if(this.cellProperties.strict){this.htEditor.selectCell(0,0);this.TEXTAREA.style.visibility="hidden"}else{this.htEditor.deselectCell();this.TEXTAREA.style.visibility="visible"}dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)};HandsontableEditor.prototype.close=function(){this.instance.removeHook("beforeKeyDown",onBeforeKeyDown);this.instance.listen();TextEditor.prototype.close.apply(this,arguments)};HandsontableEditor.prototype.focus=function(){this.instance.listen();TextEditor.prototype.focus.apply(this,arguments)};HandsontableEditor.prototype.beginEditing=function(initialValue){var onBeginEditing=this.instance.getSettings().onBeginEditing;if(onBeginEditing&&onBeginEditing()===false){return}TextEditor.prototype.beginEditing.apply(this,arguments)};HandsontableEditor.prototype.finishEditing=function(isCancelled,ctrlDown){if(this.htEditor.isListening()){this.instance.listen()}if(this.htEditor.getSelected()){var value=this.htEditor.getInstance().getValue();if(value!==void 0){this.setValue(value)}}return TextEditor.prototype.finishEditing.apply(this,arguments)};HandsontableEditor.prototype.assignHooks=function(){var _this=this;this.instance.addHook("afterDestroy",function(){if(_this.htEditor){_this.htEditor.destroy()}})};registerEditor("handsontable",HandsontableEditor)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./textEditor.js":40}],36:[function(require,module,exports){"use strict";Object.defineProperties(exports,{MobileTextEditor:{get:function(){return MobileTextEditor}},__esModule:{value:true}});var $___46__46__47_helpers_46_js__,$___46__46__47_dom_46_js__,$___46__46__47_editors_46_js__,$___95_baseEditor_46_js__,$___46__46__47_eventManager_46_js__;var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var $__0=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditor=$__0.getEditor,registerEditor=$__0.registerEditor;var BaseEditor=($___95_baseEditor_46_js__=require("./_baseEditor.js"),$___95_baseEditor_46_js__&&$___95_baseEditor_46_js__.__esModule&&$___95_baseEditor_46_js__||{"default":$___95_baseEditor_46_js__}).BaseEditor;var eventManagerObject=($___46__46__47_eventManager_46_js__=require("./../eventManager.js"),$___46__46__47_eventManager_46_js__&&$___46__46__47_eventManager_46_js__.__esModule&&$___46__46__47_eventManager_46_js__||{"default":$___46__46__47_eventManager_46_js__}).eventManager;var MobileTextEditor=BaseEditor.prototype.extend(),domDimensionsCache={};Handsontable.editors=Handsontable.editors||{};Handsontable.editors.MobileTextEditor=MobileTextEditor;var createControls=function(){this.controls={};this.controls.leftButton=document.createElement("DIV");this.controls.leftButton.className="leftButton";this.controls.rightButton=document.createElement("DIV");this.controls.rightButton.className="rightButton";this.controls.upButton=document.createElement("DIV");this.controls.upButton.className="upButton";this.controls.downButton=document.createElement("DIV");this.controls.downButton.className="downButton";for(var button in this.controls){if(this.controls.hasOwnProperty(button)){this.positionControls.appendChild(this.controls[button])}}};MobileTextEditor.prototype.valueChanged=function(){return this.initValue!=this.getValue()};MobileTextEditor.prototype.init=function(){var that=this;this.eventManager=eventManagerObject(this.instance);this.createElements();this.bindEvents();this.instance.addHook("afterDestroy",function(){that.destroy()})};MobileTextEditor.prototype.getValue=function(){return this.TEXTAREA.value};MobileTextEditor.prototype.setValue=function(newValue){this.initValue=newValue;this.TEXTAREA.value=newValue};MobileTextEditor.prototype.createElements=function(){this.editorContainer=document.createElement("DIV");this.editorContainer.className="htMobileEditorContainer";this.cellPointer=document.createElement("DIV");this.cellPointer.className="cellPointer";this.moveHandle=document.createElement("DIV");this.moveHandle.className="moveHandle";this.inputPane=document.createElement("DIV");this.inputPane.className="inputs";this.positionControls=document.createElement("DIV");this.positionControls.className="positionControls";this.TEXTAREA=document.createElement("TEXTAREA");dom.addClass(this.TEXTAREA,"handsontableInput");this.inputPane.appendChild(this.TEXTAREA);this.editorContainer.appendChild(this.cellPointer);this.editorContainer.appendChild(this.moveHandle);this.editorContainer.appendChild(this.inputPane);this.editorContainer.appendChild(this.positionControls);createControls.call(this);document.body.appendChild(this.editorContainer)};MobileTextEditor.prototype.onBeforeKeyDown=function(event){var instance=this;var that=instance.getActiveEditor();dom.enableImmediatePropagation(event);if(event.target!==that.TEXTAREA||event.isImmediatePropagationStopped()){return}var keyCodes=helper.keyCode;switch(event.keyCode){case keyCodes.ENTER:that.close();event.preventDefault();break;case keyCodes.BACKSPACE:event.stopImmediatePropagation();break}};MobileTextEditor.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown);dom.addClass(this.editorContainer,"active");dom.removeClass(this.cellPointer,"hidden");this.updateEditorPosition()};MobileTextEditor.prototype.focus=function(){this.TEXTAREA.focus();dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};MobileTextEditor.prototype.close=function(){this.TEXTAREA.blur();this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown);dom.removeClass(this.editorContainer,"active")};MobileTextEditor.prototype.scrollToView=function(){var coords=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(coords)};MobileTextEditor.prototype.hideCellPointer=function(){if(!dom.hasClass(this.cellPointer,"hidden")){dom.addClass(this.cellPointer,"hidden")}};MobileTextEditor.prototype.updateEditorPosition=function(x,y){if(x&&y){x=parseInt(x,10);y=parseInt(y,10);this.editorContainer.style.top=y+"px";this.editorContainer.style.left=x+"px"}else{var selection=this.instance.getSelected(),selectedCell=this.instance.getCell(selection[0],selection[1]);if(!domDimensionsCache.cellPointer){domDimensionsCache.cellPointer={height:dom.outerHeight(this.cellPointer),width:dom.outerWidth(this.cellPointer)}}if(!domDimensionsCache.editorContainer){domDimensionsCache.editorContainer={width:dom.outerWidth(this.editorContainer)}}if(selectedCell!==undefined){var scrollLeft=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:dom.getScrollLeft(this.instance.view.wt.wtOverlays.leftOverlay.holder);var scrollTop=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:dom.getScrollTop(this.instance.view.wt.wtOverlays.topOverlay.holder);var selectedCellOffset=dom.offset(selectedCell),selectedCellWidth=dom.outerWidth(selectedCell),currentScrollPosition={x:scrollLeft,y:scrollTop};this.editorContainer.style.top=parseInt(selectedCellOffset.top+dom.outerHeight(selectedCell)-currentScrollPosition.y+domDimensionsCache.cellPointer.height,10)+"px";this.editorContainer.style.left=parseInt(window.innerWidth/2-domDimensionsCache.editorContainer.width/2,10)+"px";if(selectedCellOffset.left+selectedCellWidth/2>parseInt(this.editorContainer.style.left,10)+domDimensionsCache.editorContainer.width){this.editorContainer.style.left=window.innerWidth-domDimensionsCache.editorContainer.width+"px"}else if(selectedCellOffset.left+selectedCellWidth/2<parseInt(this.editorContainer.style.left,10)+20){this.editorContainer.style.left=0+"px"}this.cellPointer.style.left=parseInt(selectedCellOffset.left-domDimensionsCache.cellPointer.width/2-dom.offset(this.editorContainer).left+selectedCellWidth/2-currentScrollPosition.x,10)+"px"}}};MobileTextEditor.prototype.updateEditorData=function(){var selected=this.instance.getSelected(),selectedValue=this.instance.getDataAtCell(selected[0],selected[1]);this.row=selected[0];this.col=selected[1];this.setValue(selectedValue);this.updateEditorPosition()};MobileTextEditor.prototype.prepareAndSave=function(){var val;if(!this.valueChanged()){return true}if(this.instance.getSettings().trimWhitespace){val=[[String.prototype.trim.call(this.getValue())]]}else{val=[[this.getValue()]]}this.saveValue(val)};MobileTextEditor.prototype.bindEvents=function(){var that=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(event){that.prepareAndSave();that.instance.selection.transformStart(0,-1,null,true);that.updateEditorData();event.preventDefault()});this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(event){that.prepareAndSave();that.instance.selection.transformStart(0,1,null,true);that.updateEditorData();event.preventDefault()});this.eventManager.addEventListener(this.controls.upButton,"touchend",function(event){that.prepareAndSave();that.instance.selection.transformStart(-1,0,null,true);that.updateEditorData();event.preventDefault()});this.eventManager.addEventListener(this.controls.downButton,"touchend",function(event){that.prepareAndSave();that.instance.selection.transformStart(1,0,null,true);that.updateEditorData();event.preventDefault()});this.eventManager.addEventListener(this.moveHandle,"touchstart",function(event){if(event.touches.length==1){var touch=event.touches[0],onTouchPosition={x:that.editorContainer.offsetLeft,y:that.editorContainer.offsetTop},onTouchOffset={x:touch.pageX-onTouchPosition.x,y:touch.pageY-onTouchPosition.y};that.eventManager.addEventListener(this,"touchmove",function(event){var touch=event.touches[0];that.updateEditorPosition(touch.pageX-onTouchOffset.x,touch.pageY-onTouchOffset.y);that.hideCellPointer();event.preventDefault()})}});this.eventManager.addEventListener(document.body,"touchend",function(event){if(!dom.isChildOf(event.target,that.editorContainer)&&!dom.isChildOf(event.target,that.instance.rootElement)){that.close()}});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(event){if(that.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window){that.hideCellPointer()}});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(event){if(that.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window){that.hideCellPointer()}})};MobileTextEditor.prototype.destroy=function(){this.eventManager.clear();this.editorContainer.parentNode.removeChild(this.editorContainer)};registerEditor("mobile",MobileTextEditor)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30}],37:[function(require,module,exports){"use strict";Object.defineProperties(exports,{NumericEditor:{get:function(){return NumericEditor}},__esModule:{value:true}});var $__numeral__,$___46__46__47_editors_46_js__,$__textEditor_46_js__;var numeral=($__numeral__=require("numeral"),$__numeral__&&$__numeral__.__esModule&&$__numeral__||{"default":$__numeral__}).default;var $__1=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditor=$__1.getEditor,registerEditor=$__1.registerEditor;var TextEditor=($__textEditor_46_js__=require("./textEditor.js"),$__textEditor_46_js__&&$__textEditor_46_js__.__esModule&&$__textEditor_46_js__||{"default":$__textEditor_46_js__}).TextEditor;var NumericEditor=TextEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.NumericEditor=NumericEditor;NumericEditor.prototype.beginEditing=function(initialValue){var BaseEditor=TextEditor.prototype;if(typeof initialValue==="undefined"&&this.originalValue){var value=""+this.originalValue;if(typeof this.cellProperties.language!=="undefined"){numeral.language(this.cellProperties.language)}var decimalDelimiter=numeral.languageData().delimiters.decimal;value=value.replace(".",decimalDelimiter);BaseEditor.beginEditing.apply(this,[value])}else{BaseEditor.beginEditing.apply(this,arguments)}};registerEditor("numeric",NumericEditor)},{"./../editors.js":29,"./textEditor.js":40,numeral:"numeral"}],38:[function(require,module,exports){"use strict";Object.defineProperties(exports,{PasswordEditor:{get:function(){return PasswordEditor}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_editors_46_js__,$__textEditor_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var $__0=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditor=$__0.getEditor,registerEditor=$__0.registerEditor;var TextEditor=($__textEditor_46_js__=require("./textEditor.js"),$__textEditor_46_js__&&$__textEditor_46_js__.__esModule&&$__textEditor_46_js__||{"default":$__textEditor_46_js__}).TextEditor;var PasswordEditor=TextEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.PasswordEditor=PasswordEditor;PasswordEditor.prototype.createElements=function(){TextEditor.prototype.createElements.apply(this,arguments);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;dom.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)};registerEditor("password",PasswordEditor)},{"./../dom.js":27,"./../editors.js":29,"./textEditor.js":40}],39:[function(require,module,exports){"use strict";Object.defineProperties(exports,{SelectEditor:{get:function(){return SelectEditor}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_helpers_46_js__,$___46__46__47_editors_46_js__,$___95_baseEditor_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var $__0=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__}),getEditor=$__0.getEditor,registerEditor=$__0.registerEditor;var BaseEditor=($___95_baseEditor_46_js__=require("./_baseEditor.js"),$___95_baseEditor_46_js__&&$___95_baseEditor_46_js__.__esModule&&$___95_baseEditor_46_js__||{"default":$___95_baseEditor_46_js__}).BaseEditor;var SelectEditor=BaseEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.SelectEditor=SelectEditor;SelectEditor.prototype.init=function(){this.select=document.createElement("SELECT");dom.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select)};SelectEditor.prototype.prepare=function(){BaseEditor.prototype.prepare.apply(this,arguments);var selectOptions=this.cellProperties.selectOptions;var options;if(typeof selectOptions=="function"){options=this.prepareOptions(selectOptions(this.row,this.col,this.prop))}else{options=this.prepareOptions(selectOptions)}dom.empty(this.select);for(var option in options){if(options.hasOwnProperty(option)){var optionElement=document.createElement("OPTION");optionElement.value=option;dom.fastInnerHTML(optionElement,options[option]);this.select.appendChild(optionElement)}}};SelectEditor.prototype.prepareOptions=function(optionsToPrepare){var preparedOptions={};if(Array.isArray(optionsToPrepare)){for(var i=0,len=optionsToPrepare.length;i<len;i++){preparedOptions[optionsToPrepare[i]]=optionsToPrepare[i]}}else if(typeof optionsToPrepare=="object"){preparedOptions=optionsToPrepare}return preparedOptions};SelectEditor.prototype.getValue=function(){return this.select.value};SelectEditor.prototype.setValue=function(value){this.select.value=value};var onBeforeKeyDown=function(event){var instance=this;var editor=instance.getActiveEditor();if(event!=null&&event.isImmediatePropagationEnabled==null){event.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=false};event.isImmediatePropagationEnabled=true;event.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}}switch(event.keyCode){case helper.keyCode.ARROW_UP:var previousOptionIndex=editor.select.selectedIndex-1;if(previousOptionIndex>=0){editor.select[previousOptionIndex].selected=true}event.stopImmediatePropagation();event.preventDefault();break;case helper.keyCode.ARROW_DOWN:var nextOptionIndex=editor.select.selectedIndex+1;if(nextOptionIndex<=editor.select.length-1){editor.select[nextOptionIndex].selected=true}event.stopImmediatePropagation();event.preventDefault();break}};SelectEditor.prototype.checkEditorSection=function(){if(this.row<this.instance.getSettings().fixedRowsTop){if(this.col<this.instance.getSettings().fixedColumnsLeft){return"corner"}else{return"top"}}else{if(this.col<this.instance.getSettings().fixedColumnsLeft){return"left"}}};SelectEditor.prototype.open=function(){var width=dom.outerWidth(this.TD);var height=dom.outerHeight(this.TD);var rootOffset=dom.offset(this.instance.rootElement);var tdOffset=dom.offset(this.TD);var editorSection=this.checkEditorSection();var cssTransformOffset;switch(editorSection){case"top":cssTransformOffset=dom.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":cssTransformOffset=dom.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":cssTransformOffset=dom.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break}var selectStyle=this.select.style;if(cssTransformOffset&&cssTransformOffset!=-1){selectStyle[cssTransformOffset[0]]=cssTransformOffset[1]}else{dom.resetCssTransform(this.select)}selectStyle.height=height+"px";selectStyle.minWidth=width+"px";selectStyle.top=tdOffset.top-rootOffset.top+"px";selectStyle.left=tdOffset.left-rootOffset.left+"px";selectStyle.margin="0px";selectStyle.display="";this.instance.addHook("beforeKeyDown",onBeforeKeyDown)};SelectEditor.prototype.close=function(){this.select.style.display="none";this.instance.removeHook("beforeKeyDown",onBeforeKeyDown)};SelectEditor.prototype.focus=function(){this.select.focus()};registerEditor("select",SelectEditor)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./_baseEditor.js":30}],40:[function(require,module,exports){"use strict";Object.defineProperties(exports,{TextEditor:{get:function(){return TextEditor}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_helpers_46_js__,$__autoResize__,$___95_baseEditor_46_js__,$___46__46__47_eventManager_46_js__,$___46__46__47_editors_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var autoResize=($__autoResize__=require("autoResize"),$__autoResize__&&$__autoResize__.__esModule&&$__autoResize__||{"default":$__autoResize__}).default;var BaseEditor=($___95_baseEditor_46_js__=require("./_baseEditor.js"),$___95_baseEditor_46_js__&&$___95_baseEditor_46_js__.__esModule&&$___95_baseEditor_46_js__||{"default":$___95_baseEditor_46_js__}).BaseEditor;var eventManagerObject=($___46__46__47_eventManager_46_js__=require("./../eventManager.js"),$___46__46__47_eventManager_46_js__&&$___46__46__47_eventManager_46_js__.__esModule&&$___46__46__47_eventManager_46_js__||{"default":$___46__46__47_eventManager_46_js__}).eventManager;var $__3=($___46__46__47_editors_46_js__=require("./../editors.js"),$___46__46__47_editors_46_js__&&$___46__46__47_editors_46_js__.__esModule&&$___46__46__47_editors_46_js__||{"default":$___46__46__47_editors_46_js__
}),getEditor=$__3.getEditor,registerEditor=$__3.registerEditor;var TextEditor=BaseEditor.prototype.extend();Handsontable.editors=Handsontable.editors||{};Handsontable.editors.TextEditor=TextEditor;TextEditor.prototype.init=function(){var that=this;this.createElements();this.eventManager=eventManagerObject(this);this.bindEvents();this.autoResize=autoResize();this.instance.addHook("afterDestroy",function(){that.destroy()})};TextEditor.prototype.getValue=function(){return this.TEXTAREA.value};TextEditor.prototype.setValue=function(newValue){this.TEXTAREA.value=newValue};var onBeforeKeyDown=function onBeforeKeyDown(event){var instance=this,that=instance.getActiveEditor(),keyCodes,ctrlDown;keyCodes=helper.keyCode;ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;dom.enableImmediatePropagation(event);if(event.target!==that.TEXTAREA||event.isImmediatePropagationStopped()){return}if(event.keyCode===17||event.keyCode===224||event.keyCode===91||event.keyCode===93){event.stopImmediatePropagation();return}switch(event.keyCode){case keyCodes.ARROW_RIGHT:if(dom.getCaretPosition(that.TEXTAREA)!==that.TEXTAREA.value.length){event.stopImmediatePropagation()}break;case keyCodes.ARROW_LEFT:if(dom.getCaretPosition(that.TEXTAREA)!==0){event.stopImmediatePropagation()}break;case keyCodes.ENTER:var selected=that.instance.getSelected();var isMultipleSelection=!(selected[0]===selected[2]&&selected[1]===selected[3]);if(ctrlDown&&!isMultipleSelection||event.altKey){if(that.isOpened()){var caretPosition=dom.getCaretPosition(that.TEXTAREA),value=that.getValue();var newValue=value.slice(0,caretPosition)+"\n"+value.slice(caretPosition);that.setValue(newValue);dom.setCaretPosition(that.TEXTAREA,caretPosition+1)}else{that.beginEditing(that.originalValue+"\n")}event.stopImmediatePropagation()}event.preventDefault();break;case keyCodes.A:case keyCodes.X:case keyCodes.C:case keyCodes.V:if(ctrlDown){event.stopImmediatePropagation()}break;case keyCodes.BACKSPACE:case keyCodes.DELETE:case keyCodes.HOME:case keyCodes.END:event.stopImmediatePropagation();break}that.autoResize.resize(String.fromCharCode(event.keyCode))};TextEditor.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",onBeforeKeyDown)};TextEditor.prototype.close=function(){this.textareaParentStyle.display="none";this.autoResize.unObserve();if(document.activeElement===this.TEXTAREA){this.instance.listen()}this.instance.removeHook("beforeKeyDown",onBeforeKeyDown)};TextEditor.prototype.focus=function(){this.TEXTAREA.focus();dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};TextEditor.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");dom.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var that=this;this.instance._registerTimeout(setTimeout(function(){that.refreshDimensions()},0))};TextEditor.prototype.checkEditorSection=function(){if(this.row<this.instance.getSettings().fixedRowsTop){if(this.col<this.instance.getSettings().fixedColumnsLeft){return"corner"}else{return"top"}}else{if(this.col<this.instance.getSettings().fixedColumnsLeft){return"left"}}};TextEditor.prototype.getEditedCell=function(){var editorSection=this.checkEditorSection(),editedCell;switch(editorSection){case"top":editedCell=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case"corner":editedCell=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"left":editedCell=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:editedCell=this.instance.getCell(this.row,this.col);this.textareaParentStyle.zIndex="";break}return editedCell!=-1&&editedCell!=-2?editedCell:void 0};TextEditor.prototype.refreshDimensions=function(){if(this.state!==Handsontable.EditorState.EDITING){return}this.TD=this.getEditedCell();if(!this.TD){return}var currentOffset=dom.offset(this.TD),containerOffset=dom.offset(this.instance.rootElement),scrollableContainer=dom.getScrollableElement(this.TD),editTop=currentOffset.top-containerOffset.top-1-(scrollableContainer.scrollTop||0),editLeft=currentOffset.left-containerOffset.left-1-(scrollableContainer.scrollLeft||0),settings=this.instance.getSettings(),rowHeadersCount=settings.rowHeaders?1:0,colHeadersCount=settings.colHeaders?1:0,editorSection=this.checkEditorSection(),backgroundColor=this.TD.style.backgroundColor,cssTransformOffset;switch(editorSection){case"top":cssTransformOffset=dom.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":cssTransformOffset=dom.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":cssTransformOffset=dom.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break}if(editTop<0){editTop=0}if(editLeft<0){editLeft=0}if(colHeadersCount&&this.instance.getSelected()[0]===0){editTop+=1}if(rowHeadersCount&&this.instance.getSelected()[1]===0){editLeft+=1}if(cssTransformOffset&&cssTransformOffset!=-1){this.textareaParentStyle[cssTransformOffset[0]]=cssTransformOffset[1]}else{dom.resetCssTransform(this.textareaParentStyle)}this.textareaParentStyle.top=editTop+"px";this.textareaParentStyle.left=editLeft+"px";var cellTopOffset=this.TD.offsetTop-this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),cellLeftOffset=this.TD.offsetLeft-this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition();var width=dom.innerWidth(this.TD)-8,maxWidth=this.instance.view.maximumVisibleElementWidth(cellLeftOffset)-10,height=this.TD.scrollHeight+1,maxHeight=this.instance.view.maximumVisibleElementHeight(cellTopOffset)-2;if(parseInt(this.TD.style.borderTopWidth,10)>0){height-=1}if(parseInt(this.TD.style.borderLeftWidth,10)>0){if(rowHeadersCount>0){width-=1}}this.TEXTAREA.style.fontSize=dom.getComputedStyle(this.TD).fontSize;this.TEXTAREA.style.fontFamily=dom.getComputedStyle(this.TD).fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=backgroundColor?backgroundColor:dom.getComputedStyle(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(height,maxHeight),maxHeight:maxHeight,minWidth:Math.min(width,maxWidth),maxWidth:maxWidth},true);this.textareaParentStyle.display="block"};TextEditor.prototype.bindEvents=function(){var editor=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(event){helper.stopPropagation(event)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(event){helper.stopPropagation(event)});this.instance.addHook("afterScrollVertically",function(){editor.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){editor.refreshDimensions();editor.focus()});this.instance.addHook("afterRowResize",function(){editor.refreshDimensions();editor.focus()});this.instance.addHook("afterDestroy",function(){editor.eventManager.clear()})};TextEditor.prototype.destroy=function(){this.eventManager.clear()};registerEditor("text",TextEditor)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30,autoResize:"autoResize"}],41:[function(require,module,exports){"use strict";Object.defineProperties(exports,{EventManager:{get:function(){return EventManager}},eventManager:{get:function(){return eventManager}},__esModule:{value:true}});var $__dom_46_js__;var dom=($__dom_46_js__=require("./dom.js"),$__dom_46_js__&&$__dom_46_js__.__esModule&&$__dom_46_js__||{"default":$__dom_46_js__});var EventManager=function EventManager(){var context=arguments[0]!==void 0?arguments[0]:null;this.context=context||this;if(!this.context.eventListeners){this.context.eventListeners=[]}};$traceurRuntime.createClass(EventManager,{addEventListener:function(element,eventName,callback){var $__0=this;var context=this.context;function callbackProxy(event){if(event.target==void 0&&event.srcElement!=void 0){if(event.definePoperty){event.definePoperty("target",{value:event.srcElement})}else{event.target=event.srcElement}}if(event.preventDefault==void 0){if(event.definePoperty){event.definePoperty("preventDefault",{value:function(){this.returnValue=false}})}else{event.preventDefault=function(){this.returnValue=false}}}event=extendEvent(context,event);callback.call(this,event)}this.context.eventListeners.push({element:element,event:eventName,callback:callback,callbackProxy:callbackProxy});if(window.addEventListener){element.addEventListener(eventName,callbackProxy,false)}else{element.attachEvent("on"+eventName,callbackProxy)}Handsontable.countEventManagerListeners++;return function(){$__0.removeEventListener(element,eventName,callback)}},removeEventListener:function(element,eventName,callback){var len=this.context.eventListeners.length;var tmpEvent;while(len--){tmpEvent=this.context.eventListeners[len];if(tmpEvent.event==eventName&&tmpEvent.element==element){if(callback&&callback!=tmpEvent.callback){continue}this.context.eventListeners.splice(len,1);if(tmpEvent.element.removeEventListener){tmpEvent.element.removeEventListener(tmpEvent.event,tmpEvent.callbackProxy,false)}else{tmpEvent.element.detachEvent("on"+tmpEvent.event,tmpEvent.callbackProxy)}Handsontable.countEventManagerListeners--}}},clearEvents:function(){var len=this.context.eventListeners.length;while(len--){var event=this.context.eventListeners[len];if(event){this.removeEventListener(event.element,event.event,event.callback)}}},clear:function(){this.clearEvents()},fireEvent:function(element,eventName){var options={bubbles:true,cancelable:eventName!=="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:undefined};var event;if(document.createEvent){event=document.createEvent("MouseEvents");event.initMouseEvent(eventName,options.bubbles,options.cancelable,options.view,options.detail,options.screenX,options.screenY,options.clientX,options.clientY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,options.relatedTarget||document.body.parentNode)}else{event=document.createEventObject()}if(element.dispatchEvent){element.dispatchEvent(event)}else{element.fireEvent("on"+eventName,event)}}},{});function extendEvent(context,event){var componentName="HOT-TABLE";var isHotTableSpotted;var fromElement;var realTarget;var target;var len;event.isTargetWebComponent=false;event.realTarget=event.target;if(!Handsontable.eventManager.isHotTableEnv){return event}event=dom.polymerWrap(event);len=event.path?event.path.length:0;while(len--){if(event.path[len].nodeName===componentName){isHotTableSpotted=true}else if(isHotTableSpotted&&event.path[len].shadowRoot){target=event.path[len];break}if(len===0&&!target){target=event.path[len]}}if(!target){target=event.target}event.isTargetWebComponent=true;if(dom.isWebComponentSupportedNatively()){event.realTarget=event.srcElement||event.toElement}else if(context instanceof Handsontable.Core||context instanceof Walkontable){if(context instanceof Handsontable.Core){fromElement=context.view.wt.wtTable.TABLE}else if(context instanceof Walkontable){fromElement=context.wtTable.TABLE.parentNode.parentNode}realTarget=dom.closest(event.target,[componentName],fromElement);if(realTarget){event.realTarget=fromElement.querySelector(componentName)||event.target}else{event.realTarget=event.target}}Object.defineProperty(event,"target",{get:function(){return dom.polymerWrap(target)},enumerable:true,configurable:true});return event}window.Handsontable=window.Handsontable||{};Handsontable.countEventManagerListeners=0;Handsontable.eventManager=eventManager;function eventManager(context){return new EventManager(context)}},{"./dom.js":27}],42:[function(require,module,exports){"use strict";Object.defineProperties(exports,{isPrintableChar:{get:function(){return isPrintableChar}},isMetaKey:{get:function(){return isMetaKey}},isCtrlKey:{get:function(){return isCtrlKey}},stringify:{get:function(){return stringify}},toUpperCaseFirst:{get:function(){return toUpperCaseFirst}},duckSchema:{get:function(){return duckSchema}},spreadsheetColumnLabel:{get:function(){return spreadsheetColumnLabel}},createSpreadsheetData:{get:function(){return createSpreadsheetData}},createSpreadsheetObjectData:{get:function(){return createSpreadsheetObjectData}},isNumeric:{get:function(){return isNumeric}},randomString:{get:function(){return randomString}},inherit:{get:function(){return inherit}},extend:{get:function(){return extend}},deepExtend:{get:function(){return deepExtend}},deepClone:{get:function(){return deepClone}},isObjectEquals:{get:function(){return isObjectEquals}},getPrototypeOf:{get:function(){return getPrototypeOf}},columnFactory:{get:function(){return columnFactory}},translateRowsToColumns:{get:function(){return translateRowsToColumns}},to2dArray:{get:function(){return to2dArray}},extendArray:{get:function(){return extendArray}},isInput:{get:function(){return isInput}},isOutsideInput:{get:function(){return isOutsideInput}},keyCode:{get:function(){return keyCode}},isObject:{get:function(){return isObject}},pivot:{get:function(){return pivot}},proxy:{get:function(){return proxy}},cellMethodLookupFactory:{get:function(){return cellMethodLookupFactory}},isMobileBrowser:{get:function(){return isMobileBrowser}},isTouchSupported:{get:function(){return isTouchSupported}},stopPropagation:{get:function(){return stopPropagation}},pageX:{get:function(){return pageX}},pageY:{get:function(){return pageY}},defineGetter:{get:function(){return defineGetter}},requestAnimationFrame:{get:function(){return requestAnimationFrame}},cancelAnimationFrame:{get:function(){return cancelAnimationFrame}},__esModule:{value:true}});var $__dom_46_js__;var dom=($__dom_46_js__=require("./dom.js"),$__dom_46_js__&&$__dom_46_js__.__esModule&&$__dom_46_js__||{"default":$__dom_46_js__});function isPrintableChar(keyCode){return keyCode==32||keyCode>=48&&keyCode<=57||keyCode>=96&&keyCode<=111||keyCode>=186&&keyCode<=192||keyCode>=219&&keyCode<=222||keyCode>=226||keyCode>=65&&keyCode<=90}function isMetaKey(_keyCode){var metaKeys=[keyCode.ARROW_DOWN,keyCode.ARROW_UP,keyCode.ARROW_LEFT,keyCode.ARROW_RIGHT,keyCode.HOME,keyCode.END,keyCode.DELETE,keyCode.BACKSPACE,keyCode.F1,keyCode.F2,keyCode.F3,keyCode.F4,keyCode.F5,keyCode.F6,keyCode.F7,keyCode.F8,keyCode.F9,keyCode.F10,keyCode.F11,keyCode.F12,keyCode.TAB,keyCode.PAGE_DOWN,keyCode.PAGE_UP,keyCode.ENTER,keyCode.ESCAPE,keyCode.SHIFT,keyCode.CAPS_LOCK,keyCode.ALT];return metaKeys.indexOf(_keyCode)!=-1}function isCtrlKey(_keyCode){return[keyCode.CONTROL_LEFT,224,keyCode.COMMAND_LEFT,keyCode.COMMAND_RIGHT].indexOf(_keyCode)!=-1}function stringify(value){switch(typeof value){case"string":case"number":return value+"";case"object":if(value===null){return""}else{return value.toString()}break;case"undefined":return"";default:return value.toString()}}function toUpperCaseFirst(string){return string[0].toUpperCase()+string.substr(1)}function duckSchema(object){var schema;if(Array.isArray(object)){schema=[]}else{schema={};for(var i in object){if(object.hasOwnProperty(i)){if(object[i]&&typeof object[i]==="object"&&!Array.isArray(object[i])){schema[i]=duckSchema(object[i])}else if(Array.isArray(object[i])){if(object[i].length&&typeof object[i][0]==="object"&&!Array.isArray(object[i][0])){schema[i]=[duckSchema(object[i][0])]}else{schema[i]=[]}}else{schema[i]=null}}}}return schema}function spreadsheetColumnLabel(index){var dividend=index+1;var columnLabel="";var modulo;while(dividend>0){modulo=(dividend-1)%26;columnLabel=String.fromCharCode(65+modulo)+columnLabel;dividend=parseInt((dividend-modulo)/26,10)}return columnLabel}function createSpreadsheetData(rowCount,colCount){rowCount=typeof rowCount==="number"?rowCount:100;colCount=typeof colCount==="number"?colCount:4;var rows=[],i,j;for(i=0;i<rowCount;i++){var row=[];for(j=0;j<colCount;j++){row.push(spreadsheetColumnLabel(j)+(i+1))}rows.push(row)}return rows}function createSpreadsheetObjectData(rowCount,colCount){rowCount=typeof rowCount==="number"?rowCount:100;colCount=typeof colCount==="number"?colCount:4;var rows=[],i,j;for(i=0;i<rowCount;i++){var row={};for(j=0;j<colCount;j++){row["prop"+j]=spreadsheetColumnLabel(j)+(i+1)}rows.push(row)}return rows}function isNumeric(n){var t=typeof n;return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?!n.length?false:n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):false}function randomString(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return s4()+s4()+s4()+s4()}function inherit(Child,Parent){Parent.prototype.constructor=Parent;Child.prototype=new Parent;Child.prototype.constructor=Child;return Child}function extend(target,extension){for(var i in extension){if(extension.hasOwnProperty(i)){target[i]=extension[i]}}}function deepExtend(target,extension){for(var key in extension){if(extension.hasOwnProperty(key)){if(extension[key]&&typeof extension[key]==="object"){if(!target[key]){if(Array.isArray(extension[key])){target[key]=[]}else{target[key]={}}}deepExtend(target[key],extension[key])}else{target[key]=extension[key]}}}}function deepClone(obj){if(typeof obj==="object"){return JSON.parse(JSON.stringify(obj))}else{return obj}}function isObjectEquals(object1,object2){return JSON.stringify(object1)===JSON.stringify(object2)}function getPrototypeOf(obj){var prototype;if(typeof obj.__proto__=="object"){prototype=obj.__proto__}else{var oldConstructor,constructor=obj.constructor;if(typeof obj.constructor=="function"){oldConstructor=constructor;if(delete obj.constructor){constructor=obj.constructor;obj.constructor=oldConstructor}}prototype=constructor?constructor.prototype:null}return prototype}function columnFactory(GridSettings,conflictList){function ColumnSettings(){}inherit(ColumnSettings,GridSettings);for(var i=0,len=conflictList.length;i<len;i++){ColumnSettings.prototype[conflictList[i]]=void 0}return ColumnSettings}function translateRowsToColumns(input){var i,ilen,j,jlen,output=[],olen=0;for(i=0,ilen=input.length;i<ilen;i++){for(j=0,jlen=input[i].length;j<jlen;j++){if(j==olen){output.push([]);olen++}output[j].push(input[i][j])}}return output}function to2dArray(arr){var i=0,ilen=arr.length;while(i<ilen){arr[i]=[arr[i]];i++}}function extendArray(arr,extension){var i=0,ilen=extension.length;while(i<ilen){arr.push(extension[i]);i++}}function isInput(element){var inputs=["INPUT","SELECT","TEXTAREA"];return inputs.indexOf(element.nodeName)>-1||element.contentEditable==="true"}function isOutsideInput(element){return isInput(element)&&element.className.indexOf("handsontableInput")==-1}var keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};function isObject(obj){return Object.prototype.toString.call(obj)=="[object Object]"}function pivot(arr){var pivotedArr=[];if(!arr||arr.length===0||!arr[0]||arr[0].length===0){return pivotedArr}var rowCount=arr.length;var colCount=arr[0].length;for(var i=0;i<rowCount;i++){for(var j=0;j<colCount;j++){if(!pivotedArr[j]){pivotedArr[j]=[]}pivotedArr[j][i]=arr[i][j]}}return pivotedArr}function proxy(fun,context){return function(){return fun.apply(context,arguments)}}function cellMethodLookupFactory(methodName,allowUndefined){allowUndefined=typeof allowUndefined=="undefined"?true:allowUndefined;return function cellMethodLookup(row,col){return function getMethodFromProperties(properties){if(!properties){return}else if(properties.hasOwnProperty(methodName)&&properties[methodName]!==void 0){return properties[methodName]}else if(properties.hasOwnProperty("type")&&properties.type){var type;if(typeof properties.type!="string"){throw new Error("Cell type must be a string ")}type=translateTypeNameToObject(properties.type);if(type.hasOwnProperty(methodName)){return type[methodName]}else if(allowUndefined){return}}return getMethodFromProperties(getPrototypeOf(properties))}(typeof row=="number"?this.getCellMeta(row,col):row)};function translateTypeNameToObject(typeName){var type=Handsontable.cellTypes[typeName];if(typeof type=="undefined"){throw new Error('You declared cell type "'+typeName+'" as a string that is not mapped to a known object. '+"Cell type must be an object or a string mapped to an object in Handsontable.cellTypes")}return type}}function isMobileBrowser(userAgent){if(!userAgent){userAgent=navigator.userAgent}return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent)}function isTouchSupported(){return"ontouchstart"in window}function stopPropagation(event){if(typeof event.stopPropagation==="function"){event.stopPropagation()}else{event.cancelBubble=true}}function pageX(event){if(event.pageX){return event.pageX}var scrollLeft=dom.getWindowScrollLeft();var cursorX=event.clientX+scrollLeft;return cursorX}function pageY(event){if(event.pageY){return event.pageY}var scrollTop=dom.getWindowScrollTop();var cursorY=event.clientY+scrollTop;return cursorY}function defineGetter(object,property,value,options){options.value=value;options.writable=options.writable===false?false:true;options.enumerable=options.enumerable===false?false:true;options.configurable=options.configurable===false?false:true;Object.defineProperty(object,property,options)}var lastTime=0;var vendors=["ms","moz","webkit","o"];var _requestAnimationFrame=window.requestAnimationFrame;var _cancelAnimationFrame=window.cancelAnimationFrame;for(var x=0;x<vendors.length&&!_requestAnimationFrame;++x){_requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];_cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(!_requestAnimationFrame){_requestAnimationFrame=function(callback){var currTime=(new Date).getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id}}if(!_cancelAnimationFrame){_cancelAnimationFrame=function(id){clearTimeout(id)}}function requestAnimationFrame(callback){return _requestAnimationFrame.call(window,callback)}function cancelAnimationFrame(id){_cancelAnimationFrame.call(window,id)}window.Handsontable=window.Handsontable||{};Handsontable.helper={cancelAnimationFrame:cancelAnimationFrame,cellMethodLookupFactory:cellMethodLookupFactory,columnFactory:columnFactory,createSpreadsheetData:createSpreadsheetData,createSpreadsheetObjectData:createSpreadsheetObjectData,duckSchema:duckSchema,deepClone:deepClone,deepExtend:deepExtend,defineGetter:defineGetter,extend:extend,extendArray:extendArray,getPrototypeOf:getPrototypeOf,inherit:inherit,isCtrlKey:isCtrlKey,isInput:isInput,isMetaKey:isMetaKey,isMobileBrowser:isMobileBrowser,isNumeric:isNumeric,isObject:isObject,isObjectEquals:isObjectEquals,isOutsideInput:isOutsideInput,isPrintableChar:isPrintableChar,isTouchSupported:isTouchSupported,keyCode:keyCode,pageX:pageX,pageY:pageY,pivot:pivot,proxy:proxy,randomString:randomString,requestAnimationFrame:requestAnimationFrame,spreadsheetColumnLabel:spreadsheetColumnLabel,stopPropagation:stopPropagation,stringify:stringify,to2dArray:to2dArray,toUpperCaseFirst:toUpperCaseFirst,translateRowsToColumns:translateRowsToColumns}},{"./dom.js":27}],43:[function(require,module,exports){"use strict";Object.defineProperties(exports,{MultiMap:{get:function(){return MultiMap}},__esModule:{value:true}});window.MultiMap=MultiMap;function MultiMap(){var map={arrayMap:[],weakMap:new WeakMap};return{get:function(key){if(canBeAnArrayMapKey(key)){return map.arrayMap[key]}else if(canBeAWeakMapKey(key)){return map.weakMap.get(key)}},set:function(key,value){if(canBeAnArrayMapKey(key)){map.arrayMap[key]=value}else if(canBeAWeakMapKey(key)){map.weakMap.set(key,value)}else{throw new Error("Invalid key type")}},"delete":function(key){if(canBeAnArrayMapKey(key)){delete map.arrayMap[key]}else if(canBeAWeakMapKey(key)){map.weakMap["delete"](key)}}};function canBeAnArrayMapKey(obj){return obj!==null&&!isNaNSymbol(obj)&&(typeof obj=="string"||typeof obj=="number")}function canBeAWeakMapKey(obj){return obj!==null&&(typeof obj=="object"||typeof obj=="function")}function isNaNSymbol(obj){return obj!==obj}}},{}],44:[function(require,module,exports){"use strict";Object.defineProperties(exports,{Hooks:{get:function(){return Hooks}},__esModule:{value:true}});var $__eventManager_46_js__;var REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterChangesObserved","afterColumnMove","afterColumnResize","afterContextMenuDefaultOptions","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","afterCreateCol","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterIsMultipleSelectionCheck","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellMouseDown","afterOnCellMouseOver","afterRemoveCol","afterRemoveRow","afterRender","afterRenderer","afterRowMove","afterRowResize","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","modifyCol","modifyColWidth","modifyRow","modifyRowHeight","persistentStateLoad","persistentStateReset","persistentStateSave"];var EventManager=($__eventManager_46_js__=require("./eventManager.js"),$__eventManager_46_js__&&$__eventManager_46_js__.__esModule&&$__eventManager_46_js__||{"default":$__eventManager_46_js__}).EventManager;var Hooks=function Hooks(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(Hooks,{createEmptyBucket:function(){var handler=Object.create(null);for(var i=0,len=REGISTERED_HOOKS.length;i<len;i++){handler[REGISTERED_HOOKS[i]]=[]}return handler},getBucket:function(){var context=arguments[0]!==void 0?arguments[0]:null;if(context){if(!context.pluginHookBucket){context.pluginHookBucket=this.createEmptyBucket()}return context.pluginHookBucket}return this.globalBucket},add:function(key,callback){var context=arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(callback)){for(var i=0,len=callback.length;i<len;i++){this.add(key,callback[i])}}else{var bucket=this.getBucket(context);if(typeof bucket[key]==="undefined"){this.register(key);bucket[key]=[]}callback.skip=false;if(bucket[key].indexOf(callback)===-1){bucket[key].push(callback)}}return this},once:function(key,callback){var context=arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(callback)){for(var i=0,len=callback.length;i<len;i++){callback[i].runOnce=true;this.add(key,callback[i],context)}}else{callback.runOnce=true;this.add(key,callback,context)}},remove:function(key,callback){var context=arguments[2]!==void 0?arguments[2]:null;var bucket=this.getBucket(context);if(typeof bucket[key]!=="undefined"){if(bucket[key].indexOf(callback)>=0){callback.skip=true;return true}}return false},run:function(context,key,p1,p2,p3,p4,p5,p6){{var globalHandlers=this.globalBucket[key];var len=globalHandlers?globalHandlers.length:0;for(var i=0;i<len;i++){if(globalHandlers[i].skip){continue}var res=globalHandlers[i].call(context,p1,p2,p3,p4,p5,p6);if(res!==void 0){p1=res}if(globalHandlers[i].runOnce){this.remove(key,globalHandlers[i])}}}{var localHandlers=this.getBucket(context)[key];var len$__2=localHandlers?localHandlers.length:0;for(var i$__3=0;i$__3<len$__2;i$__3++){if(localHandlers[i$__3].skip){continue}var res$__4=localHandlers[i$__3].call(context,p1,p2,p3,p4,p5,p6);if(res$__4!==void 0){p1=res$__4}if(localHandlers[i$__3].runOnce){this.remove(key,localHandlers[i$__3],context)}}}return p1},destroy:function(){var context=arguments[0]!==void 0?arguments[0]:null;var bucket=this.getBucket(context);for(var key in bucket){for(var i=0,len=bucket[key].length;i<len;i++){this.remove(key,bucket[key],context)}}},register:function(key){if(!this.isRegistered(key)){REGISTERED_HOOKS.push(key)}},deregister:function(key){if(this.isRegistered(key)){REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(key),1)}},isRegistered:function(key){return REGISTERED_HOOKS.indexOf(key)>=0},getRegistered:function(){return REGISTERED_HOOKS}},{})},{"./eventManager.js":41}],45:[function(require,module,exports){"use strict";Object.defineProperties(exports,{registerPlugin:{get:function(){return registerPlugin}},getPlugin:{get:function(){return getPlugin}},__esModule:{value:true}});var registeredPlugins=new WeakMap;function registerPlugin(pluginName,PluginClass){Handsontable.hooks.add("beforeInit",function(){var holder;pluginName=pluginName.toLowerCase();if(!registeredPlugins.has(this)){registeredPlugins.set(this,{})}holder=registeredPlugins.get(this);if(!holder[pluginName]){holder[pluginName]=new PluginClass(this)}});Handsontable.hooks.add("afterDestroy",function(){var i,pluginsHolder;if(registeredPlugins.has(this)){pluginsHolder=registeredPlugins.get(this);for(i in pluginsHolder){if(pluginsHolder.hasOwnProperty(i)){pluginsHolder[i].destroy()}}registeredPlugins.delete(this)}})}function getPlugin(instance,pluginName){if(typeof pluginName!="string"){throw Error('Only strings can be passed as "plugin" parameter')}var _pluginName=pluginName.toLowerCase();if(!registeredPlugins.has(instance)||!registeredPlugins.get(instance)[_pluginName]){throw Error('No plugin registered under name "'+pluginName+'"')}return registeredPlugins.get(instance)[_pluginName]}},{}],46:[function(require,module,exports){"use strict";Object.defineProperties(exports,{"default":{get:function(){return $__default}},__esModule:{value:true}});var $___46__46__47_helpers_46_js__;var defineGetter=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__}).defineGetter;var BasePlugin=function BasePlugin(hotInstance){defineGetter(this,"hot",hotInstance,{writable:false})};$traceurRuntime.createClass(BasePlugin,{destroy:function(){delete this.hot}},{});var $__default=BasePlugin},{"./../helpers.js":42}],47:[function(require,module,exports){"use strict";Object.defineProperties(exports,{AutoColumnSize:{get:function(){return AutoColumnSize}},__esModule:{value:true}});var $___46__46__47__46__46__47_helpers_46_js__,$___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{
"default":$___46__46__47__46__46__47_dom_46_js__});var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function AutoColumnSize(){var plugin=this,sampleCount=5;this.beforeInit=function(){var instance=this;instance.autoColumnWidths=[];if(instance.getSettings().autoColumnSize!==false){if(!instance.autoColumnSizeTmp){instance.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:true};instance.addHook("beforeRender",htAutoColumnSize.determineIfChanged);instance.addHook("modifyColWidth",htAutoColumnSize.modifyColWidth);instance.addHook("afterDestroy",htAutoColumnSize.afterDestroy);instance.determineColumnWidth=plugin.determineColumnWidth}}else{if(instance.autoColumnSizeTmp){instance.removeHook("beforeRender",htAutoColumnSize.determineIfChanged);instance.removeHook("modifyColWidth",htAutoColumnSize.modifyColWidth);instance.removeHook("afterDestroy",htAutoColumnSize.afterDestroy);delete instance.determineColumnWidth;plugin.afterDestroy.call(instance)}}};this.determineIfChanged=function(force){if(force){htAutoColumnSize.determineColumnsWidth.apply(this,arguments)}};this.determineColumnWidth=function(col){var instance=this,tmp=instance.autoColumnSizeTmp;if(!tmp.container){createTmpContainer.call(tmp,instance)}tmp.container.className=instance.rootElement.className+" htAutoColumnSize";tmp.table.className=instance.table.className;var rows=instance.countRows();var samples={};for(var r=0;r<rows;r++){var value=instance.getDataAtCell(r,col);if(!Array.isArray(value)){value=helper.stringify(value)}var len=value.length;if(!samples[len]){samples[len]={needed:sampleCount,strings:[]}}if(samples[len].needed){samples[len].strings.push({value:value,row:r});samples[len].needed--}}var settings=instance.getSettings();if(settings.colHeaders){instance.view.appendColHeader(col,tmp.theadTh)}dom.empty(tmp.tbody);for(var i in samples){if(samples.hasOwnProperty(i)){for(var j=0,jlen=samples[i].strings.length;j<jlen;j++){var row=samples[i].strings[j].row;var cellProperties=instance.getCellMeta(row,col);cellProperties.col=col;cellProperties.row=row;var renderer=instance.getCellRenderer(cellProperties);var tr=document.createElement("tr");var td=document.createElement("td");renderer(instance,td,row,col,instance.colToProp(col),samples[i].strings[j].value,cellProperties);r++;tr.appendChild(td);tmp.tbody.appendChild(tr)}}}var parent=instance.rootElement.parentNode;parent.appendChild(tmp.container);var width=dom.outerWidth(tmp.table);parent.removeChild(tmp.container);return width};this.determineColumnsWidth=function(){var instance=this;var settings=this.getSettings();if(settings.autoColumnSize||!settings.colWidths){var cols=this.countCols();for(var c=0;c<cols;c++){if(!instance._getColWidthFromSettings(c)){this.autoColumnWidths[c]=plugin.determineColumnWidth.call(instance,c)}}}};this.modifyColWidth=function(width,col){if(this.autoColumnWidths[col]&&this.autoColumnWidths[col]>width){return this.autoColumnWidths[col]}return width};this.afterDestroy=function(){var instance=this;if(instance.autoColumnSizeTmp&&instance.autoColumnSizeTmp.container&&instance.autoColumnSizeTmp.container.parentNode){instance.autoColumnSizeTmp.container.parentNode.removeChild(instance.autoColumnSizeTmp.container)}instance.autoColumnSizeTmp=null};function createTmpContainer(instance){var d=document,tmp=this;tmp.table=d.createElement("table");tmp.theadTh=d.createElement("th");tmp.table.appendChild(d.createElement("thead")).appendChild(d.createElement("tr")).appendChild(tmp.theadTh);tmp.tableStyle=tmp.table.style;tmp.tableStyle.tableLayout="auto";tmp.tableStyle.width="auto";tmp.tbody=d.createElement("tbody");tmp.table.appendChild(tmp.tbody);tmp.container=d.createElement("div");tmp.container.className=instance.rootElement.className+" hidden";tmp.containerStyle=tmp.container.style;tmp.container.appendChild(tmp.table)}}var htAutoColumnSize=new AutoColumnSize;Handsontable.hooks.add("beforeInit",htAutoColumnSize.beforeInit);Handsontable.hooks.add("afterUpdateSettings",htAutoColumnSize.beforeInit)},{"./../../dom.js":27,"./../../helpers.js":42,"./../../plugins.js":45}],48:[function(require,module,exports){"use strict";Object.defineProperties(exports,{Autofill:{get:function(){return Autofill}},__esModule:{value:true}});var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var WalkontableCellCoords=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./../../3rdparty/walkontable/src/cell/coords.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;function getDeltas(start,end,data,direction){var rlength=data.length,clength=data?data[0].length:0,deltas=[],arr=[],diffRow,diffCol,startValue,endValue,delta;diffRow=end.row-start.row;diffCol=end.col-start.col;if(["down","up"].indexOf(direction)!==-1){for(var col=0;col<=diffCol;col++){startValue=parseInt(data[0][col],10);endValue=parseInt(data[rlength-1][col],10);delta=(direction==="down"?endValue-startValue:startValue-endValue)/(rlength-1)||0;arr.push(delta)}deltas.push(arr)}if(["right","left"].indexOf(direction)!==-1){for(var row=0;row<=diffRow;row++){startValue=parseInt(data[row][0],10);endValue=parseInt(data[row][clength-1],10);delta=(direction==="right"?endValue-startValue:startValue-endValue)/(clength-1)||0;arr=[];arr.push(delta);deltas.push(arr)}}return deltas}function Autofill(instance){var _this=this,mouseDownOnCellCorner=false,wtOnCellCornerMouseDown,wtOnCellMouseOver,eventManager;this.instance=instance;this.addingStarted=false;eventManager=eventManagerObject(instance);function mouseUpCallback(event){if(!instance.autofill){return true}if(instance.autofill.handle&&instance.autofill.handle.isDragged){if(instance.autofill.handle.isDragged>1){instance.autofill.apply()}instance.autofill.handle.isDragged=0;mouseDownOnCellCorner=false}}function mouseMoveCallback(event){var tableBottom,tableRight;if(!_this.instance.autofill){return false}tableBottom=dom.offset(_this.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+dom.outerHeight(_this.instance.table);tableRight=dom.offset(_this.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+dom.outerWidth(_this.instance.table);if(_this.addingStarted===false&&_this.instance.autofill.handle.isDragged>0&&event.clientY>tableBottom&&event.clientX<=tableRight){_this.instance.mouseDragOutside=true;_this.addingStarted=true}else{_this.instance.mouseDragOutside=false}if(_this.instance.mouseDragOutside){setTimeout(function(){_this.addingStarted=false;_this.instance.alter("insert_row")},200)}}eventManager.addEventListener(document,"mouseup",mouseUpCallback);eventManager.addEventListener(document,"mousemove",mouseMoveCallback);wtOnCellCornerMouseDown=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown;this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(event){instance.autofill.handle.isDragged=1;mouseDownOnCellCorner=true;wtOnCellCornerMouseDown(event)};wtOnCellMouseOver=this.instance.view.wt.wtSettings.settings.onCellMouseOver;this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(event,coords,TD,wt){if(instance.autofill&&mouseDownOnCellCorner&&!instance.view.isMouseDown()&&instance.autofill.handle&&instance.autofill.handle.isDragged){instance.autofill.handle.isDragged++;instance.autofill.showBorder(coords);instance.autofill.checkIfNewRowNeeded()}wtOnCellMouseOver(event,coords,TD,wt)};this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){instance.autofill.selectAdjacent()}}Autofill.prototype.init=function(){this.handle={}};Autofill.prototype.disable=function(){this.handle.disabled=true};Autofill.prototype.selectAdjacent=function(){var select,data,r,maxR,c;if(this.instance.selection.isMultiple()){select=this.instance.view.wt.selections.area.getCorners()}else{select=this.instance.view.wt.selections.current.getCorners()}data=this.instance.getData();rows:for(r=select[2]+1;r<this.instance.countRows();r++){for(c=select[1];c<=select[3];c++){if(data[r][c]){break rows}}if(!!data[r][select[1]-1]||!!data[r][select[3]+1]){maxR=r}}if(maxR){this.instance.view.wt.selections.fill.clear();this.instance.view.wt.selections.fill.add(new WalkontableCellCoords(select[0],select[1]));this.instance.view.wt.selections.fill.add(new WalkontableCellCoords(maxR,select[3]));this.apply()}};Autofill.prototype.apply=function(){var drag,select,start,end,_data,direction,deltas,selRange;this.handle.isDragged=0;drag=this.instance.view.wt.selections.fill.getCorners();if(!drag){return}this.instance.view.wt.selections.fill.clear();if(this.instance.selection.isMultiple()){select=this.instance.view.wt.selections.area.getCorners()}else{select=this.instance.view.wt.selections.current.getCorners()}Handsontable.hooks.run(this.instance,"afterAutofillApplyValues",select,drag);if(drag[0]===select[0]&&drag[1]<select[1]){direction="left";start=new WalkontableCellCoords(drag[0],drag[1]);end=new WalkontableCellCoords(drag[2],select[1]-1)}else if(drag[0]===select[0]&&drag[3]>select[3]){direction="right";start=new WalkontableCellCoords(drag[0],select[3]+1);end=new WalkontableCellCoords(drag[2],drag[3])}else if(drag[0]<select[0]&&drag[1]===select[1]){direction="up";start=new WalkontableCellCoords(drag[0],drag[1]);end=new WalkontableCellCoords(select[0]-1,drag[3])}else if(drag[2]>select[2]&&drag[1]===select[1]){direction="down";start=new WalkontableCellCoords(select[2]+1,drag[1]);end=new WalkontableCellCoords(drag[2],drag[3])}if(start&&start.row>-1&&start.col>-1){selRange={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};_data=this.instance.getData(selRange.from.row,selRange.from.col,selRange.to.row,selRange.to.col);deltas=getDeltas(start,end,_data,direction);Handsontable.hooks.run(this.instance,"beforeAutofill",start,end,_data);this.instance.populateFromArray(start.row,start.col,_data,end.row,end.col,"autofill",null,direction,deltas);this.instance.selection.setRangeStart(new WalkontableCellCoords(drag[0],drag[1]));this.instance.selection.setRangeEnd(new WalkontableCellCoords(drag[2],drag[3]))}else{this.instance.selection.refreshBorders()}};Autofill.prototype.showBorder=function(coords){var topLeft=this.instance.getSelectedRange().getTopLeftCorner(),bottomRight=this.instance.getSelectedRange().getBottomRightCorner();if(this.instance.getSettings().fillHandle!=="horizontal"&&(bottomRight.row<coords.row||topLeft.row>coords.row)){coords=new WalkontableCellCoords(coords.row,bottomRight.col)}else if(this.instance.getSettings().fillHandle!=="vertical"){coords=new WalkontableCellCoords(bottomRight.row,coords.col)}else{return}this.instance.view.wt.selections.fill.clear();this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from);this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to);this.instance.view.wt.selections.fill.add(coords);this.instance.view.render()};Autofill.prototype.checkIfNewRowNeeded=function(){var fillCorners,selection,tableRows=this.instance.countRows(),that=this;if(this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===false){selection=this.instance.getSelected();fillCorners=this.instance.view.wt.selections.fill.getCorners();if(selection[2]<tableRows-1&&fillCorners[2]===tableRows-1){this.addingStarted=true;this.instance._registerTimeout(setTimeout(function(){that.instance.alter("insert_row");that.addingStarted=false},200))}}};Handsontable.hooks.add("afterInit",function(){var autofill=new Autofill(this);if(typeof this.getSettings().fillHandle!=="undefined"){if(autofill.handle&&this.getSettings().fillHandle===false){autofill.disable()}else if(!autofill.handle&&this.getSettings().fillHandle!==false){this.autofill=autofill;this.autofill.init()}}});Handsontable.hooks.add("afterDestroy",function(){$(document).off(".autofill."+this.guid,this.rootElement);$(document).off(".moveOutside_"+this.guid)});Handsontable.Autofill=Autofill},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45}],49:[function(require,module,exports){"use strict";Object.defineProperties(exports,{"default":{get:function(){return $__default}},__esModule:{value:true}});var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__95_base_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var BasePlugin=($___46__46__47__95_base_46_js__=require("./../_base.js"),$___46__46__47__95_base_46_js__&&$___46__46__47__95_base_46_js__.__esModule&&$___46__46__47__95_base_46_js__||{"default":$___46__46__47__95_base_46_js__}).default;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var ColumnSorting=function ColumnSorting(hotInstance){var $__3=this;$traceurRuntime.superConstructor($ColumnSorting).call(this,hotInstance);var _this=this;this.sortIndicators=[];this.hot.addHook("afterInit",function(){return $__3.init.call($__3,"afterInit")});this.hot.addHook("afterUpdateSettings",function(){return $__3.init.call($__3,"afterUpdateSettings")});this.hot.addHook("modifyRow",function(){return _this.translateRow.apply(_this,arguments)});this.hot.addHook("afterGetColHeader",function(){return _this.getColHeader.apply(_this,arguments)});Handsontable.hooks.register("beforeColumnSort");Handsontable.hooks.register("afterColumnSort")};var $ColumnSorting=ColumnSorting;$traceurRuntime.createClass(ColumnSorting,{init:function(source){var sortingSettings=this.hot.getSettings().columnSorting,_this=this;this.hot.sortingEnabled=!!sortingSettings;if(this.hot.sortingEnabled){this.hot.sortIndex=[];var loadedSortingState=this.loadSortingState(),sortingColumn,sortingOrder;if(typeof loadedSortingState!="undefined"){sortingColumn=loadedSortingState.sortColumn;sortingOrder=loadedSortingState.sortOrder}else{sortingColumn=sortingSettings.column;sortingOrder=sortingSettings.sortOrder}this.sortByColumn(sortingColumn,sortingOrder);this.hot.sort=function(){var args=Array.prototype.slice.call(arguments);return _this.sortByColumn.apply(_this,args)};if(typeof this.hot.getSettings().observeChanges=="undefined"){this.enableObserveChangesPlugin()}if(source=="afterInit"){this.bindColumnSortingAfterClick();this.hot.addHook("afterCreateRow",function(){_this.afterCreateRow.apply(_this,arguments)});this.hot.addHook("afterRemoveRow",function(){_this.afterRemoveRow.apply(_this,arguments)});this.hot.addHook("afterLoadData",function(){_this.init.apply(_this,arguments)})}}else{this.hot.sort=void 0;this.hot.removeHook("afterCreateRow",this.afterCreateRow);this.hot.removeHook("afterRemoveRow",this.afterRemoveRow);this.hot.removeHook("afterLoadData",this.init)}},setSortingColumn:function(col,order){if(typeof col=="undefined"){this.hot.sortColumn=void 0;this.hot.sortOrder=void 0;return}else if(this.hot.sortColumn===col&&typeof order=="undefined"){if(this.hot.sortOrder===false){this.hot.sortOrder=void 0}else{this.hot.sortOrder=!this.hot.sortOrder}}else{this.hot.sortOrder=typeof order!="undefined"?order:true}this.hot.sortColumn=col},sortByColumn:function(col,order){this.setSortingColumn(col,order);if(typeof this.hot.sortColumn=="undefined"){return}Handsontable.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder);this.sort();this.hot.render();this.saveSortingState();Handsontable.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder)},saveSortingState:function(){var sortingState={};if(typeof this.hot.sortColumn!="undefined"){sortingState.sortColumn=this.hot.sortColumn}if(typeof this.hot.sortOrder!="undefined"){sortingState.sortOrder=this.hot.sortOrder}if(sortingState.hasOwnProperty("sortColumn")||sortingState.hasOwnProperty("sortOrder")){Handsontable.hooks.run(this.hot,"persistentStateSave","columnSorting",sortingState)}},loadSortingState:function(){var storedState={};Handsontable.hooks.run(this.hot,"persistentStateLoad","columnSorting",storedState);return storedState.value},bindColumnSortingAfterClick:function(){var eventManager=eventManagerObject(this.hot),_this=this;eventManager.addEventListener(this.hot.rootElement,"click",function(e){if(dom.hasClass(e.target,"columnSorting")){var col=getColumn(e.target);if(col!==this.lastSortedColumn){_this.sortOrderClass="ascending"}else{switch(_this.hot.sortOrder){case void 0:_this.sortOrderClass="ascending";break;case true:_this.sortOrderClass="descending";break;case false:_this.sortOrderClass=void 0}}this.lastSortedColumn=col;_this.sortByColumn(col)}});function countRowHeaders(){var THs=_this.hot.view.TBODY.querySelector("tr").querySelectorAll("th");return THs.length}function getColumn(target){var TH=dom.closest(target,"TH");return dom.index(TH)-countRowHeaders()}},enableObserveChangesPlugin:function(){var _this=this;this.hot._registerTimeout(setTimeout(function(){_this.hot.updateSettings({observeChanges:true})},0))},defaultSort:function(sortOrder){return function(a,b){if(typeof a[1]=="string"){a[1]=a[1].toLowerCase()}if(typeof b[1]=="string"){b[1]=b[1].toLowerCase()}if(a[1]===b[1]){return 0}if(a[1]===null||a[1]===""){return 1}if(b[1]===null||b[1]===""){return-1}if(a[1]<b[1]){return sortOrder?-1:1}if(a[1]>b[1]){return sortOrder?1:-1}return 0}},dateSort:function(sortOrder){return function(a,b){if(a[1]===b[1]){return 0}if(a[1]===null){return 1}if(b[1]===null){return-1}var aDate=new Date(a[1]);var bDate=new Date(b[1]);if(aDate<bDate){return sortOrder?-1:1}if(aDate>bDate){return sortOrder?1:-1}return 0}},sort:function(){if(typeof this.hot.sortOrder=="undefined"){return}var colMeta,sortFunction;this.hot.sortingEnabled=false;this.hot.sortIndex.length=0;var colOffset=this.hot.colOffset();for(var i=0,ilen=this.hot.countRows()-this.hot.getSettings().minSpareRows;i<ilen;i++){this.hot.sortIndex.push([i,this.hot.getDataAtCell(i,this.hot.sortColumn+colOffset)])}colMeta=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=colMeta.sortIndicator;switch(colMeta.type){case"date":sortFunction=this.dateSort;break;default:sortFunction=this.defaultSort}this.hot.sortIndex.sort(sortFunction(this.hot.sortOrder));for(var i=this.hot.sortIndex.length;i<this.hot.countRows();i++){this.hot.sortIndex.push([i,this.hot.getDataAtCell(i,this.hot.sortColumn+colOffset)])}this.hot.sortingEnabled=true},translateRow:function(row){if(this.hot.sortingEnabled&&typeof this.hot.sortOrder!=="undefined"&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[row]){return this.hot.sortIndex[row][0]}return row},untranslateRow:function(row){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length){for(var i=0;i<this.hot.sortIndex.length;i++){if(this.hot.sortIndex[i][0]==row){return i}}}},getColHeader:function(col,TH){var headerLink=TH.querySelector(".colHeader");if(this.hot.getSettings().columnSorting&&col>=0){dom.addClass(headerLink,"columnSorting")}dom.removeClass(headerLink,"descending");dom.removeClass(headerLink,"ascending");if(this.sortIndicators[col]){if(col===this.hot.sortColumn){if(this.sortOrderClass==="ascending"){dom.addClass(headerLink,"ascending")}else if(this.sortOrderClass==="descending"){dom.addClass(headerLink,"descending")}}}},isSorted:function(){return typeof this.hot.sortColumn!="undefined"},afterCreateRow:function(index,amount){if(!this.isSorted()){return}for(var i=0;i<this.hot.sortIndex.length;i++){if(this.hot.sortIndex[i][0]>=index){this.hot.sortIndex[i][0]+=amount}}for(var i=0;i<amount;i++){this.hot.sortIndex.splice(index+i,0,[index+i,this.hot.getData()[index+i][this.hot.sortColumn+this.hot.colOffset()]])}this.saveSortingState()},afterRemoveRow:function(index,amount){if(!this.isSorted()){return}var physicalRemovedIndex=this.translateRow(index);this.hot.sortIndex.splice(index,amount);for(var i=0;i<this.hot.sortIndex.length;i++){if(this.hot.sortIndex[i][0]>physicalRemovedIndex){this.hot.sortIndex[i][0]-=amount}}this.saveSortingState()}},{},BasePlugin);var $__default=ColumnSorting;registerPlugin("columnSorting",ColumnSorting)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],50:[function(require,module,exports){"use strict";Object.defineProperties(exports,{CommentEditor:{get:function(){return CommentEditor}},__esModule:{value:true}});var $___46__46__47__46__46__47_dom_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var CommentEditor=function CommentEditor(){this.editor=this.createEditor();this.editorStyle=this.editor.style;this.editorStyle.position="absolute";this.editorStyle.zIndex=100;this.hide()};var $CommentEditor=CommentEditor;$traceurRuntime.createClass(CommentEditor,{setPosition:function(x,y){this.editorStyle.left=x+"px";this.editorStyle.top=y+"px"},show:function(){this.editorStyle.display="block"},hide:function(){this.editorStyle.display="none"},isVisible:function(){return this.editorStyle.display==="block"},setValue:function(){var value=arguments[0]!==void 0?arguments[0]:"";value=value||"";this.getInputElement().value=value},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var container=document.querySelector("."+$CommentEditor.CLASS_EDITOR_CONTAINER);var editor;var textArea;if(!container){container=document.createElement("div");dom.addClass(container,$CommentEditor.CLASS_EDITOR_CONTAINER);document.body.appendChild(container)}editor=document.createElement("div");dom.addClass(editor,$CommentEditor.CLASS_EDITOR);textArea=document.createElement("textarea");dom.addClass(textArea,$CommentEditor.CLASS_INPUT);editor.appendChild(textArea);container.appendChild(editor);return editor},getInputElement:function(){return this.editor.querySelector("."+$CommentEditor.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"./../../dom.js":27}],51:[function(require,module,exports){"use strict";Object.defineProperties(exports,{Comments:{get:function(){return Comments}},__esModule:{value:true}});var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__,$___46__46__47__46__46__47_plugins_46_js__,$___46__46__47__95_base_46_js__,$__commentEditor_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var EventManager=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).EventManager;var WalkontableCellCoords=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./../../3rdparty/walkontable/src/cell/coords.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;var $__2=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}),registerPlugin=$__2.registerPlugin,getPlugin=$__2.getPlugin;var BasePlugin=($___46__46__47__95_base_46_js__=require("./../_base.js"),$___46__46__47__95_base_46_js__&&$___46__46__47__95_base_46_js__.__esModule&&$___46__46__47__95_base_46_js__||{"default":$___46__46__47__95_base_46_js__}).default;var CommentEditor=($__commentEditor_46_js__=require("./commentEditor.js"),$__commentEditor_46_js__&&$__commentEditor_46_js__.__esModule&&$__commentEditor_46_js__||{"default":$__commentEditor_46_js__}).CommentEditor;var Comments=function Comments(hotInstance){var $__5=this;$traceurRuntime.superConstructor($Comments).call(this,hotInstance);if(!this.hot.getSettings().comments){return}this.editor=new CommentEditor;this.eventManager=new EventManager(this);this.range={};this.mouseDown=false;this.contextMenuEvent=false;this.timer=null;this.hot.addHook("afterInit",function(){return $__5.registerListeners()});this.hot.addHook("afterContextMenuDefaultOptions",function(options){return $__5.addToContextMenu(options)});this.hot.addHook("afterRenderer",function(TD,row,col,prop,value,cellProperties){return $__5.onAfterRenderer(TD,cellProperties)});this.hot.addHook("afterScrollVertically",function(){return $__5.refreshEditorPosition()});this.hot.addHook("afterColumnResize",function(){return $__5.refreshEditorPosition()});this.hot.addHook("afterRowResize",function(){return $__5.refreshEditorPosition()})};var $Comments=Comments;$traceurRuntime.createClass(Comments,{registerListeners:function(){var $__5=this;this.eventManager.addEventListener(document,"mouseover",function(event){return $__5.onMouseOver(event)});this.eventManager.addEventListener(document,"mousedown",function(event){return $__5.onMouseDown(event)});this.eventManager.addEventListener(document,"mousemove",function(event){return $__5.onMouseMove(event)});this.eventManager.addEventListener(document,"mouseup",function(event){return $__5.onMouseUp(event)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(event){return $__5.onEditorBlur(event)})},setRange:function(range){this.range=range},clearRange:function(){this.range={}},targetIsCellWithComment:function(event){return dom.hasClass(event.target,"htCommentCell")&&dom.closest(event.target,[this.hot.rootElement])?true:false},targetIsCommentTextArea:function(event){return this.editor.getInputElement()===event.target},saveComment:function(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var comment=this.editor.getValue();var row=this.range.from.row;var col=this.range.from.col;this.hot.setCellMeta(row,col,"comment",comment);this.hot.render()},saveCommentAtCell:function(row,col){this.setRange({from:new WalkontableCellCoords(row,col)});this.saveComment()},removeComment:function(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}this.hot.removeCellMeta(this.range.from.row,this.range.from.col,"comment");this.hot.render();this.hide()},removeCommentAtCell:function(row,col){this.setRange({from:new WalkontableCellCoords(row,col)});this.removeComment()},show:function(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())')}var meta=this.hot.getCellMeta(this.range.from.row,this.range.from.col);this.refreshEditorPosition(true);this.editor.setValue(meta.comment||"");this.editor.show();return true},showAtCell:function(row,col){this.setRange({from:new WalkontableCellCoords(row,col)});return this.show()},hide:function(){this.editor.hide()},refreshEditorPosition:function(){var force=arguments[0]!==void 0?arguments[0]:false;if(!force&&(!this.range.from||!this.editor.isVisible())){return}var TD=this.hot.view.wt.wtTable.getCell(this.range.from);var offset=dom.offset(TD);var lastColWidth=this.hot.getColWidth(this.range.from.col);var cellTopOffset=offset.top;var cellLeftOffset=offset.left;var verticalCompensation=0;var horizontalCompensation=0;if(this.hot.view.wt.wtViewport.hasVerticalScroll()){cellTopOffset=cellTopOffset-this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition();verticalCompensation=20}if(this.hot.view.wt.wtViewport.hasHorizontalScroll()){cellLeftOffset=cellLeftOffset-this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition();horizontalCompensation=20}var x=cellLeftOffset+lastColWidth;var y=cellTopOffset;var rect=this.hot.view.wt.wtTable.holder.getBoundingClientRect();var holderPos={left:rect.left+dom.getWindowScrollLeft()+horizontalCompensation,right:rect.right+dom.getWindowScrollLeft()-15,top:rect.top+dom.getWindowScrollTop()+verticalCompensation,bottom:rect.bottom+dom.getWindowScrollTop()};if(x<=holderPos.left||x>holderPos.right||y<=holderPos.top||y>holderPos.bottom){this.hide()}else{this.editor.setPosition(x,y)}},onMouseDown:function(event){this.mouseDown=true;if(!this.hot.view||!this.hot.view.wt){return}if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(event)&&!this.targetIsCellWithComment(event)){this.hide()}this.contextMenuEvent=false},onMouseOver:function(event){if(this.mouseDown||this.editor.isFocused()){return}if(this.targetIsCellWithComment(event)){var coordinates=this.hot.view.wt.wtTable.getCoords(event.target);var range={from:new WalkontableCellCoords(coordinates.row,coordinates.col)};this.setRange(range);this.show()}else if(!this.targetIsCommentTextArea(event)&&!this.editor.isFocused()){
this.hide()}},onMouseMove:function(event){var $__5=this;if(this.targetIsCommentTextArea(event)){this.mouseDown=true;clearTimeout(this.timer);this.timer=setTimeout(function(){$__5.mouseDown=false},200)}},onMouseUp:function(event){this.mouseDown=false},onAfterRenderer:function(TD,cellProperties){if(cellProperties.comment){dom.addClass(TD,cellProperties.commentedCellClassName)}},onEditorBlur:function(event){this.saveComment()},checkSelectionCommentsConsistency:function(){var hasComment=false;var cell=this.hot.getSelectedRange().from;if(this.hot.getCellMeta(cell.row,cell.col).comment){hasComment=true}return hasComment},onContextMenuAddComment:function(){var $__5=this;var coords=this.hot.getSelectedRange();this.contextMenuEvent=true;this.setRange({from:coords.from});this.show();setTimeout(function(){if($__5.hot){$__5.hot.deselectCell();$__5.editor.focus()}},10)},onContextMenuRemoveComment:function(key,selection){this.contextMenuEvent=true;this.removeCommentAtCell(selection.start.row,selection.start.col)},addToContextMenu:function(defaultOptions){var $__5=this;defaultOptions.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return $__5.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){return $__5.onContextMenuAddComment()},disabled:function(){return false}},{key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(key,selection){return $__5.onContextMenuRemoveComment(key,selection)},disabled:function(){return!$__5.checkSelectionCommentsConsistency()}})},destroy:function(){if(this.eventManager){this.eventManager.clear()}if(this.editor){this.editor.destroy()}$traceurRuntime.superGet(this,$Comments.prototype,"destroy").call(this)}},{},BasePlugin);registerPlugin("comments",Comments)},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,"./commentEditor.js":50}],52:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ContextMenu:{get:function(){return ContextMenu}},__esModule:{value:true}});var $___46__46__47__46__46__47_helpers_46_js__,$___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function ContextMenu(instance,customOptions){this.instance=instance;var contextMenu=this;contextMenu.menus=[];contextMenu.htMenus={};contextMenu.triggerRows=[];contextMenu.eventManager=eventManagerObject(contextMenu);this.enabled=true;this.instance.addHook("afterDestroy",function(){contextMenu.destroy()});this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(key,selection){this.alter("insert_row",selection.start.row)},disabled:function(){var selected=this.getSelected(),entireColumnSelection=[0,selected[1],this.countRows()-1,selected[1]],columnSelected=entireColumnSelection.join(",")==selected.join(",");return selected[0]<0||this.countRows()>=this.getSettings().maxRows||columnSelected}},{key:"row_below",name:"Insert row below",callback:function(key,selection){this.alter("insert_row",selection.end.row+1)},disabled:function(){var selected=this.getSelected(),entireColumnSelection=[0,selected[1],this.countRows()-1,selected[1]],columnSelected=entireColumnSelection.join(",")==selected.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||columnSelected}},ContextMenu.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(key,selection){this.alter("insert_col",selection.start.col)},disabled:function(){if(!this.isColumnModificationAllowed()){return true}var selected=this.getSelected(),entireRowSelection=[selected[0],0,selected[0],this.countCols()-1],rowSelected=entireRowSelection.join(",")==selected.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||rowSelected}},{key:"col_right",name:"Insert column on the right",callback:function(key,selection){this.alter("insert_col",selection.end.col+1)},disabled:function(){if(!this.isColumnModificationAllowed()){return true}var selected=this.getSelected(),entireRowSelection=[selected[0],0,selected[0],this.countCols()-1],rowSelected=entireRowSelection.join(",")==selected.join(",");return selected[1]<0||this.countCols()>=this.getSettings().maxCols||rowSelected}},ContextMenu.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(key,selection){var amount=selection.end.row-selection.start.row+1;this.alter("remove_row",selection.start.row,amount)},disabled:function(){var selected=this.getSelected(),entireColumnSelection=[0,selected[1],this.countRows()-1,selected[1]],columnSelected=entireColumnSelection.join(",")==selected.join(",");return selected[0]<0||columnSelected}},{key:"remove_col",name:"Remove column",callback:function(key,selection){var amount=selection.end.col-selection.start.col+1;this.alter("remove_col",selection.start.col,amount)},disabled:function(){if(!this.isColumnModificationAllowed()){return true}var selected=this.getSelected(),entireRowSelection=[selected[0],0,selected[0],this.countCols()-1],rowSelected=entireRowSelection.join(",")==selected.join(",");return selected[1]<0||rowSelected}},ContextMenu.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},ContextMenu.SEPARATOR,{key:"make_read_only",name:function(){var label="Read only";var atLeastOneReadOnly=contextMenu.checkSelectionReadOnlyConsistency(this);if(atLeastOneReadOnly){label=contextMenu.markSelected(label)}return label},callback:function(){var atLeastOneReadOnly=contextMenu.checkSelectionReadOnlyConsistency(this);var that=this;this.getSelectedRange().forAll(function(r,c){that.getCellMeta(r,c).readOnly=atLeastOneReadOnly?false:true});this.render()}},ContextMenu.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var label="Left";var hasClass=contextMenu.checkSelectionAlignment(this,"htLeft");if(hasClass){label=contextMenu.markSelected(label)}return label},callback:function(){align.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:false},{name:function(){var label="Center";var hasClass=contextMenu.checkSelectionAlignment(this,"htCenter");if(hasClass){label=contextMenu.markSelected(label)}return label},callback:function(){align.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:false},{name:function(){var label="Right";var hasClass=contextMenu.checkSelectionAlignment(this,"htRight");if(hasClass){label=contextMenu.markSelected(label)}return label},callback:function(){align.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:false},{name:function(){var label="Justify";var hasClass=contextMenu.checkSelectionAlignment(this,"htJustify");if(hasClass){label=contextMenu.markSelected(label)}return label},callback:function(){align.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:false},ContextMenu.SEPARATOR,{name:function(){var label="Top";var hasClass=contextMenu.checkSelectionAlignment(this,"htTop");if(hasClass){label=contextMenu.markSelected(label)}return label},callback:function(){align.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:false},{name:function(){var label="Middle";var hasClass=contextMenu.checkSelectionAlignment(this,"htMiddle");if(hasClass){label=contextMenu.markSelected(label)}return label},callback:function(){align.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:false},{name:function(){var label="Bottom";var hasClass=contextMenu.checkSelectionAlignment(this,"htBottom");if(hasClass){label=contextMenu.markSelected(label)}return label},callback:function(){align.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:false}]}}]};contextMenu.options={};helper.extend(contextMenu.options,this.options);this.bindMouseEvents();this.markSelected=function(label){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+label};this.checkSelectionAlignment=function(hot,className){var hasAlignment=false;hot.getSelectedRange().forAll(function(r,c){var metaClassName=hot.getCellMeta(r,c).className;if(metaClassName&&metaClassName.indexOf(className)!=-1){hasAlignment=true;return false}});return hasAlignment};if(!this.instance.getSettings().allowInsertRow){var rowAboveIndex=findIndexByKey(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(rowAboveIndex,1);var rowBelowIndex=findIndexByKey(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(rowBelowIndex,1);this.defaultOptions.items.splice(rowBelowIndex,1)}if(!this.instance.getSettings().allowInsertColumn){var colLeftIndex=findIndexByKey(this.defaultOptions.items,"col_left");this.defaultOptions.items.splice(colLeftIndex,1);var colRightIndex=findIndexByKey(this.defaultOptions.items,"col_right");this.defaultOptions.items.splice(colRightIndex,1);this.defaultOptions.items.splice(colRightIndex,1)}var removeRow=false;var removeCol=false;var removeRowIndex,removeColumnIndex;if(!this.instance.getSettings().allowRemoveRow){removeRowIndex=findIndexByKey(this.defaultOptions.items,"remove_row");this.defaultOptions.items.splice(removeRowIndex,1);removeRow=true}if(!this.instance.getSettings().allowRemoveColumn){removeColumnIndex=findIndexByKey(this.defaultOptions.items,"remove_col");this.defaultOptions.items.splice(removeColumnIndex,1);removeCol=true}if(removeRow&&removeCol){this.defaultOptions.items.splice(removeColumnIndex,1)}this.checkSelectionReadOnlyConsistency=function(hot){var atLeastOneReadOnly=false;hot.getSelectedRange().forAll(function(r,c){if(hot.getCellMeta(r,c).readOnly){atLeastOneReadOnly=true;return false}});return atLeastOneReadOnly};Handsontable.hooks.run(instance,"afterContextMenuDefaultOptions",this.defaultOptions)}ContextMenu.prototype.createMenu=function(menuName,row){if(menuName){menuName=menuName.replace(/ /g,"_");menuName="htContextSubMenu_"+menuName}var menu;if(menuName){menu=document.querySelector(".htContextMenu."+menuName)}else{menu=document.querySelector(".htContextMenu")}if(!menu){menu=document.createElement("DIV");dom.addClass(menu,"htContextMenu");if(menuName){dom.addClass(menu,menuName)}document.getElementsByTagName("body")[0].appendChild(menu)}if(this.menus.indexOf(menu)<0){this.menus.push(menu);row=row||0;this.triggerRows.push(row)}return menu};ContextMenu.prototype.bindMouseEvents=function(){function contextMenuOpenListener(event){var settings=this.instance.getSettings(),showRowHeaders=this.instance.getSettings().rowHeaders,showColHeaders=this.instance.getSettings().colHeaders,containsCornerHeader,element,items,menu;function isValidElement(element){return element.nodeName==="TD"||element.parentNode.nodeName==="TD"}element=event.realTarget;this.closeAll();event.preventDefault();helper.stopPropagation(event);if(!(showRowHeaders||showColHeaders)){if(!isValidElement(element)&&!(dom.hasClass(element,"current")&&dom.hasClass(element,"wtBorder"))){return}}else if(showRowHeaders&&showColHeaders){containsCornerHeader=element.parentNode.querySelectorAll(".cornerHeader").length>0;if(containsCornerHeader){return}}menu=this.createMenu();items=this.getItems(settings.contextMenu);this.show(menu,items);this.setMenuPosition(event,menu);this.eventManager.addEventListener(document.documentElement,"mousedown",helper.proxy(ContextMenu.prototype.closeAll,this))}var eventManager=eventManagerObject(this.instance);eventManager.addEventListener(this.instance.rootElement,"contextmenu",helper.proxy(contextMenuOpenListener,this))};ContextMenu.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){};this.instance.addHook("afterScrollVertically",this._afterScrollCallback);this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)};ContextMenu.prototype.unbindTableEvents=function(){if(this._afterScrollCallback){this.instance.removeHook("afterScrollVertically",this._afterScrollCallback);this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback);this._afterScrollCallback=null}};ContextMenu.prototype.performAction=function(event,hot){var contextMenu=this;var selectedItemIndex=hot.getSelected()[0];var selectedItem=hot.getData()[selectedItemIndex];if(selectedItem.disabled===true||typeof selectedItem.disabled=="function"&&selectedItem.disabled.call(this.instance)===true){return}if(!selectedItem.hasOwnProperty("submenu")){if(typeof selectedItem.callback!="function"){return}var selRange=this.instance.getSelectedRange();var normalizedSelection=ContextMenu.utils.normalizeSelection(selRange);selectedItem.callback.call(this.instance,selectedItem.key,normalizedSelection,event);contextMenu.closeAll()}};ContextMenu.prototype.unbindMouseEvents=function(){this.eventManager.clear();var eventManager=eventManagerObject(this.instance);eventManager.removeEventListener(this.instance.rootElement,"contextmenu")};ContextMenu.prototype.show=function(menu,items){var that=this;menu.removeAttribute("style");menu.style.display="block";var settings={data:items,colHeaders:false,colWidths:[200],readOnly:true,copyPaste:false,columns:[{data:"name",renderer:helper.proxy(this.renderer,this)}],renderAllRows:true,beforeKeyDown:function(event){that.onBeforeKeyDown(event,htContextMenu)},afterOnCellMouseOver:function(event,coords,TD){that.onCellMouseOver(event,coords,TD,htContextMenu)}};var htContextMenu=new Handsontable(menu,settings);htContextMenu.isHotTableEnv=this.instance.isHotTableEnv;Handsontable.eventManager.isHotTableEnv=this.instance.isHotTableEnv;this.eventManager.removeEventListener(menu,"mousedown");this.eventManager.addEventListener(menu,"mousedown",function(event){that.performAction(event,htContextMenu)});this.bindTableEvents();htContextMenu.listen();this.htMenus[htContextMenu.guid]=htContextMenu;Handsontable.hooks.run(this.instance,"afterContextMenuShow",htContextMenu)};ContextMenu.prototype.close=function(menu){this.hide(menu);this.eventManager.clear();this.unbindTableEvents();this.instance.listen()};ContextMenu.prototype.closeAll=function(){while(this.menus.length>0){var menu=this.menus.pop();if(menu){this.close(menu)}}this.triggerRows=[]};ContextMenu.prototype.closeLastOpenedSubMenu=function(){var menu=this.menus.pop();if(menu){this.hide(menu)}};ContextMenu.prototype.hide=function(menu){menu.style.display="none";var instance=this.htMenus[menu.id];Handsontable.hooks.run(this.instance,"afterContextMenuHide",instance);instance.destroy();delete this.htMenus[menu.id]};ContextMenu.prototype.renderer=function(instance,TD,row,col,prop,value){var contextMenu=this;var item=instance.getData()[row];var wrapper=document.createElement("DIV");if(typeof value==="function"){value=value.call(this.instance)}dom.empty(TD);TD.appendChild(wrapper);if(itemIsSeparator(item)){dom.addClass(TD,"htSeparator")}else{dom.fastInnerHTML(wrapper,value)}if(itemIsDisabled(item)){dom.addClass(TD,"htDisabled");this.eventManager.addEventListener(wrapper,"mouseenter",function(){instance.deselectCell()})}else{if(isSubMenu(item)){dom.addClass(TD,"htSubmenu");this.eventManager.addEventListener(wrapper,"mouseenter",function(){instance.selectCell(row,col)})}else{dom.removeClass(TD,"htSubmenu");dom.removeClass(TD,"htDisabled");this.eventManager.addEventListener(wrapper,"mouseenter",function(){instance.selectCell(row,col)})}}function isSubMenu(item){return item.hasOwnProperty("submenu")}function itemIsSeparator(item){return new RegExp(ContextMenu.SEPARATOR.name,"i").test(item.name)}function itemIsDisabled(item){return item.disabled===true||typeof item.disabled=="function"&&item.disabled.call(contextMenu.instance)===true}};ContextMenu.prototype.onCellMouseOver=function(event,coords,TD,hot){var menusLength=this.menus.length;if(menusLength>0){var lastMenu=this.menus[menusLength-1];if(lastMenu.id!=hot.guid){this.closeLastOpenedSubMenu()}}else{this.closeLastOpenedSubMenu()}if(TD.className.indexOf("htSubmenu")!=-1){var selectedItem=hot.getData()[coords.row];var items=this.getItems(selectedItem.submenu);var subMenu=this.createMenu(selectedItem.name,coords.row);var tdCoords=TD.getBoundingClientRect();this.show(subMenu,items);this.setSubMenuPosition(tdCoords,subMenu)}};ContextMenu.prototype.onBeforeKeyDown=function(event,instance){dom.enableImmediatePropagation(event);var contextMenu=this;var selection=instance.getSelected();switch(event.keyCode){case helper.keyCode.ESCAPE:contextMenu.closeAll();event.preventDefault();event.stopImmediatePropagation();break;case helper.keyCode.ENTER:if(selection){contextMenu.performAction(event,instance)}break;case helper.keyCode.ARROW_DOWN:if(!selection){selectFirstCell(instance,contextMenu)}else{selectNextCell(selection[0],selection[1],instance,contextMenu)}event.preventDefault();event.stopImmediatePropagation();break;case helper.keyCode.ARROW_UP:if(!selection){selectLastCell(instance,contextMenu)}else{selectPrevCell(selection[0],selection[1],instance,contextMenu)}event.preventDefault();event.stopImmediatePropagation();break;case helper.keyCode.ARROW_RIGHT:if(selection){var row=selection[0];var cell=instance.getCell(selection[0],0);if(ContextMenu.utils.hasSubMenu(cell)){openSubMenu(instance,contextMenu,cell,row)}}event.preventDefault();event.stopImmediatePropagation();break;case helper.keyCode.ARROW_LEFT:if(selection){if(instance.rootElement.className.indexOf("htContextSubMenu_")!=-1){contextMenu.closeLastOpenedSubMenu();var index=contextMenu.menus.length;if(index>0){var menu=contextMenu.menus[index-1];var triggerRow=contextMenu.triggerRows.pop();instance=this.htMenus[menu.id];instance.selectCell(triggerRow,0)}}event.preventDefault();event.stopImmediatePropagation()}break}function selectFirstCell(instance){var firstCell=instance.getCell(0,0);if(ContextMenu.utils.isSeparator(firstCell)||ContextMenu.utils.isDisabled(firstCell)){selectNextCell(0,0,instance)}else{instance.selectCell(0,0)}}function selectLastCell(instance){var lastRow=instance.countRows()-1;var lastCell=instance.getCell(lastRow,0);if(ContextMenu.utils.isSeparator(lastCell)||ContextMenu.utils.isDisabled(lastCell)){selectPrevCell(lastRow,0,instance)}else{instance.selectCell(lastRow,0)}}function selectNextCell(row,col,instance){var nextRow=row+1;var nextCell=nextRow<instance.countRows()?instance.getCell(nextRow,col):null;if(!nextCell){return}if(ContextMenu.utils.isSeparator(nextCell)||ContextMenu.utils.isDisabled(nextCell)){selectNextCell(nextRow,col,instance)}else{instance.selectCell(nextRow,col)}}function selectPrevCell(row,col,instance){var prevRow=row-1;var prevCell=prevRow>=0?instance.getCell(prevRow,col):null;if(!prevCell){return}if(ContextMenu.utils.isSeparator(prevCell)||ContextMenu.utils.isDisabled(prevCell)){selectPrevCell(prevRow,col,instance)}else{instance.selectCell(prevRow,col)}}function openSubMenu(instance,contextMenu,cell,row){var selectedItem=instance.getData()[row];var items=contextMenu.getItems(selectedItem.submenu);var subMenu=contextMenu.createMenu(selectedItem.name,row);var coords=cell.getBoundingClientRect();var subMenuInstance=contextMenu.show(subMenu,items);contextMenu.setSubMenuPosition(coords,subMenu);subMenuInstance.selectCell(0,0)}};function findByKey(items,key){for(var i=0,ilen=items.length;i<ilen;i++){if(items[i].key===key){return items[i]}}}function findIndexByKey(items,key){for(var i=0,ilen=items.length;i<ilen;i++){if(items[i].key===key){return i}}}ContextMenu.prototype.getItems=function(items){var menu,item;function ContextMenuItem(rawItem){if(typeof rawItem=="string"){this.name=rawItem}else{helper.extend(this,rawItem)}}ContextMenuItem.prototype=items;if(items&&items.items){items=items.items}if(items===true){items=this.defaultOptions.items}if(1==1){menu=[];for(var key in items){if(items.hasOwnProperty(key)){if(typeof items[key]==="string"){item=findByKey(this.defaultOptions.items,items[key])}else{item=findByKey(this.defaultOptions.items,key)}if(!item){item=items[key]}item=new ContextMenuItem(item);if(typeof items[key]==="object"){helper.extend(item,items[key])}if(!item.key){item.key=key}menu.push(item)}}}return menu};ContextMenu.prototype.setSubMenuPosition=function(coords,menu){var scrollTop=dom.getWindowScrollTop();var scrollLeft=dom.getWindowScrollLeft();var cursor={top:scrollTop+coords.top,topRelative:coords.top,left:coords.left,leftRelative:coords.left-scrollLeft,scrollTop:scrollTop,scrollLeft:scrollLeft,cellHeight:coords.height,cellWidth:coords.width};if(this.menuFitsBelowCursor(cursor,menu,document.body.clientWidth)){this.positionMenuBelowCursor(cursor,menu,true)}else{if(this.menuFitsAboveCursor(cursor,menu)){this.positionMenuAboveCursor(cursor,menu,true)}else{this.positionMenuBelowCursor(cursor,menu,true)}}if(this.menuFitsOnRightOfCursor(cursor,menu,document.body.clientWidth)){this.positionMenuOnRightOfCursor(cursor,menu,true)}else{this.positionMenuOnLeftOfCursor(cursor,menu,true)}};ContextMenu.prototype.setMenuPosition=function(event,menu){var scrollTop=dom.getWindowScrollTop();var scrollLeft=dom.getWindowScrollLeft();var cursorY=event.pageY||event.clientY+scrollTop;var cursorX=event.pageX||event.clientX+scrollLeft;var cursor={top:cursorY,topRelative:cursorY-scrollTop,left:cursorX,leftRelative:cursorX-scrollLeft,scrollTop:scrollTop,scrollLeft:scrollLeft,cellHeight:event.target.clientHeight,cellWidth:event.target.clientWidth};if(this.menuFitsBelowCursor(cursor,menu,document.body.clientHeight)){this.positionMenuBelowCursor(cursor,menu)}else{if(this.menuFitsAboveCursor(cursor,menu)){this.positionMenuAboveCursor(cursor,menu)}else{this.positionMenuBelowCursor(cursor,menu)}}if(this.menuFitsOnRightOfCursor(cursor,menu,document.body.clientWidth)){this.positionMenuOnRightOfCursor(cursor,menu)}else{this.positionMenuOnLeftOfCursor(cursor,menu)}};ContextMenu.prototype.menuFitsAboveCursor=function(cursor,menu){return cursor.topRelative>=menu.offsetHeight};ContextMenu.prototype.menuFitsBelowCursor=function(cursor,menu,viewportHeight){return cursor.topRelative+menu.offsetHeight<=viewportHeight};ContextMenu.prototype.menuFitsOnRightOfCursor=function(cursor,menu,viewportHeight){return cursor.leftRelative+menu.offsetWidth<=viewportHeight};ContextMenu.prototype.positionMenuBelowCursor=function(cursor,menu){menu.style.top=cursor.top+"px"};ContextMenu.prototype.positionMenuAboveCursor=function(cursor,menu,subMenu){if(subMenu){menu.style.top=cursor.top+cursor.cellHeight-menu.offsetHeight+"px"}else{menu.style.top=cursor.top-menu.offsetHeight+"px"}};ContextMenu.prototype.positionMenuOnRightOfCursor=function(cursor,menu,subMenu){if(subMenu){menu.style.left=1+cursor.left+cursor.cellWidth+"px"}else{menu.style.left=1+cursor.left+"px"}};ContextMenu.prototype.positionMenuOnLeftOfCursor=function(cursor,menu,subMenu){if(subMenu){menu.style.left=cursor.left-menu.offsetWidth+"px"}else{menu.style.left=cursor.left-menu.offsetWidth+"px"}};ContextMenu.utils={};ContextMenu.utils.normalizeSelection=function(selRange){return{start:selRange.getTopLeftCorner(),end:selRange.getBottomRightCorner()}};ContextMenu.utils.isSeparator=function(cell){return dom.hasClass(cell,"htSeparator")};ContextMenu.utils.hasSubMenu=function(cell){return dom.hasClass(cell,"htSubmenu")};ContextMenu.utils.isDisabled=function(cell){return dom.hasClass(cell,"htDisabled")};ContextMenu.prototype.enable=function(){if(!this.enabled){this.enabled=true;this.bindMouseEvents()}};ContextMenu.prototype.disable=function(){if(this.enabled){this.enabled=false;this.closeAll();this.unbindMouseEvents();this.unbindTableEvents()}};ContextMenu.prototype.destroy=function(){this.closeAll();while(this.menus.length>0){var menu=this.menus.pop();this.triggerRows.pop();if(menu){this.close(menu);if(!this.isMenuEnabledByOtherHotInstance()){this.removeMenu(menu)}}}this.unbindMouseEvents();this.unbindTableEvents()};ContextMenu.prototype.isMenuEnabledByOtherHotInstance=function(){var hotContainers=document.querySelectorAll(".handsontable");var menuEnabled=false;for(var i=0,len=hotContainers.length;i<len;i++){var instance=this.htMenus[hotContainers[i].id];if(instance&&instance.getSettings().contextMenu){menuEnabled=true;break}}return menuEnabled};ContextMenu.prototype.removeMenu=function(menu){if(menu.parentNode){this.menu.parentNode.removeChild(menu)}};ContextMenu.prototype.align=function(range,type,alignment){align.call(this,range,type,alignment)};ContextMenu.SEPARATOR={name:"---------"};function updateHeight(){if(this.rootElement.className.indexOf("htContextMenu")){return}var realSeparatorHeight=0,realEntrySize=0,dataSize=this.getSettings().data.length,currentHiderWidth=parseInt(this.view.wt.wtTable.hider.style.width,10);for(var i=0;i<dataSize;i++){if(this.getSettings().data[i].name==ContextMenu.SEPARATOR.name){realSeparatorHeight+=1}else{realEntrySize+=26}}this.view.wt.wtTable.holder.style.width=currentHiderWidth+22+"px";this.view.wt.wtTable.holder.style.height=realEntrySize+realSeparatorHeight+4+"px"}function prepareVerticalAlignClass(className,alignment){if(className.indexOf(alignment)!=-1){return className}className=className.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");className+=" "+alignment;return className}function prepareHorizontalAlignClass(className,alignment){if(className.indexOf(alignment)!=-1){return className}className=className.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");className+=" "+alignment;return className}function getAlignmentClasses(range){var classesArray={};for(var row=range.from.row;row<=range.to.row;row++){for(var col=range.from.col;col<=range.to.col;col++){if(!classesArray[row]){classesArray[row]=[]}classesArray[row][col]=this.getCellMeta(row,col).className}}return classesArray}function doAlign(row,col,type,alignment){var cellMeta=this.getCellMeta(row,col),className=alignment;if(cellMeta.className){if(type==="vertical"){className=prepareVerticalAlignClass(cellMeta.className,alignment)}else{className=prepareHorizontalAlignClass(cellMeta.className,alignment)}}this.setCellMeta(row,col,"className",className)}function align(range,type,alignment){var stateBefore=getAlignmentClasses.call(this,range);this.runHooks("beforeCellAlignment",stateBefore,range,type,alignment);if(range.from.row==range.to.row&&range.from.col==range.to.col){doAlign.call(this,range.from.row,range.from.col,type,alignment)}else{for(var row=range.from.row;row<=range.to.row;row++){for(var col=range.from.col;col<=range.to.col;col++){doAlign.call(this,row,col,type,alignment)}}}this.render()}function init(){var instance=this;var contextMenuSetting=instance.getSettings().contextMenu;var customOptions=helper.isObject(contextMenuSetting)?contextMenuSetting:{};if(contextMenuSetting){if(!instance.contextMenu){instance.contextMenu=new ContextMenu(instance,customOptions)}instance.contextMenu.enable()}else if(instance.contextMenu){instance.contextMenu.destroy();delete instance.contextMenu}}Handsontable.hooks.add("afterInit",init);Handsontable.hooks.add("afterUpdateSettings",init);Handsontable.hooks.add("afterInit",updateHeight);Handsontable.hooks.register("afterContextMenuDefaultOptions");Handsontable.hooks.register("afterContextMenuShow");Handsontable.hooks.register("afterContextMenuHide");Handsontable.ContextMenu=ContextMenu},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],53:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ContextMenuCopyPaste:{get:function(){return ContextMenuCopyPaste}},__esModule:{value:true}});var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__,$___46__46__47__95_base_46_js__,$__zeroclipboard__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var BasePlugin=($___46__46__47__95_base_46_js__=require("./../_base.js"),$___46__46__47__95_base_46_js__&&$___46__46__47__95_base_46_js__.__esModule&&$___46__46__47__95_base_46_js__||{"default":$___46__46__47__95_base_46_js__}).default;var ZeroClipboard=($__zeroclipboard__=require("zeroclipboard"),$__zeroclipboard__&&$__zeroclipboard__.__esModule&&$__zeroclipboard__||{"default":$__zeroclipboard__}).default;var ContextMenuCopyPaste=function ContextMenuCopyPaste(hotInstance){var $__4=this;$traceurRuntime.superConstructor($ContextMenuCopyPaste).call(this,hotInstance);this.swfPath=null;this.hotContextMenu=null;this.outsideClickDeselectsCache=null;this.hot.addHook("afterContextMenuShow",function(htContextMenu){return $__4.setupZeroClipboard(htContextMenu)});this.hot.addHook("afterInit",function(){return $__4.afterInit()});this.hot.addHook("afterContextMenuDefaultOptions",function(options){return $__4.addToContextMenu(options)})};var $ContextMenuCopyPaste=ContextMenuCopyPaste;$traceurRuntime.createClass(ContextMenuCopyPaste,{afterInit:function(){if(!this.hot.getSettings().contextMenuCopyPaste){return}else if(typeof this.hot.getSettings().contextMenuCopyPaste=="object"){this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath}if(typeof ZeroClipboard==="undefined"){throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.")}try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(exception){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"]){throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}}this.prepareZeroClipboard()},prepareZeroClipboard:function(){if(this.swfPath){ZeroClipboard.config({swfPath:this.swfPath})}},getCopyValue:function(){this.hot.copyPaste.setCopyableText();return this.hot.copyPaste.copyPasteInstance.elTextarea.value},addToContextMenu:function(defaultOptions){if(!this.hot.getSettings().contextMenuCopyPaste){return}defaultOptions.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste();
}},Handsontable.ContextMenu.SEPARATOR)},setupZeroClipboard:function(hotContextMenu){var $__4=this;var data,zeroClipboardInstance;if(!this.hot.getSettings().contextMenuCopyPaste){return}this.hotContextMenu=hotContextMenu;data=this.hotContextMenu.getData();for(var i=0,ilen=data.length;i<ilen;i++){if(data[i].key==="copy"){zeroClipboardInstance=new ZeroClipboard(this.hotContextMenu.getCell(i,0));zeroClipboardInstance.off();zeroClipboardInstance.on("copy",function(event){var clipboard=event.clipboardData;clipboard.setData("text/plain",$__4.getCopyValue());$__4.hot.getSettings().outsideClickDeselects=$__4.outsideClickDeselectsCache});this.bindEvents();break}}},removeCurrentClass:function(){if(this.hotContextMenu.rootElement){var element=this.hotContextMenu.rootElement.querySelector("td.current");if(element){dom.removeClass(element,"current")}}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=false},removeZeroClipboardClass:function(){if(this.hotContextMenu.rootElement){var element=this.hotContextMenu.rootElement.querySelector("td.zeroclipboard-is-hover");if(element){dom.removeClass(element,"zeroclipboard-is-hover")}}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache},bindEvents:function(){var $__4=this;var eventManager=eventManagerObject(this.hotContextMenu);eventManager.addEventListener(document,"mouseenter",function(){return $__4.removeCurrentClass()});eventManager.addEventListener(document,"mouseleave",function(){return $__4.removeZeroClipboardClass()})}},{},BasePlugin);registerPlugin("contextMenuCopyPaste",ContextMenuCopyPaste)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,zeroclipboard:"zeroclipboard"}],54:[function(require,module,exports){"use strict";Object.defineProperties(exports,{CopyPaste:{get:function(){return CopyPaste}},__esModule:{value:true}});var $___46__46__47__46__46__47_helpers_46_js__,$__copyPaste__,$__SheetClip__,$___46__46__47__46__46__47_plugins_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});var copyPaste=($__copyPaste__=require("copyPaste"),$__copyPaste__&&$__copyPaste__.__esModule&&$__copyPaste__||{"default":$__copyPaste__}).default;var SheetClip=($__SheetClip__=require("SheetClip"),$__SheetClip__&&$__SheetClip__.__esModule&&$__SheetClip__||{"default":$__SheetClip__}).default;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var WalkontableCellCoords=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./../../3rdparty/walkontable/src/cell/coords.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;var WalkontableCellRange=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__=require("./../../3rdparty/walkontable/src/cell/range.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__}).WalkontableCellRange;function CopyPastePlugin(instance){var _this=this;this.copyPasteInstance=copyPaste();this.copyPasteInstance.onCut(onCut);this.copyPasteInstance.onPaste(onPaste);instance.addHook("beforeKeyDown",onBeforeKeyDown);function onCut(){if(!instance.isListening()){return}instance.selection.empty()}function onPaste(str){var input,inputArray,selected,coordsFrom,coordsTo,cellRange,topLeftCorner,bottomRightCorner,areaStart,areaEnd;if(!instance.isListening()||!instance.selection.isSelected()){return}input=str;inputArray=SheetClip.parse(input);selected=instance.getSelected();coordsFrom=new WalkontableCellCoords(selected[0],selected[1]);coordsTo=new WalkontableCellCoords(selected[2],selected[3]);cellRange=new WalkontableCellRange(coordsFrom,coordsFrom,coordsTo);topLeftCorner=cellRange.getTopLeftCorner();bottomRightCorner=cellRange.getBottomRightCorner();areaStart=topLeftCorner;areaEnd=new WalkontableCellCoords(Math.max(bottomRightCorner.row,inputArray.length-1+topLeftCorner.row),Math.max(bottomRightCorner.col,inputArray[0].length-1+topLeftCorner.col));instance.addHookOnce("afterChange",function(changes,source){if(changes&&changes.length){this.selectCell(areaStart.row,areaStart.col,areaEnd.row,areaEnd.col)}});instance.populateFromArray(areaStart.row,areaStart.col,inputArray,areaEnd.row,areaEnd.col,"paste",instance.getSettings().pasteMode)}function onBeforeKeyDown(event){var ctrlDown;if(instance.getSelected()){if(helper.isCtrlKey(event.keyCode)){_this.setCopyableText();event.stopImmediatePropagation();return}ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(event.keyCode==helper.keyCode.A&&ctrlDown){instance._registerTimeout(setTimeout(helper.proxy(_this.setCopyableText,_this),0))}}}this.destroy=function(){this.copyPasteInstance.removeCallback(onCut);this.copyPasteInstance.removeCallback(onPaste);this.copyPasteInstance.destroy();instance.removeHook("beforeKeyDown",onBeforeKeyDown)};instance.addHook("afterDestroy",helper.proxy(this.destroy,this));this.triggerPaste=helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var settings=instance.getSettings();var copyRowsLimit=settings.copyRowsLimit;var copyColsLimit=settings.copyColsLimit;var selRange=instance.getSelectedRange();var topLeft=selRange.getTopLeftCorner();var bottomRight=selRange.getBottomRightCorner();var startRow=topLeft.row;var startCol=topLeft.col;var endRow=bottomRight.row;var endCol=bottomRight.col;var finalEndRow=Math.min(endRow,startRow+copyRowsLimit-1);var finalEndCol=Math.min(endCol,startCol+copyColsLimit-1);instance.copyPaste.copyPasteInstance.copyable(instance.getCopyableData(startRow,startCol,finalEndRow,finalEndCol));if(endRow!==finalEndRow||endCol!==finalEndCol){Handsontable.hooks.run(instance,"afterCopyLimit",endRow-startRow+1,endCol-startCol+1,copyRowsLimit,copyColsLimit)}}}function init(){var instance=this,pluginEnabled=instance.getSettings().copyPaste!==false;if(pluginEnabled&&!instance.copyPaste){instance.copyPaste=new CopyPastePlugin(instance)}else if(!pluginEnabled&&instance.copyPaste){instance.copyPaste.destroy();delete instance.copyPaste}}Handsontable.hooks.add("afterInit",init);Handsontable.hooks.add("afterUpdateSettings",init);Handsontable.hooks.register("afterCopyLimit")},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../helpers.js":42,"./../../plugins.js":45,SheetClip:"SheetClip",copyPaste:"copyPaste"}],55:[function(require,module,exports){"use strict";var $___46__46__47__46__46__47_plugins_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection_46_js__;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var WalkontableCellRange=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__=require("./../../3rdparty/walkontable/src/cell/range.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__}).WalkontableCellRange;var WalkontableSelection=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection_46_js__=require("./../../3rdparty/walkontable/src/selection.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection_46_js__}).WalkontableSelection;function CustomBorders(){}var instance;var checkEnable=function(customBorders){if(typeof customBorders==="boolean"){if(customBorders===true){return true}}if(typeof customBorders==="object"){if(customBorders.length>0){return true}}return false};var init=function(){if(checkEnable(this.getSettings().customBorders)){if(!this.customBorders){instance=this;this.customBorders=new CustomBorders}}};var getSettingIndex=function(className){for(var i=0;i<instance.view.wt.selections.length;i++){if(instance.view.wt.selections[i].settings.className==className){return i}}return-1};var insertBorderIntoSettings=function(border){var coordinates={row:border.row,col:border.col};var selection=new WalkontableSelection(border,new WalkontableCellRange(coordinates,coordinates,coordinates));var index=getSettingIndex(border.className);if(index>=0){instance.view.wt.selections[index]=selection}else{instance.view.wt.selections.push(selection)}};var prepareBorderFromCustomAdded=function(row,col,borderObj){var border=createEmptyBorders(row,col);border=extendDefaultBorder(border,borderObj);this.setCellMeta(row,col,"borders",border);insertBorderIntoSettings(border)};var prepareBorderFromCustomAddedRange=function(rowObj){var range=rowObj.range;for(var row=range.from.row;row<=range.to.row;row++){for(var col=range.from.col;col<=range.to.col;col++){var border=createEmptyBorders(row,col);var add=0;if(row==range.from.row){add++;if(rowObj.hasOwnProperty("top")){border.top=rowObj.top}}if(row==range.to.row){add++;if(rowObj.hasOwnProperty("bottom")){border.bottom=rowObj.bottom}}if(col==range.from.col){add++;if(rowObj.hasOwnProperty("left")){border.left=rowObj.left}}if(col==range.to.col){add++;if(rowObj.hasOwnProperty("right")){border.right=rowObj.right}}if(add>0){this.setCellMeta(row,col,"borders",border);insertBorderIntoSettings(border)}}}};var createClassName=function(row,col){return"border_row"+row+"col"+col};var createDefaultCustomBorder=function(){return{width:1,color:"#000"}};var createSingleEmptyBorder=function(){return{hide:true}};var createDefaultHtBorder=function(){return{width:1,color:"#000",cornerVisible:false}};var createEmptyBorders=function(row,col){return{className:createClassName(row,col),border:createDefaultHtBorder(),row:row,col:col,top:createSingleEmptyBorder(),right:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),left:createSingleEmptyBorder()}};var extendDefaultBorder=function(defaultBorder,customBorder){if(customBorder.hasOwnProperty("border")){defaultBorder.border=customBorder.border}if(customBorder.hasOwnProperty("top")){defaultBorder.top=customBorder.top}if(customBorder.hasOwnProperty("right")){defaultBorder.right=customBorder.right}if(customBorder.hasOwnProperty("bottom")){defaultBorder.bottom=customBorder.bottom}if(customBorder.hasOwnProperty("left")){defaultBorder.left=customBorder.left}return defaultBorder};var removeBordersFromDom=function(borderClassName){var borders=document.querySelectorAll("."+borderClassName);for(var i=0;i<borders.length;i++){if(borders[i]){if(borders[i].nodeName!="TD"){var parent=borders[i].parentNode;if(parent.parentNode){parent.parentNode.removeChild(parent)}}}}};var removeAllBorders=function(row,col){var borderClassName=createClassName(row,col);removeBordersFromDom(borderClassName);this.removeCellMeta(row,col,"borders")};var setBorder=function(row,col,place,remove){var bordersMeta=this.getCellMeta(row,col).borders;if(!bordersMeta||bordersMeta.border==undefined){bordersMeta=createEmptyBorders(row,col)}if(remove){bordersMeta[place]=createSingleEmptyBorder()}else{bordersMeta[place]=createDefaultCustomBorder()}this.setCellMeta(row,col,"borders",bordersMeta);var borderClassName=createClassName(row,col);removeBordersFromDom(borderClassName);insertBorderIntoSettings(bordersMeta);this.render()};var prepareBorder=function(range,place,remove){if(range.from.row==range.to.row&&range.from.col==range.to.col){if(place=="noBorders"){removeAllBorders.call(this,range.from.row,range.from.col)}else{setBorder.call(this,range.from.row,range.from.col,place,remove)}}else{switch(place){case"noBorders":for(var column=range.from.col;column<=range.to.col;column++){for(var row=range.from.row;row<=range.to.row;row++){removeAllBorders.call(this,row,column)}}break;case"top":for(var topCol=range.from.col;topCol<=range.to.col;topCol++){setBorder.call(this,range.from.row,topCol,place,remove)}break;case"right":for(var rowRight=range.from.row;rowRight<=range.to.row;rowRight++){setBorder.call(this,rowRight,range.to.col,place)}break;case"bottom":for(var bottomCol=range.from.col;bottomCol<=range.to.col;bottomCol++){setBorder.call(this,range.to.row,bottomCol,place)}break;case"left":for(var rowLeft=range.from.row;rowLeft<=range.to.row;rowLeft++){setBorder.call(this,rowLeft,range.from.col,place)}break}}};var checkSelectionBorders=function(hot,direction){var atLeastOneHasBorder=false;hot.getSelectedRange().forAll(function(r,c){var metaBorders=hot.getCellMeta(r,c).borders;if(metaBorders){if(direction){if(!metaBorders[direction].hasOwnProperty("hide")){atLeastOneHasBorder=true;return false}}else{atLeastOneHasBorder=true;return false}}});return atLeastOneHasBorder};var markSelected=function(label){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+label};var addBordersOptionsToContextMenu=function(defaultOptions){if(!this.getSettings().customBorders){return}defaultOptions.items.push(Handsontable.ContextMenu.SEPARATOR);defaultOptions.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var label="Top";var hasBorder=checkSelectionBorders(this,"top");if(hasBorder){label=markSelected(label)}return label},callback:function(){var hasBorder=checkSelectionBorders(this,"top");prepareBorder.call(this,this.getSelectedRange(),"top",hasBorder)},disabled:false},right:{name:function(){var label="Right";var hasBorder=checkSelectionBorders(this,"right");if(hasBorder){label=markSelected(label)}return label},callback:function(){var hasBorder=checkSelectionBorders(this,"right");prepareBorder.call(this,this.getSelectedRange(),"right",hasBorder)},disabled:false},bottom:{name:function(){var label="Bottom";var hasBorder=checkSelectionBorders(this,"bottom");if(hasBorder){label=markSelected(label)}return label},callback:function(){var hasBorder=checkSelectionBorders(this,"bottom");prepareBorder.call(this,this.getSelectedRange(),"bottom",hasBorder)},disabled:false},left:{name:function(){var label="Left";var hasBorder=checkSelectionBorders(this,"left");if(hasBorder){label=markSelected(label)}return label},callback:function(){var hasBorder=checkSelectionBorders(this,"left");prepareBorder.call(this,this.getSelectedRange(),"left",hasBorder)},disabled:false},remove:{name:"Remove border(s)",callback:function(){prepareBorder.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!checkSelectionBorders(this)}}}}})};Handsontable.hooks.add("beforeInit",init);Handsontable.hooks.add("afterContextMenuDefaultOptions",addBordersOptionsToContextMenu);Handsontable.hooks.add("afterInit",function(){var customBorders=this.getSettings().customBorders;if(customBorders){for(var i=0;i<customBorders.length;i++){if(customBorders[i].range){prepareBorderFromCustomAddedRange.call(this,customBorders[i])}else{prepareBorderFromCustomAdded.call(this,customBorders[i].row,customBorders[i].col,customBorders[i])}}this.render();this.view.wt.draw(true)}});Handsontable.CustomBorders=CustomBorders},{"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/selection.js":18,"./../../plugins.js":45}],56:[function(require,module,exports){"use strict";Object.defineProperties(exports,{DragToScroll:{get:function(){return DragToScroll}},__esModule:{value:true}});var $___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;Handsontable.plugins.DragToScroll=DragToScroll;function DragToScroll(){this.boundaries=null;this.callback=null}DragToScroll.prototype.setBoundaries=function(boundaries){this.boundaries=boundaries};DragToScroll.prototype.setCallback=function(callback){this.callback=callback};DragToScroll.prototype.check=function(x,y){var diffX=0;var diffY=0;if(y<this.boundaries.top){diffY=y-this.boundaries.top}else if(y>this.boundaries.bottom){diffY=y-this.boundaries.bottom}if(x<this.boundaries.left){diffX=x-this.boundaries.left}else if(x>this.boundaries.right){diffX=x-this.boundaries.right}this.callback(diffX,diffY)};var dragToScroll;var instance;if(typeof Handsontable!=="undefined"){var setupListening=function(instance){instance.dragToScrollListening=false;var scrollHandler=instance.view.wt.wtTable.holder;dragToScroll=new DragToScroll;if(scrollHandler===window){return}else{dragToScroll.setBoundaries(scrollHandler.getBoundingClientRect())}dragToScroll.setCallback(function(scrollX,scrollY){if(scrollX<0){scrollHandler.scrollLeft-=50}else if(scrollX>0){scrollHandler.scrollLeft+=50}if(scrollY<0){scrollHandler.scrollTop-=20}else if(scrollY>0){scrollHandler.scrollTop+=20}});instance.dragToScrollListening=true}}Handsontable.hooks.add("afterInit",function(){var instance=this;var eventManager=eventManagerObject(this);eventManager.addEventListener(document,"mouseup",function(){instance.dragToScrollListening=false});eventManager.addEventListener(document,"mousemove",function(event){if(instance.dragToScrollListening){dragToScroll.check(event.clientX,event.clientY)}})});Handsontable.hooks.add("afterDestroy",function(){eventManagerObject(this).clear()});Handsontable.hooks.add("afterOnCellMouseDown",function(){setupListening(this)});Handsontable.hooks.add("afterOnCellCornerMouseDown",function(){setupListening(this)});Handsontable.plugins.DragToScroll=DragToScroll},{"./../../eventManager.js":41,"./../../plugins.js":45}],57:[function(require,module,exports){"use strict";var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function Grouping(instance){var groups=[];var item={id:"",level:0,hidden:0,rows:[],cols:[]};var counters={rows:0,cols:0};var levels={rows:0,cols:0};var hiddenRows=[];var hiddenCols=[];var classes={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(direction){return"ht"+direction+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(id){return"htCollapse-"+id},collapseFromLevel:function(direction,level){return"htCollapse"+direction+"FromLevel-"+level},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"};var compare=function(property,orderDirection){return function(item1,item2){return typeof orderDirection==="undefined"||orderDirection==="asc"?item1[property]-item2[property]:item2[property]-item1[property]}};var range=function(from,to){var arr=[];while(from<=to){arr.push(from++)}return arr};var getRangeGroups=function(dataType,from,to){var cells=[],cell={row:null,col:null};if(dataType=="cols"){while(from<=to){cell={row:-1,col:from++};cells.push(cell)}}else{while(from<=to){cell={row:from++,col:-1};cells.push(cell)}}var cellsGroups=getCellsGroups(cells),totalRows=0,totalCols=0;for(var i=0;i<cellsGroups.length;i++){totalRows+=cellsGroups[i].filter(function(item){return item["rows"]}).length;totalCols+=cellsGroups[i].filter(function(item){return item["cols"]}).length}return{total:{rows:totalRows,cols:totalCols},groups:cellsGroups}};var getCellsGroups=function(cells){var _groups=[];for(var i=0;i<cells.length;i++){_groups.push(getCellGroups(cells[i]))}return _groups};var getCellGroups=function(coords,groupLevel,groupType){var row=coords.row,col=coords.col;var tmpRow=row===-1?0:row,tmpCol=col===-1?0:col;var _groups=[];for(var i=0;i<groups.length;i++){var group=groups[i],id=group["id"],level=group["level"],rows=group["rows"]||[],cols=group["cols"]||[];if(_groups.indexOf(id)===-1){if(rows.indexOf(tmpRow)!==-1||cols.indexOf(tmpCol)!==-1){_groups.push(group)}}}if(col===-1){_groups=_groups.concat(getColGroups())}else if(row===-1){_groups=_groups.concat(getRowGroups())}if(groupLevel){_groups=_groups.filter(function(item){return item["level"]===groupLevel})}if(groupType){if(groupType==="cols"){_groups=_groups.filter(function(item){return item["cols"]})}else if(groupType==="rows"){_groups=_groups.filter(function(item){return item["rows"]})}}var tmp=[];return _groups.filter(function(item){if(tmp.indexOf(item.id)===-1){tmp.push(item.id);return item}})};var getGroupById=function(id){for(var i=0,groupsLength=groups.length;i<groupsLength;i++){if(groups[i].id==id){return groups[i]}}return false};var getGroupByRowAndLevel=function(row,level){for(var i=0,groupsLength=groups.length;i<groupsLength;i++){if(groups[i].level==level&&groups[i].rows&&groups[i].rows.indexOf(row)>-1){return groups[i]}}return false};var getGroupByColAndLevel=function(col,level){for(var i=0,groupsLength=groups.length;i<groupsLength;i++){if(groups[i].level==level&&groups[i].cols&&groups[i].cols.indexOf(col)>-1){return groups[i]}}return false};var getColGroups=function(){var result=[];for(var i=0,groupsLength=groups.length;i<groupsLength;i++){if(Array.isArray(groups[i]["cols"])){result.push(groups[i])}}return result};var getColGroupsByLevel=function(level){var result=[];for(var i=0,groupsLength=groups.length;i<groupsLength;i++){if(groups[i]["cols"]&&groups[i]["level"]===level){result.push(groups[i])}}return result};var getRowGroups=function(){var result=[];for(var i=0,groupsLength=groups.length;i<groupsLength;i++){if(Array.isArray(groups[i]["rows"])){result.push(groups[i])}}return result};var getRowGroupsByLevel=function(level){var result=[];for(var i=0,groupsLength=groups.length;i<groupsLength;i++){if(groups[i]["rows"]&&groups[i]["level"]===level){result.push(groups[i])}}return result};var getLastLevelColsInRange=function(rangeGroups){var level=0;if(rangeGroups.length){rangeGroups.forEach(function(items){items=items.filter(function(item){return item["cols"]});if(items.length){var sortedGroup=items.sort(compare("level","desc")),lastLevel=sortedGroup[0].level;if(level<lastLevel){level=lastLevel}}})}return level};var getLastLevelRowsInRange=function(rangeGroups){var level=0;if(rangeGroups.length){rangeGroups.forEach(function(items){items=items.filter(function(item){return item["rows"]});if(items.length){var sortedGroup=items.sort(compare("level","desc")),lastLevel=sortedGroup[0].level;if(level<lastLevel){level=lastLevel}}})}return level};var groupCols=function(from,to){var rangeGroups=getRangeGroups("cols",from,to),lastLevel=getLastLevelColsInRange(rangeGroups.groups);if(lastLevel===levels.cols){levels.cols++}else if(lastLevel>levels.cols){levels.cols=lastLevel+1}if(!counters.cols){counters.cols=getColGroups().length}counters.cols++;groups.push({id:"c"+counters.cols,level:lastLevel+1,cols:range(from,to),hidden:0})};var groupRows=function(from,to){var rangeGroups=getRangeGroups("rows",from,to),lastLevel=getLastLevelRowsInRange(rangeGroups.groups);levels.rows=Math.max(levels.rows,lastLevel+1);if(!counters.rows){counters.rows=getRowGroups().length}counters.rows++;groups.push({id:"r"+counters.rows,level:lastLevel+1,rows:range(from,to),hidden:0})};var showHideGroups=function(hidden,groups){var level;for(var i=0,groupsLength=groups.length;i<groupsLength;i++){groups[i].hidden=hidden;level=groups[i].level;if(!hiddenRows[level]){hiddenRows[level]=[]}if(!hiddenCols[level]){hiddenCols[level]=[]}if(groups[i].rows){for(var j=0,rowsLength=groups[i].rows.length;j<rowsLength;j++){if(hidden>0){hiddenRows[level][groups[i].rows[j]]=true}else{hiddenRows[level][groups[i].rows[j]]=void 0}}}else if(groups[i].cols){for(var j=0,colsLength=groups[i].cols.length;j<colsLength;j++){if(hidden>0){hiddenCols[level][groups[i].cols[j]]=true}else{hiddenCols[level][groups[i].cols[j]]=void 0}}}}};var nextIndexSharesLevel=function(dimension,currentPosition,level,currentGroupId){var nextCellGroupId,levelsByOrder;switch(dimension){case"rows":nextCellGroupId=getGroupByRowAndLevel(currentPosition+1,level).id;levelsByOrder=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":nextCellGroupId=getGroupByColAndLevel(currentPosition+1,level).id;levelsByOrder=Handsontable.Grouping.getGroupLevelsByCols();break}return!!(levelsByOrder[currentPosition+1]&&levelsByOrder[currentPosition+1].indexOf(level)>-1&&currentGroupId==nextCellGroupId)};var previousIndexSharesLevel=function(dimension,currentPosition,level,currentGroupId){var previousCellGroupId,levelsByOrder;switch(dimension){case"rows":previousCellGroupId=getGroupByRowAndLevel(currentPosition-1,level).id;levelsByOrder=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":previousCellGroupId=getGroupByColAndLevel(currentPosition-1,level).id;levelsByOrder=Handsontable.Grouping.getGroupLevelsByCols();break}return!!(levelsByOrder[currentPosition-1]&&levelsByOrder[currentPosition-1].indexOf(level)>-1&&currentGroupId==previousCellGroupId)};var isLastIndexOfTheLine=function(dimension,index,level,currentGroupId){if(index===0){return false}var levelsByOrder,entriesLength,previousSharesLevel=previousIndexSharesLevel(dimension,index,level,currentGroupId),nextSharesLevel=nextIndexSharesLevel(dimension,index,level,currentGroupId),nextIsHidden=false;switch(dimension){case"rows":levelsByOrder=Handsontable.Grouping.getGroupLevelsByRows();entriesLength=instance.countRows();for(var i=0;i<=levels.rows;i++){if(hiddenRows[i]&&hiddenRows[i][index+1]){nextIsHidden=true;break}}break;case"cols":levelsByOrder=Handsontable.Grouping.getGroupLevelsByCols();entriesLength=instance.countCols();for(var i=0;i<=levels.cols;i++){if(hiddenCols[i]&&hiddenCols[i][index+1]){nextIsHidden=true;break}}break}if(previousSharesLevel){if(index==entriesLength-1){return true}else if(!nextSharesLevel||nextSharesLevel&&nextIsHidden){return true}else if(!levelsByOrder[index+1]){return true}}return false};var isLastHidden=function(dataType){var levelAmount;switch(dataType){case"rows":levelAmount=levels.rows;for(var j=0;j<=levelAmount;j++){if(hiddenRows[j]&&hiddenRows[j][instance.countRows()-1]){return true}}break;case"cols":levelAmount=levels.cols;for(var j=0;j<=levelAmount;j++){if(hiddenCols[j]&&hiddenCols[j][instance.countCols()-1]){return true}}break}return false};var isFirstIndexOfTheLine=function(dimension,index,level,currentGroupId){var levelsByOrder,entriesLength,currentGroup=getGroupById(currentGroupId),previousAreHidden=false,arePreviousHidden=function(dimension){var hidden=false,hiddenArr=dimension=="rows"?hiddenRows:hiddenCols;for(var i=0;i<=levels[dimension];i++){tempInd=index;while(currentGroup[dimension].indexOf(tempInd)>-1){hidden=!!(hiddenArr[i]&&hiddenArr[i][tempInd]);tempInd--}if(hidden){break}}return hidden},previousSharesLevel=previousIndexSharesLevel(dimension,index,level,currentGroupId),nextSharesLevel=nextIndexSharesLevel(dimension,index,level,currentGroupId),tempInd;switch(dimension){case"rows":levelsByOrder=Handsontable.Grouping.getGroupLevelsByRows();entriesLength=instance.countRows();previousAreHidden=arePreviousHidden(dimension);break;case"cols":levelsByOrder=Handsontable.Grouping.getGroupLevelsByCols();entriesLength=instance.countCols();previousAreHidden=arePreviousHidden(dimension);break}if(index==entriesLength-1){return false}else if(index===0){if(nextSharesLevel){return true}}else if(!previousSharesLevel||previousSharesLevel&&previousAreHidden){if(nextSharesLevel){return true}}else if(!levelsByOrder[index-1]){if(nextSharesLevel){return true}}return false};var addGroupExpander=function(dataType,index,level,id,elem){var previousIndexGroupId;switch(dataType){case"rows":previousIndexGroupId=getGroupByRowAndLevel(index-1,level).id;break;case"cols":previousIndexGroupId=getGroupByColAndLevel(index-1,level).id;break}if(!previousIndexGroupId){return null}if(index>0){if(previousIndexSharesLevel(dataType,index-1,level,previousIndexGroupId)&&previousIndexGroupId!=id){var expanderButton=document.createElement("DIV");dom.addClass(expanderButton,classes.expandButton);expanderButton.id="htExpand-"+previousIndexGroupId;expanderButton.appendChild(document.createTextNode("+"));expanderButton.setAttribute("data-level",level);expanderButton.setAttribute("data-type",dataType);expanderButton.setAttribute("data-hidden","1");elem.appendChild(expanderButton);return expanderButton}}return null};var isCollapsed=function(currentPosition){var rowGroups=getRowGroups(),colGroups=getColGroups();for(var i=0,rowGroupsCount=rowGroups.length;i<rowGroupsCount;i++){if(rowGroups[i].rows.indexOf(currentPosition.row)>-1&&rowGroups[i].hidden){return true}}if(currentPosition.col===null){return false}for(var i=0,colGroupsCount=colGroups.length;i<colGroupsCount;i++){if(colGroups[i].cols.indexOf(currentPosition.col)>-1&&colGroups[i].hidden){return true}}return false};return{getGroups:function(){return groups},getLevels:function(){return levels},instance:instance,baseSpareRows:instance.getSettings().minSpareRows,baseSpareCols:instance.getSettings().minSpareCols,getRowGroups:getRowGroups,getColGroups:getColGroups,init:function(){var groupsSetting=instance.getSettings().groups;if(groupsSetting){if(Array.isArray(groupsSetting)){Handsontable.Grouping.initGroups(groupsSetting)}}},initGroups:function(initialGroups){var that=this;groups=[];initialGroups.forEach(function(item){var _group=[],isRow=false,isCol=false;if(Array.isArray(item.rows)){_group=item.rows;isRow=true}else if(Array.isArray(item.cols)){_group=item.cols;isCol=true}var from=_group[0],to=_group[_group.length-1];if(isRow){groupRows(from,to)}else if(isCol){groupCols(from,to)}})},resetGroups:function(){
groups=[];counters={rows:0,cols:0};levels={rows:0,cols:0};var allOccurrences;for(var i in classes){if(typeof classes[i]!="function"){allOccurrences=document.querySelectorAll("."+classes[i]);for(var j=0,occurrencesLength=allOccurrences.length;j<occurrencesLength;j++){dom.removeClass(allOccurrences[j],classes[i])}}}var otherClasses=["htGroupColClosest","htGroupCol"];for(var i=0,otherClassesLength=otherClasses.length;i<otherClassesLength;i++){allOccurrences=document.querySelectorAll("."+otherClasses[i]);for(var j=0,occurrencesLength=allOccurrences.length;j<occurrencesLength;j++){dom.removeClass(allOccurrences[j],otherClasses[i])}}},updateGroups:function(){var groupSettings=this.getSettings().groups;Handsontable.Grouping.resetGroups();Handsontable.Grouping.initGroups(groupSettings)},afterGetRowHeader:function(row,TH){var currentRowHidden=false;for(var i=0,levels=hiddenRows.length;i<levels;i++){if(hiddenRows[i]&&hiddenRows[i][row]===true){currentRowHidden=true}}if(currentRowHidden){dom.addClass(TH.parentNode,"hidden")}else if(!currentRowHidden&&dom.hasClass(TH.parentNode,"hidden")){dom.removeClass(TH.parentNode,"hidden")}},afterGetColHeader:function(col,TH){var rowHeaders=this.view.wt.wtSettings.getSetting("rowHeaders").length,thisColgroup=instance.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(col+rowHeaders+1,10)+")");if(thisColgroup.length===0){return}var currentColHidden=false;for(var i=0,levels=hiddenCols.length;i<levels;i++){if(hiddenCols[i]&&hiddenCols[i][col]===true){currentColHidden=true}}if(currentColHidden){for(var i=0,colsAmount=thisColgroup.length;i<colsAmount;i++){dom.addClass(thisColgroup[i],"hidden")}}else if(!currentColHidden&&dom.hasClass(thisColgroup[0],"hidden")){for(var i=0,colsAmount=thisColgroup.length;i<colsAmount;i++){dom.removeClass(thisColgroup[i],"hidden")}}},groupIndicatorsFactory:function(renderersArr,direction){var groupsLevelsList,getCurrentLevel,getCurrentGroupId,dataType,getGroupByIndexAndLevel,headersType,currentHeaderModifier,createLevelTriggers;switch(direction){case"horizontal":groupsLevelsList=Handsontable.Grouping.getGroupLevelsByCols();getCurrentLevel=function(elem){return Array.prototype.indexOf.call(elem.parentNode.parentNode.childNodes,elem.parentNode)+1};getCurrentGroupId=function(col,level){return getGroupByColAndLevel(col,level).id};dataType="cols";getGroupByIndexAndLevel=function(col,level){return getGroupByColAndLevel(col-1,level)};headersType="columnHeaders";currentHeaderModifier=function(headerRenderers){if(headerRenderers.length===1){var oldFn=headerRenderers[0];headerRenderers[0]=function(index,elem,level){if(index<-1){makeGroupIndicatorsForLevel()(index,elem,level)}else{dom.removeClass(elem,classes.groupIndicatorContainer);oldFn(index,elem,level)}}}return function(){return headerRenderers}};createLevelTriggers=true;break;case"vertical":groupsLevelsList=Handsontable.Grouping.getGroupLevelsByRows();getCurrentLevel=function(elem){return dom.index(elem)+1};getCurrentGroupId=function(row,level){return getGroupByRowAndLevel(row,level).id};dataType="rows";getGroupByIndexAndLevel=function(row,level){return getGroupByRowAndLevel(row-1,level)};headersType="rowHeaders";currentHeaderModifier=function(headerRenderers){return headerRenderers};break}var createButton=function(parent){var button=document.createElement("div");parent.appendChild(button);return{button:button,addClass:function(className){dom.addClass(button,className)}}};var makeGroupIndicatorsForLevel=function(){var directionClassname=direction.charAt(0).toUpperCase()+direction.slice(1);return function(index,elem,level){level++;var child,collapseButton;while(child=elem.lastChild){elem.removeChild(child)}dom.addClass(elem,classes.groupIndicatorContainer);var currentGroupId=getCurrentGroupId(index,level);if(index>-1&&(groupsLevelsList[index]&&groupsLevelsList[index].indexOf(level)>-1)){collapseButton=createButton(elem);collapseButton.addClass(classes.groupIndicator(directionClassname));if(isFirstIndexOfTheLine(dataType,index,level,currentGroupId)){collapseButton.addClass(classes.groupStart)}if(isLastIndexOfTheLine(dataType,index,level,currentGroupId)){collapseButton.button.appendChild(document.createTextNode("-"));collapseButton.addClass(classes.collapseButton);collapseButton.button.id=classes.collapseGroupId(currentGroupId);collapseButton.button.setAttribute("data-level",level);collapseButton.button.setAttribute("data-type",dataType)}}if(createLevelTriggers){var rowInd=dom.index(elem.parentNode);if(index===-1||index<-1&&rowInd===Handsontable.Grouping.getLevels().cols+1||rowInd===0&&Handsontable.Grouping.getLevels().cols===0){collapseButton=createButton(elem);collapseButton.addClass(classes.levelTrigger);if(index===-1){collapseButton.button.id=classes.collapseFromLevel("Cols",level);collapseButton.button.appendChild(document.createTextNode(level))}else if(index<-1&&rowInd===Handsontable.Grouping.getLevels().cols+1||rowInd===0&&Handsontable.Grouping.getLevels().cols===0){var colInd=dom.index(elem)+1;collapseButton.button.id=classes.collapseFromLevel("Rows",colInd);collapseButton.button.appendChild(document.createTextNode(colInd))}}}var expanderButton=addGroupExpander(dataType,index,level,currentGroupId,elem);if(index>0){var previousGroupObj=getGroupByIndexAndLevel(index-1,level);if(expanderButton&&previousGroupObj.hidden){dom.addClass(expanderButton,classes.clickable)}}updateHeaderWidths()}};renderersArr=currentHeaderModifier(renderersArr);if(counters[dataType]>0){for(var i=0;i<levels[dataType]+1;i++){if(!Array.isArray(renderersArr)){renderersArr=typeof renderersArr==="function"?renderersArr():new Array(renderersArr)}renderersArr.unshift(makeGroupIndicatorsForLevel())}}},getGroupLevelsByRows:function(){var rowGroups=getRowGroups(),result=[];for(var i=0,groupsLength=rowGroups.length;i<groupsLength;i++){if(rowGroups[i].rows){for(var j=0,groupRowsLength=rowGroups[i].rows.length;j<groupRowsLength;j++){if(!result[rowGroups[i].rows[j]]){result[rowGroups[i].rows[j]]=[]}result[rowGroups[i].rows[j]].push(rowGroups[i].level)}}}return result},getGroupLevelsByCols:function(){var colGroups=getColGroups(),result=[];for(var i=0,groupsLength=colGroups.length;i<groupsLength;i++){if(colGroups[i].cols){for(var j=0,groupColsLength=colGroups[i].cols.length;j<groupColsLength;j++){if(!result[colGroups[i].cols[j]]){result[colGroups[i].cols[j]]=[]}result[colGroups[i].cols[j]].push(colGroups[i].level)}}}return result},toggleGroupVisibility:function(event,coords,TD){if(dom.hasClass(event.target,classes.expandButton)||dom.hasClass(event.target,classes.collapseButton)||dom.hasClass(event.target,classes.levelTrigger)){var element=event.target,elemIdSplit=element.id.split("-");var groups=[],id,level,type,hidden;var prepareGroupData=function(componentElement){if(componentElement){element=componentElement}elemIdSplit=element.id.split("-");id=elemIdSplit[1];level=parseInt(element.getAttribute("data-level"),10);type=element.getAttribute("data-type");hidden=parseInt(element.getAttribute("data-hidden"));if(isNaN(hidden)){hidden=1}else{hidden=hidden?0:1}element.setAttribute("data-hidden",hidden.toString());groups.push(getGroupById(id))};if(element.className.indexOf(classes.levelTrigger)>-1){var groupsInLevel,groupsToExpand=[],groupsToCollapse=[],levelType=element.id.indexOf("Rows")>-1?"rows":"cols";for(var i=1,levelsCount=levels[levelType];i<=levelsCount;i++){groupsInLevel=levelType=="rows"?getRowGroupsByLevel(i):getColGroupsByLevel(i);if(i>=parseInt(elemIdSplit[1],10)){for(var j=0,groupCount=groupsInLevel.length;j<groupCount;j++){groupsToCollapse.push(groupsInLevel[j])}}else{for(var j=0,groupCount=groupsInLevel.length;j<groupCount;j++){groupsToExpand.push(groupsInLevel[j])}}}showHideGroups(true,groupsToCollapse);showHideGroups(false,groupsToExpand)}else{prepareGroupData();showHideGroups(hidden,groups)}type=type||levelType;var lastHidden=isLastHidden(type),typeUppercase=type.charAt(0).toUpperCase()+type.slice(1),spareElements=Handsontable.Grouping["baseSpare"+typeUppercase];if(lastHidden){if(spareElements==0){instance.alter("insert_"+type.slice(0,-1),instance["count"+typeUppercase]());Handsontable.Grouping["dummy"+type.slice(0,-1)]=true}}else{if(spareElements==0){if(Handsontable.Grouping["dummy"+type.slice(0,-1)]){instance.alter("remove_"+type.slice(0,-1),instance["count"+typeUppercase]()-1);Handsontable.Grouping["dummy"+type.slice(0,-1)]=false}}}instance.render();event.stopImmediatePropagation()}},modifySelectionFactory:function(position){var instance=this.instance;var currentlySelected,nextPosition=new WalkontableCellCoords(0,0),nextVisible=function(direction,currentPosition){var updateDelta=0;switch(direction){case"down":while(isCollapsed(currentPosition)){updateDelta++;currentPosition.row+=1}break;case"up":while(isCollapsed(currentPosition)){updateDelta--;currentPosition.row-=1}break;case"right":while(isCollapsed(currentPosition)){updateDelta++;currentPosition.col+=1}break;case"left":while(isCollapsed(currentPosition)){updateDelta--;currentPosition.col-=1}break}return updateDelta},updateDelta=function(delta,nextPosition){if(delta.row>0){if(isCollapsed(nextPosition)){delta.row+=nextVisible("down",nextPosition)}}else if(delta.row<0){if(isCollapsed(nextPosition)){delta.row+=nextVisible("up",nextPosition)}}if(delta.col>0){if(isCollapsed(nextPosition)){delta.col+=nextVisible("right",nextPosition)}}else if(delta.col<0){if(isCollapsed(nextPosition)){delta.col+=nextVisible("left",nextPosition)}}};switch(position){case"start":return function(delta){currentlySelected=instance.getSelected();nextPosition.row=currentlySelected[0]+delta.row;nextPosition.col=currentlySelected[1]+delta.col;updateDelta(delta,nextPosition)};break;case"end":return function(delta){currentlySelected=instance.getSelected();nextPosition.row=currentlySelected[2]+delta.row;nextPosition.col=currentlySelected[3]+delta.col;updateDelta(delta,nextPosition)};break}},modifyRowHeight:function(height,row){if(instance.view.wt.wtTable.rowFilter&&isCollapsed({row:row,col:null})){return 0}},validateGroups:function(){var areRangesOverlapping=function(a,b){if(a[0]<b[0]&&a[1]<b[1]&&b[0]<=a[1]||a[0]>b[0]&&b[1]<a[1]&&a[0]<=b[1]){return true}};var configGroups=instance.getSettings().groups,cols=[],rows=[];for(var i=0,groupsLength=configGroups.length;i<groupsLength;i++){if(configGroups[i].rows){if(configGroups[i].rows.length===1){throw new Error("Grouping error:  Group {"+configGroups[i].rows[0]+"} is invalid. Cannot define single-entry groups.");return false}else if(configGroups[i].rows.length===0){throw new Error("Grouping error:  Cannot define empty groups.");return false}rows.push(configGroups[i].rows);for(var j=0,rowsLength=rows.length;j<rowsLength;j++){if(areRangesOverlapping(configGroups[i].rows,rows[j])){throw new Error("Grouping error:  ranges {"+configGroups[i].rows[0]+", "+configGroups[i].rows[1]+"} and {"+rows[j][0]+", "+rows[j][1]+"} are overlapping.");return false}}}else if(configGroups[i].cols){if(configGroups[i].cols.length===1){throw new Error("Grouping error:  Group {"+configGroups[i].cols[0]+"} is invalid. Cannot define single-entry groups.");return false}else if(configGroups[i].cols.length===0){throw new Error("Grouping error:  Cannot define empty groups.");return false}cols.push(configGroups[i].cols);for(var j=0,colsLength=cols.length;j<colsLength;j++){if(areRangesOverlapping(configGroups[i].cols,cols[j])){throw new Error("Grouping error:  ranges {"+configGroups[i].cols[0]+", "+configGroups[i].cols[1]+"} and {"+cols[j][0]+", "+cols[j][1]+"} are overlapping.");return false}}}}return true},afterGetRowHeaderRenderers:function(arr){Handsontable.Grouping.groupIndicatorsFactory(arr,"vertical")},afterGetColumnHeaderRenderers:function(arr){Handsontable.Grouping.groupIndicatorsFactory(arr,"horizontal")},hookProxy:function(fn,arg){return function(){if(instance.getSettings().groups){return arg?Handsontable.Grouping[fn](arg).apply(this,arguments):Handsontable.Grouping[fn].apply(this,arguments)}else{return void 0}}}}}Grouping.prototype.beforeInit=function(){};var init=function(){var instance=this,groupingSetting=!!instance.getSettings().groups;if(groupingSetting){var headerUpdates={};Handsontable.Grouping=new Grouping(instance);if(!instance.getSettings().rowHeaders){headerUpdates.rowHeaders=true}if(!instance.getSettings().colHeaders){headerUpdates.colHeaders=true}if(headerUpdates.colHeaders||headerUpdates.rowHeaders){instance.updateSettings(headerUpdates)}var groupConfigValid=Handsontable.Grouping.validateGroups();if(!groupConfigValid){return}instance.addHook("beforeInit",Handsontable.Grouping.hookProxy("init"));instance.addHook("afterUpdateSettings",Handsontable.Grouping.hookProxy("updateGroups"));instance.addHook("afterGetColumnHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetColumnHeaderRenderers"));instance.addHook("afterGetRowHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetRowHeaderRenderers"));instance.addHook("afterGetRowHeader",Handsontable.Grouping.hookProxy("afterGetRowHeader"));instance.addHook("afterGetColHeader",Handsontable.Grouping.hookProxy("afterGetColHeader"));instance.addHook("beforeOnCellMouseDown",Handsontable.Grouping.hookProxy("toggleGroupVisibility"));instance.addHook("modifyTransformStart",Handsontable.Grouping.hookProxy("modifySelectionFactory","start"));instance.addHook("modifyTransformEnd",Handsontable.Grouping.hookProxy("modifySelectionFactory","end"));instance.addHook("modifyRowHeight",Handsontable.Grouping.hookProxy("modifyRowHeight"))}};var updateHeaderWidths=function(){var colgroups=document.querySelectorAll("colgroup");for(var i=0,colgroupsLength=colgroups.length;i<colgroupsLength;i++){var rowHeaders=colgroups[i].querySelectorAll("col.rowHeader");if(rowHeaders.length===0){return}for(var j=0,rowHeadersLength=rowHeaders.length+1;j<rowHeadersLength;j++){if(rowHeadersLength==2){return}if(j<Handsontable.Grouping.getLevels().rows+1){if(j==Handsontable.Grouping.getLevels().rows){dom.addClass(rowHeaders[j],"htGroupColClosest")}else{dom.addClass(rowHeaders[j],"htGroupCol")}}}}};Handsontable.hooks.add("beforeInit",init);Handsontable.hooks.add("afterUpdateSettings",function(){if(this.getSettings().groups&&!Handsontable.Grouping){init.call(this,arguments)}else if(!this.getSettings().groups&&Handsontable.Grouping){Handsontable.Grouping.resetGroups();Handsontable.Grouping=void 0}});Handsontable.plugins.Grouping=Grouping},{"./../../dom.js":27,"./../../plugins.js":45}],58:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ManualColumnFreeze:{get:function(){return ManualColumnFreeze}},__esModule:{value:true}});var $___46__46__47__46__46__47_plugins_46_js__;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function ManualColumnFreeze(instance){var fixedColumnsCount=instance.getSettings().fixedColumnsLeft;var init=function(){if(typeof instance.manualColumnPositionsPluginUsages!=="undefined"){instance.manualColumnPositionsPluginUsages.push("manualColumnFreeze")}else{instance.manualColumnPositionsPluginUsages=["manualColumnFreeze"]}bindHooks()};function addContextMenuEntry(defaultOptions){defaultOptions.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var selectedColumn=instance.getSelected()[1];if(selectedColumn>fixedColumnsCount-1){return"Freeze this column"}else{return"Unfreeze this column"}},disabled:function(){var selection=instance.getSelected();return selection[1]!==selection[3]},callback:function(){var selectedColumn=instance.getSelected()[1];if(selectedColumn>fixedColumnsCount-1){freezeColumn(selectedColumn)}else{unfreezeColumn(selectedColumn)}}})}function addFixedColumn(){instance.updateSettings({fixedColumnsLeft:fixedColumnsCount+1});fixedColumnsCount++}function removeFixedColumn(){instance.updateSettings({fixedColumnsLeft:fixedColumnsCount-1});fixedColumnsCount--}function checkPositionData(col){if(!instance.manualColumnPositions||instance.manualColumnPositions.length===0){if(!instance.manualColumnPositions){instance.manualColumnPositions=[]}}if(col){if(!instance.manualColumnPositions[col]){createPositionData(col+1)}}else{createPositionData(instance.countCols())}}function createPositionData(len){if(instance.manualColumnPositions.length<len){for(var i=instance.manualColumnPositions.length;i<len;i++){instance.manualColumnPositions[i]=i}}}function modifyColumnOrder(col,actualCol,returnCol,action){if(returnCol==null){returnCol=col}if(action==="freeze"){instance.manualColumnPositions.splice(fixedColumnsCount,0,instance.manualColumnPositions.splice(actualCol,1)[0])}else if(action==="unfreeze"){instance.manualColumnPositions.splice(returnCol,0,instance.manualColumnPositions.splice(actualCol,1)[0])}}function getBestColumnReturnPosition(col){var i=fixedColumnsCount,j=getModifiedColumnIndex(i),initialCol=getModifiedColumnIndex(col);while(j<initialCol){i++;j=getModifiedColumnIndex(i)}return i-1}function freezeColumn(col){if(col<=fixedColumnsCount-1){return}var modifiedColumn=getModifiedColumnIndex(col)||col;checkPositionData(modifiedColumn);modifyColumnOrder(modifiedColumn,col,null,"freeze");addFixedColumn();instance.view.wt.wtOverlays.leftOverlay.refresh();instance.view.wt.wtOverlays.adjustElementsSize()}function unfreezeColumn(col){if(col>fixedColumnsCount-1){return}var returnCol=getBestColumnReturnPosition(col);var modifiedColumn=getModifiedColumnIndex(col)||col;checkPositionData(modifiedColumn);modifyColumnOrder(modifiedColumn,col,returnCol,"unfreeze");removeFixedColumn();instance.view.wt.wtOverlays.leftOverlay.refresh()}function getModifiedColumnIndex(col){return instance.manualColumnPositions[col]}function onModifyCol(col){if(this.manualColumnPositionsPluginUsages.length>1){return col}return getModifiedColumnIndex(col)}function bindHooks(){instance.addHook("modifyCol",onModifyCol);instance.addHook("afterContextMenuDefaultOptions",addContextMenuEntry)}return{init:init,freezeColumn:freezeColumn,unfreezeColumn:unfreezeColumn,helpers:{addFixedColumn:addFixedColumn,removeFixedColumn:removeFixedColumn,checkPositionData:checkPositionData,modifyColumnOrder:modifyColumnOrder,getBestColumnReturnPosition:getBestColumnReturnPosition}}}var init=function init(){if(!this.getSettings().manualColumnFreeze){return}var mcfPlugin;Handsontable.plugins.manualColumnFreeze=ManualColumnFreeze;this.manualColumnFreeze=new ManualColumnFreeze(this);mcfPlugin=this.manualColumnFreeze;mcfPlugin.init.call(this)};Handsontable.hooks.add("beforeInit",init)},{"./../../plugins.js":45}],59:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ManualColumnMove:{get:function(){return ManualColumnMove}},__esModule:{value:true}});var $___46__46__47__46__46__47_helpers_46_js__,$___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function ManualColumnMove(){var startCol,endCol,startX,startOffset,currentCol,instance,currentTH,handle=document.createElement("DIV"),guide=document.createElement("DIV"),eventManager=eventManagerObject(this);handle.className="manualColumnMover";guide.className="manualColumnMoverGuide";var saveManualColumnPositions=function(){var instance=this;Handsontable.hooks.run(instance,"persistentStateSave","manualColumnPositions",instance.manualColumnPositions)};var loadManualColumnPositions=function(){var instance=this;var storedState={};Handsontable.hooks.run(instance,"persistentStateLoad","manualColumnPositions",storedState);return storedState.value};function setupHandlePosition(TH){instance=this;currentTH=TH;var col=this.view.wt.wtTable.getCoords(TH).col;if(col>=0){currentCol=col;var box=currentTH.getBoundingClientRect();startOffset=box.left;handle.style.top=box.top+"px";handle.style.left=startOffset+"px";instance.rootElement.appendChild(handle)}}function refreshHandlePosition(TH,delta){var box=TH.getBoundingClientRect();var handleWidth=6;if(delta>0){handle.style.left=box.left+box.width-handleWidth+"px"}else{handle.style.left=box.left+"px"}}function setupGuidePosition(){var instance=this;dom.addClass(handle,"active");dom.addClass(guide,"active");var box=currentTH.getBoundingClientRect();guide.style.width=box.width+"px";guide.style.height=instance.view.maximumVisibleElementHeight(0)+"px";guide.style.top=handle.style.top;guide.style.left=startOffset+"px";instance.rootElement.appendChild(guide)}function refreshGuidePosition(diff){guide.style.left=startOffset+diff+"px"}function hideHandleAndGuide(){dom.removeClass(handle,"active");dom.removeClass(guide,"active")}var checkColumnHeader=function(element){if(element.tagName!="BODY"){if(element.parentNode.tagName=="THEAD"){return true}else{element=element.parentNode;return checkColumnHeader(element)}}return false};var getTHFromTargetElement=function(element){if(element.tagName!="TABLE"){if(element.tagName=="TH"){return element}else{return getTHFromTargetElement(element.parentNode)}}return null};var bindEvents=function(){var instance=this;var pressed;eventManager.addEventListener(instance.rootElement,"mouseover",function(e){if(checkColumnHeader(e.target)){var th=getTHFromTargetElement(e.target);if(th){if(pressed){var col=instance.view.wt.wtTable.getCoords(th).col;if(col>=0){endCol=col;refreshHandlePosition(e.target,endCol-startCol)}}else{setupHandlePosition.call(instance,th)}}}});eventManager.addEventListener(instance.rootElement,"mousedown",function(e){if(dom.hasClass(e.target,"manualColumnMover")){startX=helper.pageX(e);setupGuidePosition.call(instance);pressed=instance;startCol=currentCol;endCol=currentCol}});eventManager.addEventListener(window,"mousemove",function(e){if(pressed){refreshGuidePosition(helper.pageX(e)-startX)}});eventManager.addEventListener(window,"mouseup",function(e){if(pressed){hideHandleAndGuide();pressed=false;createPositionData(instance.manualColumnPositions,instance.countCols());instance.manualColumnPositions.splice(endCol,0,instance.manualColumnPositions.splice(startCol,1)[0]);instance.forceFullRender=true;instance.view.render();saveManualColumnPositions.call(instance);Handsontable.hooks.run(instance,"afterColumnMove",startCol,endCol);setupHandlePosition.call(instance,currentTH)}});instance.addHook("afterDestroy",unbindEvents)};var unbindEvents=function(){eventManager.clear()};var createPositionData=function(positionArr,len){if(positionArr.length<len){for(var i=positionArr.length;i<len;i++){positionArr[i]=i}}};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(source){var instance=this;var manualColMoveEnabled=!!this.getSettings().manualColumnMove;if(manualColMoveEnabled){var initialManualColumnPositions=this.getSettings().manualColumnMove;var loadedManualColumnPositions=loadManualColumnPositions.call(instance);if(typeof loadedManualColumnPositions!="undefined"){this.manualColumnPositions=loadedManualColumnPositions}else if(Array.isArray(initialManualColumnPositions)){this.manualColumnPositions=initialManualColumnPositions}else{this.manualColumnPositions=[]}if(source=="afterInit"){if(typeof instance.manualColumnPositionsPluginUsages!="undefined"){instance.manualColumnPositionsPluginUsages.push("manualColumnMove")}else{instance.manualColumnPositionsPluginUsages=["manualColumnMove"]}bindEvents.call(this);if(this.manualColumnPositions.length>0){this.forceFullRender=true;this.render()}}}else{var pluginUsagesIndex=instance.manualColumnPositionsPluginUsages?instance.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1;if(pluginUsagesIndex>-1){unbindEvents.call(this);this.manualColumnPositions=[];instance.manualColumnPositionsPluginUsages[pluginUsagesIndex]=void 0}}};this.modifyCol=function(col){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[col]==="undefined"){createPositionData(this.manualColumnPositions,col+1)}return this.manualColumnPositions[col]}return col};this.afterRemoveCol=function(index,amount){if(!this.getSettings().manualColumnMove){return}var rmindx,colpos=this.manualColumnPositions;rmindx=colpos.splice(index,amount);colpos=colpos.map(function(colpos){var i,newpos=colpos;for(i=0;i<rmindx.length;i++){if(colpos>rmindx[i]){newpos--}}return newpos});this.manualColumnPositions=colpos};this.afterCreateCol=function(index,amount){if(!this.getSettings().manualColumnMove){return}var colpos=this.manualColumnPositions;if(!colpos.length){return}var addindx=[];for(var i=0;i<amount;i++){addindx.push(index+i)}if(index>=colpos.length){colpos.concat(addindx)}else{colpos=colpos.map(function(colpos){return colpos>=index?colpos+amount:colpos});colpos.splice.apply(colpos,[index,0].concat(addindx))}this.manualColumnPositions=colpos}}var htManualColumnMove=new ManualColumnMove;Handsontable.hooks.add("beforeInit",htManualColumnMove.beforeInit);Handsontable.hooks.add("afterInit",function(){htManualColumnMove.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){htManualColumnMove.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyCol",htManualColumnMove.modifyCol);Handsontable.hooks.add("afterRemoveCol",htManualColumnMove.afterRemoveCol);Handsontable.hooks.add("afterCreateCol",htManualColumnMove.afterCreateCol);Handsontable.hooks.register("afterColumnMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],60:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ManualColumnResize:{get:function(){return ManualColumnResize}},__esModule:{value:true}});var $___46__46__47__46__46__47_helpers_46_js__,$___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function ManualColumnResize(){var currentTH,currentCol,currentWidth,instance,newSize,startX,startWidth,startOffset,handle=document.createElement("DIV"),guide=document.createElement("DIV"),eventManager=eventManagerObject(this);handle.className="manualColumnResizer";guide.className="manualColumnResizerGuide";var saveManualColumnWidths=function(){var instance=this;Handsontable.hooks.run(instance,"persistentStateSave","manualColumnWidths",instance.manualColumnWidths)};var loadManualColumnWidths=function(){var instance=this;var storedState={};Handsontable.hooks.run(instance,"persistentStateLoad","manualColumnWidths",storedState);return storedState.value};function setupHandlePosition(TH){instance=this;currentTH=TH;var col=this.view.wt.wtTable.getCoords(TH).col;if(col>=0){currentCol=col;var box=currentTH.getBoundingClientRect();startOffset=box.left-6;startWidth=parseInt(box.width,10);handle.style.top=box.top+"px";handle.style.left=startOffset+startWidth+"px";instance.rootElement.appendChild(handle)}}function refreshHandlePosition(){handle.style.left=startOffset+currentWidth+"px"}function setupGuidePosition(){var instance=this;dom.addClass(handle,"active");dom.addClass(guide,"active");guide.style.top=handle.style.top;guide.style.left=handle.style.left;guide.style.height=instance.view.maximumVisibleElementHeight(0)+"px";instance.rootElement.appendChild(guide)}function refreshGuidePosition(){guide.style.left=handle.style.left}function hideHandleAndGuide(){dom.removeClass(handle,"active");dom.removeClass(guide,"active")}var checkColumnHeader=function(element){if(element.tagName!="BODY"){if(element.parentNode.tagName=="THEAD"){return true}else{element=element.parentNode;return checkColumnHeader(element)}}return false};var getTHFromTargetElement=function(element){if(element.tagName!="TABLE"){if(element.tagName=="TH"){return element}else{return getTHFromTargetElement(element.parentNode)}}return null};var bindEvents=function(){var instance=this;var pressed;var dblclick=0;var autoresizeTimeout=null;eventManager.addEventListener(instance.rootElement,"mouseover",function(e){if(checkColumnHeader(e.target)){var th=getTHFromTargetElement(e.target);if(th){if(!pressed){setupHandlePosition.call(instance,th)}}}});eventManager.addEventListener(instance.rootElement,"mousedown",function(e){if(dom.hasClass(e.target,"manualColumnResizer")){setupGuidePosition.call(instance);pressed=instance;if(autoresizeTimeout==null){autoresizeTimeout=setTimeout(function(){if(dblclick>=2){newSize=instance.determineColumnWidth.call(instance,currentCol);setManualSize(currentCol,newSize);instance.forceFullRender=true;instance.view.render();Handsontable.hooks.run(instance,"afterColumnResize",currentCol,newSize)}dblclick=0;autoresizeTimeout=null},500);instance._registerTimeout(autoresizeTimeout)}dblclick++;startX=helper.pageX(e);newSize=startWidth}});eventManager.addEventListener(window,"mousemove",function(e){if(pressed){currentWidth=startWidth+(helper.pageX(e)-startX);newSize=setManualSize(currentCol,currentWidth);refreshHandlePosition();refreshGuidePosition()}});eventManager.addEventListener(window,"mouseup",function(){if(pressed){hideHandleAndGuide();pressed=false;if(newSize!=startWidth){instance.forceFullRender=true;instance.view.render();instance.view.wt.wtOverlays.adjustElementsSize();saveManualColumnWidths.call(instance);Handsontable.hooks.run(instance,"afterColumnResize",currentCol,newSize)}setupHandlePosition.call(instance,currentTH)}});instance.addHook("afterDestroy",unbindEvents)};var unbindEvents=function(){eventManager.clear()};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(source){var instance=this;var manualColumnWidthEnabled=!!this.getSettings().manualColumnResize;if(manualColumnWidthEnabled){var initialColumnWidths=this.getSettings().manualColumnResize;
var loadedManualColumnWidths=loadManualColumnWidths.call(instance);if(typeof instance.manualColumnWidthsPluginUsages!="undefined"){instance.manualColumnWidthsPluginUsages.push("manualColumnResize")}else{instance.manualColumnWidthsPluginUsages=["manualColumnResize"]}if(typeof loadedManualColumnWidths!="undefined"){this.manualColumnWidths=loadedManualColumnWidths}else if(Array.isArray(initialColumnWidths)){this.manualColumnWidths=initialColumnWidths}else{this.manualColumnWidths=[]}if(source=="afterInit"){bindEvents.call(this);if(this.manualColumnWidths.length>0){this.forceFullRender=true;this.render()}}}else{var pluginUsagesIndex=instance.manualColumnWidthsPluginUsages?instance.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1;if(pluginUsagesIndex>-1){unbindEvents.call(this);this.manualColumnWidths=[]}}};var setManualSize=function(col,width){width=Math.max(width,20);col=Handsontable.hooks.run(instance,"modifyCol",col);instance.manualColumnWidths[col]=width;return width};this.modifyColWidth=function(width,col){col=this.runHooks("modifyCol",col);if(this.getSettings().manualColumnResize&&this.manualColumnWidths[col]){return this.manualColumnWidths[col]}return width}}var htManualColumnResize=new ManualColumnResize;Handsontable.hooks.add("beforeInit",htManualColumnResize.beforeInit);Handsontable.hooks.add("afterInit",function(){htManualColumnResize.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){htManualColumnResize.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyColWidth",htManualColumnResize.modifyColWidth);Handsontable.hooks.register("afterColumnResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],61:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ManualRowMove:{get:function(){return ManualRowMove}},__esModule:{value:true}});var $___46__46__47__46__46__47_helpers_46_js__,$___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function ManualRowMove(){var startRow,endRow,startY,startOffset,currentRow,currentTH,handle=document.createElement("DIV"),guide=document.createElement("DIV"),eventManager=eventManagerObject(this);handle.className="manualRowMover";guide.className="manualRowMoverGuide";var saveManualRowPositions=function(){var instance=this;Handsontable.hooks.run(instance,"persistentStateSave","manualRowPositions",instance.manualRowPositions)};var loadManualRowPositions=function(){var instance=this,storedState={};Handsontable.hooks.run(instance,"persistentStateLoad","manualRowPositions",storedState);return storedState.value};function setupHandlePosition(TH){var instance=this;currentTH=TH;var row=this.view.wt.wtTable.getCoords(TH).row;if(row>=0){currentRow=row;var box=currentTH.getBoundingClientRect();startOffset=box.top;handle.style.top=startOffset+"px";handle.style.left=box.left+"px";instance.rootElement.appendChild(handle)}}function refreshHandlePosition(TH,delta){var box=TH.getBoundingClientRect();var handleHeight=6;if(delta>0){handle.style.top=box.top+box.height-handleHeight+"px"}else{handle.style.top=box.top+"px"}}function setupGuidePosition(){var instance=this;dom.addClass(handle,"active");dom.addClass(guide,"active");var box=currentTH.getBoundingClientRect();guide.style.width=instance.view.maximumVisibleElementWidth(0)+"px";guide.style.height=box.height+"px";guide.style.top=startOffset+"px";guide.style.left=handle.style.left;instance.rootElement.appendChild(guide)}function refreshGuidePosition(diff){guide.style.top=startOffset+diff+"px"}function hideHandleAndGuide(){dom.removeClass(handle,"active");dom.removeClass(guide,"active")}var checkRowHeader=function(element){if(element.tagName!="BODY"){if(element.parentNode.tagName=="TBODY"){return true}else{element=element.parentNode;return checkRowHeader(element)}}return false};var getTHFromTargetElement=function(element){if(element.tagName!="TABLE"){if(element.tagName=="TH"){return element}else{return getTHFromTargetElement(element.parentNode)}}return null};var bindEvents=function(){var instance=this;var pressed;eventManager.addEventListener(instance.rootElement,"mouseover",function(e){if(checkRowHeader(e.target)){var th=getTHFromTargetElement(e.target);if(th){if(pressed){endRow=instance.view.wt.wtTable.getCoords(th).row;refreshHandlePosition(th,endRow-startRow)}else{setupHandlePosition.call(instance,th)}}}});eventManager.addEventListener(instance.rootElement,"mousedown",function(e){if(dom.hasClass(e.target,"manualRowMover")){startY=helper.pageY(e);setupGuidePosition.call(instance);pressed=instance;startRow=currentRow;endRow=currentRow}});eventManager.addEventListener(window,"mousemove",function(e){if(pressed){refreshGuidePosition(helper.pageY(e)-startY)}});eventManager.addEventListener(window,"mouseup",function(e){if(pressed){hideHandleAndGuide();pressed=false;createPositionData(instance.manualRowPositions,instance.countRows());instance.manualRowPositions.splice(endRow,0,instance.manualRowPositions.splice(startRow,1)[0]);instance.forceFullRender=true;instance.view.render();saveManualRowPositions.call(instance);Handsontable.hooks.run(instance,"afterRowMove",startRow,endRow);setupHandlePosition.call(instance,currentTH)}});instance.addHook("afterDestroy",unbindEvents)};var unbindEvents=function(){eventManager.clear()};var createPositionData=function(positionArr,len){if(positionArr.length<len){for(var i=positionArr.length;i<len;i++){positionArr[i]=i}}};this.beforeInit=function(){this.manualRowPositions=[]};this.init=function(source){var instance=this;var manualRowMoveEnabled=!!instance.getSettings().manualRowMove;if(manualRowMoveEnabled){var initialManualRowPositions=instance.getSettings().manualRowMove;var loadedManualRowPostions=loadManualRowPositions.call(instance);if(typeof instance.manualRowPositionsPluginUsages!="undefined"){instance.manualRowPositionsPluginUsages.push("manualColumnMove")}else{instance.manualRowPositionsPluginUsages=["manualColumnMove"]}if(typeof loadedManualRowPostions!="undefined"){this.manualRowPositions=loadedManualRowPostions}else if(Array.isArray(initialManualRowPositions)){this.manualRowPositions=initialManualRowPositions}else{this.manualRowPositions=[]}if(source==="afterInit"){bindEvents.call(this);if(this.manualRowPositions.length>0){instance.forceFullRender=true;instance.render()}}}else{var pluginUsagesIndex=instance.manualRowPositionsPluginUsages?instance.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1;if(pluginUsagesIndex>-1){unbindEvents.call(this);instance.manualRowPositions=[];instance.manualRowPositionsPluginUsages[pluginUsagesIndex]=void 0}}};this.modifyRow=function(row){var instance=this;if(instance.getSettings().manualRowMove){if(typeof instance.manualRowPositions[row]==="undefined"){createPositionData(this.manualRowPositions,row+1)}return instance.manualRowPositions[row]}return row}}var htManualRowMove=new ManualRowMove;Handsontable.hooks.add("beforeInit",htManualRowMove.beforeInit);Handsontable.hooks.add("afterInit",function(){htManualRowMove.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){htManualRowMove.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRow",htManualRowMove.modifyRow);Handsontable.hooks.register("afterRowMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],62:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ManualRowResize:{get:function(){return ManualRowResize}},__esModule:{value:true}});var $___46__46__47__46__46__47_helpers_46_js__,$___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function ManualRowResize(){var currentTH,currentRow,currentHeight,instance,newSize,startY,startHeight,startOffset,handle=document.createElement("DIV"),guide=document.createElement("DIV"),eventManager=eventManagerObject(this);handle.className="manualRowResizer";guide.className="manualRowResizerGuide";var saveManualRowHeights=function(){var instance=this;Handsontable.hooks.run(instance,"persistentStateSave","manualRowHeights",instance.manualRowHeights)};var loadManualRowHeights=function(){var instance=this,storedState={};Handsontable.hooks.run(instance,"persistentStateLoad","manualRowHeights",storedState);return storedState.value};function setupHandlePosition(TH){instance=this;currentTH=TH;var row=this.view.wt.wtTable.getCoords(TH).row;if(row>=0){currentRow=row;var box=currentTH.getBoundingClientRect();startOffset=box.top-6;startHeight=parseInt(box.height,10);handle.style.left=box.left+"px";handle.style.top=startOffset+startHeight+"px";instance.rootElement.appendChild(handle)}}function refreshHandlePosition(){handle.style.top=startOffset+currentHeight+"px"}function setupGuidePosition(){var instance=this;dom.addClass(handle,"active");dom.addClass(guide,"active");guide.style.top=handle.style.top;guide.style.left=handle.style.left;guide.style.width=instance.view.maximumVisibleElementWidth(0)+"px";instance.rootElement.appendChild(guide)}function refreshGuidePosition(){guide.style.top=handle.style.top}function hideHandleAndGuide(){dom.removeClass(handle,"active");dom.removeClass(guide,"active")}var checkRowHeader=function(element){if(element.tagName!="BODY"){if(element.parentNode.tagName=="TBODY"){return true}else{element=element.parentNode;return checkRowHeader(element)}}return false};var getTHFromTargetElement=function(element){if(element.tagName!="TABLE"){if(element.tagName=="TH"){return element}else{return getTHFromTargetElement(element.parentNode)}}return null};var bindEvents=function(){var instance=this;var pressed;var dblclick=0;var autoresizeTimeout=null;eventManager.addEventListener(instance.rootElement,"mouseover",function(e){if(checkRowHeader(e.target)){var th=getTHFromTargetElement(e.target);if(th){if(!pressed){setupHandlePosition.call(instance,th)}}}});eventManager.addEventListener(instance.rootElement,"mousedown",function(e){if(dom.hasClass(e.target,"manualRowResizer")){setupGuidePosition.call(instance);pressed=instance;if(autoresizeTimeout==null){autoresizeTimeout=setTimeout(function(){if(dblclick>=2){setManualSize(currentRow,null);instance.forceFullRender=true;instance.view.render();Handsontable.hooks.run(instance,"afterRowResize",currentRow,newSize)}dblclick=0;autoresizeTimeout=null},500);instance._registerTimeout(autoresizeTimeout)}dblclick++;startY=helper.pageY(e);newSize=startHeight}});eventManager.addEventListener(window,"mousemove",function(e){if(pressed){currentHeight=startHeight+(helper.pageY(e)-startY);newSize=setManualSize(currentRow,currentHeight);refreshHandlePosition();refreshGuidePosition()}});eventManager.addEventListener(window,"mouseup",function(e){if(pressed){hideHandleAndGuide();pressed=false;if(newSize!=startHeight){instance.forceFullRender=true;instance.view.render();saveManualRowHeights.call(instance);Handsontable.hooks.run(instance,"afterRowResize",currentRow,newSize)}setupHandlePosition.call(instance,currentTH)}});instance.addHook("afterDestroy",unbindEvents)};var unbindEvents=function(){eventManager.clear()};this.beforeInit=function(){this.manualRowHeights=[]};this.init=function(source){var instance=this;var manualColumnHeightEnabled=!!this.getSettings().manualRowResize;if(manualColumnHeightEnabled){var initialRowHeights=this.getSettings().manualRowResize;var loadedManualRowHeights=loadManualRowHeights.call(instance);if(typeof instance.manualRowHeightsPluginUsages!="undefined"){instance.manualRowHeightsPluginUsages.push("manualRowResize")}else{instance.manualRowHeightsPluginUsages=["manualRowResize"]}if(typeof loadedManualRowHeights!="undefined"){this.manualRowHeights=loadedManualRowHeights}else if(Array.isArray(initialRowHeights)){this.manualRowHeights=initialRowHeights}else{this.manualRowHeights=[]}if(source==="afterInit"){bindEvents.call(this);if(this.manualRowHeights.length>0){this.forceFullRender=true;this.render()}}else{this.forceFullRender=true;this.render()}}else{var pluginUsagesIndex=instance.manualRowHeightsPluginUsages?instance.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1;if(pluginUsagesIndex>-1){unbindEvents.call(this);this.manualRowHeights=[];instance.manualRowHeightsPluginUsages[pluginUsagesIndex]=void 0}}};var setManualSize=function(row,height){row=Handsontable.hooks.run(instance,"modifyRow",row);instance.manualRowHeights[row]=height;return height};this.modifyRowHeight=function(height,row){if(this.getSettings().manualRowResize){row=this.runHooks("modifyRow",row);if(this.manualRowHeights[row]!==void 0){return this.manualRowHeights[row]}}return height}}var htManualRowResize=new ManualRowResize;Handsontable.hooks.add("beforeInit",htManualRowResize.beforeInit);Handsontable.hooks.add("afterInit",function(){htManualRowResize.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){htManualRowResize.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRowHeight",htManualRowResize.modifyRowHeight);Handsontable.hooks.register("afterRowResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],63:[function(require,module,exports){"use strict";Object.defineProperties(exports,{MergeCells:{get:function(){return MergeCells}},__esModule:{value:true}});var $___46__46__47__46__46__47_plugins_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__,$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table_46_js__;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var WalkontableCellCoords=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./../../3rdparty/walkontable/src/cell/coords.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;var WalkontableCellRange=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__=require("./../../3rdparty/walkontable/src/cell/range.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range_46_js__}).WalkontableCellRange;var WalkontableTable=($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table_46_js__=require("./../../3rdparty/walkontable/src/table.js"),$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table_46_js__&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table_46_js__.__esModule&&$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table_46_js__||{"default":$___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table_46_js__}).WalkontableTable;function CellInfoCollection(){var collection=[];collection.getInfo=function(row,col){for(var i=0,ilen=this.length;i<ilen;i++){if(this[i].row<=row&&this[i].row+this[i].rowspan-1>=row&&this[i].col<=col&&this[i].col+this[i].colspan-1>=col){return this[i]}}};collection.setInfo=function(info){for(var i=0,ilen=this.length;i<ilen;i++){if(this[i].row===info.row&&this[i].col===info.col){this[i]=info;return}}this.push(info)};collection.removeInfo=function(row,col){for(var i=0,ilen=this.length;i<ilen;i++){if(this[i].row===row&&this[i].col===col){this.splice(i,1);break}}};return collection}function MergeCells(mergeCellsSetting){this.mergedCellInfoCollection=new CellInfoCollection;if(Array.isArray(mergeCellsSetting)){for(var i=0,ilen=mergeCellsSetting.length;i<ilen;i++){this.mergedCellInfoCollection.setInfo(mergeCellsSetting[i])}}}MergeCells.prototype.canMergeRange=function(cellRange){return!cellRange.isSingle()};MergeCells.prototype.mergeRange=function(cellRange){if(!this.canMergeRange(cellRange)){return}var topLeft=cellRange.getTopLeftCorner();var bottomRight=cellRange.getBottomRightCorner();var mergeParent={};mergeParent.row=topLeft.row;mergeParent.col=topLeft.col;mergeParent.rowspan=bottomRight.row-topLeft.row+1;mergeParent.colspan=bottomRight.col-topLeft.col+1;this.mergedCellInfoCollection.setInfo(mergeParent)};MergeCells.prototype.mergeOrUnmergeSelection=function(cellRange){var info=this.mergedCellInfoCollection.getInfo(cellRange.from.row,cellRange.from.col);if(info){this.unmergeSelection(cellRange.from)}else{this.mergeSelection(cellRange)}};MergeCells.prototype.mergeSelection=function(cellRange){this.mergeRange(cellRange)};MergeCells.prototype.unmergeSelection=function(cellRange){var info=this.mergedCellInfoCollection.getInfo(cellRange.row,cellRange.col);this.mergedCellInfoCollection.removeInfo(info.row,info.col)};MergeCells.prototype.applySpanProperties=function(TD,row,col){var info=this.mergedCellInfoCollection.getInfo(row,col);if(info){if(info.row===row&&info.col===col){TD.setAttribute("rowspan",info.rowspan);TD.setAttribute("colspan",info.colspan)}else{TD.removeAttribute("rowspan");TD.removeAttribute("colspan");TD.style.display="none"}}else{TD.removeAttribute("rowspan");TD.removeAttribute("colspan")}};MergeCells.prototype.modifyTransform=function(hook,currentSelectedRange,delta){var sameRowspan=function(merged,coords){if(coords.row>=merged.row&&coords.row<=merged.row+merged.rowspan-1){return true}return false},sameColspan=function(merged,coords){if(coords.col>=merged.col&&coords.col<=merged.col+merged.colspan-1){return true}return false},getNextPosition=function(newDelta){return new WalkontableCellCoords(currentSelectedRange.to.row+newDelta.row,currentSelectedRange.to.col+newDelta.col)};var newDelta={row:delta.row,col:delta.col};if(hook=="modifyTransformStart"){if(!this.lastDesiredCoords){this.lastDesiredCoords=new WalkontableCellCoords(null,null)}var currentPosition=new WalkontableCellCoords(currentSelectedRange.highlight.row,currentSelectedRange.highlight.col),mergedParent=this.mergedCellInfoCollection.getInfo(currentPosition.row,currentPosition.col),currentRangeContainsMerge;for(var i=0,mergesLength=this.mergedCellInfoCollection.length;i<mergesLength;i++){var range=this.mergedCellInfoCollection[i];range=new WalkontableCellCoords(range.row+range.rowspan-1,range.col+range.colspan-1);if(currentSelectedRange.includes(range)){currentRangeContainsMerge=true;break}}if(mergedParent){var mergeTopLeft=new WalkontableCellCoords(mergedParent.row,mergedParent.col),mergeBottomRight=new WalkontableCellCoords(mergedParent.row+mergedParent.rowspan-1,mergedParent.col+mergedParent.colspan-1),mergeRange=new WalkontableCellRange(mergeTopLeft,mergeTopLeft,mergeBottomRight);if(!mergeRange.includes(this.lastDesiredCoords)){this.lastDesiredCoords=new WalkontableCellCoords(null,null)}newDelta.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-currentPosition.row:newDelta.row;newDelta.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-currentPosition.col:newDelta.col;if(delta.row>0){newDelta.row=mergedParent.row+mergedParent.rowspan-1-currentPosition.row+delta.row}else if(delta.row<0){newDelta.row=currentPosition.row-mergedParent.row+delta.row}if(delta.col>0){newDelta.col=mergedParent.col+mergedParent.colspan-1-currentPosition.col+delta.col}else if(delta.col<0){newDelta.col=currentPosition.col-mergedParent.col+delta.col}}var nextPosition=new WalkontableCellCoords(currentSelectedRange.highlight.row+newDelta.row,currentSelectedRange.highlight.col+newDelta.col),nextParentIsMerged=this.mergedCellInfoCollection.getInfo(nextPosition.row,nextPosition.col);if(nextParentIsMerged){this.lastDesiredCoords=nextPosition;newDelta={row:nextParentIsMerged.row-currentPosition.row,col:nextParentIsMerged.col-currentPosition.col}}}else if(hook=="modifyTransformEnd"){for(var i=0,mergesLength=this.mergedCellInfoCollection.length;i<mergesLength;i++){var currentMerge=this.mergedCellInfoCollection[i],mergeTopLeft=new WalkontableCellCoords(currentMerge.row,currentMerge.col),mergeBottomRight=new WalkontableCellCoords(currentMerge.row+currentMerge.rowspan-1,currentMerge.col+currentMerge.colspan-1),mergedRange=new WalkontableCellRange(mergeTopLeft,mergeTopLeft,mergeBottomRight),sharedBorders=currentSelectedRange.getBordersSharedWith(mergedRange);if(mergedRange.isEqual(currentSelectedRange)){currentSelectedRange.setDirection("NW-SE")}else if(sharedBorders.length>0){var mergeHighlighted=currentSelectedRange.highlight.isEqual(mergedRange.from);if(sharedBorders.indexOf("top")>-1){if(currentSelectedRange.to.isSouthEastOf(mergedRange.from)&&mergeHighlighted){currentSelectedRange.setDirection("NW-SE")}else if(currentSelectedRange.to.isSouthWestOf(mergedRange.from)&&mergeHighlighted){currentSelectedRange.setDirection("NE-SW")}}else if(sharedBorders.indexOf("bottom")>-1){if(currentSelectedRange.to.isNorthEastOf(mergedRange.from)&&mergeHighlighted){currentSelectedRange.setDirection("SW-NE")}else if(currentSelectedRange.to.isNorthWestOf(mergedRange.from)&&mergeHighlighted){currentSelectedRange.setDirection("SE-NW")}}}var nextPosition=getNextPosition(newDelta),withinRowspan=sameRowspan(currentMerge,nextPosition),withinColspan=sameColspan(currentMerge,nextPosition);if(currentSelectedRange.includesRange(mergedRange)&&(mergedRange.includes(nextPosition)||withinRowspan||withinColspan)){if(withinRowspan){if(newDelta.row<0){newDelta.row-=currentMerge.rowspan-1}else if(newDelta.row>0){newDelta.row+=currentMerge.rowspan-1}}if(withinColspan){if(newDelta.col<0){newDelta.col-=currentMerge.colspan-1}else if(newDelta.col>0){newDelta.col+=currentMerge.colspan-1}}}}}if(newDelta.row!==0){delta.row=newDelta.row}if(newDelta.col!==0){delta.col=newDelta.col}};var beforeInit=function(){var instance=this;var mergeCellsSetting=instance.getSettings().mergeCells;if(mergeCellsSetting){if(!instance.mergeCells){instance.mergeCells=new MergeCells(mergeCellsSetting)}}};var afterInit=function(){var instance=this;if(instance.mergeCells){instance.view.wt.wtTable.getCell=function(coords){if(instance.getSettings().mergeCells){var mergeParent=instance.mergeCells.mergedCellInfoCollection.getInfo(coords.row,coords.col);if(mergeParent){coords=mergeParent}}return WalkontableTable.prototype.getCell.call(this,coords)}}};var onBeforeKeyDown=function(event){if(!this.mergeCells){return}var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(ctrlDown){if(event.keyCode===77){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render();event.stopImmediatePropagation()}}};var addMergeActionsToContextMenu=function(defaultOptions){if(!this.getSettings().mergeCells){return}defaultOptions.items.push(Handsontable.ContextMenu.SEPARATOR);defaultOptions.items.push({key:"mergeCells",name:function(){var sel=this.getSelected();var info=this.mergeCells.mergedCellInfoCollection.getInfo(sel[0],sel[1]);if(info){return"Unmerge cells"}else{return"Merge cells"}},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render()},disabled:function(){return false}})};var afterRenderer=function(TD,row,col,prop,value,cellProperties){if(this.mergeCells){this.mergeCells.applySpanProperties(TD,row,col)}};var modifyTransformFactory=function(hook){return function(delta){var mergeCellsSetting=this.getSettings().mergeCells;if(mergeCellsSetting){var currentSelectedRange=this.getSelectedRange();this.mergeCells.modifyTransform(hook,currentSelectedRange,delta);if(hook==="modifyTransformEnd"){var totalRows=this.countRows();var totalCols=this.countCols();if(currentSelectedRange.from.row<0){currentSelectedRange.from.row=0}else if(currentSelectedRange.from.row>0&&currentSelectedRange.from.row>=totalRows){currentSelectedRange.from.row=currentSelectedRange.from-1}if(currentSelectedRange.from.col<0){currentSelectedRange.from.col=0}else if(currentSelectedRange.from.col>0&&currentSelectedRange.from.col>=totalCols){currentSelectedRange.from.col=totalCols-1}}}}};var beforeSetRangeEnd=function(coords){this.lastDesiredCoords=null;var mergeCellsSetting=this.getSettings().mergeCells;if(mergeCellsSetting){var selRange=this.getSelectedRange();selRange.highlight=new WalkontableCellCoords(selRange.highlight.row,selRange.highlight.col);selRange.to=coords;var rangeExpanded=false;do{rangeExpanded=false;for(var i=0,ilen=this.mergeCells.mergedCellInfoCollection.length;i<ilen;i++){var cellInfo=this.mergeCells.mergedCellInfoCollection[i];var mergedCellTopLeft=new WalkontableCellCoords(cellInfo.row,cellInfo.col);var mergedCellBottomRight=new WalkontableCellCoords(cellInfo.row+cellInfo.rowspan-1,cellInfo.col+cellInfo.colspan-1);var mergedCellRange=new WalkontableCellRange(mergedCellTopLeft,mergedCellTopLeft,mergedCellBottomRight);if(selRange.expandByRange(mergedCellRange)){coords.row=selRange.to.row;coords.col=selRange.to.col;rangeExpanded=true}}}while(rangeExpanded)}};var beforeDrawAreaBorders=function(corners,className){if(className&&className=="area"){var mergeCellsSetting=this.getSettings().mergeCells;if(mergeCellsSetting){var selRange=this.getSelectedRange();var startRange=new WalkontableCellRange(selRange.from,selRange.from,selRange.from);var stopRange=new WalkontableCellRange(selRange.to,selRange.to,selRange.to);for(var i=0,ilen=this.mergeCells.mergedCellInfoCollection.length;i<ilen;i++){var cellInfo=this.mergeCells.mergedCellInfoCollection[i];var mergedCellTopLeft=new WalkontableCellCoords(cellInfo.row,cellInfo.col);var mergedCellBottomRight=new WalkontableCellCoords(cellInfo.row+cellInfo.rowspan-1,cellInfo.col+cellInfo.colspan-1);var mergedCellRange=new WalkontableCellRange(mergedCellTopLeft,mergedCellTopLeft,mergedCellBottomRight);if(startRange.expandByRange(mergedCellRange)){corners[0]=startRange.from.row;corners[1]=startRange.from.col}if(stopRange.expandByRange(mergedCellRange)){corners[2]=stopRange.from.row;corners[3]=stopRange.from.col}}}}};var afterGetCellMeta=function(row,col,cellProperties){var mergeCellsSetting=this.getSettings().mergeCells;if(mergeCellsSetting){var mergeParent=this.mergeCells.mergedCellInfoCollection.getInfo(row,col);if(mergeParent&&(mergeParent.row!=row||mergeParent.col!=col)){cellProperties.copyable=false}}};var afterViewportRowCalculatorOverride=function(calc){var mergeCellsSetting=this.getSettings().mergeCells;if(mergeCellsSetting){var colCount=this.countCols();var mergeParent;for(var c=0;c<colCount;c++){mergeParent=this.mergeCells.mergedCellInfoCollection.getInfo(calc.startRow,c);if(mergeParent){if(mergeParent.row<calc.startRow){calc.startRow=mergeParent.row;return afterViewportRowCalculatorOverride.call(this,calc)}}mergeParent=this.mergeCells.mergedCellInfoCollection.getInfo(calc.endRow,c);if(mergeParent){var mergeEnd=mergeParent.row+mergeParent.rowspan-1;if(mergeEnd>calc.endRow){calc.endRow=mergeEnd;return afterViewportRowCalculatorOverride.call(this,calc)}}}}};var afterViewportColumnCalculatorOverride=function(calc){var mergeCellsSetting=this.getSettings().mergeCells;if(mergeCellsSetting){var rowCount=this.countRows();var mergeParent;for(var r=0;r<rowCount;r++){mergeParent=this.mergeCells.mergedCellInfoCollection.getInfo(r,calc.startColumn);if(mergeParent){if(mergeParent.col<calc.startColumn){calc.startColumn=mergeParent.col;return afterViewportColumnCalculatorOverride.call(this,calc)}}mergeParent=this.mergeCells.mergedCellInfoCollection.getInfo(r,calc.endColumn);if(mergeParent){var mergeEnd=mergeParent.col+mergeParent.colspan-1;if(mergeEnd>calc.endColumn){calc.endColumn=mergeEnd;return afterViewportColumnCalculatorOverride.call(this,calc)}}}}};var isMultipleSelection=function(isMultiple){if(isMultiple&&this.mergeCells){var mergedCells=this.mergeCells.mergedCellInfoCollection,selectionRange=this.getSelectedRange();for(var group in mergedCells){if(selectionRange.highlight.row==mergedCells[group].row&&selectionRange.highlight.col==mergedCells[group].col&&selectionRange.to.row==mergedCells[group].row+mergedCells[group].rowspan-1&&selectionRange.to.col==mergedCells[group].col+mergedCells[group].colspan-1){return false}}}return isMultiple};function afterAutofillApplyValues(select,drag){var mergeCellsSetting=this.getSettings().mergeCells;if(!mergeCellsSetting||this.selection.isMultiple()){return}var info=this.mergeCells.mergedCellInfoCollection.getInfo(select[0],select[1]);if(info){select[0]=info.row;select[1]=info.col;select[2]=info.row+info.rowspan-1;select[3]=info.col+info.colspan-1}}Handsontable.hooks.add("beforeInit",beforeInit);Handsontable.hooks.add("afterInit",afterInit);Handsontable.hooks.add("beforeKeyDown",onBeforeKeyDown);Handsontable.hooks.add("modifyTransformStart",modifyTransformFactory("modifyTransformStart"));Handsontable.hooks.add("modifyTransformEnd",modifyTransformFactory("modifyTransformEnd"));Handsontable.hooks.add("beforeSetRangeEnd",beforeSetRangeEnd);Handsontable.hooks.add("beforeDrawBorders",beforeDrawAreaBorders);Handsontable.hooks.add("afterIsMultipleSelection",isMultipleSelection);Handsontable.hooks.add("afterRenderer",afterRenderer);Handsontable.hooks.add("afterContextMenuDefaultOptions",addMergeActionsToContextMenu);
Handsontable.hooks.add("afterGetCellMeta",afterGetCellMeta);Handsontable.hooks.add("afterViewportRowCalculatorOverride",afterViewportRowCalculatorOverride);Handsontable.hooks.add("afterViewportColumnCalculatorOverride",afterViewportColumnCalculatorOverride);Handsontable.hooks.add("afterAutofillApplyValues",afterAutofillApplyValues);Handsontable.MergeCells=MergeCells},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/table.js":20,"./../../plugins.js":45}],64:[function(require,module,exports){"use strict";Object.defineProperties(exports,{"default":{get:function(){return $__default}},__esModule:{value:true}});var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__95_base_46_js__,$___46__46__47__46__46__47_eventManager_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var BasePlugin=($___46__46__47__95_base_46_js__=require("./../_base.js"),$___46__46__47__95_base_46_js__&&$___46__46__47__95_base_46_js__.__esModule&&$___46__46__47__95_base_46_js__||{"default":$___46__46__47__95_base_46_js__}).default;var eventManagerObject=($___46__46__47__46__46__47_eventManager_46_js__=require("./../../eventManager.js"),$___46__46__47__46__46__47_eventManager_46_js__&&$___46__46__47__46__46__47_eventManager_46_js__.__esModule&&$___46__46__47__46__46__47_eventManager_46_js__||{"default":$___46__46__47__46__46__47_eventManager_46_js__}).eventManager;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var MultipleSelectionHandles=function MultipleSelectionHandles(hotInstance){var $__3=this;$traceurRuntime.superConstructor($MultipleSelectionHandles).call(this,hotInstance);this.dragged=[];this.eventManager=eventManagerObject(this.hot);this.bindTouchEvents();this.hot.addHook("afterInit",function(){return $__3.init()})};var $MultipleSelectionHandles=MultipleSelectionHandles;$traceurRuntime.createClass(MultipleSelectionHandles,{init:function(){this.lastSetCell=null;Handsontable.plugins.multipleSelectionHandles=new $MultipleSelectionHandles(this.hot)},bindTouchEvents:function(){var _this=this;function removeFromDragged(query){if(_this.dragged.length===1){_this.dragged.splice(0,_this.dragged.length);return true}var entryPosition=_this.dragged.indexOf(query);if(entryPosition==-1){return false}else if(entryPosition===0){_this.dragged=_this.dragged.slice(0,1)}else if(entryPosition==1){_this.dragged=_this.dragged.slice(-1)}}this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(event){var selectedRange;if(dom.hasClass(event.target,"topLeftSelectionHandle-HitArea")){selectedRange=_this.hot.getSelectedRange();_this.dragged.push("topLeft");_this.touchStartRange={width:selectedRange.getWidth(),height:selectedRange.getHeight(),direction:selectedRange.getDirection()};event.preventDefault();return false}else if(dom.hasClass(event.target,"bottomRightSelectionHandle-HitArea")){selectedRange=_this.hot.getSelectedRange();_this.dragged.push("bottomRight");_this.touchStartRange={width:selectedRange.getWidth(),height:selectedRange.getHeight(),direction:selectedRange.getDirection()};event.preventDefault();return false}});this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(event){if(dom.hasClass(event.target,"topLeftSelectionHandle-HitArea")){removeFromDragged.call(_this,"topLeft");_this.touchStartRange=void 0;event.preventDefault();return false}else if(dom.hasClass(event.target,"bottomRightSelectionHandle-HitArea")){removeFromDragged.call(_this,"bottomRight");_this.touchStartRange=void 0;event.preventDefault();return false}});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(event){var scrollTop=dom.getWindowScrollTop(),scrollLeft=dom.getWindowScrollLeft(),endTarget,targetCoords,selectedRange,rangeWidth,rangeHeight,rangeDirection,newRangeCoords;if(_this.dragged.length===0){return}endTarget=document.elementFromPoint(event.touches[0].screenX-scrollLeft,event.touches[0].screenY-scrollTop);if(!endTarget||endTarget===_this.lastSetCell){return}if(endTarget.nodeName=="TD"||endTarget.nodeName=="TH"){targetCoords=_this.hot.getCoords(endTarget);if(targetCoords.col==-1){targetCoords.col=0}selectedRange=_this.hot.getSelectedRange();rangeWidth=selectedRange.getWidth();rangeHeight=selectedRange.getHeight();rangeDirection=selectedRange.getDirection();if(rangeWidth==1&&rangeHeight==1){_this.hot.selection.setRangeEnd(targetCoords)}newRangeCoords=_this.getCurrentRangeCoords(selectedRange,targetCoords,_this.touchStartRange.direction,rangeDirection,_this.dragged[0]);if(newRangeCoords.start!==null){_this.hot.selection.setRangeStart(newRangeCoords.start)}_this.hot.selection.setRangeEnd(newRangeCoords.end);_this.lastSetCell=endTarget}event.preventDefault()})},getCurrentRangeCoords:function(selectedRange,currentTouch,touchStartDirection,currentDirection,draggedHandle){var topLeftCorner=selectedRange.getTopLeftCorner(),bottomRightCorner=selectedRange.getBottomRightCorner(),bottomLeftCorner=selectedRange.getBottomLeftCorner(),topRightCorner=selectedRange.getTopRightCorner();var newCoords={start:null,end:null};switch(touchStartDirection){case"NE-SW":switch(currentDirection){case"NE-SW":case"NW-SE":if(draggedHandle=="topLeft"){newCoords={start:new WalkontableCellCoords(currentTouch.row,selectedRange.highlight.col),end:new WalkontableCellCoords(bottomLeftCorner.row,currentTouch.col)}}else{newCoords={start:new WalkontableCellCoords(selectedRange.highlight.row,currentTouch.col),end:new WalkontableCellCoords(currentTouch.row,topLeftCorner.col)}}break;case"SE-NW":if(draggedHandle=="bottomRight"){newCoords={start:new WalkontableCellCoords(bottomRightCorner.row,currentTouch.col),end:new WalkontableCellCoords(currentTouch.row,topLeftCorner.col)}}break}break;case"NW-SE":switch(currentDirection){case"NE-SW":if(draggedHandle=="topLeft"){newCoords={start:currentTouch,end:bottomLeftCorner}}else{newCoords.end=currentTouch}break;case"NW-SE":if(draggedHandle=="topLeft"){newCoords={start:currentTouch,end:bottomRightCorner}}else{newCoords.end=currentTouch}break;case"SE-NW":if(draggedHandle=="topLeft"){newCoords={start:currentTouch,end:topLeftCorner}}else{newCoords.end=currentTouch}break;case"SW-NE":if(draggedHandle=="topLeft"){newCoords={start:currentTouch,end:topRightCorner}}else{newCoords.end=currentTouch}break}break;case"SW-NE":switch(currentDirection){case"NW-SE":if(draggedHandle=="bottomRight"){newCoords={start:new WalkontableCellCoords(currentTouch.row,topLeftCorner.col),end:new WalkontableCellCoords(bottomLeftCorner.row,currentTouch.col)}}else{newCoords={start:new WalkontableCellCoords(topLeftCorner.row,currentTouch.col),end:new WalkontableCellCoords(currentTouch.row,bottomRightCorner.col)}}break;case"SW-NE":if(draggedHandle=="topLeft"){newCoords={start:new WalkontableCellCoords(selectedRange.highlight.row,currentTouch.col),end:new WalkontableCellCoords(currentTouch.row,bottomRightCorner.col)}}else{newCoords={start:new WalkontableCellCoords(currentTouch.row,topLeftCorner.col),end:new WalkontableCellCoords(topLeftCorner.row,currentTouch.col)}}break;case"SE-NW":if(draggedHandle=="bottomRight"){newCoords={start:new WalkontableCellCoords(currentTouch.row,topRightCorner.col),end:new WalkontableCellCoords(topLeftCorner.row,currentTouch.col)}}else if(draggedHandle=="topLeft"){newCoords={start:bottomLeftCorner,end:currentTouch}}break}break;case"SE-NW":switch(currentDirection){case"NW-SE":case"NE-SW":case"SW-NE":if(draggedHandle=="topLeft"){newCoords.end=currentTouch}break;case"SE-NW":if(draggedHandle=="topLeft"){newCoords.end=currentTouch}else{newCoords={start:currentTouch,end:topLeftCorner}}break}break}return newCoords},isDragged:function(){return this.dragged.length>0}},{},BasePlugin);var $__default=MultipleSelectionHandles;registerPlugin("multipleSelectionHandles",MultipleSelectionHandles)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],65:[function(require,module,exports){"use strict";Object.defineProperties(exports,{ObserveChanges:{get:function(){return ObserveChanges}},__esModule:{value:true}});var $___46__46__47__46__46__47_plugins_46_js__,$__jsonpatch__;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var jsonpatch=($__jsonpatch__=require("jsonpatch"),$__jsonpatch__&&$__jsonpatch__.__esModule&&$__jsonpatch__||{"default":$__jsonpatch__}).default;function ObserveChanges(){}Handsontable.hooks.add("afterLoadData",init);Handsontable.hooks.add("afterUpdateSettings",init);Handsontable.hooks.register("afterChangesObserved");function init(){var instance=this;var pluginEnabled=instance.getSettings().observeChanges;if(pluginEnabled){if(instance.observer){destroy.call(instance)}createObserver.call(instance);bindEvents.call(instance)}else if(!pluginEnabled){destroy.call(instance)}}function createObserver(){var instance=this;instance.observeChangesActive=true;instance.pauseObservingChanges=function(){instance.observeChangesActive=false};instance.resumeObservingChanges=function(){instance.observeChangesActive=true};instance.observedData=instance.getData();instance.observer=jsonpatch.observe(instance.observedData,function(patches){if(instance.observeChangesActive){runHookForOperation.call(instance,patches);instance.render()}instance.runHooks("afterChangesObserved")})}function runHookForOperation(rawPatches){var instance=this;var patches=cleanPatches(rawPatches);for(var i=0,len=patches.length;i<len;i++){var patch=patches[i];var parsedPath=parsePath(patch.path);switch(patch.op){case"add":if(isNaN(parsedPath.col)){instance.runHooks("afterCreateRow",parsedPath.row)}else{instance.runHooks("afterCreateCol",parsedPath.col)}break;case"remove":if(isNaN(parsedPath.col)){instance.runHooks("afterRemoveRow",parsedPath.row,1)}else{instance.runHooks("afterRemoveCol",parsedPath.col,1)}break;case"replace":instance.runHooks("afterChange",[parsedPath.row,parsedPath.col,null,patch.value],"external");break}}function cleanPatches(rawPatches){var patches;patches=removeLengthRelatedPatches(rawPatches);patches=removeMultipleAddOrRemoveColPatches(patches);return patches}function removeMultipleAddOrRemoveColPatches(rawPatches){var newOrRemovedColumns=[];return rawPatches.filter(function(patch){var parsedPath=parsePath(patch.path);if(["add","remove"].indexOf(patch.op)!=-1&&!isNaN(parsedPath.col)){if(newOrRemovedColumns.indexOf(parsedPath.col)!=-1){return false}else{newOrRemovedColumns.push(parsedPath.col)}}return true})}function removeLengthRelatedPatches(rawPatches){return rawPatches.filter(function(patch){return!/[/]length/gi.test(patch.path)})}function parsePath(path){var match=path.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(match[1],10),col:/^\d*$/.test(match[2])?parseInt(match[2],10):match[2]}}}function destroy(){var instance=this;if(instance.observer){destroyObserver.call(instance);unbindEvents.call(instance)}}function destroyObserver(){var instance=this;jsonpatch.unobserve(instance.observedData,instance.observer);delete instance.observeChangesActive;delete instance.pauseObservingChanges;delete instance.resumeObservingChanges}function bindEvents(){var instance=this;instance.addHook("afterDestroy",destroy);instance.addHook("afterCreateRow",afterTableAlter);instance.addHook("afterRemoveRow",afterTableAlter);instance.addHook("afterCreateCol",afterTableAlter);instance.addHook("afterRemoveCol",afterTableAlter);instance.addHook("afterChange",function(changes,source){if(source!="loadData"){afterTableAlter.call(this)}})}function unbindEvents(){var instance=this;instance.removeHook("afterDestroy",destroy);instance.removeHook("afterCreateRow",afterTableAlter);instance.removeHook("afterRemoveRow",afterTableAlter);instance.removeHook("afterCreateCol",afterTableAlter);instance.removeHook("afterRemoveCol",afterTableAlter);instance.removeHook("afterChange",afterTableAlter)}function afterTableAlter(){var instance=this;instance.pauseObservingChanges();instance.addHookOnce("afterChangesObserved",function(){instance.resumeObservingChanges()})}},{"./../../plugins.js":45,jsonpatch:"jsonpatch"}],66:[function(require,module,exports){"use strict";Object.defineProperties(exports,{HandsontablePersistentState:{get:function(){return HandsontablePersistentState}},__esModule:{value:true}});var $___46__46__47__46__46__47_plugins_46_js__;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;function Storage(prefix){var savedKeys;var saveSavedKeys=function(){window.localStorage[prefix+"__"+"persistentStateKeys"]=JSON.stringify(savedKeys)};var loadSavedKeys=function(){var keysJSON=window.localStorage[prefix+"__"+"persistentStateKeys"];var keys=typeof keysJSON=="string"?JSON.parse(keysJSON):void 0;savedKeys=keys?keys:[]};var clearSavedKeys=function(){savedKeys=[];saveSavedKeys()};loadSavedKeys();this.saveValue=function(key,value){window.localStorage[prefix+"_"+key]=JSON.stringify(value);if(savedKeys.indexOf(key)==-1){savedKeys.push(key);saveSavedKeys()}};this.loadValue=function(key,defaultValue){key=typeof key!="undefined"?key:defaultValue;var value=window.localStorage[prefix+"_"+key];return typeof value=="undefined"?void 0:JSON.parse(value)};this.reset=function(key){window.localStorage.removeItem(prefix+"_"+key)};this.resetAll=function(){for(var index=0;index<savedKeys.length;index++){window.localStorage.removeItem(prefix+"_"+savedKeys[index])}clearSavedKeys()}}function HandsontablePersistentState(){var plugin=this;this.init=function(){var instance=this,pluginSettings=instance.getSettings().persistentState;plugin.enabled=!!pluginSettings;if(!plugin.enabled){removeHooks.call(instance);return}if(!instance.storage){instance.storage=new Storage(instance.rootElement.id)}instance.resetState=plugin.resetValue;addHooks.call(instance)};this.saveValue=function(key,value){var instance=this;instance.storage.saveValue(key,value)};this.loadValue=function(key,saveTo){var instance=this;saveTo.value=instance.storage.loadValue(key)};this.resetValue=function(key){var instance=this;if(typeof key!="undefined"){instance.storage.reset(key)}else{instance.storage.resetAll()}};var hooks={persistentStateSave:plugin.saveValue,persistentStateLoad:plugin.loadValue,persistentStateReset:plugin.resetValue};for(var hookName in hooks){if(hooks.hasOwnProperty(hookName)){Handsontable.hooks.register(hookName)}}function addHooks(){var instance=this;for(var hookName in hooks){if(hooks.hasOwnProperty(hookName)){instance.addHook(hookName,hooks[hookName])}}}function removeHooks(){var instance=this;for(var hookName in hooks){if(hooks.hasOwnProperty(hookName)){instance.removeHook(hookName,hooks[hookName])}}}}var htPersistentState=new HandsontablePersistentState;Handsontable.hooks.add("beforeInit",htPersistentState.init);Handsontable.hooks.add("afterUpdateSettings",htPersistentState.init)},{"./../../plugins.js":45}],67:[function(require,module,exports){"use strict";var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__46__46__47_renderers_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var $__0=($___46__46__47__46__46__47_renderers_46_js__=require("./../../renderers.js"),$___46__46__47__46__46__47_renderers_46_js__&&$___46__46__47__46__46__47_renderers_46_js__.__esModule&&$___46__46__47__46__46__47_renderers_46_js__||{"default":$___46__46__47__46__46__47_renderers_46_js__}),registerRenderer=$__0.registerRenderer,getRenderer=$__0.getRenderer;Handsontable.Search=function Search(instance){this.query=function(queryStr,callback,queryMethod){var rowCount=instance.countRows();var colCount=instance.countCols();var queryResult=[];if(!callback){callback=Handsontable.Search.global.getDefaultCallback()}if(!queryMethod){queryMethod=Handsontable.Search.global.getDefaultQueryMethod()}for(var rowIndex=0;rowIndex<rowCount;rowIndex++){for(var colIndex=0;colIndex<colCount;colIndex++){var cellData=instance.getDataAtCell(rowIndex,colIndex);var cellProperties=instance.getCellMeta(rowIndex,colIndex);var cellCallback=cellProperties.search.callback||callback;var cellQueryMethod=cellProperties.search.queryMethod||queryMethod;var testResult=cellQueryMethod(queryStr,cellData);if(testResult){var singleResult={row:rowIndex,col:colIndex,data:cellData};queryResult.push(singleResult)}if(cellCallback){cellCallback(instance,rowIndex,colIndex,cellData,testResult)}}}return queryResult}};Handsontable.Search.DEFAULT_CALLBACK=function(instance,row,col,data,testResult){instance.getCellMeta(row,col).isSearchResult=testResult};Handsontable.Search.DEFAULT_QUERY_METHOD=function(query,value){if(typeof query=="undefined"||query==null||!query.toLowerCase||query.length===0){return false}if(typeof value=="undefined"||value==null){return false}return value.toString().toLowerCase().indexOf(query.toLowerCase())!=-1};Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";Handsontable.Search.global=function(){var defaultCallback=Handsontable.Search.DEFAULT_CALLBACK;var defaultQueryMethod=Handsontable.Search.DEFAULT_QUERY_METHOD;var defaultSearchResultClass=Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return defaultCallback},setDefaultCallback:function(newDefaultCallback){defaultCallback=newDefaultCallback},getDefaultQueryMethod:function(){return defaultQueryMethod},setDefaultQueryMethod:function(newDefaultQueryMethod){defaultQueryMethod=newDefaultQueryMethod},getDefaultSearchResultClass:function(){return defaultSearchResultClass},setDefaultSearchResultClass:function(newSearchResultClass){defaultSearchResultClass=newSearchResultClass}}}();Handsontable.SearchCellDecorator=function(instance,TD,row,col,prop,value,cellProperties){var searchResultClass=cellProperties.search!==null&&typeof cellProperties.search=="object"&&cellProperties.search.searchResultClass||Handsontable.Search.global.getDefaultSearchResultClass();if(cellProperties.isSearchResult){dom.addClass(TD,searchResultClass)}else{dom.removeClass(TD,searchResultClass)}};var originalBaseRenderer=getRenderer("base");registerRenderer("base",function(instance,TD,row,col,prop,value,cellProperties){originalBaseRenderer.apply(this,arguments);Handsontable.SearchCellDecorator.apply(this,arguments)});function init(){var instance=this;var pluginEnabled=!!instance.getSettings().search;if(pluginEnabled){instance.search=new Handsontable.Search(instance)}else{delete instance.search}}Handsontable.hooks.add("afterInit",init);Handsontable.hooks.add("afterUpdateSettings",init)},{"./../../dom.js":27,"./../../renderers.js":70}],68:[function(require,module,exports){"use strict";Object.defineProperties(exports,{TouchScroll:{get:function(){return TouchScroll}},__esModule:{value:true}});var $___46__46__47__46__46__47_dom_46_js__,$___46__46__47__95_base_46_js__,$___46__46__47__46__46__47_plugins_46_js__;var dom=($___46__46__47__46__46__47_dom_46_js__=require("./../../dom.js"),$___46__46__47__46__46__47_dom_46_js__&&$___46__46__47__46__46__47_dom_46_js__.__esModule&&$___46__46__47__46__46__47_dom_46_js__||{"default":$___46__46__47__46__46__47_dom_46_js__});var BasePlugin=($___46__46__47__95_base_46_js__=require("./../_base.js"),$___46__46__47__95_base_46_js__&&$___46__46__47__95_base_46_js__.__esModule&&$___46__46__47__95_base_46_js__||{"default":$___46__46__47__95_base_46_js__}).default;var registerPlugin=($___46__46__47__46__46__47_plugins_46_js__=require("./../../plugins.js"),$___46__46__47__46__46__47_plugins_46_js__&&$___46__46__47__46__46__47_plugins_46_js__.__esModule&&$___46__46__47__46__46__47_plugins_46_js__||{"default":$___46__46__47__46__46__47_plugins_46_js__}).registerPlugin;var TouchScroll=function TouchScroll(hotInstance){var $__2=this;$traceurRuntime.superConstructor($TouchScroll).call(this,hotInstance);this.hot.addHook("afterInit",function(){return $__2.init()});this.hot.addHook("afterUpdateSettings",function(){return $__2.onAfterUpdateSettings()});this.scrollbars=[];this.clones=[]};var $TouchScroll=TouchScroll;$traceurRuntime.createClass(TouchScroll,{init:function(){this.registerEvents();this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var _this=this;this.hot.addHookOnce("afterRender",function(){var wtOverlays=_this.hot.view.wt.wtOverlays;_this.scrollbars=[];_this.scrollbars.push(wtOverlays.topOverlay);_this.scrollbars.push(wtOverlays.leftOverlay);if(wtOverlays.topLeftCornerOverlay){_this.scrollbars.push(wtOverlays.topLeftCornerOverlay)}_this.clones=[];if(wtOverlays.topOverlay.needFullRender){_this.clones.push(wtOverlays.topOverlay.clone.wtTable.holder.parentNode)}if(wtOverlays.leftOverlay.needFullRender){_this.clones.push(wtOverlays.leftOverlay.clone.wtTable.holder.parentNode)}if(wtOverlays.topLeftCornerOverlay){_this.clones.push(wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}})},registerEvents:function(){var $__2=this;this.hot.addHook("beforeTouchScroll",function(){return $__2.onBeforeTouchScroll()});this.hot.addHook("afterMomentumScroll",function(){return $__2.onAfterMomentumScroll()})},onBeforeTouchScroll:function(){Handsontable.freezeOverlays=true;for(var i=0,cloneCount=this.clones.length;i<cloneCount;i++){dom.addClass(this.clones[i],"hide-tween")}},onAfterMomentumScroll:function(){Handsontable.freezeOverlays=false;var _that=this;for(var i=0,cloneCount=this.clones.length;i<cloneCount;i++){dom.removeClass(this.clones[i],"hide-tween")}for(var i$__4=0,cloneCount$__5=this.clones.length;i$__4<cloneCount$__5;i$__4++){dom.addClass(this.clones[i$__4],"show-tween")}setTimeout(function(){for(var i=0,cloneCount=_that.clones.length;i<cloneCount;i++){dom.removeClass(_that.clones[i],"show-tween")}},400);for(var i$__6=0,cloneCount$__7=this.scrollbars.length;i$__6<cloneCount$__7;i$__6++){this.scrollbars[i$__6].refresh();this.scrollbars[i$__6].resetFixedPosition()}this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},BasePlugin);registerPlugin("touchScroll",TouchScroll)},{"./../../dom.js":27,"./../../plugins.js":45,"./../_base.js":46}],69:[function(require,module,exports){"use strict";var $___46__46__47__46__46__47_helpers_46_js__;var helper=($___46__46__47__46__46__47_helpers_46_js__=require("./../../helpers.js"),$___46__46__47__46__46__47_helpers_46_js__&&$___46__46__47__46__46__47_helpers_46_js__.__esModule&&$___46__46__47__46__46__47_helpers_46_js__||{"default":$___46__46__47__46__46__47_helpers_46_js__});Handsontable.UndoRedo=function(instance){var plugin=this;this.instance=instance;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;instance.addHook("afterChange",function(changes,origin){if(changes){var action=new Handsontable.UndoRedo.ChangeAction(changes);plugin.done(action)}});instance.addHook("afterCreateRow",function(index,amount,createdAutomatically){if(createdAutomatically){return}var action=new Handsontable.UndoRedo.CreateRowAction(index,amount);plugin.done(action)});instance.addHook("beforeRemoveRow",function(index,amount){var originalData=plugin.instance.getData();index=(originalData.length+index)%originalData.length;var removedData=originalData.slice(index,index+amount);var action=new Handsontable.UndoRedo.RemoveRowAction(index,removedData);plugin.done(action)});instance.addHook("afterCreateCol",function(index,amount,createdAutomatically){if(createdAutomatically){return}var action=new Handsontable.UndoRedo.CreateColumnAction(index,amount);plugin.done(action)});instance.addHook("beforeRemoveCol",function(index,amount){var originalData=plugin.instance.getData();index=(plugin.instance.countCols()+index)%plugin.instance.countCols();var removedData=[];for(var i=0,len=originalData.length;i<len;i++){removedData[i]=originalData[i].slice(index,index+amount)}var headers;if(Array.isArray(instance.getSettings().colHeaders)){headers=instance.getSettings().colHeaders.slice(index,index+removedData.length)}var action=new Handsontable.UndoRedo.RemoveColumnAction(index,removedData,headers);plugin.done(action)});instance.addHook("beforeCellAlignment",function(stateBefore,range,type,alignment){var action=new Handsontable.UndoRedo.CellAlignmentAction(stateBefore,range,type,alignment);plugin.done(action)})};Handsontable.UndoRedo.prototype.done=function(action){if(!this.ignoreNewActions){this.doneActions.push(action);this.undoneActions.length=0}};Handsontable.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var action=this.doneActions.pop();this.ignoreNewActions=true;var that=this;action.undo(this.instance,function(){that.ignoreNewActions=false;that.undoneActions.push(action)})}};Handsontable.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var action=this.undoneActions.pop();this.ignoreNewActions=true;var that=this;action.redo(this.instance,function(){that.ignoreNewActions=false;that.doneActions.push(action)})}};Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};Handsontable.UndoRedo.Action=function(){};Handsontable.UndoRedo.Action.prototype.undo=function(){};Handsontable.UndoRedo.Action.prototype.redo=function(){};Handsontable.UndoRedo.ChangeAction=function(changes){this.changes=changes};helper.inherit(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.ChangeAction.prototype.undo=function(instance,undoneCallback){var data=helper.deepClone(this.changes),emptyRowsAtTheEnd=instance.countEmptyRows(true),emptyColsAtTheEnd=instance.countEmptyCols(true);for(var i=0,len=data.length;i<len;i++){data[i].splice(3,1)}instance.addHookOnce("afterChange",undoneCallback);instance.setDataAtRowProp(data,null,null,"undo");for(var i=0,len=data.length;i<len;i++){if(instance.getSettings().minSpareRows&&data[i][0]+1+instance.getSettings().minSpareRows===instance.countRows()&&emptyRowsAtTheEnd==instance.getSettings().minSpareRows){instance.alter("remove_row",parseInt(data[i][0]+1,10),instance.getSettings().minSpareRows);instance.undoRedo.doneActions.pop()}if(instance.getSettings().minSpareCols&&data[i][1]+1+instance.getSettings().minSpareCols===instance.countCols()&&emptyColsAtTheEnd==instance.getSettings().minSpareCols){instance.alter("remove_col",parseInt(data[i][1]+1,10),instance.getSettings().minSpareCols);instance.undoRedo.doneActions.pop()}}};Handsontable.UndoRedo.ChangeAction.prototype.redo=function(instance,onFinishCallback){var data=helper.deepClone(this.changes);for(var i=0,len=data.length;i<len;i++){data[i].splice(2,1)}instance.addHookOnce("afterChange",onFinishCallback);instance.setDataAtRowProp(data,null,null,"redo")};Handsontable.UndoRedo.CreateRowAction=function(index,amount){this.index=index;this.amount=amount};helper.inherit(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(instance,undoneCallback){var rowCount=instance.countRows(),minSpareRows=instance.getSettings().minSpareRows;if(this.index>=rowCount&&this.index-minSpareRows<rowCount){this.index-=minSpareRows}instance.addHookOnce("afterRemoveRow",undoneCallback);instance.alter("remove_row",this.index,this.amount)};Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce("afterCreateRow",redoneCallback);instance.alter("insert_row",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveRowAction=function(index,data){this.index=index;this.data=data};helper.inherit(Handsontable.UndoRedo.RemoveRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(instance,undoneCallback){var spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.data);Array.prototype.splice.apply(instance.getData(),spliceArgs);instance.addHookOnce("afterRender",undoneCallback);instance.render()};Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce("afterRemoveRow",redoneCallback);instance.alter("remove_row",this.index,this.data.length)};Handsontable.UndoRedo.CreateColumnAction=function(index,amount){this.index=index;this.amount=amount};helper.inherit(Handsontable.UndoRedo.CreateColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(instance,undoneCallback){instance.addHookOnce("afterRemoveCol",undoneCallback);instance.alter("remove_col",this.index,this.amount)};Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce("afterCreateCol",redoneCallback);instance.alter("insert_col",this.index+1,this.amount)};Handsontable.UndoRedo.CellAlignmentAction=function(stateBefore,range,type,alignment){this.stateBefore=stateBefore;this.range=range;this.type=type;this.alignment=alignment};Handsontable.UndoRedo.CellAlignmentAction.prototype.undo=function(instance,undoneCallback){if(!instance.contextMenu){return}for(var row=this.range.from.row;row<=this.range.to.row;row++){for(var col=this.range.from.col;col<=this.range.to.col;col++){instance.setCellMeta(row,col,"className",this.stateBefore[row][col]||" htLeft")}}instance.addHookOnce("afterRender",undoneCallback);instance.render()};Handsontable.UndoRedo.CellAlignmentAction.prototype.redo=function(instance,undoneCallback){if(!instance.contextMenu){return}for(var row=this.range.from.row;row<=this.range.to.row;row++){for(var col=this.range.from.col;col<=this.range.to.col;col++){instance.contextMenu.align.call(instance,this.range,this.type,this.alignment)}}instance.addHookOnce("afterRender",undoneCallback);instance.render()};Handsontable.UndoRedo.RemoveColumnAction=function(index,data,headers){this.index=index;this.data=data;this.amount=this.data[0].length;this.headers=headers};helper.inherit(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(instance,undoneCallback){var row,spliceArgs;for(var i=0,len=instance.getData().length;i<len;i++){row=instance.getSourceDataAtRow(i);spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.data[i]);Array.prototype.splice.apply(row,spliceArgs)}if(typeof this.headers!="undefined"){spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.headers);Array.prototype.splice.apply(instance.getSettings().colHeaders,spliceArgs)}instance.addHookOnce("afterRender",undoneCallback);instance.render()};Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce("afterRemoveCol",redoneCallback);instance.alter("remove_col",this.index,this.amount)};function init(){var instance=this;var pluginEnabled=typeof instance.getSettings().undo=="undefined"||instance.getSettings().undo;if(pluginEnabled){if(!instance.undoRedo){instance.undoRedo=new Handsontable.UndoRedo(instance);exposeUndoRedoMethods(instance);instance.addHook("beforeKeyDown",onBeforeKeyDown);instance.addHook("afterChange",onAfterChange)}}else{if(instance.undoRedo){
delete instance.undoRedo;removeExposedUndoRedoMethods(instance);instance.removeHook("beforeKeyDown",onBeforeKeyDown);instance.removeHook("afterChange",onAfterChange)}}}function onBeforeKeyDown(event){var instance=this;var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(ctrlDown){if(event.keyCode===89||event.shiftKey&&event.keyCode===90){instance.undoRedo.redo();event.stopImmediatePropagation()}else if(event.keyCode===90){instance.undoRedo.undo();event.stopImmediatePropagation()}}}function onAfterChange(changes,source){var instance=this;if(source=="loadData"){return instance.undoRedo.clear()}}function exposeUndoRedoMethods(instance){instance.undo=function(){return instance.undoRedo.undo()};instance.redo=function(){return instance.undoRedo.redo()};instance.isUndoAvailable=function(){return instance.undoRedo.isUndoAvailable()};instance.isRedoAvailable=function(){return instance.undoRedo.isRedoAvailable()};instance.clearUndo=function(){return instance.undoRedo.clear()}}function removeExposedUndoRedoMethods(instance){delete instance.undo;delete instance.redo;delete instance.isUndoAvailable;delete instance.isRedoAvailable;delete instance.clearUndo}Handsontable.hooks.add("afterInit",init);Handsontable.hooks.add("afterUpdateSettings",init)},{"./../../helpers.js":42}],70:[function(require,module,exports){"use strict";Object.defineProperties(exports,{registerRenderer:{get:function(){return registerRenderer}},getRenderer:{get:function(){return getRenderer}},hasRenderer:{get:function(){return hasRenderer}},__esModule:{value:true}});var $__helpers_46_js__;var helper=($__helpers_46_js__=require("./helpers.js"),$__helpers_46_js__&&$__helpers_46_js__.__esModule&&$__helpers_46_js__||{"default":$__helpers_46_js__});var registeredRenderers={};Handsontable.renderers=Handsontable.renderers||{};Handsontable.renderers.registerRenderer=registerRenderer;Handsontable.renderers.getRenderer=getRenderer;function registerRenderer(rendererName,rendererFunction){var registerName;registeredRenderers[rendererName]=rendererFunction;registerName=helper.toUpperCaseFirst(rendererName)+"Renderer";Handsontable.renderers[registerName]=rendererFunction;Handsontable[registerName]=rendererFunction}function getRenderer(rendererName){if(typeof rendererName=="function"){return rendererName}if(typeof rendererName!="string"){throw Error('Only strings and functions can be passed as "renderer" parameter')}if(!(rendererName in registeredRenderers)){throw Error('No editor registered under name "'+rendererName+'"')}return registeredRenderers[rendererName]}function hasRenderer(rendererName){return rendererName in registeredRenderers}},{"./helpers.js":42}],71:[function(require,module,exports){"use strict";Object.defineProperties(exports,{cellDecorator:{get:function(){return cellDecorator}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_renderers_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var registerRenderer=($___46__46__47_renderers_46_js__=require("./../renderers.js"),$___46__46__47_renderers_46_js__&&$___46__46__47_renderers_46_js__.__esModule&&$___46__46__47_renderers_46_js__||{"default":$___46__46__47_renderers_46_js__}).registerRenderer;registerRenderer("base",cellDecorator);Handsontable.renderers.cellDecorator=cellDecorator;function cellDecorator(instance,TD,row,col,prop,value,cellProperties){if(cellProperties.className){if(TD.className){TD.className=TD.className+" "+cellProperties.className}else{TD.className=cellProperties.className}}if(cellProperties.readOnly){dom.addClass(TD,cellProperties.readOnlyCellClassName)}if(cellProperties.valid===false&&cellProperties.invalidCellClassName){dom.addClass(TD,cellProperties.invalidCellClassName)}else{dom.removeClass(TD,cellProperties.invalidCellClassName)}if(cellProperties.wordWrap===false&&cellProperties.noWordWrapClassName){dom.addClass(TD,cellProperties.noWordWrapClassName)}if(!value&&cellProperties.placeholder){dom.addClass(TD,cellProperties.placeholderCellClassName)}}},{"./../dom.js":27,"./../renderers.js":70}],72:[function(require,module,exports){"use strict";Object.defineProperties(exports,{autocompleteRenderer:{get:function(){return autocompleteRenderer}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_eventManager_46_js__,$___46__46__47_renderers_46_js__,$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var eventManagerObject=($___46__46__47_eventManager_46_js__=require("./../eventManager.js"),$___46__46__47_eventManager_46_js__&&$___46__46__47_eventManager_46_js__.__esModule&&$___46__46__47_eventManager_46_js__||{"default":$___46__46__47_eventManager_46_js__}).eventManager;var $__1=($___46__46__47_renderers_46_js__=require("./../renderers.js"),$___46__46__47_renderers_46_js__&&$___46__46__47_renderers_46_js__.__esModule&&$___46__46__47_renderers_46_js__||{"default":$___46__46__47_renderers_46_js__}),getRenderer=$__1.getRenderer,registerRenderer=$__1.registerRenderer;var WalkontableCellCoords=($___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./../3rdparty/walkontable/src/cell/coords.js"),$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;var clonableWRAPPER=document.createElement("DIV");clonableWRAPPER.className="htAutocompleteWrapper";var clonableARROW=document.createElement("DIV");clonableARROW.className="htAutocompleteArrow";clonableARROW.appendChild(document.createTextNode(String.fromCharCode(9660)));var wrapTdContentWithWrapper=function(TD,WRAPPER){WRAPPER.innerHTML=TD.innerHTML;dom.empty(TD);TD.appendChild(WRAPPER)};registerRenderer("autocomplete",autocompleteRenderer);function autocompleteRenderer(instance,TD,row,col,prop,value,cellProperties){var WRAPPER=clonableWRAPPER.cloneNode(true);var ARROW=clonableARROW.cloneNode(true);getRenderer("text")(instance,TD,row,col,prop,value,cellProperties);TD.appendChild(ARROW);dom.addClass(TD,"htAutocomplete");if(!TD.firstChild){TD.appendChild(document.createTextNode(String.fromCharCode(160)))}if(!instance.acArrowListener){var eventManager=eventManagerObject(instance);instance.acArrowListener=function(event){if(dom.hasClass(event.target,"htAutocompleteArrow")){instance.view.wt.getSetting("onCellDblClick",null,new WalkontableCellCoords(row,col),TD)}};eventManager.addEventListener(instance.rootElement,"mousedown",instance.acArrowListener);instance.addHookOnce("afterDestroy",function(){eventManager.clear()})}}},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../dom.js":27,"./../eventManager.js":41,"./../renderers.js":70}],73:[function(require,module,exports){"use strict";Object.defineProperties(exports,{checkboxRenderer:{get:function(){return checkboxRenderer}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_helpers_46_js__,$___46__46__47_eventManager_46_js__,$___46__46__47_renderers_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var EventManager=($___46__46__47_eventManager_46_js__=require("./../eventManager.js"),$___46__46__47_eventManager_46_js__&&$___46__46__47_eventManager_46_js__.__esModule&&$___46__46__47_eventManager_46_js__||{"default":$___46__46__47_eventManager_46_js__}).EventManager;var $__1=($___46__46__47_renderers_46_js__=require("./../renderers.js"),$___46__46__47_renderers_46_js__&&$___46__46__47_renderers_46_js__.__esModule&&$___46__46__47_renderers_46_js__||{"default":$___46__46__47_renderers_46_js__}),getRenderer=$__1.getRenderer,registerRenderer=$__1.registerRenderer;var clonableINPUT=document.createElement("INPUT");clonableINPUT.className="htCheckboxRendererInput";clonableINPUT.type="checkbox";clonableINPUT.setAttribute("autocomplete","off");var isListeningKeyDownEvent=new WeakMap;function checkboxRenderer(instance,TD,row,col,prop,value,cellProperties){var eventManager=new EventManager(instance);var input=clonableINPUT.cloneNode(false);if(typeof cellProperties.checkedTemplate==="undefined"){cellProperties.checkedTemplate=true}if(typeof cellProperties.uncheckedTemplate==="undefined"){cellProperties.uncheckedTemplate=false}dom.empty(TD);if(value===cellProperties.checkedTemplate||value===helper.stringify(cellProperties.checkedTemplate)){input.checked=true;TD.appendChild(input)}else if(value===cellProperties.uncheckedTemplate||value===helper.stringify(cellProperties.uncheckedTemplate)){TD.appendChild(input)}else if(value===null){dom.addClass(input,"noValue");TD.appendChild(input)}else{dom.fastInnerText(TD,"#bad value#")}if(cellProperties.readOnly){eventManager.addEventListener(input,"click",preventDefault)}else{eventManager.addEventListener(input,"mousedown",stopPropagation);eventManager.addEventListener(input,"mouseup",stopPropagation);eventManager.addEventListener(input,"change",function(event){instance.setDataAtRowProp(row,prop,event.target.checked?cellProperties.checkedTemplate:cellProperties.uncheckedTemplate)})}if(!isListeningKeyDownEvent.has(instance)){isListeningKeyDownEvent.set(instance,true);instance.addHook("beforeKeyDown",onBeforeKeyDown)}function onBeforeKeyDown(event){var allowedKeys=[helper.keyCode.SPACE,helper.keyCode.ENTER,helper.keyCode.DELETE,helper.keyCode.BACKSPACE];dom.enableImmediatePropagation(event);if(allowedKeys.indexOf(event.keyCode)!==-1&&!event.isImmediatePropagationStopped()){eachSelectedCheckboxCell(function(){event.stopImmediatePropagation();event.preventDefault()})}if(event.keyCode==helper.keyCode.SPACE||event.keyCode==helper.keyCode.ENTER){toggleSelected()}if(event.keyCode==helper.keyCode.DELETE||event.keyCode==helper.keyCode.BACKSPACE){toggleSelected(false)}}function toggleSelected(){var checked=arguments[0]!==void 0?arguments[0]:null;eachSelectedCheckboxCell(function(checkboxes){for(var i=0,len=checkboxes.length;i<len;i++){toggleCheckbox(checkboxes[i],checked)}})}function toggleCheckbox(checkbox){var checked=arguments[1]!==void 0?arguments[1]:null;if(checked===null){checkbox.checked=!checkbox.checked}else{checkbox.checked=checked}eventManager.fireEvent(checkbox,"change")}function eachSelectedCheckboxCell(callback){var selRange=instance.getSelectedRange();var topLeft=selRange.getTopLeftCorner();var bottomRight=selRange.getBottomRightCorner();for(var row=topLeft.row;row<=bottomRight.row;row++){for(var col=topLeft.col;col<=bottomRight.col;col++){var cell=instance.getCell(row,col);var cellProperties$__2=instance.getCellMeta(row,col);var checkboxes=cell.querySelectorAll("input[type=checkbox]");if(checkboxes.length>0&&!cellProperties$__2.readOnly){callback(checkboxes)}}}}function preventDefault(event){event.preventDefault()}function stopPropagation(event){helper.stopPropagation(event)}}registerRenderer("checkbox",checkboxRenderer)},{"./../dom.js":27,"./../eventManager.js":41,"./../helpers.js":42,"./../renderers.js":70}],74:[function(require,module,exports){"use strict";Object.defineProperties(exports,{htmlRenderer:{get:function(){return htmlRenderer}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_renderers_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var $__0=($___46__46__47_renderers_46_js__=require("./../renderers.js"),$___46__46__47_renderers_46_js__&&$___46__46__47_renderers_46_js__.__esModule&&$___46__46__47_renderers_46_js__||{"default":$___46__46__47_renderers_46_js__}),getRenderer=$__0.getRenderer,registerRenderer=$__0.registerRenderer;registerRenderer("html",htmlRenderer);function htmlRenderer(instance,TD,row,col,prop,value,cellProperties){getRenderer("base").apply(this,arguments);dom.fastInnerHTML(TD,value)}},{"./../dom.js":27,"./../renderers.js":70}],75:[function(require,module,exports){"use strict";Object.defineProperties(exports,{numericRenderer:{get:function(){return numericRenderer}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_helpers_46_js__,$__numeral__,$___46__46__47_renderers_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var numeral=($__numeral__=require("numeral"),$__numeral__&&$__numeral__.__esModule&&$__numeral__||{"default":$__numeral__}).default;var $__1=($___46__46__47_renderers_46_js__=require("./../renderers.js"),$___46__46__47_renderers_46_js__&&$___46__46__47_renderers_46_js__.__esModule&&$___46__46__47_renderers_46_js__||{"default":$___46__46__47_renderers_46_js__}),getRenderer=$__1.getRenderer,registerRenderer=$__1.registerRenderer;registerRenderer("numeric",numericRenderer);function numericRenderer(instance,TD,row,col,prop,value,cellProperties){if(helper.isNumeric(value)){if(typeof cellProperties.language!=="undefined"){numeral.language(cellProperties.language)}value=numeral(value).format(cellProperties.format||"0");dom.addClass(TD,"htNumeric")}getRenderer("text")(instance,TD,row,col,prop,value,cellProperties)}},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70,numeral:"numeral"}],76:[function(require,module,exports){"use strict";Object.defineProperties(exports,{passwordRenderer:{get:function(){return passwordRenderer}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_renderers_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var $__0=($___46__46__47_renderers_46_js__=require("./../renderers.js"),$___46__46__47_renderers_46_js__&&$___46__46__47_renderers_46_js__.__esModule&&$___46__46__47_renderers_46_js__||{"default":$___46__46__47_renderers_46_js__}),getRenderer=$__0.getRenderer,registerRenderer=$__0.registerRenderer;registerRenderer("password",passwordRenderer);function passwordRenderer(instance,TD,row,col,prop,value,cellProperties){getRenderer("text").apply(this,arguments);value=TD.innerHTML;var hash;var hashLength=cellProperties.hashLength||value.length;var hashSymbol=cellProperties.hashSymbol||"*";for(hash="";hash.split(hashSymbol).length-1<hashLength;hash+=hashSymbol){}dom.fastInnerHTML(TD,hash)}},{"./../dom.js":27,"./../renderers.js":70}],77:[function(require,module,exports){"use strict";Object.defineProperties(exports,{textRenderer:{get:function(){return textRenderer}},__esModule:{value:true}});var $___46__46__47_dom_46_js__,$___46__46__47_helpers_46_js__,$___46__46__47_renderers_46_js__;var dom=($___46__46__47_dom_46_js__=require("./../dom.js"),$___46__46__47_dom_46_js__&&$___46__46__47_dom_46_js__.__esModule&&$___46__46__47_dom_46_js__||{"default":$___46__46__47_dom_46_js__});var helper=($___46__46__47_helpers_46_js__=require("./../helpers.js"),$___46__46__47_helpers_46_js__&&$___46__46__47_helpers_46_js__.__esModule&&$___46__46__47_helpers_46_js__||{"default":$___46__46__47_helpers_46_js__});var $__0=($___46__46__47_renderers_46_js__=require("./../renderers.js"),$___46__46__47_renderers_46_js__&&$___46__46__47_renderers_46_js__.__esModule&&$___46__46__47_renderers_46_js__||{"default":$___46__46__47_renderers_46_js__}),getRenderer=$__0.getRenderer,registerRenderer=$__0.registerRenderer;registerRenderer("text",textRenderer);function textRenderer(instance,TD,row,col,prop,value,cellProperties){getRenderer("base").apply(this,arguments);if(!value&&cellProperties.placeholder){value=cellProperties.placeholder}var escaped=helper.stringify(value);if(!instance.getSettings().trimWhitespace){escaped=escaped.replace(/ /g,String.fromCharCode(160))}if(cellProperties.rendererTemplate){dom.empty(TD);var TEMPLATE=document.createElement("TEMPLATE");TEMPLATE.setAttribute("bind","{{}}");TEMPLATE.innerHTML=cellProperties.rendererTemplate;HTMLTemplateElement.decorate(TEMPLATE);TEMPLATE.model=instance.getSourceDataAtRow(row);TD.appendChild(TEMPLATE)}else{dom.fastInnerText(TD,escaped)}}},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70}],78:[function(require,module,exports){"use strict";if(!Array.prototype.filter){Array.prototype.filter=function(fun,thisp){"use strict";if(typeof this==="undefined"||this===null){throw new TypeError}if(typeof fun!=="function"){throw new TypeError}thisp=thisp||this;if(isNodeList(thisp)){thisp=convertNodeListToArray(thisp)}var len=thisp.length,res=[],i,val;for(i=0;i<len;i+=1){if(thisp.hasOwnProperty(i)){val=thisp[i];if(fun.call(thisp,val,i,thisp)){res.push(val)}}}return res;function isNodeList(object){return/NodeList/i.test(object.item)}function convertNodeListToArray(nodeList){var array=[];for(var i=0,len=nodeList.length;i<len;i++){array[i]=nodeList[i]}return array}}}},{}],79:[function(require,module,exports){"use strict";if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0;var from=Number(arguments[1])||0;from=from<0?Math.ceil(from):Math.floor(from);if(from<0){from+=len}for(;from<len;from++){if(from in this&&this[from]===elt){return from}}return-1}}},{}],80:[function(require,module,exports){"use strict";if(!Array.isArray){Array.isArray=function(obj){return Object.prototype.toString.call(obj)=="[object Array]"}}},{}],81:[function(require,module,exports){"use strict";(function(global){"use strict";if(global.$traceurRuntime){return}var $Object=Object;var $TypeError=TypeError;var $create=$Object.create;var $defineProperties=$Object.defineProperties;var $defineProperty=$Object.defineProperty;var $freeze=$Object.freeze;var $getOwnPropertyDescriptor=$Object.getOwnPropertyDescriptor;var $getOwnPropertyNames=$Object.getOwnPropertyNames;var $keys=$Object.keys;var $hasOwnProperty=$Object.prototype.hasOwnProperty;var $toString=$Object.prototype.toString;var $preventExtensions=Object.preventExtensions;var $seal=Object.seal;var $isExtensible=Object.isExtensible;function nonEnum(value){return{configurable:true,enumerable:false,value:value,writable:true}}var method=nonEnum;var counter=0;function newUniqueString(){return"__$"+Math.floor(Math.random()*1e9)+"$"+ ++counter+"$__"}var symbolInternalProperty=newUniqueString();var symbolDescriptionProperty=newUniqueString();var symbolDataProperty=newUniqueString();var symbolValues=$create(null);var privateNames=$create(null);function isPrivateName(s){return privateNames[s]}function createPrivateName(){var s=newUniqueString();privateNames[s]=true;return s}function isShimSymbol(symbol){return typeof symbol==="object"&&symbol instanceof SymbolValue}function typeOf(v){if(isShimSymbol(v))return"symbol";return typeof v}function Symbol(description){var value=new SymbolValue(description);if(!(this instanceof Symbol))return value;throw new TypeError("Symbol cannot be new'ed")}$defineProperty(Symbol.prototype,"constructor",nonEnum(Symbol));$defineProperty(Symbol.prototype,"toString",method(function(){var symbolValue=this[symbolDataProperty];if(!getOption("symbols"))return symbolValue[symbolInternalProperty];if(!symbolValue)throw TypeError("Conversion from symbol to string");var desc=symbolValue[symbolDescriptionProperty];if(desc===undefined)desc="";return"Symbol("+desc+")"}));$defineProperty(Symbol.prototype,"valueOf",method(function(){var symbolValue=this[symbolDataProperty];if(!symbolValue)throw TypeError("Conversion from symbol to string");if(!getOption("symbols"))return symbolValue[symbolInternalProperty];return symbolValue}));function SymbolValue(description){var key=newUniqueString();$defineProperty(this,symbolDataProperty,{value:this});$defineProperty(this,symbolInternalProperty,{value:key});$defineProperty(this,symbolDescriptionProperty,{value:description});freeze(this);symbolValues[key]=this}$defineProperty(SymbolValue.prototype,"constructor",nonEnum(Symbol));$defineProperty(SymbolValue.prototype,"toString",{value:Symbol.prototype.toString,enumerable:false});$defineProperty(SymbolValue.prototype,"valueOf",{value:Symbol.prototype.valueOf,enumerable:false});var hashProperty=createPrivateName();var hashPropertyDescriptor={value:undefined};var hashObjectProperties={hash:{value:undefined},self:{value:undefined}};var hashCounter=0;function getOwnHashObject(object){var hashObject=object[hashProperty];if(hashObject&&hashObject.self===object)return hashObject;if($isExtensible(object)){hashObjectProperties.hash.value=hashCounter++;hashObjectProperties.self.value=object;hashPropertyDescriptor.value=$create(null,hashObjectProperties);$defineProperty(object,hashProperty,hashPropertyDescriptor);return hashPropertyDescriptor.value}return undefined}function freeze(object){getOwnHashObject(object);return $freeze.apply(this,arguments)}function preventExtensions(object){getOwnHashObject(object);return $preventExtensions.apply(this,arguments)}function seal(object){getOwnHashObject(object);return $seal.apply(this,arguments)}freeze(SymbolValue.prototype);function isSymbolString(s){return symbolValues[s]||privateNames[s]}function toProperty(name){if(isShimSymbol(name))return name[symbolInternalProperty];return name}function removeSymbolKeys(array){var rv=[];for(var i=0;i<array.length;i++){if(!isSymbolString(array[i])){rv.push(array[i])}}return rv}function getOwnPropertyNames(object){return removeSymbolKeys($getOwnPropertyNames(object))}function keys(object){return removeSymbolKeys($keys(object))}function getOwnPropertySymbols(object){var rv=[];var names=$getOwnPropertyNames(object);for(var i=0;i<names.length;i++){var symbol=symbolValues[names[i]];if(symbol){rv.push(symbol)}}return rv}function getOwnPropertyDescriptor(object,name){return $getOwnPropertyDescriptor(object,toProperty(name))}function hasOwnProperty(name){return $hasOwnProperty.call(this,toProperty(name))}function getOption(name){return global.traceur&&global.traceur.options[name]}function defineProperty(object,name,descriptor){if(isShimSymbol(name)){name=name[symbolInternalProperty]}$defineProperty(object,name,descriptor);return object}function polyfillObject(Object){$defineProperty(Object,"defineProperty",{value:defineProperty});$defineProperty(Object,"getOwnPropertyNames",{value:getOwnPropertyNames});$defineProperty(Object,"getOwnPropertyDescriptor",{value:getOwnPropertyDescriptor});$defineProperty(Object.prototype,"hasOwnProperty",{value:hasOwnProperty});$defineProperty(Object,"freeze",{value:freeze});$defineProperty(Object,"preventExtensions",{value:preventExtensions});$defineProperty(Object,"seal",{value:seal});$defineProperty(Object,"keys",{value:keys})}function exportStar(object){for(var i=1;i<arguments.length;i++){var names=$getOwnPropertyNames(arguments[i]);for(var j=0;j<names.length;j++){var name=names[j];if(isSymbolString(name))continue;(function(mod,name){$defineProperty(object,name,{get:function(){return mod[name]},enumerable:true})})(arguments[i],names[j])}}return object}function isObject(x){return x!=null&&(typeof x==="object"||typeof x==="function")}function toObject(x){if(x==null)throw $TypeError();return $Object(x)}function checkObjectCoercible(argument){if(argument==null){throw new TypeError("Value cannot be converted to an Object")}return argument}function polyfillSymbol(global,Symbol){if(!global.Symbol){global.Symbol=Symbol;Object.getOwnPropertySymbols=getOwnPropertySymbols}if(!global.Symbol.iterator){global.Symbol.iterator=Symbol("Symbol.iterator")}}function setupGlobals(global){polyfillSymbol(global,Symbol);global.Reflect=global.Reflect||{};global.Reflect.global=global.Reflect.global||global;polyfillObject(global.Object)}setupGlobals(global);global.$traceurRuntime={checkObjectCoercible:checkObjectCoercible,createPrivateName:createPrivateName,defineProperties:$defineProperties,defineProperty:$defineProperty,exportStar:exportStar,getOwnHashObject:getOwnHashObject,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,isObject:isObject,isPrivateName:isPrivateName,isSymbolString:isSymbolString,keys:$keys,setupGlobals:setupGlobals,toObject:toObject,toProperty:toProperty,"typeof":typeOf}})(window);(function(){"use strict";var path;function relativeRequire(callerPath,requiredPath){path=path||typeof require!=="undefined"&&require("path");function isDirectory(path){return path.slice(-1)==="/"}function isAbsolute(path){return path[0]==="/"}function isRelative(path){return path[0]==="."}if(isDirectory(requiredPath)||isAbsolute(requiredPath))return;return isRelative(requiredPath)?require(path.resolve(path.dirname(callerPath),requiredPath)):require(requiredPath)}$traceurRuntime.require=relativeRequire})();(function(){"use strict";function spread(){var rv=[],j=0,iterResult;for(var i=0;i<arguments.length;i++){var valueToSpread=$traceurRuntime.checkObjectCoercible(arguments[i]);if(typeof valueToSpread[$traceurRuntime.toProperty(Symbol.iterator)]!=="function"){throw new TypeError("Cannot spread non-iterable object.")}var iter=valueToSpread[$traceurRuntime.toProperty(Symbol.iterator)]();while(!(iterResult=iter.next()).done){rv[j++]=iterResult.value}}return rv}$traceurRuntime.spread=spread})();(function(){"use strict";var $Object=Object;var $TypeError=TypeError;var $create=$Object.create;var $defineProperties=$traceurRuntime.defineProperties;var $defineProperty=$traceurRuntime.defineProperty;var $getOwnPropertyDescriptor=$traceurRuntime.getOwnPropertyDescriptor;var $getOwnPropertyNames=$traceurRuntime.getOwnPropertyNames;var $getPrototypeOf=Object.getPrototypeOf;var $__0=Object,getOwnPropertyNames=$__0.getOwnPropertyNames,getOwnPropertySymbols=$__0.getOwnPropertySymbols;function superDescriptor(homeObject,name){var proto=$getPrototypeOf(homeObject);do{var result=$getOwnPropertyDescriptor(proto,name);if(result)return result;proto=$getPrototypeOf(proto)}while(proto);return undefined}function superConstructor(ctor){return ctor.__proto__}function superCall(self,homeObject,name,args){return superGet(self,homeObject,name).apply(self,args)}function superGet(self,homeObject,name){var descriptor=superDescriptor(homeObject,name);if(descriptor){if(!descriptor.get)return descriptor.value;return descriptor.get.call(self)}return undefined}function superSet(self,homeObject,name,value){var descriptor=superDescriptor(homeObject,name);if(descriptor&&descriptor.set){descriptor.set.call(self,value);return value}throw $TypeError("super has no setter '"+name+"'.")}function getDescriptors(object){var descriptors={};var names=getOwnPropertyNames(object);for(var i=0;i<names.length;i++){var name=names[i];descriptors[name]=$getOwnPropertyDescriptor(object,name)}var symbols=getOwnPropertySymbols(object);for(var i=0;i<symbols.length;i++){var symbol=symbols[i];descriptors[$traceurRuntime.toProperty(symbol)]=$getOwnPropertyDescriptor(object,$traceurRuntime.toProperty(symbol))}return descriptors}function createClass(ctor,object,staticObject,superClass){$defineProperty(object,"constructor",{value:ctor,configurable:true,enumerable:false,writable:true});if(arguments.length>3){if(typeof superClass==="function")ctor.__proto__=superClass;ctor.prototype=$create(getProtoParent(superClass),getDescriptors(object))}else{ctor.prototype=object}$defineProperty(ctor,"prototype",{configurable:false,writable:false});return $defineProperties(ctor,getDescriptors(staticObject))}function getProtoParent(superClass){if(typeof superClass==="function"){var prototype=superClass.prototype;if($Object(prototype)===prototype||prototype===null)return superClass.prototype;throw new $TypeError("super prototype must be an Object or null")}if(superClass===null)return null;throw new $TypeError("Super expression must either be null or a function, not "+typeof superClass+".")}function defaultSuperCall(self,homeObject,args){if($getPrototypeOf(homeObject)!==null)superCall(self,homeObject,"constructor",args)}$traceurRuntime.createClass=createClass;$traceurRuntime.defaultSuperCall=defaultSuperCall;$traceurRuntime.superCall=superCall;$traceurRuntime.superConstructor=superConstructor;$traceurRuntime.superGet=superGet;$traceurRuntime.superSet=superSet})()},{path:undefined}],82:[function(require,module,exports){"use strict";if(!Object.keys){Object.keys=function(){"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=="object"&&(typeof obj!=="function"||obj===null)){throw new TypeError("Object.keys called on non-object")}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}}()}},{}],83:[function(require,module,exports){"use strict";if(!String.prototype.trim){var trimRegex=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(trimRegex,"")}}},{}],84:[function(require,module,exports){"use strict";if(typeof WeakMap==="undefined"){(function(){var defineProperty=Object.defineProperty;try{var properDefineProperty=true;defineProperty(function(){},"foo",{})}catch(e){properDefineProperty=false}var counter=+new Date%1e9;var WeakMap=function(){this.name="__st"+(Math.random()*1e9>>>0)+(counter++ +"__");if(!properDefineProperty){this._wmCache=[]}};if(properDefineProperty){WeakMap.prototype={set:function(key,value){var entry=key[this.name];if(entry&&entry[0]===key)entry[1]=value;else defineProperty(key,this.name,{value:[key,value],writable:true})},get:function(key){var entry;return(entry=key[this.name])&&entry[0]===key?entry[1]:undefined},has:function(key){return this.get(key)?true:false},"delete":function(key){this.set(key,undefined)}}}else{WeakMap.prototype={set:function(key,value){if(typeof key=="undefined"||typeof value=="undefined")return;for(var i=0,len=this._wmCache.length;i<len;i++){if(this._wmCache[i].key==key){this._wmCache[i].value=value;return}}this._wmCache.push({key:key,value:value})},get:function(key){if(typeof key=="undefined")return;for(var i=0,len=this._wmCache.length;i<len;i++){if(this._wmCache[i].key==key){return this._wmCache[i].value}}return void 0},has:function(key){return this.get(key)?true:false},"delete":function(key){if(typeof key=="undefined")return;for(var i=0,len=this._wmCache.length;i<len;i++){if(this._wmCache[i].key==key){Array.prototype.slice.call(this._wmCache,i,1)}}}}}window.WeakMap=WeakMap})()}},{}],85:[function(require,module,exports){"use strict";Object.defineProperties(exports,{TableView:{get:function(){return TableView}},__esModule:{value:true}});var $__dom_46_js__,$__helpers_46_js__,$__eventManager_46_js__,$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__,$__3rdparty_47_walkontable_47_src_47_selection_46_js__,$__3rdparty_47_walkontable_47_src_47_core_46_js__;var dom=($__dom_46_js__=require("./dom.js"),$__dom_46_js__&&$__dom_46_js__.__esModule&&$__dom_46_js__||{"default":$__dom_46_js__});var helper=($__helpers_46_js__=require("./helpers.js"),$__helpers_46_js__&&$__helpers_46_js__.__esModule&&$__helpers_46_js__||{
"default":$__helpers_46_js__});var eventManagerObject=($__eventManager_46_js__=require("./eventManager.js"),$__eventManager_46_js__&&$__eventManager_46_js__.__esModule&&$__eventManager_46_js__||{"default":$__eventManager_46_js__}).eventManager;var WalkontableCellCoords=($__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__=require("./3rdparty/walkontable/src/cell/coords.js"),$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__&&$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__.__esModule&&$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__||{"default":$__3rdparty_47_walkontable_47_src_47_cell_47_coords_46_js__}).WalkontableCellCoords;var WalkontableSelection=($__3rdparty_47_walkontable_47_src_47_selection_46_js__=require("./3rdparty/walkontable/src/selection.js"),$__3rdparty_47_walkontable_47_src_47_selection_46_js__&&$__3rdparty_47_walkontable_47_src_47_selection_46_js__.__esModule&&$__3rdparty_47_walkontable_47_src_47_selection_46_js__||{"default":$__3rdparty_47_walkontable_47_src_47_selection_46_js__}).WalkontableSelection;var Walkontable=($__3rdparty_47_walkontable_47_src_47_core_46_js__=require("./3rdparty/walkontable/src/core.js"),$__3rdparty_47_walkontable_47_src_47_core_46_js__&&$__3rdparty_47_walkontable_47_src_47_core_46_js__.__esModule&&$__3rdparty_47_walkontable_47_src_47_core_46_js__||{"default":$__3rdparty_47_walkontable_47_src_47_core_46_js__}).Walkontable;Handsontable.TableView=TableView;function TableView(instance){var that=this;this.eventManager=eventManagerObject(instance);this.instance=instance;this.settings=instance.getSettings();var originalStyle=instance.rootElement.getAttribute("style");if(originalStyle){instance.rootElement.setAttribute("data-originalstyle",originalStyle)}dom.addClass(instance.rootElement,"handsontable");var table=document.createElement("TABLE");table.className="htCore";this.THEAD=document.createElement("THEAD");table.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");table.appendChild(this.TBODY);instance.table=table;instance.container.insertBefore(table,instance.container.firstChild);this.eventManager.addEventListener(instance.rootElement,"mousedown",function(event){if(!that.isTextSelectionAllowed(event.target)){clearTextSelection();event.preventDefault();window.focus()}});this.eventManager.addEventListener(document.documentElement,"keyup",function(event){if(instance.selection.isInProgress()&&!event.shiftKey){instance.selection.finish()}});var isMouseDown;this.isMouseDown=function(){return isMouseDown};this.eventManager.addEventListener(document.documentElement,"mouseup",function(event){if(instance.selection.isInProgress()&&event.which===1){instance.selection.finish()}isMouseDown=false;if(helper.isOutsideInput(document.activeElement)){instance.unlisten()}});this.eventManager.addEventListener(document.documentElement,"mousedown",function(event){var next=event.target;if(isMouseDown){return}if(next!==instance.view.wt.wtTable.holder){while(next!==document.documentElement){if(next===null){if(event.isTargetWebComponent){break}return}if(next===instance.rootElement){return}next=next.parentNode}}else{var scrollbarWidth=Handsontable.Dom.getScrollbarWidth();if(document.elementFromPoint(event.x+scrollbarWidth,event.y)!==instance.view.wt.wtTable.holder||document.elementFromPoint(event.x,event.y+scrollbarWidth)!==instance.view.wt.wtTable.holder){return}}if(that.settings.outsideClickDeselects){instance.deselectCell()}else{instance.destroyEditor();event.stopImmediatePropagation()}});this.eventManager.addEventListener(table,"selectstart",function(event){if(that.settings.fragmentSelection){return}event.preventDefault()});var clearTextSelection=function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}else if(document.selection){document.selection.empty()}};var selections=[new WalkontableSelection({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&!instance.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!that.isCellEdited()&&!instance.selection.isMultiple()}}}),new WalkontableSelection({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&instance.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!that.isCellEdited()&&instance.selection.isMultiple()}}}),new WalkontableSelection({className:"highlight",highlightRowClassName:that.settings.currentRowClassName,highlightColumnClassName:that.settings.currentColClassName}),new WalkontableSelection({className:"fill",border:{width:1,color:"red"}})];selections.current=selections[0];selections.area=selections[1];selections.highlight=selections[2];selections.fill=selections[3];var walkontableConfig={debug:function(){return that.settings.debug},table:table,stretchH:this.settings.stretchH,data:instance.getDataAtCell,totalRows:instance.countRows,totalColumns:instance.countCols,fixedColumnsLeft:function(){return that.settings.fixedColumnsLeft},fixedRowsTop:function(){return that.settings.fixedRowsTop},renderAllRows:that.settings.renderAllRows,rowHeaders:function(){var arr=[];if(instance.hasRowHeaders()){arr.push(function(index,TH){that.appendRowHeader(index,TH)})}Handsontable.hooks.run(instance,"afterGetRowHeaderRenderers",arr);return arr},columnHeaders:function(){var arr=[];if(instance.hasColHeaders()){arr.push(function(index,TH){that.appendColHeader(index,TH)})}Handsontable.hooks.run(instance,"afterGetColumnHeaderRenderers",arr);return arr},columnWidth:instance.getColWidth,rowHeight:instance.getRowHeight,cellRenderer:function(row,col,TD){var prop=that.instance.colToProp(col),cellProperties=that.instance.getCellMeta(row,col),renderer=that.instance.getCellRenderer(cellProperties);var value=that.instance.getDataAtRowProp(row,prop);renderer(that.instance,TD,row,col,prop,value,cellProperties);Handsontable.hooks.run(that.instance,"afterRenderer",TD,row,col,prop,value,cellProperties)},selections:selections,hideBorderOnMouseDownOver:function(){return that.settings.fragmentSelection},onCellMouseDown:function(event,coords,TD,wt){instance.listen();that.activeWt=wt;isMouseDown=true;dom.enableImmediatePropagation(event);Handsontable.hooks.run(instance,"beforeOnCellMouseDown",event,coords,TD);if(!event.isImmediatePropagationStopped()){if(event.button===2&&instance.selection.inInSelection(coords)){}else if(event.shiftKey){if(coords.row>=0&&coords.col>=0){instance.selection.setRangeEnd(coords)}}else{if((coords.row<0||coords.col<0)&&(coords.row>=0||coords.col>=0)){if(coords.row<0){instance.selectCell(0,coords.col,instance.countRows()-1,coords.col);instance.selection.setSelectedHeaders(false,true)}if(coords.col<0){instance.selectCell(coords.row,0,coords.row,instance.countCols()-1);instance.selection.setSelectedHeaders(true,false)}}else{coords.row=coords.row<0?0:coords.row;coords.col=coords.col<0?0:coords.col;instance.selection.setRangeStart(coords)}}Handsontable.hooks.run(instance,"afterOnCellMouseDown",event,coords,TD);that.activeWt=that.wt}},onCellMouseOver:function(event,coords,TD,wt){that.activeWt=wt;if(coords.row>=0&&coords.col>=0){if(isMouseDown){instance.selection.setRangeEnd(coords)}}else{if(isMouseDown){if(coords.row<0){instance.selection.setRangeEnd(new WalkontableCellCoords(instance.countRows()-1,coords.col));instance.selection.setSelectedHeaders(false,true)}if(coords.col<0){instance.selection.setRangeEnd(new WalkontableCellCoords(coords.row,instance.countCols()-1));instance.selection.setSelectedHeaders(true,false)}}}Handsontable.hooks.run(instance,"afterOnCellMouseOver",event,coords,TD);that.activeWt=that.wt},onCellCornerMouseDown:function(event){event.preventDefault();Handsontable.hooks.run(instance,"afterOnCellCornerMouseDown",event)},beforeDraw:function(force){that.beforeRender(force)},onDraw:function(force){that.onDraw(force)},onScrollVertically:function(){instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){instance.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(corners,borderClassName){instance.runHooks("beforeDrawBorders",corners,borderClassName)},onBeforeTouchScroll:function(){instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){instance.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(calc){if(that.settings.viewportRowRenderingOffset){calc.startRow=Math.max(calc.startRow-that.settings.viewportRowRenderingOffset,0);calc.endRow=Math.min(calc.endRow+that.settings.viewportRowRenderingOffset,instance.countRows()-1)}instance.runHooks("afterViewportRowCalculatorOverride",calc)},viewportColumnCalculatorOverride:function(calc){if(that.settings.viewportColumnRenderingOffset){calc.startColumn=Math.max(calc.startColumn-that.settings.viewportColumnRenderingOffset,0);calc.endColumn=Math.min(calc.endColumn+that.settings.viewportColumnRenderingOffset,instance.countCols()-1)}instance.runHooks("afterViewportColumnCalculatorOverride",calc)}};Handsontable.hooks.run(instance,"beforeInitWalkontable",walkontableConfig);this.wt=new Walkontable(walkontableConfig);this.activeWt=this.wt;this.eventManager.addEventListener(that.wt.wtTable.spreader,"mousedown",function(event){if(event.target===that.wt.wtTable.spreader&&event.which===3){helper.stopPropagation(event)}});this.eventManager.addEventListener(that.wt.wtTable.spreader,"contextmenu",function(event){if(event.target===that.wt.wtTable.spreader&&event.which===3){helper.stopPropagation(event)}});this.eventManager.addEventListener(document.documentElement,"click",function(){if(that.settings.observeDOMVisibility){if(that.wt.drawInterrupted){that.instance.forceFullRender=true;that.render()}}})}TableView.prototype.isTextSelectionAllowed=function(el){if(helper.isInput(el)){return true}if(this.settings.fragmentSelection&&dom.isChildOf(el,this.TBODY)){return true}return false};TableView.prototype.isCellEdited=function(){var activeEditor=this.instance.getActiveEditor();return activeEditor&&activeEditor.isOpened()};TableView.prototype.beforeRender=function(force){if(force){Handsontable.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)}};TableView.prototype.onDraw=function(force){if(force){Handsontable.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)}};TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false};TableView.prototype.getCellAtCoords=function(coords,topmost){var td=this.wt.getCell(coords,topmost);if(td<0){return null}else{return td}};TableView.prototype.scrollViewport=function(coords){this.wt.scrollViewport(coords)};TableView.prototype.appendRowHeader=function(row,TH){if(TH.firstChild){var container=TH.firstChild;if(!dom.hasClass(container,"relative")){dom.empty(TH);this.appendRowHeader(row,TH);return}this.updateCellHeader(container.firstChild,row,this.instance.getRowHeader)}else{var div=document.createElement("div");var span=document.createElement("span");div.className="relative";span.className="colHeader";this.updateCellHeader(span,row,this.instance.getRowHeader);div.appendChild(span);TH.appendChild(div)}Handsontable.hooks.run(this.instance,"afterGetRowHeader",row,TH)};TableView.prototype.appendColHeader=function(col,TH){if(TH.firstChild){var container=TH.firstChild;if(!dom.hasClass(container,"relative")){dom.empty(TH);this.appendRowHeader(col,TH);return}this.updateCellHeader(container.firstChild,col,this.instance.getColHeader)}else{var div=document.createElement("div");var span=document.createElement("span");div.className="relative";span.className="colHeader";this.updateCellHeader(span,col,this.instance.getColHeader);div.appendChild(span);TH.appendChild(div)}Handsontable.hooks.run(this.instance,"afterGetColHeader",col,TH)};TableView.prototype.updateCellHeader=function(element,index,content){if(index>-1){dom.fastInnerHTML(element,content(index))}else{dom.fastInnerText(element,String.fromCharCode(160));dom.addClass(element,"cornerHeader")}};TableView.prototype.maximumVisibleElementWidth=function(leftOffset){var workspaceWidth=this.wt.wtViewport.getWorkspaceWidth();var maxWidth=workspaceWidth-leftOffset;return maxWidth>0?maxWidth:0};TableView.prototype.maximumVisibleElementHeight=function(topOffset){var workspaceHeight=this.wt.wtViewport.getWorkspaceHeight();var maxHeight=workspaceHeight-topOffset;return maxHeight>0?maxHeight:0};TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};TableView.prototype.destroy=function(){this.wt.destroy();this.eventManager.clear()}},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/core.js":7,"./3rdparty/walkontable/src/selection.js":18,"./dom.js":27,"./eventManager.js":41,"./helpers.js":42}],86:[function(require,module,exports){"use strict";var process=function(value,callback){var originalVal=value;var lowercaseVal=typeof originalVal==="string"?originalVal.toLowerCase():null;return function(source){var found=false;for(var s=0,slen=source.length;s<slen;s++){if(originalVal===source[s]){found=true;break}else if(lowercaseVal===Handsontable.helper.stringify(source[s]).toLowerCase()){found=true;break}}callback(found)}};Handsontable.AutocompleteValidator=function(value,callback){if(this.strict&&this.source){if(typeof this.source==="function"){this.source(value,process(value,callback))}else{process(value,callback)(this.source)}}else{callback(true)}}},{}],87:[function(require,module,exports){"use strict";var $__moment__;var moment=($__moment__=require("moment"),$__moment__&&$__moment__.__esModule&&$__moment__||{"default":$__moment__}).default;Handsontable.DateValidator=function(value,callback){var correctedValue=null,valid=true,dateEditor=Handsontable.editors.getEditor("date",this.instance);if(value===null){value=""}var isValidDate=moment(new Date(value)).isValid(),isValidFormat=moment(value,this.dateFormat||dateEditor.defaultDateFormat,true).isValid();if(!isValidDate){valid=false}if(!isValidDate&&isValidFormat){valid=true}if(isValidDate&&!isValidFormat){if(this.correctFormat===true){correctedValue=correctFormat(value,this.dateFormat);this.instance.setDataAtCell(this.row,this.col,correctedValue,"dateValidator");valid=true}else{valid=false}}callback(valid)};var correctFormat=function(value,dateFormat){value=moment(new Date(value)).format(dateFormat);return value}},{moment:"moment"}],88:[function(require,module,exports){"use strict";Handsontable.NumericValidator=function(value,callback){if(value===null){value=""}callback(/^-?\d*(\.|\,)?\d*$/.test(value))}},{}],SheetClip:[function(require,module,exports){"use strict";(function(global){"use strict";function countQuotes(str){return str.split('"').length-1}var SheetClip={parse:function(str){var r,rLen,rows,arr=[],a=0,c,cLen,multiline,last;rows=str.split("\n");if(rows.length>1&&rows[rows.length-1]===""){rows.pop()}for(r=0,rLen=rows.length;r<rLen;r+=1){rows[r]=rows[r].split("	");for(c=0,cLen=rows[r].length;c<cLen;c+=1){if(!arr[a]){arr[a]=[]}if(multiline&&c===0){last=arr[a].length-1;arr[a][last]=arr[a][last]+"\n"+rows[r][0];if(multiline&&countQuotes(rows[r][0])&1){multiline=false;arr[a][last]=arr[a][last].substring(0,arr[a][last].length-1).replace(/""/g,'"')}}else{if(c===cLen-1&&rows[r][c].indexOf('"')===0&&countQuotes(rows[r][c])&1){arr[a].push(rows[r][c].substring(1).replace(/""/g,'"'));multiline=true}else{arr[a].push(rows[r][c].replace(/""/g,'"'));multiline=false}}}if(!multiline){a+=1}}return arr},stringify:function(arr){var r,rLen,c,cLen,str="",val;for(r=0,rLen=arr.length;r<rLen;r+=1){cLen=arr[r].length;for(c=0;c<cLen;c+=1){if(c>0){str+="	"}val=arr[r][c];if(typeof val==="string"){if(val.indexOf("\n")>-1){str+='"'+val.replace(/"/g,'""')+'"'}else{str+=val}}else if(val===null||val===void 0){str+=""}else{str+=val}}str+="\n"}return str}};if(typeof exports!=="undefined"){exports.parse=SheetClip.parse;exports.stringify=SheetClip.stringify}else{global.SheetClip=SheetClip}})(window)},{}],autoResize:[function(require,module,exports){"use strict";function autoResize(){var defaults={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},el,body=document.body,text=document.createTextNode(""),span=document.createElement("SPAN"),observe=function(element,event,handler){if(window.attachEvent){element.attachEvent("on"+event,handler)}else{element.addEventListener(event,handler,false)}},unObserve=function(element,event,handler){if(window.removeEventListener){element.removeEventListener(event,handler,false)}else{element.detachEvent("on"+event,handler)}},resize=function(newChar){var width,scrollHeight;if(!newChar){newChar=""}else if(!/^[a-zA-Z \.,\\\/\|0-9]$/.test(newChar)){newChar="."}if(text.textContent!==void 0){text.textContent=el.value+newChar}else{text.data=el.value+newChar}span.style.fontSize=Handsontable.Dom.getComputedStyle(el).fontSize;span.style.fontFamily=Handsontable.Dom.getComputedStyle(el).fontFamily;span.style.whiteSpace="pre";body.appendChild(span);width=span.clientWidth+2;body.removeChild(span);el.style.height=defaults.minHeight+"px";if(defaults.minWidth>width){el.style.width=defaults.minWidth+"px"}else if(width>defaults.maxWidth){el.style.width=defaults.maxWidth+"px"}else{el.style.width=width+"px"}scrollHeight=el.scrollHeight?el.scrollHeight-1:0;if(defaults.minHeight>scrollHeight){el.style.height=defaults.minHeight+"px"}else if(defaults.maxHeight<scrollHeight){el.style.height=defaults.maxHeight+"px";el.style.overflowY="visible"}else{el.style.height=scrollHeight+"px"}},delayedResize=function(){window.setTimeout(resize,0)},extendDefaults=function(config){if(config&&config.minHeight){if(config.minHeight=="inherit"){defaults.minHeight=el.clientHeight}else{var minHeight=parseInt(config.minHeight);if(!isNaN(minHeight)){defaults.minHeight=minHeight}}}if(config&&config.maxHeight){if(config.maxHeight=="inherit"){defaults.maxHeight=el.clientHeight}else{var maxHeight=parseInt(config.maxHeight);if(!isNaN(maxHeight)){defaults.maxHeight=maxHeight}}}if(config&&config.minWidth){if(config.minWidth=="inherit"){defaults.minWidth=el.clientWidth}else{var minWidth=parseInt(config.minWidth);if(!isNaN(minWidth)){defaults.minWidth=minWidth}}}if(config&&config.maxWidth){if(config.maxWidth=="inherit"){defaults.maxWidth=el.clientWidth}else{var maxWidth=parseInt(config.maxWidth);if(!isNaN(maxWidth)){defaults.maxWidth=maxWidth}}}if(!span.firstChild){span.className="autoResize";span.style.display="inline-block";span.appendChild(text)}},init=function(el_,config,doObserve){el=el_;extendDefaults(config);if(el.nodeName=="TEXTAREA"){el.style.resize="none";el.style.overflowY="";el.style.height=defaults.minHeight+"px";el.style.minWidth=defaults.minWidth+"px";el.style.maxWidth=defaults.maxWidth+"px";el.style.overflowY="hidden"}if(doObserve){observe(el,"change",resize);observe(el,"cut",delayedResize);observe(el,"paste",delayedResize);observe(el,"drop",delayedResize);observe(el,"keydown",delayedResize)}resize()};return{init:function(el_,config,doObserve){init(el_,config,doObserve)},unObserve:function(){unObserve(el,"change",resize);unObserve(el,"cut",delayedResize);unObserve(el,"paste",delayedResize);unObserve(el,"drop",delayedResize);unObserve(el,"keydown",delayedResize)},resize:resize}}if(typeof exports!=="undefined"){module.exports=autoResize}},{}],copyPaste:[function(require,module,exports){"use strict";var instance;function copyPaste(){if(!instance){instance=new CopyPasteClass}else if(instance.hasBeenDestroyed()){instance.init()}instance.refCounter++;return instance}if(typeof exports!=="undefined"){module.exports=copyPaste}function CopyPasteClass(){this.refCounter=0;this.init()}CopyPasteClass.prototype.init=function(){var style,parent;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];parent=document.body;if(document.getElementById("CopyPasteDiv")){this.elDiv=document.getElementById("CopyPasteDiv");this.elTextarea=this.elDiv.firstChild}else{this.elDiv=document.createElement("div");this.elDiv.id="CopyPasteDiv";style=this.elDiv.style;style.position="fixed";style.top="-10000px";style.left="-10000px";parent.appendChild(this.elDiv);this.elTextarea=document.createElement("textarea");this.elTextarea.className="copyPaste";this.elTextarea.onpaste=function(event){var clipboardContents,temp;if("WebkitAppearance"in document.documentElement.style){clipboardContents=event.clipboardData.getData("Text");if(navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1){temp=clipboardContents.split("\n");temp.pop();clipboardContents=temp.join("\n")}this.value=clipboardContents;return false}};style=this.elTextarea.style;style.width="10000px";style.height="10000px";style.overflow="hidden";this.elDiv.appendChild(this.elTextarea);if(typeof style.opacity!=="undefined"){style.opacity=0}}this.onKeyDownRef=this.onKeyDown.bind(this);document.documentElement.addEventListener("keydown",this.onKeyDownRef,false)};CopyPasteClass.prototype.onKeyDown=function(event){var _this=this,isCtrlDown=false;function isActiveElementEditable(){var element=document.activeElement;if(element.shadowRoot&&element.shadowRoot.activeElement){element=element.shadowRoot.activeElement}return["INPUT","SELECT","TEXTAREA"].indexOf(element.nodeName)>-1||element.contentEditable==="true"}if(event.metaKey){isCtrlDown=true}else if(event.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){isCtrlDown=true}if(isCtrlDown){if(document.activeElement!==this.elTextarea&&(this.getSelectionText()!==""||isActiveElementEditable())){return}this.selectNodeText(this.elTextarea);setTimeout(function(){if(document.activeElement!==_this.elTextarea){_this.selectNodeText(_this.elTextarea)}},0)}if(isCtrlDown&&(event.keyCode===67||event.keyCode===86||event.keyCode===88)){if(event.keyCode===helper.keyCode.X){setTimeout(function(){_this.triggerCut(event)},0)}else if(event.keyCode===helper.keyCode.V){setTimeout(function(){_this.triggerPaste(event)},0)}}};CopyPasteClass.prototype.selectNodeText=function(element){if(element){element.select()}};CopyPasteClass.prototype.getSelectionText=function(){var text="";if(window.getSelection){text=window.getSelection().toString()}else if(document.selection&&document.selection.type!=="Control"){text=document.selection.createRange().text}return text};CopyPasteClass.prototype.copyable=function(string){if(typeof string!=="string"&&string.toString===void 0){throw new Error("copyable requires string parameter")}this.elTextarea.value=string;this.selectNodeText(this.elTextarea)};CopyPasteClass.prototype.onCut=function(callback){this.cutCallbacks.push(callback)};CopyPasteClass.prototype.onPaste=function(callback){this.pasteCallbacks.push(callback)};CopyPasteClass.prototype.removeCallback=function(callback){var i,len;for(i=0,len=this.copyCallbacks.length;i<len;i++){if(this.copyCallbacks[i]===callback){this.copyCallbacks.splice(i,1);return true}}for(i=0,len=this.cutCallbacks.length;i<len;i++){if(this.cutCallbacks[i]===callback){this.cutCallbacks.splice(i,1);return true}}for(i=0,len=this.pasteCallbacks.length;i<len;i++){if(this.pasteCallbacks[i]===callback){this.pasteCallbacks.splice(i,1);return true}}return false};CopyPasteClass.prototype.triggerCut=function(event){var _this=this;if(_this.cutCallbacks){setTimeout(function(){for(var i=0,len=_this.cutCallbacks.length;i<len;i++){_this.cutCallbacks[i](event)}},50)}};CopyPasteClass.prototype.triggerPaste=function(event,string){var _this=this;if(_this.pasteCallbacks){setTimeout(function(){var val=string||_this.elTextarea.value;for(var i=0,len=_this.pasteCallbacks.length;i<len;i++){_this.pasteCallbacks[i](val,event)}},50)}};CopyPasteClass.prototype.destroy=function(){if(!this.hasBeenDestroyed()&&--this.refCounter===0){if(this.elDiv&&this.elDiv.parentNode){this.elDiv.parentNode.removeChild(this.elDiv);this.elDiv=null;this.elTextarea=null}document.documentElement.removeEventListener("keydown",this.onKeyDownRef)}};CopyPasteClass.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],jsonpatch:[function(require,module,exports){"use strict";var jsonpatch;(function(jsonpatch){var objOps={add:function(obj,key){obj[key]=this.value;return true},remove:function(obj,key){delete obj[key];return true},replace:function(obj,key){obj[key]=this.value;return true},move:function(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"remove",path:this.from}]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true},copy:function(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true},test:function(obj,key){return JSON.stringify(obj[key])===JSON.stringify(this.value)},_get:function(obj,key){this.value=obj[key]}};var arrOps={add:function(arr,i){arr.splice(i,0,this.value);return true},remove:function(arr,i){arr.splice(i,1);return true},replace:function(arr,i){arr[i]=this.value;return true},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};var observeOps={add:function(patches,path){var patch={op:"add",path:path+escapePathComponent(this.name),value:this.object[this.name]};patches.push(patch)},"delete":function(patches,path){var patch={op:"remove",path:path+escapePathComponent(this.name)};patches.push(patch)},update:function(patches,path){var patch={op:"replace",path:path+escapePathComponent(this.name),value:this.object[this.name]};patches.push(patch)}};function escapePathComponent(str){if(str.indexOf("/")===-1&&str.indexOf("~")===-1){return str}return str.replace(/~/g,"~0").replace(/\//g,"~1")}function _getPathRecursive(root,obj){var found;for(var key in root){if(root.hasOwnProperty(key)){if(root[key]===obj){return escapePathComponent(key)+"/"}else if(typeof root[key]==="object"){found=_getPathRecursive(root[key],obj);if(found!=""){return escapePathComponent(key)+"/"+found}}}}return""}function getPath(root,obj){if(root===obj){return"/"}var path=_getPathRecursive(root,obj);if(path===""){throw new Error("Object not found in root")}return"/"+path}var beforeDict=[];jsonpatch.intervals;var Mirror=function(){function Mirror(obj){this.observers=[];this.obj=obj}return Mirror}();var ObserverInfo=function(){function ObserverInfo(callback,observer){this.callback=callback;this.observer=observer}return ObserverInfo}();function getMirror(obj){for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===obj){return beforeDict[i]}}}function getObserverFromMirror(mirror,callback){for(var j=0,jlen=mirror.observers.length;j<jlen;j++){if(mirror.observers[j].callback===callback){return mirror.observers[j].observer}}}function removeObserverFromMirror(mirror,observer){for(var j=0,jlen=mirror.observers.length;j<jlen;j++){if(mirror.observers[j].observer===observer){mirror.observers.splice(j,1);return}}}function unobserve(root,observer){generate(observer);if(Object.observe){_unobserve(observer,root)}else{clearTimeout(observer.next)}var mirror=getMirror(root);removeObserverFromMirror(mirror,observer)}jsonpatch.unobserve=unobserve;function observe(obj,callback){var patches=[];var root=obj;var observer;var mirror=getMirror(obj);if(!mirror){mirror=new Mirror(obj);beforeDict.push(mirror)}else{observer=getObserverFromMirror(mirror,callback)}if(observer){return observer}if(Object.observe&&false){observer=function(arr){_unobserve(observer,obj);_observe(observer,obj);var a=0,alen=arr.length;while(a<alen){if(!(arr[a].name==="length"&&_isArray(arr[a].object))&&!(arr[a].name==="__Jasmine_been_here_before__")){var type=arr[a].type;switch(type){case"new":type="add";break;case"deleted":type="delete";break;case"updated":type="update";break}observeOps[type].call(arr[a],patches,getPath(root,arr[a].object))}a++}if(patches){if(callback){callback(patches)}}observer.patches=patches;patches=[]}}else{observer={};mirror.value=JSON.parse(JSON.stringify(obj));if(callback){observer.callback=callback;observer.next=null;var intervals=this.intervals||[100,1e3,1e4,6e4];var currentInterval=0;var dirtyCheck=function(){generate(observer)};var fastCheck=function(){clearTimeout(observer.next);observer.next=setTimeout(function(){dirtyCheck();currentInterval=0;observer.next=setTimeout(slowCheck,intervals[currentInterval++])},0)};var slowCheck=function(){dirtyCheck();if(currentInterval==intervals.length){currentInterval=intervals.length-1}observer.next=setTimeout(slowCheck,intervals[currentInterval++])};if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("mousedown",fastCheck);window.addEventListener("mouseup",fastCheck);window.addEventListener("keydown",fastCheck)}else{window.attachEvent("onmousedown",fastCheck);window.attachEvent("onmouseup",fastCheck);window.attachEvent("onkeydown",fastCheck)}}observer.next=setTimeout(slowCheck,intervals[currentInterval++])}}observer.patches=patches;observer.object=obj;mirror.observers.push(new ObserverInfo(callback,observer));return _observe(observer,obj)}jsonpatch.observe=observe;function _observe(observer,obj){if(Object.observe&&false){Object.observe(obj,observer);for(var key in obj){if(obj.hasOwnProperty(key)){var v=obj[key];if(v&&typeof v==="object"){_observe(observer,v)}}}}return observer}function _unobserve(observer,obj){if(Object.observe&&false){Object.unobserve(obj,observer);for(var key in obj){if(obj.hasOwnProperty(key)){var v=obj[key];if(v&&typeof v==="object"){_unobserve(observer,v)}}}}return observer}function generate(observer){if(Object.observe&&false){Object.deliverChangeRecords(observer)}else{var mirror;for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===observer.object){mirror=beforeDict[i];break}}_generate(mirror.value,observer.object,observer.patches,"")}var temp=observer.patches;if(temp.length>0){observer.patches=[];if(observer.callback){observer.callback(temp)}}return temp}jsonpatch.generate=generate;var _objectKeys;if(Object.keys){_objectKeys=Object.keys}else{_objectKeys=function(obj){var keys=[];for(var o in obj){if(obj.hasOwnProperty(o)){keys.push(o)}}return keys}}function _generate(mirror,obj,patches,path){if(!obj){if(Array.isArray(mirror)){obj=[]}else if(mirror instanceof Object){obj={}}}if(obj.toJSON){obj=obj.toJSON()}var newKeys=Ember.isArray(obj)?obj.map(function(i,idx){return idx+""}):_objectKeys(obj);var oldKeys=_objectKeys(mirror);var changed=false;var deleted=false;for(var t=oldKeys.length-1;t>=0;t--){var key=oldKeys[t];var oldVal=mirror[key];if(obj.hasOwnProperty(key)){var newVal=obj[key];if(oldVal instanceof Object){_generate(oldVal,newVal,patches,path+"/"+escapePathComponent(key))}else{if(oldVal!=newVal){changed=true;patches.push({op:"replace",path:path+"/"+escapePathComponent(key),value:newVal});mirror[key]=newVal}}}else{patches.push({op:"remove",path:path+"/"+escapePathComponent(key)});delete mirror[key];deleted=true}}if(!deleted&&newKeys.length==oldKeys.length){return}for(var t=0;t<newKeys.length;t++){var key=newKeys[t];if(!mirror.hasOwnProperty(key)){if(obj[key]===undefined||typeof obj[key]==="function")continue;patches.push({op:"add",path:path+"/"+escapePathComponent(key),value:obj[key]});mirror[key]=JSON.parse(JSON.stringify(obj[key]))}}}var _isArray;if(Array.isArray){_isArray=Array.isArray}else{_isArray=function(obj){return obj.push&&typeof obj.length==="number"}}function apply(tree,patches){var result=false,p=0,plen=patches.length,patch;while(p<plen){patch=patches[p];var keys=patch.path.split("/");var obj=tree;var t=1;var len=keys.length;while(true){if(_isArray(obj)){var index=parseInt(keys[t],10);t++;if(t>=len){result=arrOps[patch.op].call(patch,obj,index,tree);break}obj=obj[index]}else{var key=keys[t];if(key.indexOf("~")!=-1){key=key.replace(/~1/g,"/").replace(/~0/g,"~")}t++;if(t>=len){result=objOps[patch.op].call(patch,obj,key,tree);break}obj=obj[key]}}p++}return result}jsonpatch.apply=apply})(jsonpatch||(jsonpatch={}));if(typeof exports!=="undefined"){exports.apply=jsonpatch.apply;exports.observe=jsonpatch.observe;exports.unobserve=jsonpatch.unobserve;exports.generate=jsonpatch.generate}},{}],moment:[function(require,module,exports){
=======
 * Date: Thu Jun 25 2015 14:04:28 GMT+0200 (CEST)
 */
window.Handsontable={version:"0.15.1",buildDate:"Thu Jun 25 2015 14:04:28 GMT+0200 (CEST)"},function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Handsontable=e()}}(function(){var e;return function(e,t,n){return function o(e,t,n){function r(a,l){if(!t[a]){if(!e[a]){var u="function"==typeof require&&require;if(!l&&u)return u(a,!0);if(i)return i(a,!0);if(s[a]&&"undefined"!=typeof window[s[a]])return window[s[a]];var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var c=t[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return r(n?n:t)},c,c.exports,o,e,t,n)}return t[a].exports}for(var i="function"==typeof require&&require,s=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","pikaday":"Pikaday"}')||{},a=0;a<n.length;a++)r(n[a]);return r}(e,t,n),function(){return Handsontable}}({1:[function(e,t,n){"use strict";window.jQuery&&!function(e,t,n){t.fn.handsontable=function(e){var t,o,r,i,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof e)return s=e||{},l?l.updateSettings(s):(l=new n.Core(a[0],s),a.data("handsontable",l),l.init()),a;if(r=[],arguments.length>1)for(t=1,o=arguments.length;o>t;t++)r.push(arguments[t]);if(l){if("undefined"==typeof l[e])throw new Error("Handsontable do not provide action: "+e);i=l[e].apply(l,r),"destroy"===e&&a.removeData()}return i}}(window,jQuery,Handsontable)},{}],2:[function(e,t,n){"use strict";function o(e,t){var n,o=function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var e=10,t=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var n={position:"absolute",height:t+"px",width:t+"px","border-radius":parseInt(t/1.5,10)+"px"};for(var o in n)n.hasOwnProperty(o)&&(this.selectionHandles.styles.bottomRightHitArea[o]=n[o],this.selectionHandles.styles.topLeftHitArea[o]=n[o]);var r={position:"absolute",height:e+"px",width:e+"px","border-radius":parseInt(e/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var o in r)r.hasOwnProperty(o)&&(this.selectionHandles.styles.bottomRight[o]=r[o],this.selectionHandles.styles.topLeft[o]=r[o]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)};if(t){var r=l(e);this.instance=e,this.settings=t,this.main=document.createElement("div"),n=this.main.style,n.position="absolute",n.top=0,n.left=0;for(var i=["top","left","bottom","right","corner"],s=0;5>s;s++){var a=i[s],u=document.createElement("DIV");u.className="wtBorder "+(this.settings.className||""),this.settings[a]&&this.settings[a].hide&&(u.className+=" hidden"),n=u.style,n.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:t.border.color,n.height=this.settings[a]&&this.settings[a].width?this.settings[a].width+"px":t.border.width+"px",n.width=this.settings[a]&&this.settings[a].width?this.settings[a].width+"px":t.border.width+"px",this.main.appendChild(u)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Handsontable.mobileBrowser&&o.call(this),this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.spreader.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.insertBefore(this.main,e.wtTable.bordersHolder.firstChild);var d=!1;r.addEventListener(document.body,"mousedown",function(){d=!0}),r.addEventListener(document.body,"mouseup",function(){d=!1});for(var c=0,h=this.main.childNodes.length;h>c;c++)r.addEventListener(this.main.childNodes[c],"mouseenter",function(t){if(d&&e.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),t.stopImmediatePropagation();var n=this.getBoundingClientRect();this.style.display="none";var o=function(e){return e.clientY<Math.floor(n.top)?!0:e.clientY>Math.ceil(n.top+n.height)?!0:e.clientX<Math.floor(n.left)?!0:e.clientX>Math.ceil(n.left+n.width)?!0:void 0},i=function(e){o(e)&&(r.removeEventListener(document.body,"mousemove",i),this.style.display="block")};r.addEventListener(document.body,"mousemove",i)}})}}Object.defineProperties(n,{WalkontableBorder:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a=(r=e("./../../../dom.js"),r&&r.__esModule&&r||{"default":r}),l=(i=e("./../../../eventManager.js"),i&&i.__esModule&&i||{"default":i}).eventManager,u=(s=e("./cell/coords.js"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords;o.prototype.appear=function(e){if(!this.disabled){var t,n,o,r,i,s,l,d,c,h,f,p,g,m,w,v,y,b,C,R=this.instance,S=function(){return!this.instance.selections.area.cellRange||w==this.instance.selections.area.cellRange.to.row&&v==this.instance.selections.area.cellRange.to.col?!1:!0},E=function(e,t,n,o){var r=parseInt(this.selectionHandles.styles.topLeft.width,10),i=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(e-r,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(t-r,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(e-i/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(t-i/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(e+o,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(t+n,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(e+o-i/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(t+n-i/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",S.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),g==this.instance.wtSettings.getSetting("fixedRowsTop")||m==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")};for(b=R.cloneOverlay instanceof WalkontableTopOverlay||R.cloneOverlay instanceof WalkontableCornerOverlay?R.getSetting("fixedRowsTop"):R.wtTable.getRenderedRowsCount(),y=0;b>y;y++)if(C=R.wtTable.rowFilter.renderedToSource(y),C>=e[0]&&C<=e[2]){g=C;break}for(y=b-1;y>=0;y--)if(C=R.wtTable.rowFilter.renderedToSource(y),C>=e[0]&&C<=e[2]){w=C;break}for(b=R.wtTable.getRenderedColumnsCount(),y=0;b>y;y++)if(C=R.wtTable.columnFilter.renderedToSource(y),C>=e[1]&&C<=e[3]){m=C;break}for(y=b-1;y>=0;y--)if(C=R.wtTable.columnFilter.renderedToSource(y),C>=e[1]&&C<=e[3]){v=C;break}if(void 0===g||void 0===m)return void this.disappear();t=g!==w||m!==v,n=R.wtTable.getCell(new u(g,m)),o=t?R.wtTable.getCell(new u(w,v)):n,r=a.offset(n),i=t?a.offset(o):r,s=a.offset(R.wtTable.TABLE),d=r.top,f=i.top+a.outerHeight(o)-d,h=r.left,p=i.left+a.outerWidth(o)-h,l=d-s.top-1,c=h-s.left-1;var T=a.getComputedStyle(n);parseInt(T.borderTopWidth,10)>0&&(l+=1,f=f>0?f-1:0),parseInt(T.borderLeftWidth,10)>0&&(c+=1,p=p>0?p-1:0),this.topStyle.top=l+"px",this.topStyle.left=c+"px",this.topStyle.width=p+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=c+"px",this.leftStyle.height=f+"px",this.leftStyle.display="block";var _=Math.floor(this.settings.border.width/2);if(this.bottomStyle.top=l+f-_+"px",this.bottomStyle.left=c+"px",this.bottomStyle.width=p+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=c+p-_+"px",this.rightStyle.height=f+1+"px",this.rightStyle.display="block",Handsontable.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||S.call(this))this.cornerStyle.display="none";else if(this.cornerStyle.top=l+f-4+"px",this.cornerStyle.left=c+p-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",v===this.instance.getSetting("totalColumns")-1){var k=a.getTrimmingContainer(R.wtTable.TABLE),H=o.offsetLeft+a.outerWidth(o)>=a.innerWidth(k);H&&(this.cornerStyle.left=Math.floor(c+p-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0)}Handsontable.mobileBrowser&&E.call(this,l,c,p,f)}},o.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Handsontable.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},o.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},window.WalkontableBorder=o},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./cell/coords.js":5}],3:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewportColumnsCalculator:{get:function(){return r}},__esModule:{value:!0}});var o=new WeakMap,r=function(e,t,n,r,i,s,a){o.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:n,columnWidthFn:r,overrideFn:i,onlyFullyVisible:s}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()},i=r;$traceurRuntime.createClass(r,{calculate:function(){for(var e,t=0,n=!0,r=[],i=o.get(this),s=i.onlyFullyVisible,a=i.overrideFn,l=i.scrollOffset,u=i.totalColumns,d=i.viewportWidth,c=0;u>c;c++)if(e=this._getColumnWidth(c),l>=t&&!s&&(this.startColumn=c),t>=l&&l+d>=t+e&&(null==this.startColumn&&(this.startColumn=c),this.endColumn=c),r.push(t),t+=e,s||(this.endColumn=c),t>=l+d){n=!1;break}if(this.endColumn===u-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var h=r[this.endColumn]+e-r[this.startColumn-1];if((d>=h||!s)&&this.startColumn--,h>d)break}null!==this.startColumn&&a&&a(this),this.startPosition=r[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(e){if("none"!==this.stretch){for(var t,n,r=0,i=o.get(this),s=i.totalColumns,a=0;s>a;a++)t=this._getColumnWidth(a),r+=t;this.totalTargetWidth=e,n=r-e,"all"===this.stretch&&0>n?(this.stretchAllRatio=e/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&e!==1/0&&(this.stretchLastWidth=-n+this._getColumnWidth(s-1))}},getStretchedColumnWidth:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n},_getStretchedAllColumnWidth:function(e,t){var n=0,r=o.get(this),i=r.totalColumns;if(this.stretchAllColumnsWidth[e]||(this.stretchAllColumnsWidth[e]=Math.round(t*this.stretchAllRatio)),this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)n+=this.stretchAllColumnsWidth[s];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]},_getStretchedLastColumnWidth:function(e){var t=o.get(this),n=t.totalColumns;return e===n-1?this.stretchLastWidth:null},_getColumnWidth:function(e){var t=o.get(this).columnWidthFn(e);return void 0===t&&(t=i.DEFAULT_WIDTH),t}},{get DEFAULT_WIDTH(){return 50}}),window.WalkontableViewportColumnsCalculator=r},{}],4:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewportRowsCalculator:{get:function(){return r}},__esModule:{value:!0}});var o=new WeakMap,r=function(e,t,n,r,i,s){o.set(this,{viewportHeight:e,scrollOffset:t,totalRows:n,rowHeightFn:r,overrideFn:i,onlyFullyVisible:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()},i=r;$traceurRuntime.createClass(r,{calculate:function(){for(var e=0,t=!0,n=[],r=o.get(this),s=r.onlyFullyVisible,a=r.overrideFn,l=r.rowHeightFn,u=r.scrollOffset,d=r.totalRows,c=r.viewportHeight,h=0;d>h;h++){var f=l(h);if(void 0===f&&(f=i.DEFAULT_HEIGHT),u>=e&&!s&&(this.startRow=h),e>=u&&u+c>=e+f&&(null===this.startRow&&(this.startRow=h),this.endRow=h),n.push(e),e+=f,s||(this.endRow=h),e>=u+c){t=!1;break}}if(this.endRow===d-1&&t)for(this.startRow=this.endRow;this.startRow>0;){var p=n[this.endRow]+f-n[this.startRow-1];if((c>=p||!s)&&this.startRow--,p>=c)break}null!==this.startRow&&a&&a(this),this.startPosition=n[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}}),window.WalkontableViewportRowsCalculator=r},{}],5:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableCellCoords:{get:function(){return o}},__esModule:{value:!0}});var o=function(e,t){"undefined"!=typeof e&&"undefined"!=typeof t?(this.row=e,this.col=t):(this.row=null,this.col=null)};$traceurRuntime.createClass(o,{isValid:function(e){return this.row<0||this.col<0?!1:this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns")?!1:!0},isEqual:function(e){return e===this?!0:this.row===e.row&&this.col===e.col},isSouthEastOf:function(e){return this.row>=e.row&&this.col>=e.col},isNorthWestOf:function(e){return this.row<=e.row&&this.col<=e.col},isSouthWestOf:function(e){return this.row>=e.row&&this.col<=e.col},isNorthEastOf:function(e){return this.row<=e.row&&this.col>=e.col}},{}),window.WalkontableCellCoords=o},{}],6:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableCellRange:{get:function(){return i}},__esModule:{value:!0}});var o,r=(o=e("./../cell/coords.js"),o&&o.__esModule&&o||{"default":o}).WalkontableCellCoords,i=function(e,t,n){this.highlight=e,this.from=t,this.to=n},s=i;$traceurRuntime.createClass(i,{isValid:function(e){return this.from.isValid(e)&&this.to.isValid(e)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&n.row>=e.row&&t.col<=e.col&&n.col>=e.col},includesRange:function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},isEqual:function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},overlaps:function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},isNorthWestOf:function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},expand:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col?(this.from=new r(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new r(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1},expandByRange:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),o=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),i=e.getBottomRightCorner(),a=Math.min(t.row,o.row),l=Math.min(t.col,o.col),u=Math.max(n.row,i.row),d=Math.max(n.col,i.col),c=new r(a,l),h=new r(u,d),f=new s(c,c,h).isCorner(this.from,e),p=e.isEqual(new s(c,c,h));return f&&!p&&(this.from.col>c.col&&(c.col=d,h.col=l),this.from.row>c.row&&(c.row=u,h.row=a)),this.from=c,this.to=h,!0},getDirection:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},setDirection:function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},getTopLeftCorner:function(){return new r(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new r(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new r(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new r(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(e,t){return t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new r(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new r(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new r(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new r(t.to.row,t.to.col)))?!0:e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())},getOppositeCorner:function(e,t){if(!(e instanceof r))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new r(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new r(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new r(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new r(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},getBordersSharedWith:function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return t.top==n.top&&o.push("top"),t.right==n.right&&o.push("right"),t.bottom==n.bottom&&o.push("bottom"),t.left==n.left&&o.push("left"),o},getInner:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var i=e.col;i<=t.col;i++)this.from.row===o&&this.from.col===i||this.to.row===o&&this.to.col===i||n.push(new r(o,i));return n},getAll:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var i=e.col;i<=t.col;i++)e.row===o&&e.col===i?n.push(e):t.row===o&&t.col===i?n.push(t):n.push(new r(o,i));return n},forAll:function(e){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),o=t.row;o<=n.row;o++)for(var r=t.col;r<=n.col;r++){var i=e(o,r);if(i===!1)return}}},{}),window.WalkontableCellRange=i},{"./../cell/coords.js":5}],7:[function(e,t,n){"use strict";Object.defineProperties(n,{Walkontable:{get:function(){return y}},__esModule:{value:!0}});var o,r,i,s,a,l,u,d,c=(o=e("./../../../dom.js"),o&&o.__esModule&&o||{"default":o}),h=(r=e("./../../../helpers.js"),r&&r.__esModule&&r||{"default":r}).randomString,f=(i=e("./event.js"),i&&i.__esModule&&i||{"default":i}).WalkontableEvent,p=(s=e("./overlays.js"),s&&s.__esModule&&s||{"default":s}).WalkontableOverlays,g=(a=e("./scroll.js"),a&&a.__esModule&&a||{"default":a}).WalkontableScroll,m=(l=e("./settings.js"),l&&l.__esModule&&l||{"default":l}).WalkontableSettings,w=(u=e("./table.js"),u&&u.__esModule&&u||{"default":u}).WalkontableTable,v=(d=e("./viewport.js"),d&&d.__esModule&&d||{"default":d}).WalkontableViewport,y=function(e){var t=[];if(this.guid="wt_"+h(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new w(this,e.table,e.wtRootElement),this.wtScroll=new g(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new f(this),this.selections=this.cloneSource.selections):(this.wtSettings=new m(this,e),this.wtTable=new w(this,e.table),this.wtScroll=new g(this),this.wtViewport=new v(this),this.wtEvent=new f(this),this.selections=this.getSetting("selections"),this.wtOverlays=new p(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;o>n;n++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){c.fastInnerText(n,t[e])}])}this.drawn=!1,this.drawInterrupted=!1};$traceurRuntime.createClass(y,{draw:function(){var e=void 0!==arguments[0]?arguments[0]:!1;return this.drawInterrupted=!1,e||c.isVisible(this.wtTable.TABLE)?this.wtTable.draw(e):this.drawInterrupted=!0,this},getCell:function(e){var t=void 0!==arguments[1]?arguments[1]:!1;if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedColumnsLeft");return e.row<n&&e.col<o?this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e):e.row<n?this.wtOverlays.topOverlay.clone.wtTable.getCell(e):e.col<o?this.wtOverlays.leftOverlay.clone.wtTable.getCell(e):this.wtTable.getCell(e)},update:function(e,t){return this.wtSettings.update(e,t)},scrollVertical:function(e){return this.wtOverlays.topOverlay.scrollTo(e),this.getSetting("onScrollVertically"),this},scrollHorizontal:function(e){return this.wtOverlays.leftOverlay.scrollTo(e),this.getSetting("onScrollHorizontally"),this},scrollViewport:function(e){return this.wtScroll.scrollViewport(e),this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},getSetting:function(e,t,n,o,r){return this.wtSettings.getSetting(e,t,n,o,r)},hasSetting:function(e){return this.wtSettings.has(e)},destroy:function(){this.wtOverlays.destroy(),this.wtEvent&&this.wtEvent.destroy()}},{}),window.Walkontable=y},{"./../../../dom.js":27,"./../../../helpers.js":42,"./event.js":8,"./overlays.js":16,"./scroll.js":17,"./settings.js":19,"./table.js":20,"./viewport.js":22}],8:[function(e,t,n){"use strict";function o(e){var t=this,n=a(e);this.instance=e;var o=[null,null];this.dblClickTimeout=[null,null];var r,i,l=function(e){var n=t.parentCell(e.realTarget);s.hasClass(e.realTarget,"corner")?t.instance.getSetting("onCellCornerMouseDown",e,e.realTarget):n.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",e,n.coords,n.TD,t.instance),2!==e.button&&n.TD&&(o[0]=n.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){o[0]=null},1e3))},u=function(e){t.instance.touchMoving=!0},d=function(e){n.addEventListener(this,"touchmove",u),t.checkIfTouchMove=setTimeout(function(){return t.instance.touchMoving===!0?(t.instance.touchMoving=void 0,void n.removeEventListener("touchmove",u,!1)):void l(e)},30)},c=function(e){var n,o;t.instance.hasSetting("onCellMouseOver")&&(n=t.instance.wtTable.TABLE,o=s.closest(e.realTarget,["TD","TH"],n),o&&o!==i&&s.isChildOf(o,n)&&(i=o,t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(o),o,t.instance)))},h=function(e){if(2!==e.button){var n=t.parentCell(e.realTarget);n.TD===o[0]&&n.TD===o[1]?(s.hasClass(e.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,t.instance):t.instance.getSetting("onCellDblClick",e,n.coords,n.TD,t.instance),o[0]=null,o[1]=null):n.TD===o[0]&&(o[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){o[1]=null},500))}},f=function(e){clearTimeout(r),e.preventDefault(),h(e)};if(n.addEventListener(this.instance.wtTable.holder,"mousedown",l),n.addEventListener(this.instance.wtTable.TABLE,"mouseover",c),n.addEventListener(this.instance.wtTable.holder,"mouseup",h),this.instance.wtTable.holder.parentNode.parentNode&&Handsontable.mobileBrowser&&!t.instance.wtTable.isWorkingOnClone()){var p="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");n.addEventListener(this.instance.wtTable.holder,"touchstart",function(e){t.instance.touchApplied=!0,s.isChildOf(e.target,p)&&d.call(e.target,e)}),n.addEventListener(this.instance.wtTable.holder,"touchend",function(e){t.instance.touchApplied=!1,s.isChildOf(e.target,p)&&f.call(e.target,e)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),n.addEventListener(this.instance.wtTable.holder,"scroll",function(e){clearTimeout(t.instance.momentumScrolling._timeout),t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll"),t.instance.momentumScrolling.ongoing=!0,t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)})}n.addEventListener(window,"resize",function(){"none"!==t.instance.getSetting("stretchH")&&t.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),n.clear()}}Object.defineProperties(n,{WalkontableEvent:{get:function(){return o}},__esModule:{value:!0}});var r,i,s=(r=e("./../../../dom.js"),r&&r.__esModule&&r||{"default":r}),a=(i=e("./../../../eventManager.js"),i&&i.__esModule&&i||{"default":i}).eventManager;o.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,o=s.closest(e,["TD","TH"],n);return o&&s.isChildOf(o,n)?(t.coords=this.instance.wtTable.getCoords(o),t.TD=o):s.hasClass(e,"wtBorder")&&s.hasClass(e,"current")?(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):s.hasClass(e,"wtBorder")&&s.hasClass(e,"area")&&this.instance.selections.area.cellRange&&(t.coords=this.instance.selections.area.cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t},window.WalkontableEvent=o},{"./../../../dom.js":27,"./../../../eventManager.js":41}],9:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableColumnFilter:{get:function(){return o}},__esModule:{value:!0}});var o=function(e,t,n){this.offset=e,this.total=t,this.countTH=n};$traceurRuntime.createClass(o,{offsetted:function(e){return e+this.offset},unOffsetted:function(e){return e-this.offset},renderedToSource:function(e){return this.offsetted(e)},sourceToRendered:function(e){return this.unOffsetted(e)},offsettedTH:function(e){return e-this.countTH},unOffsettedTH:function(e){return e+this.countTH},visibleRowHeadedColumnToSourceColumn:function(e){return this.renderedToSource(this.offsettedTH(e))},sourceColumnToVisibleRowHeadedColumn:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{}),window.WalkontableColumnFilter=o},{}],10:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableRowFilter:{get:function(){return o}},__esModule:{value:!0}});var o=function(e,t,n){this.offset=e,this.total=t,this.countTH=n};$traceurRuntime.createClass(o,{offsetted:function(e){return e+this.offset},unOffsetted:function(e){return e-this.offset},renderedToSource:function(e){return this.offsetted(e)},sourceToRendered:function(e){return this.unOffsetted(e)},offsettedTH:function(e){return e-this.countTH},unOffsettedTH:function(e){return e+this.countTH},visibleColHeadedRowToSourceRow:function(e){return this.renderedToSource(this.offsettedTH(e))},sourceRowToVisibleColHeadedRow:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{}),window.WalkontableRowFilter=o},{}],11:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableOverlay:{get:function(){return u}},__esModule:{value:!0}});var o,r,i,s=(o=e("./../../../../dom.js"),o&&o.__esModule&&o||{"default":o}),a=(r=e("./../../../../helpers.js"),r&&r.__esModule&&r||{"default":r}).defineGetter,l=(i=e("./../../../../eventManager.js"),i&&i.__esModule&&i||{"default":i}).eventManager,u=function(e){a(this,"wot",e,{writable:!1}),this.instance=this.wot,this.type="",this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=s.getTrimmingContainer(this.hider.parentNode.parentNode),this.mainTableScrollableElement=s.getScrollableElement(this.wot.wtTable.TABLE),this.needFullRender=this.shouldBeRendered(),this.isElementSizesAdjusted=!1},d=u;$traceurRuntime.createClass(u,{shouldBeRendered:function(){return!0},makeClone:function(e){if(-1===d.CLONE_TYPES.indexOf(e))throw new Error('Clone type "'+e+'" is not supported.');var t=document.createElement("DIV"),n=document.createElement("TABLE");return t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden",n.className=this.wot.wtTable.TABLE.className,t.appendChild(n),this.type=e,this.wot.wtTable.wtRootElement.parentNode.appendChild(t),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:n})},refresh:function(){var e=void 0!==arguments[0]?arguments[0]:!1,t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t},destroy:function(){l(this.clone).clear()}},{get CLONE_TOP(){return"top"},get CLONE_LEFT(){return"left"},get CLONE_CORNER(){return"corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[d.CLONE_TOP,d.CLONE_LEFT,d.CLONE_CORNER,d.CLONE_DEBUG]}}),window.WalkontableOverlay=u;
},{"./../../../../dom.js":27,"./../../../../eventManager.js":41,"./../../../../helpers.js":42}],12:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableCornerOverlay:{get:function(){return a}},__esModule:{value:!0}});var o,r,i=(o=e("./../../../../dom.js"),o&&o.__esModule&&o||{"default":o}),s=(r=e("./_base.js"),r&&r.__esModule&&r||{"default":r}).WalkontableOverlay,a=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(s.CLONE_CORNER)},l=a;$traceurRuntime.createClass(a,{shouldBeRendered:function(){return(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1},resetFixedPosition:function(){if(this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=i.outerHeight(this.clone.wtTable.TABLE),n=i.outerWidth(this.clone.wtTable.TABLE);if(this.trimmingContainer===window){var o,r,s=this.wot.wtTable.hider.getBoundingClientRect(),a=Math.ceil(s.top),l=Math.ceil(s.left),u=Math.ceil(s.bottom),d=Math.ceil(s.right);o=0>l&&d-e.offsetWidth>0?-l+"px":"0",r=0>a&&u-e.offsetHeight>0?-a+"px":"0",i.setOverlayPosition(e,o,r)}e.style.height=(0===t?t:t+4)+"px",e.style.width=(0===n?n:n+4)+"px"}}},{},s),window.WalkontableCornerOverlay=a},{"./../../../../dom.js":27,"./_base.js":11}],13:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableDebugOverlay:{get:function(){return a}},__esModule:{value:!0}});var o,r,i=(o=e("./../../../../dom.js"),o&&o.__esModule&&o||{"default":o}),s=(r=e("./_base.js"),r&&r.__esModule&&r||{"default":r}).WalkontableOverlay,a=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(s.CLONE_DEBUG),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",i.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},l=a;$traceurRuntime.createClass(a,{},{},s),window.WalkontableDebugOverlay=a},{"./../../../../dom.js":27,"./_base.js":11}],14:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableLeftOverlay:{get:function(){return a}},__esModule:{value:!0}});var o,r,i=(o=e("./../../../../dom.js"),o&&o.__esModule&&o||{"default":o}),s=(r=e("./_base.js"),r&&r.__esModule&&r||{"default":r}).WalkontableOverlay,a=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(s.CLONE_LEFT)},l=a;$traceurRuntime.createClass(a,{shouldBeRendered:function(){return this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length?!0:!1},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0;if(this.trimmingContainer===window){var n,o,r=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(r.left),a=Math.ceil(r.right);o=this.wot.wtTable.hider.style.top,o=""===o?0:o,n=0>s&&a-e.offsetWidth>0?-s:0,t=n,n+="px",i.setOverlayPosition(e,n,o)}else t=this.getScrollPosition();this.adjustHeaderBordersPosition(t)}},setScrollPosition:function(e){this.mainTableScrollableElement===window?window.scrollTo(e,i.getWindowScrollTop()):this.mainTableScrollableElement.scrollLeft=e},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(e,t){for(var n=0,o=this.wot.wtSettings.defaultColumnWidth;t>e;)n+=this.wot.wtTable.getStretchedColumnWidth(e)||o,e++;return n},adjustElementsSize:function(){var e=void 0!==arguments[0]?arguments[0]:!1;(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),e||(this.isElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,t=this.wot.wtTable.holder,n=t.clientHeight!==t.offsetHeight?i.getScrollbarWidth():0,o=this.clone.wtTable.holder.parentNode,r=o.style;this.trimmingContainer!==window&&(r.height=this.wot.wtViewport.getWorkspaceHeight()-n+"px"),this.clone.wtTable.holder.style.height=r.height,e=i.outerWidth(this.clone.wtTable.TABLE),r.width=(0===e?e:e+4)+"px"},adjustRootChildsSize:function(){var e=i.getScrollbarWidth();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===e&&(e=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+e+"px"},applyToDOM:function(){var e=this.wot.getSetting("totalColumns");if(this.isElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""},scrollTo:function(e,t){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=o.wtTable.holder,s=0;t&&r.offsetWidth!==r.clientWidth&&(s=i.getScrollbarWidth()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),n+=s,this.setScrollPosition(n)},getTableParentOffset:function(){return this.trimmingContainer===window?this.wot.wtTable.holderOffset.left:0},getScrollPosition:function(){return i.getScrollLeft(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(e){if(0===this.wot.getSetting("fixedColumnsLeft")&&this.wot.getSetting("rowHeaders").length>0){var t=this.wot.wtTable.holder.parentNode,n=i.hasClass(t,"innerBorderLeft");e?i.addClass(t,"innerBorderLeft"):i.removeClass(t,"innerBorderLeft"),(!n&&e||n&&!e)&&this.wot.wtOverlays.adjustElementsSize()}}},{},s),window.WalkontableLeftOverlay=a},{"./../../../../dom.js":27,"./_base.js":11}],15:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableTopOverlay:{get:function(){return a}},__esModule:{value:!0}});var o,r,i=(o=e("./../../../../dom.js"),o&&o.__esModule&&o||{"default":o}),s=(r=e("./_base.js"),r&&r.__esModule&&r||{"default":r}).WalkontableOverlay,a=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(s.CLONE_TOP)},l=a;$traceurRuntime.createClass(a,{shouldBeRendered:function(){return this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length?!0:!1},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0;if(this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var n,o,r=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(r.top),a=Math.ceil(r.bottom);n=this.wot.wtTable.hider.style.left,n=""===n?0:n,o=0>s&&a-e.offsetHeight>0?-s:0,t=o,o+="px",i.setOverlayPosition(e,n,o)}else t=this.getScrollPosition();this.adjustHeaderBordersPosition(t)}},setScrollPosition:function(e){this.mainTableScrollableElement===window?window.scrollTo(i.getWindowScrollLeft(),e):this.mainTableScrollableElement.scrollTop=e},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(e,t){for(var n=0,o=this.wot.wtSettings.settings.defaultRowHeight;t>e;)n+=this.wot.wtTable.getRowHeight(e)||o,e++;return n},adjustElementsSize:function(){var e=void 0!==arguments[0]?arguments[0]:!1;(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),e||(this.isElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,t=this.wot.wtTable.holder,n=t.clientWidth!==t.offsetWidth?i.getScrollbarWidth():0,o=this.clone.wtTable.holder.parentNode,r=o.style;this.trimmingContainer!==window&&(r.width=this.wot.wtViewport.getWorkspaceWidth()-n+"px"),this.clone.wtTable.holder.style.width=r.width,e=i.outerHeight(this.clone.wtTable.TABLE),r.height=(0===e?e:e+4)+"px"},adjustRootChildsSize:function(){var e=i.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===e&&(e=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"},applyToDOM:function(){var e=this.wot.getSetting("totalRows");if(this.isElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""},scrollTo:function(e,t){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=o.wtTable.holder,s=0;t&&r.offsetHeight!==r.clientHeight&&(s=i.getScrollbarWidth()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),e),n+=s,this.setScrollPosition(n)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return i.getScrollTop(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(e){if(0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var t=this.wot.wtTable.holder.parentNode,n=i.hasClass(t,"innerBorderTop");e?i.addClass(t,"innerBorderTop"):i.removeClass(t,"innerBorderTop"),(!n&&e||n&&!e)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var o=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");o&&(o.style["border-left-width"]=0)}}},{},s),window.WalkontableTopOverlay=a},{"./../../../../dom.js":27,"./_base.js":11}],16:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableOverlays:{get:function(){return g}},__esModule:{value:!0}});var o,r,i,s,a,l,u=(o=e("./../../../dom.js"),o&&o.__esModule&&o||{"default":o}),d=(r=e("./../../../eventManager.js"),r&&r.__esModule&&r||{"default":r}).EventManager,c=(i=e("./overlay/corner.js"),i&&i.__esModule&&i||{"default":i}).WalkontableCornerOverlay,h=(s=e("./overlay/debug.js"),s&&s.__esModule&&s||{"default":s}).WalkontableDebugOverlay,f=(a=e("./overlay/left.js"),a&&a.__esModule&&a||{"default":a}).WalkontableLeftOverlay,p=(l=e("./overlay/top.js"),l&&l.__esModule&&l||{"default":l}).WalkontableTopOverlay,g=function(e){this.wot=e,this.instance=this.wot,this.eventManager=new d(this.wot),this.wot.update("scrollbarWidth",u.getScrollbarWidth()),this.wot.update("scrollbarHeight",u.getScrollbarWidth()),this.mainTableScrollableElement=u.getScrollableElement(this.wot.wtTable.TABLE),this.topOverlay=new p(this.wot),this.leftOverlay=new f(this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay=new c(this.wot)),this.wot.getSetting("debug")&&(this.debug=new h(this.wot)),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},left:{top:0,left:null}},this.registerListeners()};$traceurRuntime.createClass(g,{refreshAll:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.topOverlay.onScroll(),this.leftOverlay.onScroll()}},registerListeners:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"keydown",function(){return e.onKeyDown()}),this.eventManager.addEventListener(document.documentElement,"keyup",function(){return e.onKeyUp()}),this.eventManager.addEventListener(this.mainTableScrollableElement,"scroll",function(t){return e.onTableScroll(t)}),this.topOverlay.needFullRender&&(this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}),this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)})),this.leftOverlay.needFullRender&&(this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}),this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)})),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&this.eventManager.addEventListener(window,"wheel",function(t){var n,o=t.wheelDeltaY||t.deltaY,r=t.wheelDeltaX||t.deltaX;e.topOverlay.clone.wtTable.holder.contains(t.target)?n="top":e.leftOverlay.clone.wtTable.holder.contains(t.target)&&(n="left"),"top"==n&&0!==o?t.preventDefault():"left"==n&&0!==r&&t.preventDefault()})},onTableScroll:function(e){Handsontable.mobileBrowser||(!this.keyPressed||this.mainTableScrollableElement===window||e.target.contains(this.mainTableScrollableElement))&&("scroll"===e.type?this.syncScrollPositions(e):this.translateMouseWheelToScroll(e))},onKeyDown:function(){this.keyPressed=!0},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(e){for(var t,n=this.topOverlay.clone.wtTable.holder,o=this.leftOverlay.clone.wtTable.holder,r={type:"wheel"},i=e.target,s=e.wheelDeltaY||-1*e.deltaY,a=e.wheelDeltaX||-1*e.deltaX;i!=document&&null!=i;){if(i.className.indexOf("wtHolder")>-1){t=i;break}i=i.parentNode}return r.target=t,t==n?this.syncScrollPositions(r,-.2*s):t==o&&this.syncScrollPositions(r,-.2*a),!1},syncScrollPositions:function(e){var t=void 0!==arguments[1]?arguments[1]:null;if(!this.destroyed){if(0===arguments.length)return void this.syncScrollWithMaster();var n,o,r=this.mainTableScrollableElement,i=e.target,s=0,a=!1;this.topOverlay.needFullRender&&(n=this.topOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(o=this.leftOverlay.clone.wtTable.holder),i===document&&(i=window),i===r?(s=u.getScrollLeft(i),this.overlayScrollPositions.master.left!==s&&(this.overlayScrollPositions.master.left=s,a=!0,n&&(n.scrollLeft=s)),s=u.getScrollTop(i),this.overlayScrollPositions.master.top!==s&&(this.overlayScrollPositions.master.top=s,a=!0,o&&(o.scrollTop=s))):i===n?(s=u.getScrollLeft(i),this.overlayScrollPositions.top.left!==s&&(this.overlayScrollPositions.top.left=s,a=!0,r.scrollLeft=s),null!==t&&(a=!0,r.scrollTop+=t)):i===o&&(s=u.getScrollTop(i),this.overlayScrollPositions.left.top!==s&&(this.overlayScrollPositions.left.top=s,a=!0,r.scrollTop=s),null!==t&&(a=!0,r.scrollLeft+=t)),!this.keyPressed&&a&&"scroll"===e.type&&this.refreshAll()}},syncScrollWithMaster:function(){var e=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e.scrollLeft),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=e.scrollTop)},destroy:function(){this.eventManager.clear(),this.topOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0},refresh:function(){var e=void 0!==arguments[0]?arguments[0]:!1;if(this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=t.clientWidth,o=t.clientHeight;(n!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o,this.adjustElementsSize())}this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.debug&&this.debug.refresh(e)},adjustElementsSize:function(){var e=void 0!==arguments[0]?arguments[0]:!1,t=this.wot.getSetting("totalColumns"),n=this.wot.getSetting("totalRows"),o=this.wot.wtViewport.getRowHeaderWidth(),r=this.wot.wtViewport.getColumnHeaderHeight(),i=this.wot.wtTable.hider.style;i.width=o+this.leftOverlay.sumCellSizes(0,t)+"px",i.height=r+this.topOverlay.sumCellSizes(0,n)+1+"px",this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e)},applyToDOM:function(){this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{}),window.WalkontableOverlays=g},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15}],17:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableScroll:{get:function(){return o}},__esModule:{value:!0}});var o=function(e){this.wot=e,this.instance=e};$traceurRuntime.createClass(o,{scrollViewport:function(e){if(this.wot.drawn){var t=this.wot.getSetting("totalRows"),n=this.wot.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>n-1)throw new Error("column "+e.col+" does not exist");e.row>this.instance.wtTable.getLastVisibleRow()?this.wot.wtOverlays.topOverlay.scrollTo(e.row,!0):e.row>=this.instance.getSetting("fixedRowsTop")&&e.row<this.instance.wtTable.getFirstVisibleRow()&&this.wot.wtOverlays.topOverlay.scrollTo(e.row),e.col>this.instance.wtTable.getLastVisibleColumn()?this.wot.wtOverlays.leftOverlay.scrollTo(e.col,!0):e.col>=this.instance.getSetting("fixedColumnsLeft")&&e.col<this.instance.wtTable.getFirstVisibleColumn()&&this.wot.wtOverlays.leftOverlay.scrollTo(e.col)}}},{}),window.WalkontableScroll=o},{}],18:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableSelection:{get:function(){return c}},__esModule:{value:!0}});var o,r,i,s,a=(o=e("./../../../dom.js"),o&&o.__esModule&&o||{"default":o}),l=(r=e("./border.js"),r&&r.__esModule&&r||{"default":r}).WalkontableBorder,u=(i=e("./cell/coords.js"),i&&i.__esModule&&i||{"default":i}).WalkontableCellCoords,d=(s=e("./cell/range.js"),s&&s.__esModule&&s||{"default":s}).WalkontableCellRange,c=function(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}};$traceurRuntime.createClass(c,{getBorder:function(e){return this.instanceBorders[e.guid]?this.instanceBorders[e.guid]:void(this.instanceBorders[e.guid]=new l(e,this.settings))},isEmpty:function(){return null===this.cellRange},add:function(e){this.isEmpty()?this.cellRange=new d(e,e,e):this.cellRange.expand(e)},replace:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},addClassAtCoords:function(e,t,n,o){var r=e.wtTable.getCell(new u(t,n));"object"==typeof r&&a.addClass(r,o)},draw:function(e){if(this.isEmpty()){if(this.settings.border){var t=this.getBorder(e);t&&t.disappear()}}else{for(var n,o,r,i=e.wtTable.getRenderedRowsCount(),s=e.wtTable.getRenderedColumnsCount(),l=this.getCorners(),u=0;s>u;u++)o=e.wtTable.columnFilter.renderedToSource(u),o>=l[1]&&o<=l[3]&&(r=e.wtTable.getColumnHeader(o),r&&this.settings.highlightColumnClassName&&a.addClass(r,this.settings.highlightColumnClassName));for(var d=0;i>d;d++){n=e.wtTable.rowFilter.renderedToSource(d),n>=l[0]&&n<=l[2]&&(r=e.wtTable.getRowHeader(n),r&&this.settings.highlightRowClassName&&a.addClass(r,this.settings.highlightRowClassName));for(var c=0;s>c;c++)o=e.wtTable.columnFilter.renderedToSource(c),n>=l[0]&&n<=l[2]&&o>=l[1]&&o<=l[3]?this.settings.className&&this.addClassAtCoords(e,n,o,this.settings.className):n>=l[0]&&n<=l[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(e,n,o,this.settings.highlightRowClassName):o>=l[1]&&o<=l[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(e,n,o,this.settings.highlightColumnClassName)}if(e.getSetting("onBeforeDrawBorders",l,this.settings.className),this.settings.border){var h=this.getBorder(e);h&&h.appear(l)}}}},{}),window.WalkontableSelection=c},{"./../../../dom.js":27,"./border.js":2,"./cell/coords.js":5,"./cell/range.js":6}],19:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableSettings:{get:function(){return i}},__esModule:{value:!0}});var o,r=(o=e("./../../../dom.js"),o&&o.__esModule&&o||{"default":o}),i=function(e,t){var n=this;this.wot=e,this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,o){var i=n.getSetting("data",e,t);r.fastInnerText(o,void 0===i||null===i?"":i)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={};for(var o in this.defaults)if(this.defaults.hasOwnProperty(o))if(void 0!==t[o])this.settings[o]=t[o];else{if(void 0===this.defaults[o])throw new Error('A required setting "'+o+'" was not provided');this.settings[o]=this.defaults[o]}};$traceurRuntime.createClass(i,{update:function(e,t){if(void 0===t)for(var n in e)e.hasOwnProperty(n)&&(this.settings[n]=e[n]);else this.settings[e]=t;return this.wot},getSetting:function(e,t,n,o,r){return"function"==typeof this.settings[e]?this.settings[e](t,n,o,r):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]},has:function(e){return!!this.settings[e]}},{}),window.WalkontableSettings=i},{"./../../../dom.js":27}],20:[function(e,t,n){"use strict";function o(e,t){this.instance=e,this.TABLE=t,p.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!p.hasClass(n,"wtHolder")){var o=document.createElement("DIV");o.className="wtSpreader",n&&n.insertBefore(o,this.TABLE),o.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,this.spreader.style.position="relative",n=this.spreader.parentNode,!n||1!==n.nodeType||!p.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",n&&n.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,n=this.hider.parentNode,!n||1!==n.nodeType||!p.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,this.hider),e.cloneSource||(i.parentNode.className+="ht_master handsontable"),i.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var s=document.createElement("TR");this.THEAD.appendChild(s)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null}Object.defineProperties(n,{WalkontableTable:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l,u,d,c,h,f,p=(r=e("./../../../dom.js"),r&&r.__esModule&&r||{"default":r}),g=(i=e("./cell/coords.js"),i&&i.__esModule&&i||{"default":i}).WalkontableCellCoords,m=((s=e("./cell/range.js"),s&&s.__esModule&&s||{"default":s}).WalkontableCellRange,(a=e("./filter/column.js"),a&&a.__esModule&&a||{"default":a}).WalkontableColumnFilter),w=(l=e("./overlay/corner.js"),l&&l.__esModule&&l||{"default":l}).WalkontableCornerOverlay,v=(u=e("./overlay/debug.js"),u&&u.__esModule&&u||{"default":u}).WalkontableDebugOverlay,y=(d=e("./overlay/left.js"),d&&d.__esModule&&d||{"default":d}).WalkontableLeftOverlay,b=(c=e("./filter/row.js"),c&&c.__esModule&&c||{"default":c}).WalkontableRowFilter,C=(h=e("./tableRenderer.js"),h&&h.__esModule&&h||{"default":h}).WalkontableTableRenderer,R=(f=e("./overlay/top.js"),f&&f.__esModule&&f||{"default":f}).WalkontableTopOverlay;o.prototype.alignOverlaysWithTrimmingContainer=function(){var e=p.getTrimmingContainer(this.wtRootElement);this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",e!==window?(this.holder.style.width=p.getStyle(e,"width"),this.holder.style.height=p.getStyle(e,"height"),this.holder.style.overflow=""):(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible"))},o.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},o.prototype.draw=function(e){if(this.isWorkingOnClone()||(this.holderOffset=p.offset(this.holder),e=this.instance.wtViewport.createRenderCalculators(e)),e)this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtOverlays&&this.instance.wtOverlays.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:this.tableOffset=p.offset(this.TABLE);var t;t=this.instance.cloneOverlay instanceof v||this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof w?0:this.instance.wtViewport.rowsRenderCalculator.startRow;var n;n=this.instance.cloneOverlay instanceof v||this.instance.cloneOverlay instanceof y||this.instance.cloneOverlay instanceof w?0:this.instance.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new b(t,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new m(n,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw(),this.alignOverlaysWithTrimmingContainer()}return this.refreshSelections(e),this.isWorkingOnClone()||(this.instance.wtOverlays.topOverlay.resetFixedPosition(),this.instance.wtOverlays.leftOverlay.resetFixedPosition(),this.instance.wtOverlays.topLeftCornerOverlay&&this.instance.wtOverlays.topLeftCornerOverlay.resetFixedPosition()),this.instance.drawn=!0,this},o.prototype._doDraw=function(){var e=new C(this);e.render()},o.prototype.removeClassFromCells=function(e){for(var t=this.TABLE.querySelectorAll("."+e),n=0,o=t.length;o>n;n++)p.removeClass(t[n],e)},o.prototype.refreshSelections=function(e){var t,n;if(this.instance.selections){if(n=this.instance.selections.length,e)for(t=0;n>t;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0;n>t;t++)this.instance.selections[t].draw(this.instance,e)}},o.prototype.getCell=function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},o.prototype.getColumnHeader=function(e,t){t||(t=0);var n=this.THEAD.childNodes[t];return n?n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:void 0},o.prototype.getRowHeader=function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0},o.prototype.getCoords=function(e){var t=e.parentNode,n=p.index(t);return n=t.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.renderedToSource(n),new g(n,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},o.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},o.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow},o.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow},o.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn},o.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn},o.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow},o.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow},o.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn},o.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn},o.prototype.isRowBeforeRenderedRows=function(e){return this.rowFilter.sourceToRendered(e)<0&&e>=0},o.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},o.prototype.isRowAfterRenderedRows=function(e){return e>this.getLastRenderedRow()},o.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToRendered(e)<0&&e>=0},o.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},o.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},o.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn},o.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof v?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof y||this.instance.cloneOverlay instanceof w?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count},o.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof v?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof R||this.instance.cloneOverlay instanceof w?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count},o.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count},o.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()},o.prototype.getRowHeight=function(e){var t=this.instance.wtSettings.settings.rowHeight(e),n=this.instance.wtViewport.oversizedRows[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},o.prototype.getColumnHeaderHeight=function(e){var t=this.instance.wtSettings.settings.defaultRowHeight,n=this.instance.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},o.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count},o.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()},o.prototype.getColumnWidth=function(e){var t=this.instance.wtSettings.settings.columnWidth;"function"==typeof t?t=t(e):"object"==typeof t&&(t=t[e]);var n=this.instance.wtViewport.oversizedCols[e];return void 0!==n&&(t=t?Math.max(t,n):n),
t},o.prototype.getStretchedColumnWidth=function(e){var t,n=this.getColumnWidth(e)||this.instance.wtSettings.settings.defaultColumnWidth,o=this.instance.wtViewport.columnsRenderCalculator;return o&&(t=o.getStretchedColumnWidth(e,n),t&&(n=t)),n},window.WalkontableTable=o},{"./../../../dom.js":27,"./cell/coords.js":5,"./cell/range.js":6,"./filter/column.js":9,"./filter/row.js":10,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15,"./tableRenderer.js":21}],21:[function(e,t,n){"use strict";function o(e,t){var n=document.createElement("TH");return t.insertBefore(n,e),t.removeChild(e),n}function r(e,t){var n=document.createElement("TD");return t.insertBefore(n,e),t.removeChild(e),n}Object.defineProperties(n,{WalkontableTableRenderer:{get:function(){return l}},__esModule:{value:!0}});var i,s=(i=e("./../../../dom.js"),i&&i.__esModule&&i||{"default":i}),a={},l=function(e){this.wtTable=e,this.wot=e.instance,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0};$traceurRuntime.createClass(l,{render:function(){this.wtTable.isWorkingOnClone()||this.wot.getSetting("beforeDraw",!0),this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t=this.wtTable.getRenderedColumnsCount(),n=this.wtTable.getRenderedRowsCount(),o=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),i=!1;if(o>0&&(this.adjustAvailableNodes(),i=!0,this.renderColGroups(),this.renderColumnHeaders(),this.renderRows(r,n,t),this.wtTable.isWorkingOnClone()?this.adjustColumnHeaderHeights():(e=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(t)),i||this.adjustAvailableNodes(),this.removeRedundantRows(n),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM(),e!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;for(var s=this.wtTable.getFirstRenderedColumn(),a=this.wtTable.getLastRenderedColumn(),l=s;a>l;l++){var u=this.wtTable.getStretchedColumnWidth(l),d=this.columnFilter.sourceToRendered(l);this.COLGROUP.childNodes[d+this.rowHeaderCount].style.width=u+"px"}}this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(e,t,n){for(var o,r,i=0,s=this.rowFilter.renderedToSource(i),a=this.wtTable.isWorkingOnClone();e>s&&s>=0;){if(i>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&i===t)break;if(r=this.getOrCreateTrForRow(i,r),this.renderRowHeaders(s,r),this.adjustColumns(r,n+this.rowHeaderCount),o=this.renderCells(s,r,n),a||this.resetOversizedRow(s),r.firstChild){var l=this.wot.wtTable.getRowHeight(s);l?r.firstChild.style.height=l+"px":r.firstChild.style.height=""}i++,s=this.rowFilter.renderedToSource(i)}},resetOversizedRow:function(e){this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[e]&&(this.wot.wtViewport.oversizedRows[e]=void 0)},markOversizedRows:function(){var e,t,n,o,r,i=this.instance.wtTable.TBODY.childNodes.length,a=i*this.instance.wtSettings.settings.defaultRowHeight,l=s.innerHeight(this.instance.wtTable.TBODY)-1;if(a!==l)for(;i;)i--,n=this.instance.wtTable.rowFilter.renderedToSource(i),e=this.instance.wtTable.getRowHeight(n),o=this.instance.wtTable.getTrForRow(n),r=o.querySelector("th"),t=r?s.innerHeight(r):s.innerHeight(o)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<t||t>e)&&(this.instance.wtViewport.oversizedRows[n]=t)},adjustColumnHeaderHeights:function(){for(var e=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,o=0,r=e.length;r>o;o++)if(n[o]){if(0===t[o].childNodes.length)return;t[o].childNodes[0].style.height=n[o]+"px"}},markIfOversizedColumnHeader:function(e){var t,n,o,r,i=this.wot.getSetting("columnHeaders").length,a=this.wot.wtSettings.settings.defaultRowHeight;for(t=this.wot.wtTable.columnFilter.renderedToSource(e);i;)i--,n=this.wot.wtTable.getColumnHeaderHeight(i),o=this.wot.wtTable.getColumnHeader(t,i),o&&(r=s.innerHeight(o),(!n&&r>a||r>n)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=r))},renderCells:function(e,t,n){for(var o,i,a=0;n>a;a++)i=this.columnFilter.renderedToSource(a),o=0===a?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:o.nextSibling,"TH"==o.nodeName&&(o=r(o,t)),s.hasClass(o,"hide")||(o.className=""),o.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(e,i,o);return o},adjustColumnWidths:function(e){var t=0,n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder;o.offsetHeight<o.scrollHeight&&(t=s.getScrollbarWidth()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-t);for(var r=0;e>r;r++){var i=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(r));this.COLGROUP.childNodes[r+this.rowHeaderCount].style.width=i+"px"}},appendToTbody:function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(e,t){var n;return e>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===e?this.TBODY.firstChild:t.nextSibling,n},createRow:function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},renderRowHeader:function(e,t,n){n.className="",n.removeAttribute("style"),this.rowHeaders[t](e,n,t)},renderRowHeaders:function(e,t){for(var n=t.firstChild,r=0;r<this.rowHeaderCount;r++)n?"TD"==n.nodeName&&(n=o(n,t)):(n=document.createElement("TH"),t.appendChild(n)),this.renderRowHeader(e,r,n),n=n.nextSibling},adjustAvailableNodes:function(){this.adjustColGroups(),this.adjustThead()},renderColumnHeaders:function(){var e=this.wot.getOverlayName();if(this.columnHeaderCount){for(var t=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var o=this.getTrForColumnHeaders(n),r=-1*this.rowHeaderCount;t>r;r++){var i=this.columnFilter.renderedToSource(r);this.renderColumnHeader(n,i,o.childNodes[r+this.rowHeaderCount]),a[e]||this.wtTable.isWorkingOnClone()||this.markIfOversizedColumnHeader(r)}a[e]=!0}},adjustColGroups:function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},adjustThead:function(){var e=this.wtTable.getRenderedColumnsCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,o=this.columnHeaders.length;o>n;n++){for(t=this.THEAD.childNodes[n],t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(var i=this.columnHeaders.length;r>i;i++)this.THEAD.removeChild(this.THEAD.lastChild)}else t&&s.empty(t)},getTrForColumnHeaders:function(e){return this.THEAD.childNodes[e]},renderColumnHeader:function(e,t,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[e](t,n,e)},renderColGroups:function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?s.addClass(this.COLGROUP.childNodes[e],"rowHeader"):s.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},adjustColumns:function(e,t){for(var n=e.childNodes.length;t>n;){var o=document.createElement("TD");e.appendChild(o),n++}for(;n>t;)e.removeChild(e.lastChild),n--},removeRedundantColumns:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{}),window.WalkontableTableRenderer=l},{"./../../../dom.js":27}],22:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewport:{get:function(){return c}},__esModule:{value:!0}});var o,r,i,s,a=(o=e("./../../../dom.js"),o&&o.__esModule&&o||{"default":o}),l=(r=e("./../../../eventManager.js"),r&&r.__esModule&&r||{"default":r}).eventManager,u=(i=e("./calculator/viewportColumns.js"),i&&i.__esModule&&i||{"default":i}).WalkontableViewportColumnsCalculator,d=(s=e("./calculator/viewportRows.js"),s&&s.__esModule&&s||{"default":s}).WalkontableViewportRowsCalculator,c=function(e){var t=this;this.wot=e,this.instance=this.wot,this.oversizedRows=[],this.oversizedCols=[],this.oversizedColumnHeaders=[],this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null;var n=l(e);n.addEventListener(window,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})};$traceurRuntime.createClass(c,{getWorkspaceHeight:function(){var e,t=this.instance.wtOverlays.topOverlay.trimmingContainer,n=0;return t===window?n=document.documentElement.clientHeight:(e=a.outerHeight(t),n=e>0&&t.clientHeight>0?t.clientHeight:1/0),n},getWorkspaceWidth:function(){var e,t,n=this.instance.getSetting("totalColumns"),o=this.instance.wtOverlays.leftOverlay.trimmingContainer,r=this.instance.getSetting("stretchH"),i=document.documentElement.offsetWidth;return e=Handsontable.freezeOverlays?Math.min(i-this.getWorkspaceOffset().left,i):Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i),o===window&&n>0&&this.sumColumnWidths(0,n-1)>e?document.documentElement.clientWidth:o!==window&&(t=a.getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),"scroll"==t||"hidden"==t||"auto"==t)?Math.max(e,o.clientWidth):"none"!==r&&r?e:Math.max(e,a.outerWidth(this.instance.wtTable.TABLE))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(e,t){for(var n=0,o=this.instance.wtSettings.defaultColumnWidth;t>e;)n+=this.wot.wtTable.getColumnWidth(e)||o,e++;return n},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;var e,t,n=this.instance.wtTable.holder;return t=document.createElement("DIV"),t.style.width="100%",t.style.height="1px",n.appendChild(t),e=t.offsetWidth,this.containerWidth=e,n.removeChild(t),e},getWorkspaceOffset:function(){return a.offset(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return a.outerHeight(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return a.outerWidth(this.wot.wtTable.TABLE)||a.outerWidth(this.wot.wtTable.TBODY)||a.outerWidth(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=a.outerHeight(this.wot.wtTable.THEAD)),this.columnHeaderHeight},getViewportHeight:function(){var e,t=this.getWorkspaceHeight();return t===1/0?t:(e=this.getColumnHeaderHeight(),e>0&&(t-=e),t)},getRowHeaderWidth:function(){if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,o=e.length;o>n;n++)t?(this.rowHeaderWidth+=a.outerWidth(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},getViewportWidth:function(){var e,t=this.getWorkspaceWidth();return t===1/0?t:(e=this.getRowHeaderWidth(),e>0?t-e:t)},createRowsCalculator:function(){var e,t,n,o=void 0!==arguments[0]?arguments[0]:!1,r=this;if(this.rowHeaderWidth=NaN,e=this.wot.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight(),t=a.getScrollTop(this.wot.wtOverlays.mainTableScrollableElement)-this.wot.wtOverlays.topOverlay.getTableParentOffset(),0>t&&(t=0),n=this.wot.getSetting("fixedRowsTop")){var i=this.wot.wtOverlays.topOverlay.sumCellSizes(0,n);t+=i,e-=i}return new d(e,t,this.wot.getSetting("totalRows"),function(e){return r.wot.wtTable.getRowHeight(e)},o?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,o)},createColumnsCalculator:function(){var e,t,n=void 0!==arguments[0]?arguments[0]:!1,o=this,r=this.getViewportWidth();if(this.columnHeaderHeight=NaN,e=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),0>e&&(e=0),t=this.wot.getSetting("fixedColumnsLeft")){var i=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,t);e+=i,r-=i}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(r-=a.getScrollbarWidth()),new u(r,e,this.wot.getSetting("totalColumns"),function(e){return o.wot.wtTable.getColumnWidth(e)},n?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,n,this.wot.getSetting("stretchH"))},createRenderCalculators:function(){var e=void 0!==arguments[0]?arguments[0]:!1;if(e){var t=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(e){return this.rowsVisibleCalculator?e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0?!1:e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.wot.getSetting("totalRows")-1?!1:!0:!1},areAllProposedVisibleColumnsAlreadyRendered:function(e){return this.columnsVisibleCalculator?e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0?!1:e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.wot.getSetting("totalColumns")-1?!1:!0:!1}},{}),window.WalkontableViewport=c},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./calculator/viewportColumns.js":3,"./calculator/viewportRows.js":4}],23:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d,c,h,f,p,g=Handsontable.version,m=Handsontable.buildDate;window.Handsontable=function v(e,t){var n=new v.Core(e,t||{});return n.init(),n},Handsontable.version=g,Handsontable.buildDate=m,o=e("./shims/array.filter.js"),o&&o.__esModule&&o||{"default":o},r=e("./shims/array.indexOf.js"),r&&r.__esModule&&r||{"default":r},i=e("./shims/array.isArray.js"),i&&i.__esModule&&i||{"default":i},s=e("./shims/classes.js"),s&&s.__esModule&&s||{"default":s},a=e("./shims/object.keys.js"),a&&a.__esModule&&a||{"default":a},l=e("./shims/string.trim.js"),l&&l.__esModule&&l||{"default":l},u=e("./shims/weakmap.js"),u&&u.__esModule&&u||{"default":u},Handsontable.plugins={};var w=(d=e("./pluginHooks.js"),d&&d.__esModule&&d||{"default":d}).Hooks;Handsontable.hooks||(Handsontable.hooks=new w),c=e("./core.js"),c&&c.__esModule&&c||{"default":c},h=e("./renderers/_cellDecorator.js"),h&&h.__esModule&&h||{"default":h},f=e("./cellTypes.js"),f&&f.__esModule&&f||{"default":f},p=e("./../plugins/jqueryHandsontable.js"),p&&p.__esModule&&p||{"default":p}},{"./../plugins/jqueryHandsontable.js":1,"./cellTypes.js":24,"./core.js":25,"./pluginHooks.js":44,"./renderers/_cellDecorator.js":71,"./shims/array.filter.js":78,"./shims/array.indexOf.js":79,"./shims/array.isArray.js":80,"./shims/classes.js":81,"./shims/object.keys.js":82,"./shims/string.trim.js":83,"./shims/weakmap.js":84}],24:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d,c,h,f,p,g,m,w,v,y,b,C,R,S,E,T=(o=e("./helpers.js"),o&&o.__esModule&&o||{"default":o}),_=(r=e("./editors.js"),r&&r.__esModule&&r||{"default":r}).getEditorConstructor,k=(i=e("./renderers.js"),i&&i.__esModule&&i||{"default":i}).getRenderer;(s=e("./editors/autocompleteEditor.js"),s&&s.__esModule&&s||{"default":s}).AutocompleteEditor,(a=e("./editors/checkboxEditor.js"),a&&a.__esModule&&a||{"default":a}).CheckboxEditor,(l=e("./editors/dateEditor.js"),l&&l.__esModule&&l||{"default":l}).DateEditor,(u=e("./editors/dropdownEditor.js"),u&&u.__esModule&&u||{"default":u}).DropdownEditor,(d=e("./editors/handsontableEditor.js"),d&&d.__esModule&&d||{"default":d}).HandsontableEditor,(c=e("./editors/mobileTextEditor.js"),c&&c.__esModule&&c||{"default":c}).MobileTextEditor,(h=e("./editors/numericEditor.js"),h&&h.__esModule&&h||{"default":h}).NumericEditor,(f=e("./editors/passwordEditor.js"),f&&f.__esModule&&f||{"default":f}).PasswordEditor,(p=e("./editors/selectEditor.js"),p&&p.__esModule&&p||{"default":p}).SelectEditor,(g=e("./editors/textEditor.js"),g&&g.__esModule&&g||{"default":g}).TextEditor,(m=e("./renderers/autocompleteRenderer.js"),m&&m.__esModule&&m||{"default":m}).AutocompleteRenderer,(w=e("./renderers/checkboxRenderer.js"),w&&w.__esModule&&w||{"default":w}).CheckboxRenderer,(v=e("./renderers/htmlRenderer.js"),v&&v.__esModule&&v||{"default":v}).HtmlRenderer,(y=e("./renderers/numericRenderer.js"),y&&y.__esModule&&y||{"default":y}).NumericRenderer,(b=e("./renderers/passwordRenderer.js"),b&&b.__esModule&&b||{"default":b}).PasswordRenderer,(C=e("./renderers/textRenderer.js"),C&&C.__esModule&&C||{"default":C}).TextRenderer,(R=e("./validators/autocompleteValidator.js"),R&&R.__esModule&&R||{"default":R}).AutocompleteValidator,(S=e("./validators/dateValidator.js"),S&&S.__esModule&&S||{"default":S}).DateValidator,(E=e("./validators/numericValidator.js"),E&&E.__esModule&&E||{"default":E}).NumericValidator;Handsontable.mobileBrowser=T.isMobileBrowser(),Handsontable.AutocompleteCell={editor:_("autocomplete"),renderer:k("autocomplete"),validator:Handsontable.AutocompleteValidator},Handsontable.CheckboxCell={editor:_("checkbox"),renderer:k("checkbox")},Handsontable.TextCell={editor:_(Handsontable.mobileBrowser?"mobile":"text"),renderer:k("text")},Handsontable.NumericCell={editor:_("numeric"),renderer:k("numeric"),validator:Handsontable.NumericValidator,dataType:"number"},Handsontable.DateCell={editor:_("date"),validator:Handsontable.DateValidator,renderer:k("autocomplete")},Handsontable.HandsontableCell={editor:_("handsontable"),renderer:k("autocomplete")},Handsontable.PasswordCell={editor:_("password"),renderer:k("password"),copyable:!1},Handsontable.DropdownCell={editor:_("dropdown"),renderer:k("autocomplete"),validator:Handsontable.AutocompleteValidator},Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell},Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}}},{"./editors.js":29,"./editors/autocompleteEditor.js":31,"./editors/checkboxEditor.js":32,"./editors/dateEditor.js":33,"./editors/dropdownEditor.js":34,"./editors/handsontableEditor.js":35,"./editors/mobileTextEditor.js":36,"./editors/numericEditor.js":37,"./editors/passwordEditor.js":38,"./editors/selectEditor.js":39,"./editors/textEditor.js":40,"./helpers.js":42,"./renderers.js":70,"./renderers/autocompleteRenderer.js":72,"./renderers/checkboxRenderer.js":73,"./renderers/htmlRenderer.js":74,"./renderers/numericRenderer.js":75,"./renderers/passwordRenderer.js":76,"./renderers/textRenderer.js":77,"./validators/autocompleteValidator.js":86,"./validators/dateValidator.js":87,"./validators/numericValidator.js":88}],25:[function(e,t,n){"use strict";var o,r,i,s,a,l,u,d,c,h,f,p,g=(o=e("./dom.js"),o&&o.__esModule&&o||{"default":o}),m=(r=e("./helpers.js"),r&&r.__esModule&&r||{"default":r}),w=(i=e("numeral"),i&&i.__esModule&&i||{"default":i})["default"],v=(s=e("./dataMap.js"),s&&s.__esModule&&s||{"default":s}).DataMap,y=(a=e("./editorManager.js"),a&&a.__esModule&&a||{"default":a}).EditorManager,b=(l=e("./eventManager.js"),l&&l.__esModule&&l||{"default":l}).eventManager,C=(u=e("./plugins.js"),u&&u.__esModule&&u||{"default":u}).getPlugin,R=(d=e("./renderers.js"),d&&d.__esModule&&d||{"default":d}).getRenderer,S=(c=e("./tableView.js"),c&&c.__esModule&&c||{"default":c}).TableView,E=(h=e("./3rdparty/walkontable/src/cell/coords.js"),h&&h.__esModule&&h||{"default":h}).WalkontableCellCoords,T=(f=e("./3rdparty/walkontable/src/cell/range.js"),f&&f.__esModule&&f||{"default":f}).WalkontableCellRange;(p=e("./3rdparty/walkontable/src/selection.js"),p&&p.__esModule&&p||{"default":p}).WalkontableSelection;Handsontable.activeGuid=null,Handsontable.Core=function(e,t){function n(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function o(e,t,o){function r(){var n;e.length&&(n=Handsontable.hooks.run(k,"beforeChange",e,t),"function"==typeof n?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):n===!1&&e.splice(0,e.length)),o()}var i=new n;i.onQueueEmpty=r;for(var s=e.length-1;s>=0;s--)if(null===e[s])e.splice(s,1);else{var a=e[s][0],l=c.propToCol(e[s][1]),u=k.runHooks("modifyCol",l),d=k.getCellMeta(a,u);if("numeric"===d.type&&"string"==typeof e[s][3]&&e[s][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(e[s][3])||d.format)){var h=e[s][3].length;"undefined"==typeof d.language?w.language("en"):e[s][3].indexOf(".")===h-3&&-1===e[s][3].indexOf(",")?w.language("en"):w.language(d.language),w.validate(e[s][3])&&(e[s][3]=w().unformat(e[s][3]))}k.getCellValidator(d)&&(i.addValidatorToQueue(),k.validateCell(e[s][3],d,function(t,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");o===!1&&n.allowInvalid===!1&&(e.splice(t,1),n.valid=!0,--t),i.removeValidatorFormQueue()}}(s,d),t))}i.checkIfQueueIsEmpty()}function r(e,t){var n=e.length-1;if(!(0>n)){for(;n>=0;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(d.settings.allowInsertRow)for(;e[n][0]>k.countRows()-1;)c.createRow();if("array"===k.dataType&&d.settings.allowInsertColumn)for(;c.propToCol(e[n][1])>k.countCols()-1;)c.createCol();c.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);k.forceFullRender=!0,h.adjustRowsAndCols(),Handsontable.hooks.run(k,"beforeChangeRender",e,t),f.refreshBorders(null,!0),Handsontable.hooks.run(k,"afterChange",e,t||"edit")}}function i(e,t,n){return"object"==typeof e?e:[[e,t,n]]}function s(e){if(e.hasOwnProperty("type")){var t,n={};if("object"==typeof e.type)t=e.type;else if("string"==typeof e.type&&(t=Handsontable.cellTypes[e.type],void 0===t))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var o in t)t.hasOwnProperty(o)&&!e.hasOwnProperty(o)&&(n[o]=t[o]);return n}}function a(e){return Handsontable.hooks.run(k,"modifyRow",e)}function l(e){return Handsontable.hooks.run(k,"modifyCol",e)}function u(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var d,c,h,f,p,k=this,H=function(){},M=b(k);m.extend(H.prototype,_.prototype),m.extend(H.prototype,t),m.extend(H.prototype,s(t)),this.rootElement=e,this.isHotTableEnv=g.isChildOfWebComponentTable(this.rootElement),Handsontable.eventManager.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),e.insertBefore(this.container,e.firstChild),this.guid="ht_"+m.randomString(),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),d={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new H,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},h={alter:function(e,t,n,o,r){var i;switch(n=n||1,e){case"insert_row":if(k.getSettings().maxRows===k.countRows())return;i=c.createRow(t,n),i&&(f.isSelected()&&d.selRange.from.row>=t?(d.selRange.from.row=d.selRange.from.row+i,f.transformEnd(i,0)):f.refreshBorders());break;case"insert_col":if(i=c.createCol(t,n)){if(Array.isArray(k.getSettings().colHeaders)){var s=[t,0];s.length+=i,Array.prototype.splice.apply(k.getSettings().colHeaders,s)}f.isSelected()&&d.selRange.from.col>=t?(d.selRange.from.col=d.selRange.from.col+i,f.transformEnd(0,i)):f.refreshBorders()}break;case"remove_row":t=k.runHooks("modifyCol",t),c.removeRow(t,n),d.cellSettings.splice(t,n);var a=k.getSettings().fixedRowsTop;a>=t+1&&(k.getSettings().fixedRowsTop-=Math.min(n,a-t)),h.adjustRowsAndCols(),f.refreshBorders();break;case"remove_col":c.removeCol(t,n);for(var l=0,u=c.getAll().length;u>l;l++)l in d.cellSettings&&d.cellSettings[l].splice(t,n);var p=k.getSettings().fixedColumnsLeft;p>=t+1&&(k.getSettings().fixedColumnsLeft-=Math.min(n,p-t)),Array.isArray(k.getSettings().colHeaders)&&("undefined"==typeof t&&(t=-1),k.getSettings().colHeaders.splice(t,n)),h.adjustRowsAndCols(),f.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}r||h.adjustRowsAndCols()},adjustRowsAndCols:function(){if(d.settings.minRows){var e=k.countRows();if(e<d.settings.minRows)for(var t=0,n=d.settings.minRows;n-e>t;t++)c.createRow(k.countRows(),1,!0)}if(d.settings.minSpareRows){var o=k.countEmptyRows(!0);if(o<d.settings.minSpareRows)for(;o<d.settings.minSpareRows&&k.countRows()<d.settings.maxRows;o++)c.createRow(k.countRows(),1,!0)}var r;if((d.settings.minCols||d.settings.minSpareCols)&&(r=k.countEmptyCols(!0)),d.settings.minCols&&!d.settings.columns&&k.countCols()<d.settings.minCols)for(;k.countCols()<d.settings.minCols;r++)c.createCol(k.countCols(),1,!0);if(d.settings.minSpareCols&&!d.settings.columns&&"array"===k.dataType&&r<d.settings.minSpareCols)for(;r<d.settings.minSpareCols&&k.countCols()<d.settings.maxCols;r++)c.createCol(k.countCols(),1,!0);var i=k.countRows(),s=k.countCols();if((0===i||0===s)&&f.deselect(),f.isSelected()){var a=!1,l=d.selRange.from.row,u=d.selRange.from.col,h=d.selRange.to.row,p=d.selRange.to.col;l>i-1?(l=i-1,a=!0,h>l&&(h=l)):h>i-1&&(h=i-1,a=!0,l>h&&(l=h)),u>s-1?(u=s-1,a=!0,p>u&&(p=u)):p>s-1&&(p=s-1,a=!0,u>p&&(u=p)),a&&k.selectCell(l,u,h,p)}k.view&&k.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(e,t,n,o,r,i,s){var a,l,u,c,h=[],f={};if(l=t.length,0===l)return!1;var p,g,w,v;switch(r){case"shift_down":for(p=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,t=m.translateRowsToColumns(t),u=0,c=t.length,w=Math.max(c,p);w>u;u++)if(c>u){for(a=0,l=t[u].length;g-l>a;a++)t[u].push(t[u][a%l]);t[u].unshift(e.col+u,e.row,0),k.spliceCol.apply(k,t[u])}else t[u%c][0]=e.col+u,k.spliceCol.apply(k,t[u%c]);break;case"shift_right":for(p=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,a=0,l=t.length,v=Math.max(l,g);v>a;a++)if(l>a){for(u=0,c=t[a].length;p-c>u;u++)t[a].push(t[a][u%c]);t[a].unshift(e.row+a,e.col,0),k.spliceRow.apply(k,t[a])}else t[a%l][0]=e.row+a,k.spliceRow.apply(k,t[a%l]);break;case"overwrite":default:f.row=e.row,f.col=e.col;var y={row:0,col:0},b={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},C=!0;for(-1!==["up","left"].indexOf(i)?y={row:Math.ceil(b.row/l)||1,col:Math.ceil(b.col/t[0].length)||1}:-1!==["down","right"].indexOf(i)&&(y={row:1,col:1}),a=0;l>a&&!(n&&f.row>n.row||!d.settings.allowInsertRow&&f.row>k.countRows()-1||f.row>=d.settings.maxRows);a++){for(f.col=e.col,c=t[a]?t[a].length:0,u=0;c>u&&!(n&&f.col>n.col||!d.settings.allowInsertColumn&&f.col>k.countCols()-1||f.col>=d.settings.maxCols);u++){if(!k.getCellMeta(f.row,f.col).readOnly){var R,S,E,T=t[a][u],_=k.getDataAtCell(f.row,f.col),H={row:a,col:u};"autofill"===o&&(R=k.runHooks("beforeAutofillInsidePopulate",H,i,t,s,y,b),R&&(y="undefined"!=typeof R.iterators?R.iterators:y,T="undefined"!=typeof R.value?R.value:T)),null!==T&&"object"==typeof T?null===_||"object"!=typeof _?C=!1:(E=Handsontable.helper.duckSchema(_[0]||_),S=Handsontable.helper.duckSchema(T[0]||T),Handsontable.helper.isObjectEquals(E,S)?T=Handsontable.helper.deepClone(T):C=!1):null!==_&&"object"==typeof _&&(C=!1),C&&h.push([f.row,f.col,T]),C=!0}f.col++,n&&u===c-1&&(u=-1,-1!==["down","right"].indexOf(i)?y.col++:-1!==["up","left"].indexOf(i)&&y.col>1&&y.col--)}f.row++,y.col=1,n&&a===l-1&&(a=-1,-1!==["down","right"].indexOf(i)?y.row++:-1!==["up","left"].indexOf(i)&&y.row>1&&y.row--)}k.setDataAtCell(h,null,null,o||"populateFromArray")}}},this.selection=f={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){k.selection.selectedHeader.rows=e,k.selection.selectedHeader.cols=t},begin:function(){k.selection.inProgress=!0},finish:function(){var e=k.getSelected();Handsontable.hooks.run(k,"afterSelectionEnd",e[0],e[1],e[2],e[3]),Handsontable.hooks.run(k,"afterSelectionEndByProp",e[0],k.colToProp(e[1]),e[2],k.colToProp(e[3])),k.selection.inProgress=!1},isInProgress:function(){return k.selection.inProgress},setRangeStart:function(e,t){Handsontable.hooks.run(k,"beforeSetRangeStart",e),d.selRange=new T(e,e,e),f.setRangeEnd(e,null,t)},setRangeEnd:function(e,t,n){if(null!==d.selRange){var o;Handsontable.hooks.run(k,"beforeSetRangeEnd",e),k.selection.begin(),d.selRange.to=new E(e.row,e.col),d.settings.multiSelect||(d.selRange.from=e),k.view.wt.selections.current.clear(),o=k.getCellMeta(d.selRange.highlight.row,d.selRange.highlight.col).disableVisualSelection,"string"==typeof o&&(o=[o]),(o===!1||Array.isArray(o)&&-1===o.indexOf("current"))&&k.view.wt.selections.current.add(d.selRange.highlight),k.view.wt.selections.area.clear(),(o===!1||Array.isArray(o)&&-1===o.indexOf("area"))&&f.isMultiple()&&(k.view.wt.selections.area.add(d.selRange.from),k.view.wt.selections.area.add(d.selRange.to)),(d.settings.currentRowClassName||d.settings.currentColClassName)&&(k.view.wt.selections.highlight.clear(),k.view.wt.selections.highlight.add(d.selRange.from),k.view.wt.selections.highlight.add(d.selRange.to)),Handsontable.hooks.run(k,"afterSelection",d.selRange.from.row,d.selRange.from.col,d.selRange.to.row,d.selRange.to.col),Handsontable.hooks.run(k,"afterSelectionByProp",d.selRange.from.row,c.colToProp(d.selRange.from.col),d.selRange.to.row,c.colToProp(d.selRange.to.col)),t!==!1&&k.view.mainViewIsActive()&&(d.selRange.from&&!f.isMultiple()?k.view.scrollViewport(d.selRange.from):k.view.scrollViewport(e)),f.refreshBorders(null,n)}},refreshBorders:function(e,t){t||p.destroyEditor(e),k.view.render(),f.isSelected()&&!t&&p.prepareEditor()},isMultiple:function(){var e=!(d.selRange.to.col===d.selRange.from.col&&d.selRange.to.row===d.selRange.from.row),t=Handsontable.hooks.run(k,"afterIsMultipleSelection",e);return e?t:void 0},transformStart:function(e,t,n,o){var r,i,s,a=new E(e,t),l=0,u=0;k.runHooks("modifyTransformStart",a),r=k.countRows(),i=k.countCols(),d.selRange.highlight.row+e>r-1?n&&d.settings.minSpareRows>0?(k.alter("insert_row",r),r=k.countRows()):d.settings.autoWrapCol&&(a.row=1-r,a.col=d.selRange.highlight.col+a.col==i-1?1-i:1):d.settings.autoWrapCol&&d.selRange.highlight.row+a.row<0&&d.selRange.highlight.col+a.col>=0&&(a.row=r-1,
a.col=d.selRange.highlight.col+a.col==0?i-1:-1),d.selRange.highlight.col+a.col>i-1?n&&d.settings.minSpareCols>0?(k.alter("insert_col",i),i=k.countCols()):d.settings.autoWrapRow&&(a.row=d.selRange.highlight.row+a.row==r-1?1-r:1,a.col=1-i):d.settings.autoWrapRow&&d.selRange.highlight.col+a.col<0&&d.selRange.highlight.row+a.row>=0&&(a.row=d.selRange.highlight.row+a.row==0?r-1:-1,a.col=i-1),s=new E(d.selRange.highlight.row+a.row,d.selRange.highlight.col+a.col),s.row<0?(l=-1,s.row=0):s.row>0&&s.row>=r&&(l=1,s.row=r-1),s.col<0?(u=-1,s.col=0):s.col>0&&s.col>=i&&(u=1,s.col=i-1),k.runHooks("afterModifyTransformStart",s,l,u),f.setRangeStart(s,o)},transformEnd:function(e,t){var n,o,r,i=new E(e,t),s=0,a=0;k.runHooks("modifyTransformEnd",i),n=k.countRows(),o=k.countCols(),r=new E(d.selRange.to.row+i.row,d.selRange.to.col+i.col),r.row<0?(s=-1,r.row=0):r.row>0&&r.row>=n&&(s=1,r.row=n-1),r.col<0?(a=-1,r.col=0):r.col>0&&r.col>=o&&(a=1,r.col=o-1),k.runHooks("afterModifyTransformEnd",r,s,a),f.setRangeEnd(r,!0)},isSelected:function(){return null!==d.selRange},inInSelection:function(e){return f.isSelected()?d.selRange.includes(e):!1},deselect:function(){f.isSelected()&&(k.selection.inProgress=!1,d.selRange=null,k.view.wt.selections.current.clear(),k.view.wt.selections.area.clear(),(d.settings.currentRowClassName||d.settings.currentColClassName)&&k.view.wt.selections.highlight.clear(),p.destroyEditor(),f.refreshBorders(),Handsontable.hooks.run(k,"afterDeselect"))},selectAll:function(){d.settings.multiSelect&&(f.setRangeStart(new E(0,0)),f.setRangeEnd(new E(k.countRows()-1,k.countCols()-1),!1))},empty:function(){if(f.isSelected()){var e,t,n=d.selRange.getTopLeftCorner(),o=d.selRange.getBottomRightCorner(),r=[];for(e=n.row;e<=o.row;e++)for(t=n.col;t<=o.col;t++)k.getCellMeta(e,t).readOnly||r.push([e,t,""]);k.setDataAtCell(r)}}},this.init=function(){Handsontable.hooks.run(k,"beforeInit"),Handsontable.mobileBrowser&&g.addClass(k.rootElement,"mobile"),this.updateSettings(d.settings,!0),this.view=new S(this),p=new y(k,d,f,c),this.forceFullRender=!0,this.view.render(),"object"==typeof d.firstRun&&(Handsontable.hooks.run(k,"afterChange",d.firstRun[0],d.firstRun[1]),d.firstRun=!1),Handsontable.hooks.run(k,"afterInit")},this.validateCell=function(e,t,n,o){function r(e){var o=t.col,r=t.row,i=k.getCell(r,o,!0);i&&k.view.wt.wtSettings.settings.cellRenderer(r,o,i),n(e)}var i=k.getCellValidator(t);"[object RegExp]"===Object.prototype.toString.call(i)&&(i=function(e){return function(t,n){n(e.test(t))}}(i)),"function"==typeof i?(e=Handsontable.hooks.run(k,"beforeValidate",e,t.row,t.prop,o),k._registerTimeout(setTimeout(function(){i.call(t,e,function(n){n=Handsontable.hooks.run(k,"afterValidate",n,e,t.row,t.prop,o),t.valid=n,r(n),Handsontable.hooks.run(k,"postAfterValidate",n,e,t.row,t.prop,o)})},0))):(t.valid=!0,r(t.valid))},this.setDataAtCell=function(e,t,n,s){var a,l,u,d=i(e,t,n),h=[];for(a=0,l=d.length;l>a;a++){if("object"!=typeof d[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof d[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=c.colToProp(d[a][1]),h.push([d[a][0],u,c.get(d[a][0],u),d[a][2]])}s||"object"!=typeof e||(s=t),o(h,s,function(){r(h,s)})},this.setDataAtRowProp=function(e,t,n,s){var a,l,u=i(e,t,n),d=[];for(a=0,l=u.length;l>a;a++)d.push([u[a][0],u[a][1],c.get(u[a][0],u[a][1]),u[a][2]]);s||"object"!=typeof e||(s=t),o(d,s,function(){r(d,s)})},this.listen=function(){Handsontable.activeGuid=k.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){Handsontable.activeGuid=null},this.isListening=function(){return Handsontable.activeGuid===k.guid},this.destroyEditor=function(e){f.refreshBorders(e)},this.populateFromArray=function(e,t,n,o,r,i,s,a,l){var u;if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return u="number"==typeof o?new E(o,r):null,h.populateFromArray(new E(e,t),n,u,i,s,a,l)},this.spliceCol=function(e,t,n){return c.spliceCol.apply(c,arguments)},this.spliceRow=function(e,t,n){return c.spliceRow.apply(c,arguments)},this.getSelected=function(){return f.isSelected()?[d.selRange.from.row,d.selRange.from.col,d.selRange.to.row,d.selRange.to.col]:void 0},this.getSelectedRange=function(){return f.isSelected()?d.selRange:void 0},this.render=function(){k.view&&(k.forceFullRender=!0,f.refreshBorders(null,!0))},this.loadData=function(e){function t(){d.cellSettings.length=0}if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,o=0,r=d.settings.startRows;r>o;o++){n=[];for(var i=0,s=d.settings.startCols;s>i;i++)n.push(null);e.push(n)}}d.isPopulated=!1,H.prototype.data=e,Array.isArray(d.settings.dataSchema)||Array.isArray(e[0])?k.dataType="array":"function"==typeof d.settings.dataSchema?k.dataType="function":k.dataType="object",c=new v(k,d,H),t(),h.adjustRowsAndCols(),Handsontable.hooks.run(k,"afterLoadData"),d.firstRun?d.firstRun=[null,"loadData"]:(Handsontable.hooks.run(k,"afterChange",null,"loadData"),k.render()),d.isPopulated=!0},this.getData=function(e,t,n,o){return"undefined"==typeof e?c.getAll():c.getRange(new E(e,t),new E(n,o),c.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,n,o){return c.getCopyableText(new E(e,t),new E(n,o))},this.getSchema=function(){return c.getSchema()},this.updateSettings=function(e,t){var n,o;if("undefined"!=typeof e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(Handsontable.hooks.getRegistered().indexOf(n)>-1?("function"==typeof e[n]||Array.isArray(e[n]))&&k.addHook(n,e[n]):!t&&e.hasOwnProperty(n)&&(H.prototype[n]=e[n]));if(void 0===e.data&&void 0===d.settings.data?k.loadData(null):void 0!==e.data?k.loadData(e.data):void 0!==e.columns&&c.createMap(),o=k.countCols(),d.cellSettings.length=0,o>0){var r,i;for(n=0;o>n;n++)d.columnSettings[n]=m.columnFactory(H,d.columnsSettingConflicts),r=d.columnSettings[n].prototype,H.prototype.columns&&(i=H.prototype.columns[n],m.extend(r,i),m.extend(r,s(i)))}if("undefined"!=typeof e.cell)for(n in e.cell)if(e.cell.hasOwnProperty(n)){var a=e.cell[n];k.setCellMetaObject(a.row,a.col,a)}if(Handsontable.hooks.run(k,"afterCellMetaReset"),"undefined"!=typeof e.className&&(H.prototype.className&&g.removeClass(k.rootElement,H.prototype.className),e.className&&g.addClass(k.rootElement,e.className)),"undefined"!=typeof e.height){var l=e.height;"function"==typeof l&&(l=l()),k.rootElement.style.height=l+"px"}if("undefined"!=typeof e.width){var u=e.width;"function"==typeof u&&(u=u()),k.rootElement.style.width=u+"px"}l&&(k.rootElement.style.overflow="hidden"),t||Handsontable.hooks.run(k,"afterUpdateSettings"),h.adjustRowsAndCols(),k.view&&!d.firstRun&&(k.forceFullRender=!0,f.refreshBorders(null,!0))},this.getValue=function(){var e=k.getSelected();if(H.prototype.getValue){if("function"==typeof H.prototype.getValue)return H.prototype.getValue.call(k);if(e)return k.getData()[e[0]][H.prototype.getValue]}else if(e)return k.getDataAtCell(e[0],e[1])},this.getSettings=function(){return d.settings},this.clear=function(){f.selectAll(),f.empty()},this.alter=function(e,t,n,o,r){h.alter(e,t,n,o,r)},this.getCell=function(e,t,n){return k.view.getCellAtCoords(new E(e,t),n)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return c.colToProp(e)},this.propToCol=function(e){return c.propToCol(e)},this.getDataAtCell=function(e,t){return c.get(e,c.colToProp(t))},this.getDataAtRowProp=function(e,t){return c.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,c.getRange(new E(0,e),new E(d.settings.data.length-1,e),c.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t,n=[];return t=c.getRange(new E(0,c.propToCol(e)),new E(d.settings.data.length-1,c.propToCol(e)),c.DESTINATION_RENDERER),n.concat.apply(n,t)},this.getSourceDataAtCol=function(e){for(var t=[],n=d.settings.data,o=0;o<n.length;o++)t.push(n[o][e]);return t},this.getSourceDataAtRow=function(e){return d.settings.data[e]},this.getDataAtRow=function(e){var t=c.getRange(new E(e,0),new E(e,this.countCols()-1),c.DESTINATION_RENDERER);return t[0]},this.removeCellMeta=function(e,t,n){var o=k.getCellMeta(e,t);void 0!=o[n]&&delete d.cellSettings[e][t][n]},this.setCellMetaObject=function(e,t,n){if("object"==typeof n)for(var o in n)if(n.hasOwnProperty(o)){var r=n[o];this.setCellMeta(e,t,o,r)}},this.setCellMeta=function(e,t,n,o){d.cellSettings[e]||(d.cellSettings[e]=[]),d.cellSettings[e][t]||(d.cellSettings[e][t]=new d.columnSettings[t]),d.cellSettings[e][t][n]=o,Handsontable.hooks.run(k,"afterSetCellMeta",e,t,n,o)},this.getCellMeta=function(e,t){var n,o=c.colToProp(t);if(e=a(e),t=l(t),d.columnSettings[t]||(d.columnSettings[t]=m.columnFactory(H,d.columnsSettingConflicts)),d.cellSettings[e]||(d.cellSettings[e]=[]),d.cellSettings[e][t]||(d.cellSettings[e][t]=new d.columnSettings[t]),n=d.cellSettings[e][t],n.row=e,n.col=t,n.prop=o,n.instance=k,Handsontable.hooks.run(k,"beforeGetCellMeta",e,t,n),m.extend(n,s(n)),n.cells){var r=n.cells.call(n,e,t,o);r&&(m.extend(n,r),m.extend(n,s(r)))}return Handsontable.hooks.run(k,"afterGetCellMeta",e,t,n),n},this.isColumnModificationAllowed=function(){return!("object"===k.dataType||k.getSettings().columns)};var O=m.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){var n=O.call(this,e,t);return R(n)},this.getCellEditor=m.cellMethodLookupFactory("editor"),this.getCellValidator=m.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new n;t.onQueueEmpty=e;for(var o=k.countRows()-1;o>=0;){for(var r=k.countCols()-1;r>=0;)t.addValidatorToQueue(),k.validateCell(k.getDataAtCell(o,r),k.getCellMeta(o,r),function(){t.removeValidatorFormQueue()},"validateCells"),r--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],n=0,o=k.countRows();o>n;n++)t.push(k.getRowHeader(n));return t}return Array.isArray(d.settings.rowHeaders)&&void 0!==d.settings.rowHeaders[e]?d.settings.rowHeaders[e]:"function"==typeof d.settings.rowHeaders?d.settings.rowHeaders(e):d.settings.rowHeaders&&"string"!=typeof d.settings.rowHeaders&&"number"!=typeof d.settings.rowHeaders?e+1:d.settings.rowHeaders},this.hasRowHeaders=function(){return!!d.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==d.settings.colHeaders&&null!==d.settings.colHeaders)return!!d.settings.colHeaders;for(var e=0,t=k.countCols();t>e;e++)if(k.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var t=[],n=0,o=k.countCols();o>n;n++)t.push(k.getColHeader(n));return t}var r=e;return e=Handsontable.hooks.run(k,"modifyCol",e),d.settings.columns&&d.settings.columns[e]&&d.settings.columns[e].title?d.settings.columns[e].title:Array.isArray(d.settings.colHeaders)&&void 0!==d.settings.colHeaders[e]?d.settings.colHeaders[e]:"function"==typeof d.settings.colHeaders?d.settings.colHeaders(e):d.settings.colHeaders&&"string"!=typeof d.settings.colHeaders&&"number"!=typeof d.settings.colHeaders?m.spreadsheetColumnLabel(r):d.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=k.getCellMeta(0,e),n=t.width;if((void 0===n||n===d.settings.width)&&(n=t.colWidths),void 0!==n&&null!==n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(e){var t=k._getColWidthFromSettings(e);return t||(t=50),t=Handsontable.hooks.run(k,"modifyColWidth",t,e)},this._getRowHeightFromSettings=function(e){var t=d.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=k._getRowHeightFromSettings(e);return t=Handsontable.hooks.run(k,"modifyRowHeight",t,e)},this.countRows=function(){return d.settings.data.length},this.countCols=function(){return"object"===k.dataType||"function"===k.dataType?d.settings.columns&&d.settings.columns.length?d.settings.columns.length:c.colToPropCache.length:"array"===k.dataType?d.settings.columns&&d.settings.columns.length?d.settings.columns.length:d.settings.data&&d.settings.data[0]&&d.settings.data[0].length?d.settings.data[0].length:0:void 0},this.rowOffset=function(){return k.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return k.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return k.view.wt.drawn?k.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return k.view.wt.drawn?k.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return k.view.wt.drawn?k.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return k.view.wt.drawn?k.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var t,n=k.countRows()-1,o=0;n>=0;){if(t=Handsontable.hooks.run(this,"modifyRow",n),k.isEmptyRow(t))o++;else if(e)break;n--}return o},this.countEmptyCols=function(e){if(k.countRows()<1)return 0;for(var t=k.countCols()-1,n=0;t>=0;){if(k.isEmptyCol(t))n++;else if(e)break;t--}return n},this.isEmptyRow=function(e){return d.settings.isEmptyRow.call(k,e)},this.isEmptyCol=function(e){return d.settings.isEmptyCol.call(k,e)},this.selectCell=function(e,t,n,o,r,i){var s;if(i="undefined"==typeof i||i===!0,"number"!=typeof e||0>e||e>=k.countRows())return!1;if("number"!=typeof t||0>t||t>=k.countCols())return!1;if("undefined"!=typeof n){if("number"!=typeof n||0>n||n>=k.countRows())return!1;if("number"!=typeof o||0>o||o>=k.countCols())return!1}return s=new E(e,t),d.selRange=new T(s,s,s),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),i&&k.listen(),"undefined"==typeof n?f.setRangeEnd(d.selRange.from,r):f.setRangeEnd(new E(n,o),r),k.selection.finish(),!0},this.selectCellByProp=function(e,t,n,o,r){return arguments[1]=c.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=c.propToCol(arguments[3])),k.selectCell.apply(k,arguments)},this.deselectCell=function(){f.deselect()},this.destroy=function(){k._clearTimeouts(),k.view&&k.view.destroy(),g.empty(k.rootElement),M.clear(),Handsontable.hooks.run(k,"afterDestroy"),Handsontable.hooks.destroy(k);for(var e in k)k.hasOwnProperty(e)&&("function"==typeof k[e]?"runHooks"!==e&&(k[e]=u):"guid"!==e&&(k[e]=null));d=null,c=null,h=null,f=null,p=null,k=null,H=null},this.getActiveEditor=function(){return p.getActiveEditor()},this.getPlugin=function(e){return C(this,e)},this.getInstance=function(){return k},this.addHook=function(e,t){Handsontable.hooks.add(e,t,k)},this.addHookOnce=function(e,t){Handsontable.hooks.once(e,t,k)},this.removeHook=function(e,t){Handsontable.hooks.remove(e,t,k)},this.runHooks=function(e,t,n,o,r,i,s){return Handsontable.hooks.run(k,e,t,n,o,r,i,s)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;t>e;e++)clearTimeout(this.timeouts[e])},this.version=Handsontable.version};var _=function(){};_.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:!1,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t,n,o,r;for(t=0,n=this.countCols();n>t;t++)if(o=this.getDataAtCell(e,t),""!==o&&null!==o&&"undefined"!=typeof o)return"object"==typeof o?(r=this.getCellMeta(e,t),m.isObjectEquals(this.getSchema()[r.prop],o)):!1;return!0},isEmptyCol:function(e){var t,n,o;for(t=0,n=this.countRows();n>t;t++)if(o=this.getDataAtCell(t,e),""!==o&&null!==o&&"undefined"!=typeof o)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0,validator:void 0,disableVisualSelection:!1,sortIndicator:!1,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,format:void 0,className:void 0},Handsontable.DefaultSettings=_},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/cell/range.js":6,"./3rdparty/walkontable/src/selection.js":18,"./dataMap.js":26,"./dom.js":27,"./editorManager.js":28,"./eventManager.js":41,"./helpers.js":42,"./plugins.js":45,"./renderers.js":70,"./tableView.js":85,numeral:"numeral"}],26:[function(e,t,n){"use strict";function o(e,t,n){this.instance=e,this.priv=t,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap()}Object.defineProperties(n,{DataMap:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a=(r=e("./helpers.js"),r&&r.__esModule&&r||{"default":r}),l=(i=e("./multiMap.js"),i&&i.__esModule&&i||{"default":i}).MultiMap,u=(s=e("SheetClip"),s&&s.__esModule&&s||{"default":s})["default"];Handsontable.DataMap=o,o.prototype.DESTINATION_RENDERER=1,o.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,o.prototype.recursiveDuckSchema=function(e){return Handsontable.helper.duckSchema(e)},o.prototype.recursiveDuckColumns=function(e,t,n){var o,r;if("undefined"==typeof t&&(t=0,n=""),"object"==typeof e&&!Array.isArray(e))for(r in e)e.hasOwnProperty(r)&&(null===e[r]?(o=n+r,this.colToPropCache.push(o),this.propToColCache.set(o,t),t++):t=this.recursiveDuckColumns(e[r],t,r+"."));return t},o.prototype.createMap=function(){var e,t,n=this.getSchema();if("undefined"==typeof n)throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new l;var o=this.instance.getSettings().columns;if(o)for(e=0,t=o.length;t>e;e++)"undefined"!=typeof o[e].data&&(this.colToPropCache[e]=o[e].data,this.propToColCache.set(o[e].data,e));else this.recursiveDuckColumns(n)},o.prototype.colToProp=function(e){return e=Handsontable.hooks.run(this.instance,"modifyCol",e),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[e]?this.colToPropCache[e]:e},o.prototype.propToCol=function(e){var t;return t="undefined"!=typeof this.propToColCache.get(e)?this.propToColCache.get(e):e,t=Handsontable.hooks.run(this.instance,"modifyCol",t)},o.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},o.prototype.createRow=function(e,t,n){var o,r,i=this.instance.countCols(),s=0;t||(t=1),("number"!=typeof e||e>=this.instance.countRows())&&(e=this.instance.countRows()),r=e;for(var l=this.instance.getSettings().maxRows;t>s&&this.instance.countRows()<l;){if("array"===this.instance.dataType){o=[];for(var u=0;i>u;u++)o.push(null)}else"function"===this.instance.dataType?o=this.instance.getSettings().dataSchema(e):(o={},a.deepExtend(o,this.getSchema()));e===this.instance.countRows()?this.dataSource.push(o):this.dataSource.splice(e,0,o),s++,r++}return Handsontable.hooks.run(this.instance,"afterCreateRow",e,s,n),this.instance.forceFullRender=!0,s},o.prototype.createCol=function(e,t,n){if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var o,r,i=this.instance.countRows(),s=this.dataSource,l=0;t||(t=1),r=e;for(var u=this.instance.getSettings().maxCols;t>l&&this.instance.countCols()<u;){if(o=a.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){for(var d=0;i>d;d++)"undefined"==typeof s[d]&&(s[d]=[]),s[d].push(null);this.priv.columnSettings.push(o)}else{for(var d=0;i>d;d++)s[d].splice(r,0,null);this.priv.columnSettings.splice(r,0,o)}l++,r++}return Handsontable.hooks.run(this.instance,"afterCreateCol",e,l,n),this.instance.forceFullRender=!0,l},o.prototype.removeRow=function(e,t){t||(t=1),"number"!=typeof e&&(e=-t),e=(this.instance.countRows()+e)%this.instance.countRows();var n=this.physicalRowsToLogical(e,t),o=Handsontable.hooks.run(this.instance,"beforeRemoveRow",e,t);if(o!==!1){var r=this.dataSource,i=r.filter(function(e,t){return-1==n.indexOf(t)});r.length=0,Array.prototype.push.apply(r,i),Handsontable.hooks.run(this.instance,"afterRemoveRow",e,t),this.instance.forceFullRender=!0}},o.prototype.removeCol=function(e,t){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");t||(t=1),"number"!=typeof e&&(e=-t),e=(this.instance.countCols()+e)%this.instance.countCols();var n=Handsontable.hooks.run(this.instance,"beforeRemoveCol",e,t);if(n!==!1){for(var o=this.dataSource,r=0,i=this.instance.countRows();i>r;r++)o[r].splice(e,t);this.priv.columnSettings.splice(e,t),Handsontable.hooks.run(this.instance,"afterRemoveCol",e,t),this.instance.forceFullRender=!0}},o.prototype.spliceCol=function(e,t,n){var o=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(e),i=r.slice(t,t+n),s=r.slice(t+n);a.extendArray(o,s);for(var l=0;n>l;)o.push(null),l++;return a.to2dArray(o),this.instance.populateFromArray(t,e,o,null,null,"spliceCol"),i},o.prototype.spliceRow=function(e,t,n){var o=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(e),i=r.slice(t,t+n),s=r.slice(t+n);a.extendArray(o,s);for(var l=0;n>l;)o.push(null),l++;return this.instance.populateFromArray(e,t,[o],null,null,"spliceRow"),i},o.prototype.get=function(e,t){if(e=Handsontable.hooks.run(this.instance,"modifyRow",e),"string"==typeof t&&t.indexOf(".")>-1){var n=t.split("."),o=this.dataSource[e];if(!o)return null;for(var r=0,i=n.length;i>r;r++)if(o=o[n[r]],"undefined"==typeof o)return null;return o}return"function"==typeof t?t(this.dataSource.slice(e,e+1)[0]):this.dataSource[e]?this.dataSource[e][t]:null};var d=a.cellMethodLookupFactory("copyable",!1);o.prototype.getCopyable=function(e,t){return d.call(this.instance,e,this.propToCol(t))?this.get(e,t):""},o.prototype.set=function(e,t,n,o){if(e=Handsontable.hooks.run(this.instance,"modifyRow",e,o||"datamapGet"),"string"==typeof t&&t.indexOf(".")>-1){for(var r=t.split("."),i=this.dataSource[e],s=0,a=r.length-1;a>s;s++)"undefined"==typeof i[r[s]]&&(i[r[s]]={}),i=i[r[s]];i[r[s]]=n}else"function"==typeof t?t(this.dataSource.slice(e,e+1)[0],n):this.dataSource[e][t]=n},o.prototype.physicalRowsToLogical=function(e,t){for(var n,o=this.instance.countRows(),r=(o+e)%o,i=[],s=t;o>r&&s;)n=Handsontable.hooks.run(this.instance,"modifyRow",r),i.push(n),s--,r++;return i},o.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},o.prototype.getAll=function(){return this.dataSource},o.prototype.getRange=function(e,t,n){var o,r,i,s,a,l=[],u=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(r=Math.max(e.row,t.row),s=Math.max(e.col,t.col),o=Math.min(e.row,t.row);r>=o;o++){for(a=[],i=Math.min(e.col,t.col);s>=i;i++)a.push(u.call(this,o,this.colToProp(i)));l.push(a)}return l},o.prototype.getText=function(e,t){return u.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},o.prototype.getCopyableText=function(e,t){return u.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}},{"./helpers.js":42,"./multiMap.js":43,SheetClip:"SheetClip"}],27:[function(e,t,n){"use strict";function o(e){null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})}function r(e,t,n){for(;null!=e&&e!==n;){if(e.nodeType===Node.ELEMENT_NODE&&(t.indexOf(e.nodeName)>-1||t.indexOf(e)>-1))return e;e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode}return null}function i(e,t){var n=e.parentNode,o=[];for("string"==typeof t?o=Array.prototype.slice.call(document.querySelectorAll(t),0):o.push(t);null!=n;){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function s(e){function t(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===o.toUpperCase()}var n,o="hot-table",r=!1;for(n=a(e);null!=n;){if(t(n)){r=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r=t(n.host))break;n=n.host}n=n.parentNode}return r}function a(e){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(e):e}function l(e){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(e):e}function u(){var e=document.createElement("div");return e.createShadowRoot&&e.createShadowRoot.toString().match(/\[native code\]/)?!0:!1}function d(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t}function c(e){var t=0,n=[];if(!e||!e.length)return n;for(;e[t];)n.push(e[t]),t++;return n}function h(e,t){return X(e,t)}function f(e,t){return K(e,t)}function p(e,t){return q(e,t)}function g(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var n=e.childNodes,o=n.length-1;o>=0;o--)g(n[o],e)}function m(e){for(var t;t=e.lastChild;)e.removeChild(t)}function w(e,t){ne.test(t)?e.innerHTML=t:v(e,t)}function v(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?oe?n.textContent=t:n.data=t:(m(e),e.appendChild(document.createTextNode(t)))}function y(e){for(var t=e;l(t)!==document.documentElement;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return y(t.host.impl);if(t.host)return y(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0}function b(e){var t,n,o,r,i;if(r=document.documentElement,N()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName)return i=e.getBoundingClientRect(),{top:i.top+(window.pageYOffset||r.scrollTop)-(r.clientTop||0),left:i.left+(window.pageXOffset||r.scrollLeft)-(r.clientLeft||0)};for(t=e.offsetLeft,n=e.offsetTop,o=e;(e=e.offsetParent)&&e!==document.body;)t+=e.offsetLeft,n+=e.offsetTop,o=e;return o&&"fixed"===o.style.position&&(t+=window.pageXOffset||r.scrollLeft,n+=window.pageYOffset||r.scrollTop),{left:t,top:n}}function C(){var e=window.scrollY;return void 0==e&&(e=document.documentElement.scrollTop),e}function R(){var e=window.scrollX;return void 0==e&&(e=document.documentElement.scrollLeft),e}function S(e){return e===window?C(e):e.scrollTop}function E(e){return e===window?R(e):e.scrollLeft}function T(e){for(var t,n,o,r=e.parentNode,i=["auto","scroll"],s="",a="",l="",u="";r&&r.style&&document.body!==r;){if(t=r.style.overflow,n=r.style.overflowX,o=r.style.overflowY,"scroll"==t||"scroll"==n||"scroll"==o)return r;if(window.getComputedStyle&&(s=window.getComputedStyle(r),a=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),u=s.getPropertyValue("overflow-x"),"scroll"===a||"scroll"===u||"scroll"===l))return r;if(r.clientHeight<=r.scrollHeight&&(-1!==i.indexOf(o)||-1!==i.indexOf(t)||-1!==i.indexOf(a)||-1!==i.indexOf(l)))return r;if(r.clientWidth<=r.scrollWidth&&(-1!==i.indexOf(n)||-1!==i.indexOf(t)||-1!==i.indexOf(a)||-1!==i.indexOf(u)))return r;r=r.parentNode}return window}function _(e){for(var t=e.parentNode;t&&t.style&&document.body!==t;){if("visible"!==t.style.overflow&&""!==t.style.overflow)return t;if(window.getComputedStyle){var n=window.getComputedStyle(t);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return t}t=t.parentNode}return window}function k(e,t){if(e){if(e!==window){var n,o=e.style[t];return""!==o&&void 0!==o?o:(n=H(e),""!==n[t]&&void 0!==n[t]?n[t]:void 0)}if("width"===t)return window.innerWidth+"px";if("height"===t)return window.innerHeight+"px"}}function H(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}function M(e){return e.offsetWidth}function O(e){return N()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function D(e){return e.clientHeight||e.innerHeight}function x(e){return e.clientWidth||e.innerWidth}function A(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function j(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function P(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,e.insertBefore(n,t),document.body.appendChild(e),ee=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function N(){return void 0===ee&&P(),ee}function L(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(t.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function W(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange();return n.text.indexOf(t.text)+t.text.length}}function I(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(o){var r=e.parentNode,i=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=i}}else if(e.createTextRange){var s=e.createTextRange();s.collapse(!0),s.moveEnd("character",n),s.moveStart("character",t),s.select()}}function B(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var o=e.offsetWidth;return n==o&&(o=t.clientWidth),(document.body||document.documentElement).removeChild(t),n-o}function V(){return void 0===te&&(te=B()),te}function F(){return F}function Y(){return ie}function G(){return se}function z(e,t,n){re||ie?(e.style.top=n,e.style.left=t):se?e.style["-webkit-transform"]="translate3d("+t+","+n+",0)":e.style.transform="translate3d("+t+","+n+",0)";
}function U(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function $(e){e.transform&&""!==e.transform?e.transform="":e["-webkit-transform"]&&""!==e["-webkit-transform"]&&(e["-webkit-transform"]="")}Object.defineProperties(n,{enableImmediatePropagation:{get:function(){return o}},closest:{get:function(){return r}},isChildOf:{get:function(){return i}},isChildOfWebComponentTable:{get:function(){return s}},polymerWrap:{get:function(){return a}},polymerUnwrap:{get:function(){return l}},isWebComponentSupportedNatively:{get:function(){return u}},index:{get:function(){return d}},hasClass:{get:function(){return h}},addClass:{get:function(){return f}},removeClass:{get:function(){return p}},removeTextNodes:{get:function(){return g}},empty:{get:function(){return m}},HTML_CHARACTERS:{get:function(){return ne}},fastInnerHTML:{get:function(){return w}},fastInnerText:{get:function(){return v}},isVisible:{get:function(){return y}},offset:{get:function(){return b}},getWindowScrollTop:{get:function(){return C}},getWindowScrollLeft:{get:function(){return R}},getScrollTop:{get:function(){return S}},getScrollLeft:{get:function(){return E}},getScrollableElement:{get:function(){return T}},getTrimmingContainer:{get:function(){return _}},getStyle:{get:function(){return k}},getComputedStyle:{get:function(){return H}},outerWidth:{get:function(){return M}},outerHeight:{get:function(){return O}},innerHeight:{get:function(){return D}},innerWidth:{get:function(){return x}},addEvent:{get:function(){return A}},removeEvent:{get:function(){return j}},hasCaptionProblem:{get:function(){return N}},getCaretPosition:{get:function(){return L}},getSelectionEndPosition:{get:function(){return W}},setCaretPosition:{get:function(){return I}},getScrollbarWidth:{get:function(){return V}},isIE8:{get:function(){return F}},isIE9:{get:function(){return Y}},isSafari:{get:function(){return G}},setOverlayPosition:{get:function(){return z}},getCssTransform:{get:function(){return U}},resetCssTransform:{get:function(){return $}},__esModule:{value:!0}});var X,K,q,Z=document.documentElement.classList?!0:!1;if(Z){var J=function(){var e=document.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")}();X=function(e,t){return""===t?!1:e.classList.contains(t)},K=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=c(t),J)e.classList.add.apply(e.classList,t);else for(;t&&t[n];)e.classList.add(t[n]),n++},q=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=c(t),J)e.classList.remove.apply(e.classList,t);else for(;t&&t[n];)e.classList.remove(t[n]),n++}}else{var Q=function(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")};X=function(e,t){return e.className.match(Q(t))?!0:!1},K=function(e,t){var n=0,o=e.className;if("string"==typeof t&&(t=t.split(" ")),""===o)o=t.join(" ");else for(;t&&t[n];)Q(t[n]).test(o)||(o+=" "+t[n]),n++;e.className=o},q=function(e,t){var n=0,o=e.className;for("string"==typeof t&&(t=t.split(" "));t&&t[n];)o=o.replace(Q(t[n])," ").trim(),n++;e.className!==o&&(e.className=o)}}var ee,te,ne=/(<(.*)>|&(.*);)/,oe=document.createTextNode("test").textContent?!0:!1,re=!document.createTextNode("test").textContent,ie=!!document.documentMode,se=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);window.Handsontable=window.Handsontable||{},Handsontable.Dom={addClass:f,addEvent:A,closest:r,empty:m,enableImmediatePropagation:o,fastInnerHTML:w,fastInnerText:v,getCaretPosition:L,getComputedStyle:H,getCssTransform:U,getScrollableElement:T,getScrollbarWidth:V,getScrollLeft:E,getScrollTop:S,getStyle:k,getSelectionEndPosition:W,getTrimmingContainer:_,getWindowScrollLeft:R,getWindowScrollTop:C,hasCaptionProblem:N,hasClass:h,HTML_CHARACTERS:ne,index:d,innerHeight:D,innerWidth:x,isChildOf:i,isChildOfWebComponentTable:s,isIE8:F,isIE9:Y,isSafari:G,isVisible:y,isWebComponentSupportedNatively:u,offset:b,outerHeight:O,outerWidth:M,polymerUnwrap:l,polymerWrap:a,removeClass:p,removeEvent:j,removeTextNodes:g,resetCssTransform:$,setCaretPosition:I,setOverlayPosition:z}},{}],28:[function(e,t,n){"use strict";function o(e,t,n){function o(e){var o="function"==typeof t.settings.enterMoves?t.settings.enterMoves(event):t.settings.enterMoves;e?n.transformStart(-o.row,-o.col):n.transformStart(o.row,o.col,!0)}function r(e){e?n.transformEnd(-1,0):n.transformStart(-1,0)}function i(e){e?n.transformEnd(1,0):n.transformStart(1,0)}function s(e){e?n.transformEnd(0,1):n.transformStart(0,1)}function a(e){e?n.transformEnd(0,-1):n.transformStart(0,-1)}function l(l){var h,f;if(e.isListening()&&(Handsontable.hooks.run(e,"beforeKeyDown",l),!v&&(c.enableImmediatePropagation(l),!l.isImmediatePropagationStopped()&&(t.lastKeyCode=l.keyCode,n.isSelected())))){if(h=(l.ctrlKey||l.metaKey)&&!l.altKey,g&&!g.isWaiting()&&!d.isMetaKey(l.keyCode)&&!h&&!m.isEditorOpened())return void m.openEditor("",l);switch(f=l.shiftKey?n.setRangeEnd:n.setRangeStart,l.keyCode){case w.A:!m.isEditorOpened()&&h&&(n.selectAll(),l.preventDefault(),d.stopPropagation(l));break;case w.ARROW_UP:m.isEditorOpened()&&!g.isWaiting()&&m.closeEditorAndSaveChanges(h),r(l.shiftKey),l.preventDefault(),d.stopPropagation(l);break;case w.ARROW_DOWN:m.isEditorOpened()&&!g.isWaiting()&&m.closeEditorAndSaveChanges(h),i(l.shiftKey),l.preventDefault(),d.stopPropagation(l);break;case w.ARROW_RIGHT:m.isEditorOpened()&&!g.isWaiting()&&m.closeEditorAndSaveChanges(h),s(l.shiftKey),l.preventDefault(),d.stopPropagation(l);break;case w.ARROW_LEFT:m.isEditorOpened()&&!g.isWaiting()&&m.closeEditorAndSaveChanges(h),a(l.shiftKey),l.preventDefault(),d.stopPropagation(l);break;case w.TAB:var p="function"==typeof t.settings.tabMoves?t.settings.tabMoves(l):t.settings.tabMoves;l.shiftKey?n.transformStart(-p.row,-p.col):n.transformStart(p.row,p.col,!0),l.preventDefault(),d.stopPropagation(l);break;case w.BACKSPACE:case w.DELETE:n.empty(l),m.prepareEditor(),l.preventDefault();break;case w.F2:m.openEditor(null,l),l.preventDefault();break;case w.ENTER:m.isEditorOpened()?(g&&g.state!==Handsontable.EditorState.WAITING&&m.closeEditorAndSaveChanges(h),o(l.shiftKey)):e.getSettings().enterBeginsEditing?m.openEditor(null,l):o(l.shiftKey),l.preventDefault(),l.stopImmediatePropagation();break;case w.ESCAPE:m.isEditorOpened()&&m.closeEditorAndRestoreOriginalValue(h),l.preventDefault();break;case w.HOME:f(l.ctrlKey||l.metaKey?new u(0,t.selRange.from.col):new u(t.selRange.from.row,0)),l.preventDefault(),d.stopPropagation(l);break;case w.END:f(l.ctrlKey||l.metaKey?new u(e.countRows()-1,t.selRange.from.col):new u(t.selRange.from.row,e.countCols()-1)),l.preventDefault(),d.stopPropagation(l);break;case w.PAGE_UP:n.transformStart(-e.countVisibleRows(),0),l.preventDefault(),d.stopPropagation(l);break;case w.PAGE_DOWN:n.transformStart(e.countVisibleRows(),0),l.preventDefault(),d.stopPropagation(l)}}}function f(){function t(e,t,n){"TD"==n.nodeName&&m.openEditor()}e.addHook("afterDocumentKeyDown",l),p.addEventListener(document.documentElement,"keydown",function(t){e.runHooks("afterDocumentKeyDown",t)}),e.view.wt.update("onCellDblClick",t),e.addHook("afterDestroy",function(){v=!0})}var p,g,m=this,w=d.keyCode,v=!1;p=h(e),this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return g},this.prepareEditor=function(){var n,o,r,i,s,a,l;return g&&g.isWaiting()?void this.closeEditor(!1,!1,function(e){e&&m.prepareEditor()}):(n=t.selRange.highlight.row,o=t.selRange.highlight.col,r=e.colToProp(o),i=e.getCell(n,o),s=e.getDataAtCell(n,o),a=e.getCellMeta(n,o),l=e.getCellEditor(a),void(l?(g=Handsontable.editors.getEditor(l,e),g.prepare(n,o,r,i,s,a)):g=void 0))},this.isEditorOpened=function(){return g&&g.isOpened()},this.openEditor=function(e,t){g&&!g.cellProperties.readOnly?g.beginEditing(e,t):g&&g.cellProperties.readOnly&&t&&t.keyCode===d.keyCode.ENTER&&o()},this.closeEditor=function(e,t,n){g?g.finishEditing(e,t,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},f()}Object.defineProperties(n,{EditorManager:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l,u=(r=e("./3rdparty/walkontable/src/cell/coords.js"),r&&r.__esModule&&r||{"default":r}).WalkontableCellCoords,d=(i=e("./helpers.js"),i&&i.__esModule&&i||{"default":i}),c=(s=e("./dom.js"),s&&s.__esModule&&s||{"default":s}),h=((a=e("./editors.js"),a&&a.__esModule&&a||{"default":a}).getEditor,(l=e("./eventManager.js"),l&&l.__esModule&&l||{"default":l}).eventManager);Handsontable.EditorManager=o},{"./3rdparty/walkontable/src/cell/coords.js":5,"./dom.js":27,"./editors.js":29,"./eventManager.js":41,"./helpers.js":42}],29:[function(e,t,n){"use strict";function o(e){var t,n;n={},t=e,this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in n||(n[e.guid]=new t(e)),n[e.guid]}}function r(e,t){var n=new o(t);"string"==typeof e&&(d[e]=n,Handsontable.editors[u.toUpperCaseFirst(e)+"Editor"]=t),c.set(t,n)}function i(e,t){var n;if("function"==typeof e)c.get(e)||r(null,e),n=c.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');n=d[e]}if(!n)throw Error('No editor registered under name "'+e+'"');return n.getInstance(t)}function s(e){var t;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');if(t=d[e],!t)throw Error('No editor registered under name "'+e+'"');return t.getConstructor()}function a(e){return d[e]?!0:!1}Object.defineProperties(n,{registerEditor:{get:function(){return r}},getEditor:{get:function(){return i}},hasEditor:{get:function(){return a}},getEditorConstructor:{get:function(){return s}},__esModule:{value:!0}});var l,u=(l=e("./helpers.js"),l&&l.__esModule&&l||{"default":l}),d={},c=new WeakMap;Handsontable.editors=Handsontable.editors||{},Handsontable.editors.registerEditor=r,Handsontable.editors.getEditor=i},{"./helpers.js":42}],30:[function(e,t,n){"use strict";function o(e){this.instance=e,this.state=Handsontable.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}Object.defineProperties(n,{BaseEditor:{get:function(){return o}},__esModule:{value:!0}});var r,i,s=(r=e("./../helpers.js"),r&&r.__esModule&&r||{"default":r}),a=(i=e("./../3rdparty/walkontable/src/cell/coords.js"),i&&i.__esModule&&i||{"default":i}).WalkontableCellCoords;Handsontable.editors=Handsontable.editors||{},Handsontable.editors.BaseEditor=o,Handsontable.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},o.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},o.prototype.init=function(){},o.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},o.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},o.prototype.open=function(){throw Error("Editor open() method unimplemented")},o.prototype.close=function(){throw Error("Editor close() method unimplemented")},o.prototype.prepare=function(e,t,n,o,r,i){this.TD=o,this.row=e,this.col=t,this.prop=n,this.originalValue=r,this.cellProperties=i,this.state=Handsontable.EditorState.VIRGIN},o.prototype.extend=function(){function e(){n.apply(this,arguments)}function t(e,t){function n(){}return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e}var n=this.constructor;return t(e,n)},o.prototype.saveValue=function(e,t){var n,o;t?(n=this.instance.getSelected(),n[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o),this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")):this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},o.prototype.beginEditing=function(e,t){this.state==Handsontable.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new a(this.row,this.col)),this.instance.view.render(),this.state=Handsontable.EditorState.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue(s.stringify(e)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render())},o.prototype.finishEditing=function(e,t,n){var o,r=this;if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e)}}if(!this.isWaiting()){if(this.state==Handsontable.EditorState.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0));if(this.state==Handsontable.EditorState.EDITING){if(e)return this.cancelChanges(),void this.instance.view.render();o=this.instance.getSettings().trimWhitespace?[["string"==typeof this.getValue()?String.prototype.trim.call(this.getValue()||""):this.getValue()]]:[[this.getValue()]],this.state=Handsontable.EditorState.WAITING,this.saveValue(o,t),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(e){r.state=Handsontable.EditorState.FINISHED,r.discardEditor(e)}):(this.state=Handsontable.EditorState.FINISHED,this.discardEditor(!0))}}},o.prototype.cancelChanges=function(){this.state=Handsontable.EditorState.FINISHED,this.discardEditor()},o.prototype.discardEditor=function(e){this.state===Handsontable.EditorState.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=Handsontable.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=Handsontable.EditorState.VIRGIN,this._fireCallbacks(!0)))},o.prototype.isOpened=function(){return this._opened},o.prototype.isWaiting=function(){return this.state===Handsontable.EditorState.WAITING}},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../helpers.js":42}],31:[function(e,t,n){"use strict";function o(e){p=!1;var t=this.getActiveEditor(),n=l.keyCode;if(l.isPrintableChar(e.keyCode)||e.keyCode===n.BACKSPACE||e.keyCode===n.DELETE||e.keyCode===n.INSERT){var o=0;if(e.keyCode===n.C&&(e.ctrlKey||e.metaKey))return;t.isOpened()||(o+=10),t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value),p=!0},o))}}Object.defineProperties(n,{AutocompleteEditor:{get:function(){return f}},__esModule:{value:!0}});var r,i,s,a,l=(r=e("./../helpers.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../dom.js"),i&&i.__esModule&&i||{"default":i}),d=(s=e("./../editors.js"),s&&s.__esModule&&s||{"default":s}),c=(d.getEditorConstructor,d.registerEditor),h=(a=e("./handsontableEditor.js"),a&&a.__esModule&&a||{"default":a}).HandsontableEditor,f=h.prototype.extend();f.prototype.init=function(){h.prototype.init.apply(this,arguments),this.query=null,this.choices=[]},f.prototype.createElements=function(){h.prototype.createElements.apply(this,arguments),u.addClass(this.htContainer,"autocompleteEditor"),u.addClass(this.htContainer,-1!==window.navigator.platform.indexOf("Mac")?"htMacScroll":"")};var p=!1;f.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",o),h.prototype.prepare.apply(this,arguments)},f.prototype.open=function(){h.prototype.open.apply(this,arguments);var e=this.htEditor.getInstance(),t=this;this.TEXTAREA.style.visibility="visible",this.focus(),e.updateSettings({colWidths:[u.outerWidth(this.TEXTAREA)-2],width:u.outerWidth(this.TEXTAREA)+u.getScrollbarWidth()+2,afterRenderer:function(e,n,o,r,i){var s,a,l=this.getCellMeta(n,o).filteringCaseSensitive===!0,i=Handsontable.helper.stringify(i);i&&(s=l?i.indexOf(this.query):i.toLowerCase().indexOf(t.query.toLowerCase()),-1!=s&&(a=i.substr(s,t.query.length),e.innerHTML=i.replace(a,"<strong>"+a+"</strong>")))}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=u.getScrollbarWidth()+2+"px",p&&(p=!1),t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value)},0))},f.prototype.close=function(){h.prototype.close.apply(this,arguments)},f.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var t=this;this.cellProperties.source(e,function(e){t.updateChoicesList(e)})}else if(Array.isArray(this.cellProperties.source)){var n;if(e&&this.cellProperties.filter!==!1){var o=this.cellProperties.filteringCaseSensitive===!0,r=e.toLowerCase();n=this.cellProperties.source.filter(function(t){return o?-1!=t.indexOf(e):-1!=t.toLowerCase().indexOf(r)})}else n=this.cellProperties.source;this.updateChoicesList(n)}else this.updateChoicesList([])},f.prototype.updateChoicesList=function(e){var t,n=u.getCaretPosition(this.TEXTAREA),o=u.getSelectionEndPosition(this.TEXTAREA),r=f.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var i=[],s=0,a=r.length;a>s;s++)i.push(e[r[s]]);t=0,e=i}else t=r[0];this.choices=e,this.htEditor.loadData(l.pivot([e])),this.updateDropdownHeight(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(t),this.instance.listen(),this.TEXTAREA.focus(),u.setCaretPosition(this.TEXTAREA,n,n!=o?o:void 0)},f.prototype.updateDropdownHeight=function(){this.htEditor.updateSettings({height:this.getDropdownHeight()}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},f.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",o),h.prototype.finishEditing.apply(this,arguments)},f.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},f.sortByRelevance=function(e,t,n){var o,r,i,s,a,l=[],u=e.length,d=[];if(0===u){for(s=0,a=t.length;a>s;s++)d.push(s);return d}for(s=0,a=t.length;a>s;s++)o=Handsontable.helper.stringify(t[s]),r=n?o.indexOf(e):o.toLowerCase().indexOf(e.toLowerCase()),-1!=r&&(i=o.length-r-u,l.push({baseIndex:s,index:r,charsLeft:i,value:o}));for(l.sort(function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),s=0,a=l.length;a>s;s++)d.push(l[s].baseIndex);return d},f.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},c("autocomplete",f)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./handsontableEditor.js":35}],32:[function(e,t,n){"use strict";Object.defineProperties(n,{CheckboxEditor:{get:function(){return u}},__esModule:{value:!0}});var o,r,i,s=(o=e("./../editors.js"),o&&o.__esModule&&o||{"default":o}).registerEditor,a=(r=e("./_baseEditor.js"),r&&r.__esModule&&r||{"default":r}).BaseEditor,l=(i=e("./../dom.js"),i&&i.__esModule&&i||{"default":i}),u=function(){$traceurRuntime.superConstructor(d).apply(this,arguments)},d=u;$traceurRuntime.createClass(u,{beginEditing:function(){var e=this.TD.querySelector('input[type="checkbox"]');l.hasClass(e,"htBadValue")||e.click()},finishEditing:function(){},init:function(){},open:function(){},close:function(){},getValue:function(){},setValue:function(){},focus:function(){}},{},a),s("checkbox",u)},{"./../dom.js":27,"./../editors.js":29,"./_baseEditor.js":30}],33:[function(e,t,n){"use strict";Object.defineProperties(n,{DateEditor:{get:function(){return v}},__esModule:{value:!0}});var o,r,i,s,a,l,u,d=(o=e("./../helpers.js"),o&&o.__esModule&&o||{"default":o}),c=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),h=(i=e("./../editors.js"),i&&i.__esModule&&i||{"default":i}),f=(h.getEditor,h.registerEditor),p=(s=e("./textEditor.js"),s&&s.__esModule&&s||{"default":s}).TextEditor,g=(a=e("./../eventManager.js"),a&&a.__esModule&&a||{"default":a}).eventManager,m=(l=e("moment"),l&&l.__esModule&&l||{"default":l})["default"],w=(u=e("pikaday"),u&&u.__esModule&&u||{"default":u})["default"],v=function(e){this.$datePicker=null,this.datePicker=null,this.datePickerStyle=null,this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,$traceurRuntime.superGet(this,y.prototype,"constructor").call(this,e)},y=v;$traceurRuntime.createClass(v,{init:function(){var e=this;if("function"!=typeof m)throw new Error("You need to include moment.js to your project.");if("function"!=typeof w)throw new Error("You need to include Pikaday to your project.");$traceurRuntime.superGet(this,y.prototype,"init").call(this),this.instance.addHook("afterDestroy",function(){e.parentDestroyed=!0,e.destroyElements()})},createElements:function(){var e=this;$traceurRuntime.superGet(this,y.prototype,"createElements").call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,c.addClass(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker);var t=this.TEXTAREA,n={format:this.defaultDateFormat,field:t,trigger:t,container:this.datePicker,reposition:!1,bound:!1,onSelect:function(t){isNaN(t.getTime())||(t=m(t).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(t),e.hideDatepicker()},onClose:function(){e.parentDestroyed||e.finishEditing(!1)}};this.$datePicker=new w(n);var o=g(this);o.addEventListener(this.datePicker,"mousedown",function(e){d.stopPropagation(e)}),this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(e,t,n,o,r,i){this._opened=!1,$traceurRuntime.superGet(this,y.prototype,"prepare").call(this,e,t,n,o,r,i)},open:function(){var e=void 0!==arguments[0]?arguments[0]:null;$traceurRuntime.superGet(this,y.prototype,"open").call(this),this.showDatepicker(e)},close:function(){var e=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0)),$traceurRuntime.superGet(this,y.prototype,"close").call(this)},finishEditing:function(){var e=void 0!==arguments[0]?arguments[0]:!1,t=void 0!==arguments[1]?arguments[1]:!1;if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}this.hideDatepicker(),$traceurRuntime.superGet(this,y.prototype,"finishEditing").call(this,e,t)},showDatepicker:function(e){var t,n=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.$datePicker.config(),i=this.instance.view.isMouseDown(),s=e?d.isMetaKey(e.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+n.top+c.outerHeight(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+n.left+"px",this.$datePicker._onInputFocus=function(){},r.format=o,this.originalValue?(t=this.originalValue,m(t,o,!0).isValid()&&this.$datePicker.setMoment(m(t,o),!0),s||i||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,r.defaultDate=t,m(t,o,!0).isValid()&&this.$datePicker.setMoment(m(t,o),!0),s||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{},p),f("date",v)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./textEditor.js":40,moment:"moment",pikaday:"pikaday"}],34:[function(e,t,n){"use strict";Object.defineProperties(n,{DropdownEditor:{get:function(){return l}},__esModule:{value:!0}});var o,r,i=(o=e("./../editors.js"),o&&o.__esModule&&o||{"default":o}),s=(i.getEditor,i.registerEditor),a=(r=e("./autocompleteEditor.js"),r&&r.__esModule&&r||{"default":r}).AutocompleteEditor,l=function(){$traceurRuntime.superConstructor(u).apply(this,arguments)},u=l;$traceurRuntime.createClass(l,{prepare:function(e,t,n,o,r,i){$traceurRuntime.superGet(this,u.prototype,"prepare").call(this,e,t,n,o,r,i),this.cellProperties.filter=!1,this.cellProperties.strict=!0}},{},a),s("dropdown",l)},{"./../editors.js":29,"./autocompleteEditor.js":31}],35:[function(e,t,n){"use strict";Object.defineProperties(n,{HandsontableEditor:{get:function(){return h}},__esModule:{value:!0}});var o,r,i,s,a=(o=e("./../helpers.js"),o&&o.__esModule&&o||{"default":o}),l=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../editors.js"),i&&i.__esModule&&i||{"default":i}),d=(u.getEditor,u.registerEditor),c=(s=e("./textEditor.js"),s&&s.__esModule&&s||{"default":s}).TextEditor,h=c.prototype.extend();h.prototype.createElements=function(){c.prototype.createElements.apply(this,arguments);var e=document.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.htEditor=new Handsontable(e),this.assignHooks()},h.prototype.prepare=function(e,t,n,o,r,i){c.prototype.prepare.apply(this,arguments);var s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&s.setValue(e),s.instance.destroyEditor()}};this.cellProperties.handsontable&&a.extend(l,i.handsontable),this.htEditor&&this.htEditor.destroy(),this.htEditor=new Handsontable(this.htContainer,l)};var f=function(e){if(null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),!e.isImmediatePropagationStopped()){var t,n=this.getActiveEditor(),o=n.htEditor.getInstance();if(e.keyCode==a.keyCode.ARROW_DOWN)if(o.getSelected()){var r=o.getSelected()[0],i=o.countRows()-1;t=Math.min(i,r+1)}else t=0;else if(e.keyCode==a.keyCode.ARROW_UP&&o.getSelected()){var r=o.getSelected()[0];t=r-1}void 0!==t&&(0>t?o.deselectCell():o.selectCell(t,0),e.preventDefault(),e.stopImmediatePropagation(),n.instance.listen(),n.TEXTAREA.focus())}};h.prototype.open=function(){this.instance.addHook("beforeKeyDown",f),c.prototype.open.apply(this,arguments),this.htEditor.render(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),l.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},h.prototype.close=function(){this.instance.removeHook("beforeKeyDown",f),this.instance.listen(),c.prototype.close.apply(this,arguments)},h.prototype.focus=function(){this.instance.listen(),c.prototype.focus.apply(this,arguments)},h.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&t()===!1||c.prototype.beginEditing.apply(this,arguments)},h.prototype.finishEditing=function(e,t){if(this.htEditor.isListening()&&this.instance.listen(),this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return c.prototype.finishEditing.apply(this,arguments)},h.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},d("handsontable",h)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./textEditor.js":40}],36:[function(e,t,n){"use strict";Object.defineProperties(n,{MobileTextEditor:{get:function(){return p}},__esModule:{value:!0}});var o,r,i,s,a,l=(o=e("./../helpers.js"),o&&o.__esModule&&o||{"default":o}),u=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),d=(i=e("./../editors.js"),i&&i.__esModule&&i||{"default":i}),c=(d.getEditor,d.registerEditor),h=(s=e("./_baseEditor.js"),s&&s.__esModule&&s||{"default":s}).BaseEditor,f=(a=e("./../eventManager.js"),a&&a.__esModule&&a||{"default":a}).eventManager,p=h.prototype.extend(),g={},m=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)this.controls.hasOwnProperty(e)&&this.positionControls.appendChild(this.controls[e])};p.prototype.valueChanged=function(){return this.initValue!=this.getValue()},p.prototype.init=function(){var e=this;this.eventManager=f(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},p.prototype.getValue=function(){return this.TEXTAREA.value},p.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},p.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),u.addClass(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),m.call(this),document.body.appendChild(this.editorContainer)},p.prototype.onBeforeKeyDown=function(e){var t=this,n=t.getActiveEditor();if(u.enableImmediatePropagation(e),e.target===n.TEXTAREA&&!e.isImmediatePropagationStopped()){var o=l.keyCode;switch(e.keyCode){case o.ENTER:n.close(),e.preventDefault();break;case o.BACKSPACE:e.stopImmediatePropagation()}}},p.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),u.addClass(this.editorContainer,"active"),u.removeClass(this.cellPointer,"hidden"),this.updateEditorPosition()},p.prototype.focus=function(){this.TEXTAREA.focus(),u.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},p.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),u.removeClass(this.editorContainer,"active")},p.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},p.prototype.hideCellPointer=function(){u.hasClass(this.cellPointer,"hidden")||u.addClass(this.cellPointer,"hidden")},p.prototype.updateEditorPosition=function(e,t){if(e&&t)e=parseInt(e,10),t=parseInt(t,10),this.editorContainer.style.top=t+"px",this.editorContainer.style.left=e+"px";else{var n=this.instance.getSelected(),o=this.instance.getCell(n[0],n[1]);if(g.cellPointer||(g.cellPointer={height:u.outerHeight(this.cellPointer),width:u.outerWidth(this.cellPointer)}),g.editorContainer||(g.editorContainer={width:u.outerWidth(this.editorContainer)}),void 0!==o){var r=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:u.getScrollLeft(this.instance.view.wt.wtOverlays.leftOverlay.holder),i=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:u.getScrollTop(this.instance.view.wt.wtOverlays.topOverlay.holder),s=u.offset(o),a=u.outerWidth(o),l={x:r,y:i};this.editorContainer.style.top=parseInt(s.top+u.outerHeight(o)-l.y+g.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-g.editorContainer.width/2,10)+"px",s.left+a/2>parseInt(this.editorContainer.style.left,10)+g.editorContainer.width?this.editorContainer.style.left=window.innerWidth-g.editorContainer.width+"px":s.left+a/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(s.left-g.cellPointer.width/2-u.offset(this.editorContainer).left+a/2-l.x,10)+"px"}}},p.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},p.prototype.prepareAndSave=function(){var e;return this.valueChanged()?(e=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],void this.saveValue(e)):!0},p.prototype.bindEvents=function(){
var e=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,-1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(-1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(t){if(1==t.touches.length){var n=t.touches[0],o={x:e.editorContainer.offsetLeft,y:e.editorContainer.offsetTop},r={x:n.pageX-o.x,y:n.pageY-o.y};e.eventManager.addEventListener(this,"touchmove",function(t){var n=t.touches[0];e.updateEditorPosition(n.pageX-r.x,n.pageY-r.y),e.hideCellPointer(),t.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(t){u.isChildOf(t.target,e.editorContainer)||u.isChildOf(t.target,e.instance.rootElement)||e.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&e.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&e.hideCellPointer()})},p.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},c("mobile",p)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30}],37:[function(e,t,n){"use strict";Object.defineProperties(n,{NumericEditor:{get:function(){return d}},__esModule:{value:!0}});var o,r,i,s=(o=e("numeral"),o&&o.__esModule&&o||{"default":o})["default"],a=(r=e("./../editors.js"),r&&r.__esModule&&r||{"default":r}),l=(a.getEditor,a.registerEditor),u=(i=e("./textEditor.js"),i&&i.__esModule&&i||{"default":i}).TextEditor,d=function(){$traceurRuntime.superConstructor(c).apply(this,arguments)},c=d;$traceurRuntime.createClass(d,{beginEditing:function(e){if("undefined"==typeof e&&this.originalValue){"undefined"!=typeof this.cellProperties.language&&s.language(this.cellProperties.language);var t=s.languageData().delimiters.decimal;e=(""+this.originalValue).replace(".",t)}$traceurRuntime.superGet(this,c.prototype,"beginEditing").call(this,e)}},{},u),l("numeric",d)},{"./../editors.js":29,"./textEditor.js":40,numeral:"numeral"}],38:[function(e,t,n){"use strict";Object.defineProperties(n,{PasswordEditor:{get:function(){return d}},__esModule:{value:!0}});var o,r,i,s=(o=e("./../dom.js"),o&&o.__esModule&&o||{"default":o}),a=(r=e("./../editors.js"),r&&r.__esModule&&r||{"default":r}),l=(a.getEditor,a.registerEditor),u=(i=e("./textEditor.js"),i&&i.__esModule&&i||{"default":i}).TextEditor,d=function(){$traceurRuntime.superConstructor(c).apply(this,arguments)},c=d;$traceurRuntime.createClass(d,{createElements:function(){$traceurRuntime.superGet(this,c.prototype,"createElements").call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,s.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},u),l("password",d)},{"./../dom.js":27,"./../editors.js":29,"./textEditor.js":40}],39:[function(e,t,n){"use strict";Object.defineProperties(n,{SelectEditor:{get:function(){return h}},__esModule:{value:!0}});var o,r,i,s,a=(o=e("./../dom.js"),o&&o.__esModule&&o||{"default":o}),l=(r=e("./../helpers.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../editors.js"),i&&i.__esModule&&i||{"default":i}),d=(u.getEditor,u.registerEditor),c=(s=e("./_baseEditor.js"),s&&s.__esModule&&s||{"default":s}).BaseEditor,h=c.prototype.extend();h.prototype.init=function(){this.select=document.createElement("SELECT"),a.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select)},h.prototype.prepare=function(){c.prototype.prepare.apply(this,arguments);var e,t=this.cellProperties.selectOptions;e="function"==typeof t?this.prepareOptions(t(this.row,this.col,this.prop)):this.prepareOptions(t),a.empty(this.select);for(var n in e)if(e.hasOwnProperty(n)){var o=document.createElement("OPTION");o.value=n,a.fastInnerHTML(o,e[n]),this.select.appendChild(o)}},h.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var n=0,o=e.length;o>n;n++)t[e[n]]=e[n];else"object"==typeof e&&(t=e);return t},h.prototype.getValue=function(){return this.select.value},h.prototype.setValue=function(e){this.select.value=e};var f=function(e){var t=this,n=t.getActiveEditor();switch(null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),e.keyCode){case l.keyCode.ARROW_UP:var o=n.select.selectedIndex-1;o>=0&&(n.select[o].selected=!0),e.stopImmediatePropagation(),e.preventDefault();break;case l.keyCode.ARROW_DOWN:var r=n.select.selectedIndex+1;r<=n.select.length-1&&(n.select[r].selected=!0),e.stopImmediatePropagation(),e.preventDefault()}};h.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},h.prototype.open=function(){var e,t=a.outerWidth(this.TD),n=a.outerHeight(this.TD),o=a.offset(this.instance.rootElement),r=a.offset(this.TD),i=this.checkEditorSection();switch(i){case"top":e=a.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=a.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":e=a.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}var s=this.select.style;e&&-1!=e?s[e[0]]=e[1]:a.resetCssTransform(this.select),s.height=n+"px",s.minWidth=t+"px",s.top=r.top-o.top+"px",s.left=r.left-o.left+"px",s.margin="0px",s.display="",this.instance.addHook("beforeKeyDown",f)},h.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",f)},h.prototype.focus=function(){this.select.focus()},d("select",h)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./_baseEditor.js":30}],40:[function(e,t,n){"use strict";Object.defineProperties(n,{TextEditor:{get:function(){return m}},__esModule:{value:!0}});var o,r,i,s,a,l,u=(o=e("./../dom.js"),o&&o.__esModule&&o||{"default":o}),d=(r=e("./../helpers.js"),r&&r.__esModule&&r||{"default":r}),c=(i=e("autoResize"),i&&i.__esModule&&i||{"default":i})["default"],h=(s=e("./_baseEditor.js"),s&&s.__esModule&&s||{"default":s}).BaseEditor,f=(a=e("./../eventManager.js"),a&&a.__esModule&&a||{"default":a}).eventManager,p=(l=e("./../editors.js"),l&&l.__esModule&&l||{"default":l}),g=(p.getEditor,p.registerEditor),m=h.prototype.extend();m.prototype.init=function(){var e=this;this.createElements(),this.eventManager=f(this),this.bindEvents(),this.autoResize=c(),this.instance.addHook("afterDestroy",function(){e.destroy()})},m.prototype.getValue=function(){return this.TEXTAREA.value},m.prototype.setValue=function(e){this.TEXTAREA.value=e};var w=function(e){var t,n,o=this,r=o.getActiveEditor();if(t=d.keyCode,n=(e.ctrlKey||e.metaKey)&&!e.altKey,u.enableImmediatePropagation(e),e.target===r.TEXTAREA&&!e.isImmediatePropagationStopped()){if(17===e.keyCode||224===e.keyCode||91===e.keyCode||93===e.keyCode)return void e.stopImmediatePropagation();switch(e.keyCode){case t.ARROW_RIGHT:case t.ARROW_LEFT:case t.ARROW_UP:case t.ARROW_DOWN:r.isWaiting()||e.stopImmediatePropagation();break;case t.ENTER:var i=r.instance.getSelected(),s=!(i[0]===i[2]&&i[1]===i[3]);if(n&&!s||e.altKey){if(r.isOpened()){var a=u.getCaretPosition(r.TEXTAREA),l=r.getValue(),c=l.slice(0,a)+"\n"+l.slice(a);r.setValue(c),u.setCaretPosition(r.TEXTAREA,a+1)}else r.beginEditing(r.originalValue+"\n");e.stopImmediatePropagation()}e.preventDefault();break;case t.A:case t.X:case t.C:case t.V:n&&e.stopImmediatePropagation();break;case t.BACKSPACE:case t.DELETE:case t.HOME:case t.END:e.stopImmediatePropagation()}r.autoResize.resize(String.fromCharCode(e.keyCode))}};m.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",w)},m.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",w)},m.prototype.focus=function(){this.TEXTAREA.focus(),u.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},m.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),u.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),u.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},m.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},m.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},m.prototype.refreshDimensions=function(){if(this.state===Handsontable.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var e,t=u.offset(this.TD),n=u.offset(this.instance.rootElement),o=u.getScrollableElement(this.TD),r=t.top-n.top-1-(o.scrollTop||0),i=t.left-n.left-1-(o.scrollLeft||0),s=this.instance.getSettings(),a=s.rowHeaders?1:0,l=s.colHeaders?1:0,d=this.checkEditorSection(),c=this.TD.style.backgroundColor;switch(d){case"top":e=u.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=u.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":e=u.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}0>r&&(r=0),0>i&&(i=0),l&&0===this.instance.getSelected()[0]&&(r+=1),a&&0===this.instance.getSelected()[1]&&(i+=1),e&&-1!=e?this.textareaParentStyle[e[0]]=e[1]:u.resetCssTransform(this.textareaParentStyle),this.textareaParentStyle.top=r+"px",this.textareaParentStyle.left=i+"px";var h=this.TD.offsetTop-this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),f=this.TD.offsetLeft-this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),p=u.innerWidth(this.TD)-8,g=this.instance.view.maximumVisibleElementWidth(f)-10,m=this.TD.scrollHeight+1,w=this.instance.view.maximumVisibleElementHeight(h)-2;parseInt(this.TD.style.borderTopWidth,10)>0&&(m-=1),parseInt(this.TD.style.borderLeftWidth,10)>0&&a>0&&(p-=1),this.TEXTAREA.style.fontSize=u.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=u.getComputedStyle(this.TD).fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=c?c:u.getComputedStyle(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(m,w),maxHeight:w,minWidth:Math.min(p,g),maxWidth:g},!0),this.textareaParentStyle.display="block"}},m.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){d.stopPropagation(e)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){d.stopPropagation(e)}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterRowResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterDestroy",function(){e.eventManager.clear()})},m.prototype.destroy=function(){this.eventManager.clear()},g("text",m)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30,autoResize:"autoResize"}],41:[function(e,t,n){"use strict";function o(e,t){var n,o,r,i,a,l="HOT-TABLE";if(t.isTargetWebComponent=!1,t.realTarget=t.target,!Handsontable.eventManager.isHotTableEnv)return t;for(t=s.polymerWrap(t),a=t.path?t.path.length:0;a--;){if(t.path[a].nodeName===l)n=!0;else if(n&&t.path[a].shadowRoot){i=t.path[a];break}0!==a||i||(i=t.path[a])}return i||(i=t.target),t.isTargetWebComponent=!0,s.isWebComponentSupportedNatively()?t.realTarget=t.srcElement||t.toElement:(e instanceof Handsontable.Core||e instanceof Walkontable)&&(e instanceof Handsontable.Core?o=e.view.wt.wtTable.TABLE:e instanceof Walkontable&&(o=e.wtTable.TABLE.parentNode.parentNode),r=s.closest(t.target,[l],o),r?t.realTarget=o.querySelector(l)||t.target:t.realTarget=t.target),Object.defineProperty(t,"target",{get:function(){return s.polymerWrap(i)},enumerable:!0,configurable:!0}),t}function r(e){return new a(e)}Object.defineProperties(n,{EventManager:{get:function(){return a}},eventManager:{get:function(){return r}},__esModule:{value:!0}});var i,s=(i=e("./dom.js"),i&&i.__esModule&&i||{"default":i}),a=function(){var e=void 0!==arguments[0]?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(a,{addEventListener:function(e,t,n){function r(e){void 0==e.target&&void 0!=e.srcElement&&(e.definePoperty?e.definePoperty("target",{value:e.srcElement}):e.target=e.srcElement),void 0==e.preventDefault&&(e.definePoperty?e.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):e.preventDefault=function(){this.returnValue=!1}),e=o(s,e),n.call(this,e)}var i=this,s=this.context;return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:r}),window.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r),Handsontable.countEventManagerListeners++,function(){i.removeEventListener(e,t,n)}},removeEventListener:function(e,t,n){for(var o,r=this.context.eventListeners.length;r--;)if(o=this.context.eventListeners[r],o.event==t&&o.element==e){if(n&&n!=o.callback)continue;this.context.eventListeners.splice(r,1),o.element.removeEventListener?o.element.removeEventListener(o.event,o.callbackProxy,!1):o.element.detachEvent("on"+o.event,o.callbackProxy),Handsontable.countEventManagerListeners--}},clearEvents:function(){for(var e=this.context.eventListeners.length;e--;){var t=this.context.eventListeners[e];t&&this.removeEventListener(t.element,t.event,t.callback)}},clear:function(){this.clearEvents()},fireEvent:function(e,t){var n,o={bubbles:!0,cancelable:"mousemove"!==t,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents"),n.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||document.body.parentNode)):n=document.createEventObject(),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+t,n)}},{}),window.Handsontable=window.Handsontable||{},Handsontable.countEventManagerListeners=0,Handsontable.eventManager=r},{"./dom.js":27}],42:[function(e,t,n){"use strict";function o(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e}function r(e){var t=[V.ARROW_DOWN,V.ARROW_UP,V.ARROW_LEFT,V.ARROW_RIGHT,V.HOME,V.END,V.DELETE,V.BACKSPACE,V.F1,V.F2,V.F3,V.F4,V.F5,V.F6,V.F7,V.F8,V.F9,V.F10,V.F11,V.F12,V.TAB,V.PAGE_DOWN,V.PAGE_UP,V.ENTER,V.ESCAPE,V.SHIFT,V.CAPS_LOCK,V.ALT];return-1!=t.indexOf(e)}function i(e){return-1!=[V.CONTROL_LEFT,224,V.COMMAND_LEFT,V.COMMAND_RIGHT].indexOf(e)}function s(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}}function a(e){return e[0].toUpperCase()+e.substr(1)}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=e.length;o--;){var r=s(e[o]).toLowerCase();-1===n.indexOf(r)&&n.push(r)}return 1===n.length}function u(e){var t;if(Array.isArray(e))t=[];else{t={};for(var n in e)e.hasOwnProperty(n)&&(e[n]&&"object"==typeof e[n]&&!Array.isArray(e[n])?t[n]=u(e[n]):Array.isArray(e[n])?e[n].length&&"object"==typeof e[n][0]&&!Array.isArray(e[n][0])?t[n]=[u(e[n][0])]:t[n]=[]:t[n]=null)}return t}function d(e){for(var t,n=e+1,o="";n>0;)t=(n-1)%26,o=String.fromCharCode(65+t)+o,n=parseInt((n-t)/26,10);return o}function c(e,t){e="number"==typeof e?e:100,t="number"==typeof t?t:4;var n,o,r=[];for(n=0;e>n;n++){var i=[];for(o=0;t>o;o++)i.push(d(o)+(n+1));r.push(i)}return r}function h(e,t){e="number"==typeof e?e:100,t="number"==typeof t?t:4;var n,o,r=[];for(n=0;e>n;n++){var i={};for(o=0;t>o;o++)i["prop"+o]=d(o)+(n+1);r.push(i)}return r}function f(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?e.length?1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):!1:"object"==t?!(!e||"number"!=typeof e.valueOf()||e instanceof Date):!1}function p(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function g(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function m(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function w(e,t){for(var n in t)t.hasOwnProperty(n)&&(t[n]&&"object"==typeof t[n]?(e[n]||(Array.isArray(t[n])?e[n]=[]:e[n]={}),w(e[n],t[n])):e[n]=t[n])}function v(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function y(e,t){return JSON.stringify(e)===JSON.stringify(t)}function b(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var n,o=e.constructor;"function"==typeof e.constructor&&(n=o,delete e.constructor&&(o=e.constructor,e.constructor=n)),t=o?o.prototype:null}return t}function C(e,t){function n(){}g(n,e);for(var o=0,r=t.length;r>o;o++)n.prototype[t[o]]=void 0;return n}function R(e){var t,n,o,r,i=[],s=0;for(t=0,n=e.length;n>t;t++)for(o=0,r=e[t].length;r>o;o++)o==s&&(i.push([]),s++),i[o].push(e[t][o]);return i}function S(e){for(var t=0,n=e.length;n>t;)e[t]=[e[t]],t++}function E(e,t){for(var n=0,o=t.length;o>n;)e.push(t[n]),n++}function T(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1||"true"===e.contentEditable}function _(e){return T(e)&&-1==e.className.indexOf("handsontableInput")&&-1==e.className.indexOf("copyPaste")}function k(e){return"[object Object]"==Object.prototype.toString.call(e)}function H(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,o=e[0].length,r=0;n>r;r++)for(var i=0;o>i;i++)t[i]||(t[i]=[]),t[i][r]=e[r][i];return t}function M(e,t){return function(){return e.apply(t,arguments)}}function O(e,t){function n(e){var t=Handsontable.cellTypes[e];if("undefined"==typeof t)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t="undefined"==typeof t?!0:t,function(o,r){return function i(o){if(o){if(o.hasOwnProperty(e)&&void 0!==o[e])return o[e];if(o.hasOwnProperty("type")&&o.type){var r;if("string"!=typeof o.type)throw new Error("Cell type must be a string ");if(r=n(o.type),r.hasOwnProperty(e))return r[e];if(t)return}return i(b(o))}}("number"==typeof o?this.getCellMeta(o,r):o)}}function D(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}function x(){return"ontouchstart"in window}function A(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function j(e){if(e.pageX)return e.pageX;var t=B.getWindowScrollLeft(),n=e.clientX+t;return n}function P(e){if(e.pageY)return e.pageY;var t=B.getWindowScrollTop(),n=e.clientY+t;return n}function N(e,t,n,o){o.value=n,o.writable=o.writable===!1?!1:!0,o.enumerable=o.enumerable===!1?!1:!0,o.configurable=o.configurable===!1?!1:!0,Object.defineProperty(e,t,o)}function L(e){return G.call(window,e)}function W(e){z.call(window,e)}Object.defineProperties(n,{isPrintableChar:{get:function(){return o}},isMetaKey:{get:function(){return r}},isCtrlKey:{get:function(){return i}},stringify:{get:function(){return s}},toUpperCaseFirst:{get:function(){return a}},equalsIgnoreCase:{get:function(){return l}},duckSchema:{get:function(){return u}},spreadsheetColumnLabel:{get:function(){return d}},createSpreadsheetData:{get:function(){return c}},createSpreadsheetObjectData:{get:function(){return h}},isNumeric:{get:function(){return f}},randomString:{get:function(){return p}},inherit:{get:function(){return g}},extend:{get:function(){return m}},deepExtend:{get:function(){return w}},deepClone:{get:function(){return v}},isObjectEquals:{get:function(){return y}},getPrototypeOf:{get:function(){return b}},columnFactory:{get:function(){return C}},translateRowsToColumns:{get:function(){return R}},to2dArray:{get:function(){return S}},extendArray:{get:function(){return E}},isInput:{get:function(){return T}},isOutsideInput:{get:function(){return _}},keyCode:{get:function(){return V}},isObject:{get:function(){return k}},pivot:{get:function(){return H}},proxy:{get:function(){return M}},cellMethodLookupFactory:{get:function(){return O}},isMobileBrowser:{get:function(){return D}},isTouchSupported:{get:function(){return x}},stopPropagation:{get:function(){return A}},pageX:{get:function(){return j}},pageY:{get:function(){return P}},defineGetter:{get:function(){return N}},requestAnimationFrame:{get:function(){return L}},cancelAnimationFrame:{get:function(){return W}},__esModule:{value:!0}});for(var I,B=(I=e("./dom.js"),I&&I.__esModule&&I||{"default":I}),V={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},F=0,Y=["ms","moz","webkit","o"],G=window.requestAnimationFrame,z=window.cancelAnimationFrame,U=0;U<Y.length&&!G;++U)G=window[Y[U]+"RequestAnimationFrame"],z=window[Y[U]+"CancelAnimationFrame"]||window[Y[U]+"CancelRequestAnimationFrame"];G||(G=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-F)),o=window.setTimeout(function(){e(t+n)},n);return F=t+n,o}),z||(z=function(e){clearTimeout(e)}),window.Handsontable=window.Handsontable||{},Handsontable.helper={cancelAnimationFrame:W,cellMethodLookupFactory:O,columnFactory:C,createSpreadsheetData:c,createSpreadsheetObjectData:h,deepClone:v,deepExtend:w,defineGetter:N,duckSchema:u,equalsIgnoreCase:l,extend:m,extendArray:E,getPrototypeOf:b,inherit:g,isCtrlKey:i,isInput:T,isMetaKey:r,isMobileBrowser:D,isNumeric:f,isObject:k,isObjectEquals:y,isOutsideInput:_,isPrintableChar:o,isTouchSupported:x,keyCode:V,pageX:j,pageY:P,pivot:H,proxy:M,randomString:p,requestAnimationFrame:L,spreadsheetColumnLabel:d,stopPropagation:A,stringify:s,to2dArray:S,toUpperCaseFirst:a,translateRowsToColumns:R}},{"./dom.js":27}],43:[function(e,t,n){"use strict";function o(){function e(e){return null!==e&&!n(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function n(e){return e!==e}var o={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return e(n)?o.arrayMap[n]:t(n)?o.weakMap.get(n):void 0},set:function(n,r){if(e(n))o.arrayMap[n]=r;else{if(!t(n))throw new Error("Invalid key type");o.weakMap.set(n,r)}},"delete":function(n){e(n)?delete o.arrayMap[n]:t(n)&&o.weakMap["delete"](n)}}}Object.defineProperties(n,{MultiMap:{get:function(){return o}},__esModule:{value:!0}}),window.MultiMap=o},{}],44:[function(e,t,n){"use strict";Object.defineProperties(n,{Hooks:{get:function(){return i}},__esModule:{value:!0}});var o,r=["afterCellMetaReset","afterChange","afterChangesObserved","afterColumnMove","afterColumnResize","afterContextMenuDefaultOptions","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","afterCreateCol","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterIsMultipleSelectionCheck","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellMouseDown","afterOnCellMouseOver","afterRemoveCol","afterRemoveRow","afterRender","afterRenderer","afterRowMove","afterRowResize","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","modifyCol","modifyColWidth","modifyRow","modifyRowHeight","persistentStateLoad","persistentStateReset","persistentStateSave"],i=((o=e("./eventManager.js"),o&&o.__esModule&&o||{"default":o}).EventManager,function(){this.globalBucket=this.createEmptyBucket()});$traceurRuntime.createClass(i,{createEmptyBucket:function(){for(var e=Object.create(null),t=0,n=r.length;n>t;t++)e[r[t]]=[];return e},getBucket:function(){var e=void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket},add:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))for(var o=0,r=t.length;r>o;o++)this.add(e,t[o]);else{var i=this.getBucket(n);"undefined"==typeof i[e]&&(this.register(e),i[e]=[]),t.skip=!1,-1===i[e].indexOf(t)&&i[e].push(t)}return this},once:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))for(var o=0,r=t.length;r>o;o++)t[o].runOnce=!0,this.add(e,t[o],n);else t.runOnce=!0,this.add(e,t,n)},remove:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null,o=this.getBucket(n);return"undefined"!=typeof o[e]&&o[e].indexOf(t)>=0?(t.skip=!0,!0):!1},run:function(e,t,n,o,r,i,s,a){for(var l=this.globalBucket[t],u=l?l.length:0,d=0;u>d;d++)if(!l[d].skip){var c=l[d].call(e,n,o,r,i,s,a);void 0!==c&&(n=c),l[d].runOnce&&this.remove(t,l[d])}for(var h=this.getBucket(e)[t],f=h?h.length:0,p=0;f>p;p++)if(!h[p].skip){var g=h[p].call(e,n,o,r,i,s,a);void 0!==g&&(n=g),h[p].runOnce&&this.remove(t,h[p],e)}return n},destroy:function(){var e=void 0!==arguments[0]?arguments[0]:null,t=this.getBucket(e);for(var n in t)for(var o=0,r=t[n].length;r>o;o++)this.remove(n,t[n],e)},register:function(e){this.isRegistered(e)||r.push(e)},deregister:function(e){this.isRegistered(e)&&r.splice(r.indexOf(e),1)},isRegistered:function(e){return r.indexOf(e)>=0},getRegistered:function(){return r}},{})},{"./eventManager.js":41}],45:[function(e,t,n){"use strict";function o(e,t){Handsontable.hooks.add("beforeInit",function(){var n;e=e.toLowerCase(),i.has(this)||i.set(this,{}),n=i.get(this),n[e]||(n[e]=new t(this))}),Handsontable.hooks.add("afterDestroy",function(){var e,t;if(i.has(this)){t=i.get(this);for(e in t)t.hasOwnProperty(e)&&t[e].destroy();i["delete"](this)}})}function r(e,t){if("string"!=typeof t)throw Error('Only strings can be passed as "plugin" parameter');var n=t.toLowerCase();if(!i.has(e)||!i.get(e)[n])throw Error('No plugin registered under name "'+t+'"');return i.get(e)[n]}Object.defineProperties(n,{registerPlugin:{get:function(){return o}},getPlugin:{get:function(){return r}},__esModule:{value:!0}});var i=new WeakMap},{}],46:[function(e,t,n){"use strict";Object.defineProperties(n,{"default":{get:function(){return s}},__esModule:{value:!0}});var o,r=(o=e("./../helpers.js"),o&&o.__esModule&&o||{"default":o}).defineGetter,i=function(e){r(this,"hot",e,{writable:!1})};$traceurRuntime.createClass(i,{destroy:function(){delete this.hot}},{});var s=i},{"./../helpers.js":42}],47:[function(e,t,n){"use strict";function o(){function e(e){var t=document,n=this;n.table=t.createElement("table"),n.theadTh=t.createElement("th"),n.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(n.theadTh),n.tableStyle=n.table.style,n.tableStyle.tableLayout="auto",n.tableStyle.width="auto",n.tbody=t.createElement("tbody"),n.table.appendChild(n.tbody),n.container=t.createElement("div"),n.container.className=e.rootElement.className+" hidden",n.containerStyle=n.container.style,n.container.appendChild(n.table)}var t=this,n=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],e.getSettings().autoColumnSize!==!1?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",u.determineIfChanged),e.addHook("modifyColWidth",u.modifyColWidth),e.addHook("afterDestroy",u.afterDestroy),e.determineColumnWidth=t.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",u.determineIfChanged),e.removeHook("modifyColWidth",u.modifyColWidth),e.removeHook("afterDestroy",u.afterDestroy),delete e.determineColumnWidth,t.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&u.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(t){var o=this,r=o.autoColumnSizeTmp;r.container||e.call(r,o),r.container.className=o.rootElement.className+" htAutoColumnSize",r.table.className=o.table.className;for(var i=o.countRows(),s={},u=0;i>u;u++){var d=o.getDataAtCell(u,t);Array.isArray(d)||(d=a.stringify(d));var c=d.length;s[c]||(s[c]={needed:n,strings:[]}),s[c].needed&&(s[c].strings.push({value:d,row:u}),s[c].needed--)}null!==o.getColHeader(t)&&o.view.appendColHeader(t,r.theadTh),l.empty(r.tbody);for(var h in s)if(s.hasOwnProperty(h))for(var f=0,p=s[h].strings.length;p>f;f++){var g=s[h].strings[f].row,m=o.getCellMeta(g,t);m.col=t,m.row=g;var w=o.getCellRenderer(m),v=document.createElement("tr"),y=document.createElement("td");w(o,y,g,t,o.colToProp(t),s[h].strings[f].value,m),u++,v.appendChild(y),r.tbody.appendChild(v)}var b=o.rootElement.parentNode;b.appendChild(r.container);var C=l.outerWidth(r.table);return b.removeChild(r.container),C},this.determineColumnsWidth=function(){var e=this,n=this.getSettings();if(n.autoColumnSize||!n.colWidths)for(var o=this.countCols(),r=0;o>r;r++)e._getColWidthFromSettings(r)||(this.autoColumnWidths[r]=t.determineColumnWidth.call(e,r));
this.view.wt&&this.view.wt.wtOverlays.adjustElementsSize(!0)},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}}Object.defineProperties(n,{AutoColumnSize:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a=(r=e("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),l=(i=e("./../../dom.js"),i&&i.__esModule&&i||{"default":i}),u=((s=e("./../../plugins.js"),s&&s.__esModule&&s||{"default":s}).registerPlugin,new o);Handsontable.hooks.add("beforeInit",u.beforeInit),Handsontable.hooks.add("afterUpdateSettings",u.beforeInit)},{"./../../dom.js":27,"./../../helpers.js":42,"./../../plugins.js":45}],48:[function(e,t,n){"use strict";function o(e,t,n,o){var r,i,s,a,l,u=n.length,d=n?n[0].length:0,c=[],h=[];if(r=t.row-e.row,i=t.col-e.col,-1!==["down","up"].indexOf(o)){for(var f=0;i>=f;f++)s=parseInt(n[0][f],10),a=parseInt(n[u-1][f],10),l=("down"===o?a-s:s-a)/(u-1)||0,h.push(l);c.push(h)}if(-1!==["right","left"].indexOf(o))for(var p=0;r>=p;p++)s=parseInt(n[p][0],10),a=parseInt(n[p][d-1],10),l=("right"===o?a-s:s-a)/(d-1)||0,h=[],h.push(l),c.push(h);return c}function r(e){function t(t){return e.autofill?void(e.autofill.handle&&e.autofill.handle.isDragged&&(e.autofill.handle.isDragged>1&&e.autofill.apply(),e.autofill.handle.isDragged=0,a=!1)):!0}function n(e){var t,n;return s.instance.autofill?(t=u.offset(s.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+u.outerHeight(s.instance.table),n=u.offset(s.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+u.outerWidth(s.instance.table),s.addingStarted===!1&&s.instance.autofill.handle.isDragged>0&&e.clientY>t&&e.clientX<=n?(s.instance.mouseDragOutside=!0,s.addingStarted=!0):s.instance.mouseDragOutside=!1,void(s.instance.mouseDragOutside&&setTimeout(function(){s.addingStarted=!1,s.instance.alter("insert_row")},200))):!1}var o,r,i,s=this,a=!1;this.instance=e,this.addingStarted=!1,i=d(e),i.addEventListener(document,"mouseup",t),i.addEventListener(document,"mousemove",n),o=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(t){e.autofill.handle.isDragged=1,a=!0,o(t)},r=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(t,n,o,i){e.autofill&&a&&!e.view.isMouseDown()&&e.autofill.handle&&e.autofill.handle.isDragged&&(e.autofill.handle.isDragged++,e.autofill.showBorder(n),e.autofill.checkIfNewRowNeeded()),r(t,n,o,i)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){e.autofill.selectAdjacent()}}Object.defineProperties(n,{Autofill:{get:function(){return r}},__esModule:{value:!0}});var i,s,a,l,u=(i=e("./../../dom.js"),i&&i.__esModule&&i||{"default":i}),d=(s=e("./../../eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager,c=((a=e("./../../plugins.js"),a&&a.__esModule&&a||{"default":a}).registerPlugin,(l=e("./../../3rdparty/walkontable/src/cell/coords.js"),l&&l.__esModule&&l||{"default":l}).WalkontableCellCoords);r.prototype.init=function(){this.handle={}},r.prototype.disable=function(){this.handle.disabled=!0},r.prototype.selectAdjacent=function(){var e,t,n,o,r;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(n=e[2]+1;n<this.instance.countRows();n++){for(r=e[1];r<=e[3];r++)if(t[n][r])break e;(t[n][e[1]-1]||t[n][e[3]+1])&&(o=n)}o&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new c(e[0],e[1])),this.instance.view.wt.selections.fill.add(new c(o,e[3])),this.apply())},r.prototype.apply=function(){var e,t,n,r,i,s,a,l;this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners(),e&&(this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),Handsontable.hooks.run(this.instance,"afterAutofillApplyValues",t,e),e[0]===t[0]&&e[1]<t[1]?(s="left",n=new c(e[0],e[1]),r=new c(e[2],t[1]-1)):e[0]===t[0]&&e[3]>t[3]?(s="right",n=new c(e[0],t[3]+1),r=new c(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=new c(e[0],e[1]),r=new c(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=new c(t[2]+1,e[1]),r=new c(e[2],e[3])),n&&n.row>-1&&n.col>-1?(l={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to},i=this.instance.getData(l.from.row,l.from.col,l.to.row,l.to.col),a=o(n,r,i,s),Handsontable.hooks.run(this.instance,"beforeAutofill",n,r,i),this.instance.populateFromArray(n.row,n.col,i,r.row,r.col,"autofill",null,s,a),this.instance.selection.setRangeStart(new c(e[0],e[1])),this.instance.selection.setRangeEnd(new c(e[2],e[3]))):this.instance.selection.refreshBorders())},r.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),n=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(n.row<e.row||t.row>e.row))e=new c(e.row,n.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new c(n.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},r.prototype.checkIfNewRowNeeded=function(){var e,t,n=this.instance.countRows(),o=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){o.instance.alter("insert_row"),o.addingStarted=!1},200))))},Handsontable.hooks.add("afterInit",function(){var e=new r(this);"undefined"!=typeof this.getSettings().fillHandle&&(e.handle&&this.getSettings().fillHandle===!1?e.disable():e.handle||this.getSettings().fillHandle===!1||(this.autofill=e,this.autofill.init()))}),Handsontable.Autofill=r},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45}],49:[function(e,t,n){"use strict";Object.defineProperties(n,{"default":{get:function(){return f}},__esModule:{value:!0}});var o,r,i,s,a=(o=e("./../../dom.js"),o&&o.__esModule&&o||{"default":o}),l=(r=e("./../../eventManager.js"),r&&r.__esModule&&r||{"default":r}).eventManager,u=(i=e("./../_base.js"),i&&i.__esModule&&i||{"default":i})["default"],d=(s=e("./../../plugins.js"),s&&s.__esModule&&s||{"default":s}).registerPlugin,c=function(e){var t=this;$traceurRuntime.superConstructor(h).call(this,e);var n=this;this.sortIndicators=[],this.hot.addHook("afterInit",function(){return t.init.call(t,"afterInit")}),this.hot.addHook("afterUpdateSettings",function(){return t.init.call(t,"afterUpdateSettings")}),this.hot.addHook("modifyRow",function(){return n.translateRow.apply(n,arguments)}),this.hot.addHook("afterGetColHeader",function(){return n.getColHeader.apply(n,arguments)}),Handsontable.hooks.register("beforeColumnSort"),Handsontable.hooks.register("afterColumnSort")},h=c;$traceurRuntime.createClass(c,{init:function(e){var t=this.hot.getSettings().columnSorting,n=this;if(this.hot.sortingEnabled=!!t,this.hot.sortingEnabled){this.hot.sortIndex=[];var o,r,i=this.loadSortingState();"undefined"!=typeof i?(o=i.sortColumn,r=i.sortOrder):(o=t.column,r=t.sortOrder),this.sortByColumn(o,r),this.hot.sort=function(){var e=Array.prototype.slice.call(arguments);return n.sortByColumn.apply(n,e)},"undefined"==typeof this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),"afterInit"==e&&(this.bindColumnSortingAfterClick(),this.hot.addHook("afterCreateRow",function(){n.afterCreateRow.apply(n,arguments)}),this.hot.addHook("afterRemoveRow",function(){n.afterRemoveRow.apply(n,arguments)}),this.hot.addHook("afterLoadData",function(){n.init.apply(n,arguments)}))}else this.hot.sort=void 0,this.hot.removeHook("afterCreateRow",this.afterCreateRow),this.hot.removeHook("afterRemoveRow",this.afterRemoveRow),this.hot.removeHook("afterLoadData",this.init)},setSortingColumn:function(e,t){return"undefined"==typeof e?(this.hot.sortColumn=void 0,void(this.hot.sortOrder=void 0)):(this.hot.sortColumn===e&&"undefined"==typeof t?this.hot.sortOrder===!1?this.hot.sortOrder=void 0:this.hot.sortOrder=!this.hot.sortOrder:this.hot.sortOrder="undefined"!=typeof t?t:!0,void(this.hot.sortColumn=e))},sortByColumn:function(e,t){this.setSortingColumn(e,t),"undefined"!=typeof this.hot.sortColumn&&(Handsontable.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.sort(),this.hot.render(),this.saveSortingState(),Handsontable.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder))},saveSortingState:function(){var e={};"undefined"!=typeof this.hot.sortColumn&&(e.sortColumn=this.hot.sortColumn),"undefined"!=typeof this.hot.sortOrder&&(e.sortOrder=this.hot.sortOrder),(e.hasOwnProperty("sortColumn")||e.hasOwnProperty("sortOrder"))&&Handsontable.hooks.run(this.hot,"persistentStateSave","columnSorting",e)},loadSortingState:function(){var e={};return Handsontable.hooks.run(this.hot,"persistentStateLoad","columnSorting",e),e.value},bindColumnSortingAfterClick:function(){function e(){var e=o.hot.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function t(t){var n=a.closest(t,"TH");return a.index(n)-e()}var n=l(this.hot),o=this;n.addEventListener(this.hot.rootElement,"click",function(e){if(a.hasClass(e.target,"columnSorting")){var n=t(e.target);if(n!==this.lastSortedColumn)o.sortOrderClass="ascending";else switch(o.hot.sortOrder){case void 0:o.sortOrderClass="ascending";break;case!0:o.sortOrderClass="descending";break;case!1:o.sortOrderClass=void 0}this.lastSortedColumn=n,o.sortByColumn(n)}})},enableObserveChangesPlugin:function(){var e=this;this.hot._registerTimeout(setTimeout(function(){e.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(e){return function(t,n){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof n[1]&&(n[1]=n[1].toLowerCase()),t[1]===n[1]?0:null===t[1]||""===t[1]?1:null===n[1]||""===n[1]?-1:t[1]<n[1]?e?-1:1:t[1]>n[1]?e?1:-1:0}},dateSort:function(e){return function(t,n){if(t[1]===n[1])return 0;if(null===t[1])return 1;if(null===n[1])return-1;var o=new Date(t[1]),r=new Date(n[1]);return r>o?e?-1:1:o>r?e?1:-1:0}},sort:function(){if("undefined"!=typeof this.hot.sortOrder){var e,t;this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0;for(var n=this.hot.colOffset(),o=0,r=this.hot.countRows()-this.hot.getSettings().minSpareRows;r>o;o++)this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn+n)]);switch(e=this.hot.getCellMeta(0,this.hot.sortColumn),this.sortIndicators[this.hot.sortColumn]=e.sortIndicator,e.type){case"date":t=this.dateSort;break;default:t=this.defaultSort}this.hot.sortIndex.sort(t(this.hot.sortOrder));for(var o=this.hot.sortIndex.length;o<this.hot.countRows();o++)this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn+n)]);this.hot.sortingEnabled=!0}},translateRow:function(e){return this.hot.sortingEnabled&&"undefined"!=typeof this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[e]?this.hot.sortIndex[e][0]:e},untranslateRow:function(e){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==e)return t},getColHeader:function(e,t){var n=t.querySelector(".colHeader");this.hot.getSettings().columnSorting&&e>=0&&a.addClass(n,"columnSorting"),a.removeClass(n,"descending"),a.removeClass(n,"ascending"),this.sortIndicators[e]&&e===this.hot.sortColumn&&("ascending"===this.sortOrderClass?a.addClass(n,"ascending"):"descending"===this.sortOrderClass&&a.addClass(n,"descending"))},isSorted:function(){return"undefined"!=typeof this.hot.sortColumn},afterCreateRow:function(e,t){if(this.isSorted()){for(var n=0;n<this.hot.sortIndex.length;n++)this.hot.sortIndex[n][0]>=e&&(this.hot.sortIndex[n][0]+=t);for(var n=0;t>n;n++)this.hot.sortIndex.splice(e+n,0,[e+n,this.hot.getData()[e+n][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(e,t){if(this.isSorted()){var n=this.translateRow(e);this.hot.sortIndex.splice(e,t);for(var o=0;o<this.hot.sortIndex.length;o++)this.hot.sortIndex[o][0]>n&&(this.hot.sortIndex[o][0]-=t);this.saveSortingState()}}},{},u);var f=c;d("columnSorting",c)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],50:[function(e,t,n){"use strict";Object.defineProperties(n,{CommentEditor:{get:function(){return i}},__esModule:{value:!0}});var o,r=(o=e("./../../dom.js"),o&&o.__esModule&&o||{"default":o}),i=function(){this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.editorStyle.position="absolute",this.editorStyle.zIndex=100,this.hide()},s=i;$traceurRuntime.createClass(i,{setPosition:function(e,t){this.editorStyle.left=e+"px",this.editorStyle.top=t+"px"},show:function(){this.editorStyle.display="block"},hide:function(){this.editorStyle.display="none"},isVisible:function(){return"block"===this.editorStyle.display},setValue:function(){var e=void 0!==arguments[0]?arguments[0]:"";e=e||"",this.getInputElement().value=e},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var e,t,n=document.querySelector("."+s.CLASS_EDITOR_CONTAINER);return n||(n=document.createElement("div"),r.addClass(n,s.CLASS_EDITOR_CONTAINER),document.body.appendChild(n)),e=document.createElement("div"),r.addClass(e,s.CLASS_EDITOR),t=document.createElement("textarea"),r.addClass(t,s.CLASS_INPUT),e.appendChild(t),n.appendChild(e),e},getInputElement:function(){return this.editor.querySelector("."+s.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"./../../dom.js":27}],51:[function(e,t,n){"use strict";Object.defineProperties(n,{Comments:{get:function(){return m}},__esModule:{value:!0}});var o,r,i,s,a,l,u=(o=e("./../../dom.js"),o&&o.__esModule&&o||{"default":o}),d=(r=e("./../../eventManager.js"),r&&r.__esModule&&r||{"default":r}).EventManager,c=(i=e("./../../3rdparty/walkontable/src/cell/coords.js"),i&&i.__esModule&&i||{"default":i}).WalkontableCellCoords,h=(s=e("./../../plugins.js"),s&&s.__esModule&&s||{"default":s}),f=h.registerPlugin,p=(h.getPlugin,(a=e("./../_base.js"),a&&a.__esModule&&a||{"default":a})["default"]),g=(l=e("./commentEditor.js"),l&&l.__esModule&&l||{"default":l}).CommentEditor,m=function(e){var t=this;$traceurRuntime.superConstructor(w).call(this,e),this.hot.getSettings().comments&&(this.editor=new g,this.eventManager=new d(this),this.range={},this.mouseDown=!1,this.contextMenuEvent=!1,this.timer=null,this.hot.addHook("afterInit",function(){return t.registerListeners()}),this.hot.addHook("afterContextMenuDefaultOptions",function(e){return t.addToContextMenu(e)}),this.hot.addHook("afterRenderer",function(e,n,o,r,i,s){return t.onAfterRenderer(e,s)}),this.hot.addHook("afterScrollVertically",function(){return t.refreshEditorPosition()}),this.hot.addHook("afterColumnResize",function(){return t.refreshEditorPosition()}),this.hot.addHook("afterRowResize",function(){return t.refreshEditorPosition()}))},w=m;$traceurRuntime.createClass(m,{registerListeners:function(){var e=this;this.eventManager.addEventListener(document,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(document,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(document,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(document,"mouseup",function(t){return e.onMouseUp(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return e.onEditorBlur(t)})},setRange:function(e){this.range=e},clearRange:function(){this.range={}},targetIsCellWithComment:function(e){return u.hasClass(e.target,"htCommentCell")&&u.closest(e.target,[this.hot.rootElement])?!0:!1},targetIsCommentTextArea:function(e){return this.editor.getInputElement()===e.target},saveComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),t=this.range.from.row,n=this.range.from.col;this.hot.setCellMeta(t,n,"comment",e),this.hot.render()},saveCommentAtCell:function(e,t){this.setRange({from:new c(e,t)}),this.saveComment()},removeComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.removeCellMeta(this.range.from.row,this.range.from.col,"comment"),this.hot.render(),this.hide()},removeCommentAtCell:function(e,t){this.setRange({from:new c(e,t)}),this.removeComment()},show:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditorPosition(!0),this.editor.setValue(e.comment||""),this.editor.show(),!0},showAtCell:function(e,t){return this.setRange({from:new c(e,t)}),this.show()},hide:function(){this.editor.hide()},refreshEditorPosition:function(){var e=void 0!==arguments[0]?arguments[0]:!1;if(e||this.range.from&&this.editor.isVisible()){var t=this.hot.view.wt.wtTable.getCell(this.range.from),n=u.offset(t),o=this.hot.getColWidth(this.range.from.col),r=n.top,i=n.left,s=0,a=0;this.hot.view.wt.wtViewport.hasVerticalScroll()&&(r-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition(),s=20),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&(i-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition(),a=20);var l=i+o,d=r,c=this.hot.view.wt.wtTable.holder.getBoundingClientRect(),h={left:c.left+u.getWindowScrollLeft()+a,right:c.right+u.getWindowScrollLeft()-15,top:c.top+u.getWindowScrollTop()+s,bottom:c.bottom+u.getWindowScrollTop()};l<=h.left||l>h.right||d<=h.top||d>h.bottom?this.hide():this.editor.setPosition(l,d)}},onMouseDown:function(e){this.mouseDown=!0,this.hot.view&&this.hot.view.wt&&(this.contextMenuEvent||this.targetIsCommentTextArea(e)||this.targetIsCellWithComment(e)||this.hide(),this.contextMenuEvent=!1)},onMouseOver:function(e){if(!this.mouseDown&&!this.editor.isFocused())if(this.targetIsCellWithComment(e)){var t=this.hot.view.wt.wtTable.getCoords(e.target),n={from:new c(t.row,t.col)};this.setRange(n),this.show()}else this.targetIsCommentTextArea(e)||this.editor.isFocused()||this.hide()},onMouseMove:function(e){var t=this;this.targetIsCommentTextArea(e)&&(this.mouseDown=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){t.mouseDown=!1},200))},onMouseUp:function(e){this.mouseDown=!1},onAfterRenderer:function(e,t){t.comment&&u.addClass(e,t.commentedCellClassName)},onEditorBlur:function(e){this.saveComment()},checkSelectionCommentsConsistency:function(){var e=!1,t=this.hot.getSelectedRange().from;return this.hot.getCellMeta(t.row,t.col).comment&&(e=!0),e},onContextMenuAddComment:function(){var e=this,t=this.hot.getSelectedRange();this.contextMenuEvent=!0,this.setRange({from:t.from}),this.show(),setTimeout(function(){e.hot&&(e.hot.deselectCell(),e.editor.focus())},10)},onContextMenuRemoveComment:function(e,t){this.contextMenuEvent=!0,this.removeCommentAtCell(t.start.row,t.start.col)},addToContextMenu:function(e){var t=this;e.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!1}},{key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,n){return t.onContextMenuRemoveComment(e,n)},disabled:function(){return!t.checkSelectionCommentsConsistency()}})},destroy:function(){this.eventManager&&this.eventManager.clear(),this.editor&&this.editor.destroy(),$traceurRuntime.superGet(this,w.prototype,"destroy").call(this)}},{},p),f("comments",m)},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,"./commentEditor.js":50}],52:[function(e,t,n){"use strict";function o(e,t){this.instance=e;var n=this;if(n.menus=[],n.htMenus={},n.triggerRows=[],n.eventManager=y(n),this.enabled=!0,this.instance.addHook("afterDestroy",function(){n.destroy()}),this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],n=t.join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||n}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],n=t.join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||n}},o.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||n}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||n}},o.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var n=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,n)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]],n=t.join(",")==e.join(",");return e[0]<0||n}},{key:"remove_col",name:"Remove column",callback:function(e,t){var n=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,n)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")==e.join(",");return e[1]<0||n}},o.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},o.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only",t=n.checkSelectionReadOnlyConsistency(this);return t&&(e=n.markSelected(e)),e},callback:function(){var e=n.checkSelectionReadOnlyConsistency(this),t=this;this.getSelectedRange().forAll(function(n,o){t.getCellMeta(n,o).readOnly=e?!1:!0}),this.render()}},o.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left",t=n.checkSelectionAlignment(this,"htLeft");return t&&(e=n.markSelected(e)),e},callback:function(){c.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var e="Center",t=n.checkSelectionAlignment(this,"htCenter");return t&&(e=n.markSelected(e)),e},callback:function(){c.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var e="Right",t=n.checkSelectionAlignment(this,"htRight");return t&&(e=n.markSelected(e)),e},callback:function(){c.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var e="Justify",t=n.checkSelectionAlignment(this,"htJustify");return t&&(e=n.markSelected(e)),e},callback:function(){c.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},o.SEPARATOR,{name:function(){var e="Top",t=n.checkSelectionAlignment(this,"htTop");return t&&(e=n.markSelected(e)),e},callback:function(){c.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var e="Middle",t=n.checkSelectionAlignment(this,"htMiddle");return t&&(e=n.markSelected(e)),e},callback:function(){c.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var e="Bottom",t=n.checkSelectionAlignment(this,"htBottom");return t&&(e=n.markSelected(e)),e},callback:function(){c.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]},n.options={},w.extend(n.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},this.checkSelectionAlignment=function(e,t){var n=!1;return e.getSelectedRange().forAll(function(o,r){var i=e.getCellMeta(o,r).className;return i&&-1!=i.indexOf(t)?(n=!0,!1):void 0}),n},!this.instance.getSettings().allowInsertRow){var r=i(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(r,1);var s=i(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(s,1),this.defaultOptions.items.splice(s,1)}if(!this.instance.getSettings().allowInsertColumn){var a=i(this.defaultOptions.items,"col_left");this.defaultOptions.items.splice(a,1);var l=i(this.defaultOptions.items,"col_right");this.defaultOptions.items.splice(l,1),this.defaultOptions.items.splice(l,1)}var u,d,h=!1,f=!1;this.instance.getSettings().allowRemoveRow||(u=i(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(u,1),h=!0),this.instance.getSettings().allowRemoveColumn||(d=i(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(d,1),f=!0),h&&f&&this.defaultOptions.items.splice(d,1),this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll(function(n,o){return e.getCellMeta(n,o).readOnly?(t=!0,!1):void 0}),t},Handsontable.hooks.run(e,"afterContextMenuDefaultOptions",this.defaultOptions)}function r(e,t){for(var n=0,o=e.length;o>n;n++)if(e[n].key===t)return e[n]}function i(e,t){for(var n=0,o=e.length;o>n;n++)if(e[n].key===t)return n}function s(){if(!this.rootElement.className.indexOf("htContextMenu")){for(var e=0,t=0,n=this.getSettings().data.length,r=parseInt(this.view.wt.wtTable.hider.style.width,10),i=0;n>i;i++)this.getSettings().data[i].name==o.SEPARATOR.name?e+=1:t+=26;this.view.wt.wtTable.holder.style.width=r+22+"px",this.view.wt.wtTable.holder.style.height=t+e+4+"px"}}function a(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function l(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function u(e){for(var t={},n=e.from.row;n<=e.to.row;n++)for(var o=e.from.col;o<=e.to.col;o++)t[n]||(t[n]=[]),t[n][o]=this.getCellMeta(n,o).className;return t}function d(e,t,n,o){var r=this.getCellMeta(e,t),i=o;r.className&&(i="vertical"===n?a(r.className,o):l(r.className,o)),this.setCellMeta(e,t,"className",i)}function c(e,t,n){var o=u.call(this,e);if(this.runHooks("beforeCellAlignment",o,e,t,n),e.from.row==e.to.row&&e.from.col==e.to.col)d.call(this,e.from.row,e.from.col,t,n);else for(var r=e.from.row;r<=e.to.row;r++)for(var i=e.from.col;i<=e.to.col;i++)d.call(this,r,i,t,n);this.render()}function h(){var e=this,t=e.getSettings().contextMenu,n=w.isObject(t)?t:{};t?(e.contextMenu||(e.contextMenu=new o(e,n)),e.contextMenu.enable()):e.contextMenu&&(e.contextMenu.destroy(),delete e.contextMenu)}Object.defineProperties(n,{ContextMenu:{get:function(){return o}},__esModule:{value:!0}});var f,p,g,m,w=(f=e("./../../helpers.js"),f&&f.__esModule&&f||{"default":f}),v=(p=e("./../../dom.js"),p&&p.__esModule&&p||{"default":p}),y=(g=e("./../../eventManager.js"),g&&g.__esModule&&g||{"default":g}).eventManager;(m=e("./../../plugins.js"),m&&m.__esModule&&m||{"default":m}).registerPlugin;o.prototype.createMenu=function(e,t){e&&(e=e.replace(/ /g,"_"),e="htContextSubMenu_"+e);var n;return n=e?document.querySelector(".htContextMenu."+e):document.querySelector(".htContextMenu"),n||(n=document.createElement("DIV"),v.addClass(n,"htContextMenu"),e&&v.addClass(n,e),document.getElementsByTagName("body")[0].appendChild(n)),this.menus.indexOf(n)<0&&(this.menus.push(n),t=t||0,this.triggerRows.push(t)),n},o.prototype.bindMouseEvents=function(){function e(e){function t(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}var n,r,i,s,a=this.instance.getSettings(),l=this.instance.getSettings().rowHeaders,u=this.instance.getSettings().colHeaders;if(r=e.realTarget,this.closeAll(),e.preventDefault(),w.stopPropagation(e),l||u){if(l&&u&&(n=r.parentNode.querySelectorAll(".cornerHeader").length>0))return}else if(!(t(r)||v.hasClass(r,"current")&&v.hasClass(r,"wtBorder")))return;s=this.createMenu(),i=this.getItems(a.contextMenu),this.show(s,i),this.setMenuPosition(e,s),this.eventManager.addEventListener(document.documentElement,"mousedown",w.proxy(o.prototype.closeAll,this))}var t=y(this.instance);t.addEventListener(this.instance.rootElement,"contextmenu",w.proxy(e,this))},o.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},o.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},o.prototype.performAction=function(e,t){var n=this,r=t.getSelected()[0],i=t.getData()[r];if(i.disabled!==!0&&("function"!=typeof i.disabled||i.disabled.call(this.instance)!==!0)&&!i.hasOwnProperty("submenu")){if("function"!=typeof i.callback)return;var s=this.instance.getSelectedRange(),a=o.utils.normalizeSelection(s);i.callback.call(this.instance,i.key,a,e),n.closeAll()}},o.prototype.unbindMouseEvents=function(){this.eventManager.clear();var e=y(this.instance);e.removeEventListener(this.instance.rootElement,"contextmenu")},o.prototype.show=function(e,t){var n=this;e.removeAttribute("style"),e.style.display="block";var o={data:t,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:w.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(e){n.onBeforeKeyDown(e,r)},afterOnCellMouseOver:function(e,t,o){n.onCellMouseOver(e,t,o,r)}},r=new Handsontable(e,o);r.isHotTableEnv=this.instance.isHotTableEnv,Handsontable.eventManager.isHotTableEnv=this.instance.isHotTableEnv,this.eventManager.removeEventListener(e,"mousedown"),this.eventManager.addEventListener(e,"mousedown",function(e){n.performAction(e,r)}),this.bindTableEvents(),r.listen(),this.htMenus[r.guid]=r,Handsontable.hooks.run(this.instance,"afterContextMenuShow",r)},o.prototype.close=function(e){this.hide(e),this.eventManager.clear(),this.unbindTableEvents(),this.instance.listen()},o.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},o.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},o.prototype.hide=function(e){e.style.display="none";var t=this.htMenus[e.id];Handsontable.hooks.run(this.instance,"afterContextMenuHide",t),
t.destroy(),delete this.htMenus[e.id]},o.prototype.renderer=function(e,t,n,r,i,s){function a(e){return e.hasOwnProperty("submenu")}function l(e){return new RegExp(o.SEPARATOR.name,"i").test(e.name)}function u(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(d.instance)===!0}var d=this,c=e.getData()[n],h=document.createElement("DIV");"function"==typeof s&&(s=s.call(this.instance)),v.empty(t),t.appendChild(h),l(c)?v.addClass(t,"htSeparator"):v.fastInnerHTML(h,s),u(c)?(v.addClass(t,"htDisabled"),this.eventManager.addEventListener(h,"mouseenter",function(){e.deselectCell()})):a(c)?(v.addClass(t,"htSubmenu"),this.eventManager.addEventListener(h,"mouseenter",function(){e.selectCell(n,r)})):(v.removeClass(t,"htSubmenu"),v.removeClass(t,"htDisabled"),this.eventManager.addEventListener(h,"mouseenter",function(){e.selectCell(n,r)}))},o.prototype.onCellMouseOver=function(e,t,n,o){var r=this.menus.length;if(r>0){var i=this.menus[r-1];i.id!=o.guid&&this.closeLastOpenedSubMenu()}else this.closeLastOpenedSubMenu();if(-1!=n.className.indexOf("htSubmenu")){var s=o.getData()[t.row],a=this.getItems(s.submenu),l=this.createMenu(s.name,t.row),u=n.getBoundingClientRect();this.show(l,a),this.setSubMenuPosition(u,l)}},o.prototype.onBeforeKeyDown=function(e,t){function n(e){var t=e.getCell(0,0);o.utils.isSeparator(t)||o.utils.isDisabled(t)?i(0,0,e):e.selectCell(0,0)}function r(e){var t=e.countRows()-1,n=e.getCell(t,0);o.utils.isSeparator(n)||o.utils.isDisabled(n)?s(t,0,e):e.selectCell(t,0)}function i(e,t,n){var r=e+1,s=r<n.countRows()?n.getCell(r,t):null;s&&(o.utils.isSeparator(s)||o.utils.isDisabled(s)?i(r,t,n):n.selectCell(r,t))}function s(e,t,n){var r=e-1,i=r>=0?n.getCell(r,t):null;i&&(o.utils.isSeparator(i)||o.utils.isDisabled(i)?s(r,t,n):n.selectCell(r,t))}function a(e,t,n,o){var r=e.getData()[o],i=t.getItems(r.submenu),s=t.createMenu(r.name,o),a=n.getBoundingClientRect(),l=t.show(s,i);t.setSubMenuPosition(a,s),l.selectCell(0,0)}v.enableImmediatePropagation(e);var l=this,u=t.getSelected();switch(e.keyCode){case w.keyCode.ESCAPE:l.closeAll(),e.preventDefault(),e.stopImmediatePropagation();break;case w.keyCode.ENTER:u&&l.performAction(e,t);break;case w.keyCode.ARROW_DOWN:u?i(u[0],u[1],t,l):n(t,l),e.preventDefault(),e.stopImmediatePropagation();break;case w.keyCode.ARROW_UP:u?s(u[0],u[1],t,l):r(t,l),e.preventDefault(),e.stopImmediatePropagation();break;case w.keyCode.ARROW_RIGHT:if(u){var d=u[0],c=t.getCell(u[0],0);o.utils.hasSubMenu(c)&&a(t,l,c,d)}e.preventDefault(),e.stopImmediatePropagation();break;case w.keyCode.ARROW_LEFT:if(u){if(-1!=t.rootElement.className.indexOf("htContextSubMenu_")){l.closeLastOpenedSubMenu();var h=l.menus.length;if(h>0){var f=l.menus[h-1],p=l.triggerRows.pop();t=this.htMenus[f.id],t.selectCell(p,0)}}e.preventDefault(),e.stopImmediatePropagation()}}},o.prototype.getItems=function(e){function t(e){"string"==typeof e?this.name=e:w.extend(this,e)}var n,o;t.prototype=e,e&&e.items&&(e=e.items),e===!0&&(e=this.defaultOptions.items),n=[];for(var i in e)e.hasOwnProperty(i)&&(o="string"==typeof e[i]?r(this.defaultOptions.items,e[i]):r(this.defaultOptions.items,i),o||(o=e[i]),o=new t(o),"object"==typeof e[i]&&w.extend(o,e[i]),o.key||(o.key=i),n.push(o));return n},o.prototype.setSubMenuPosition=function(e,t){var n=v.getWindowScrollTop(),o=v.getWindowScrollLeft(),r={top:n+e.top,topRelative:e.top,left:e.left,leftRelative:e.left-o,scrollTop:n,scrollLeft:o,cellHeight:e.height,cellWidth:e.width};this.menuFitsBelowCursor(r,t,document.body.clientWidth)?this.positionMenuBelowCursor(r,t,!0):this.menuFitsAboveCursor(r,t)?this.positionMenuAboveCursor(r,t,!0):this.positionMenuBelowCursor(r,t,!0),this.menuFitsOnRightOfCursor(r,t,document.body.clientWidth)?this.positionMenuOnRightOfCursor(r,t,!0):this.positionMenuOnLeftOfCursor(r,t,!0)},o.prototype.setMenuPosition=function(e,t){var n=v.getWindowScrollTop(),o=v.getWindowScrollLeft(),r=e.pageY||e.clientY+n,i=e.pageX||e.clientX+o,s={top:r,topRelative:r-n,left:i,leftRelative:i-o,scrollTop:n,scrollLeft:o,cellHeight:e.target.clientHeight,cellWidth:e.target.clientWidth};this.menuFitsBelowCursor(s,t,document.body.clientHeight)?this.positionMenuBelowCursor(s,t):this.menuFitsAboveCursor(s,t)?this.positionMenuAboveCursor(s,t):this.positionMenuBelowCursor(s,t),this.menuFitsOnRightOfCursor(s,t,document.body.clientWidth)?this.positionMenuOnRightOfCursor(s,t):this.positionMenuOnLeftOfCursor(s,t)},o.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},o.prototype.menuFitsBelowCursor=function(e,t,n){return e.topRelative+t.offsetHeight<=n},o.prototype.menuFitsOnRightOfCursor=function(e,t,n){return e.leftRelative+t.offsetWidth<=n},o.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},o.prototype.positionMenuAboveCursor=function(e,t,n){n?t.style.top=e.top+e.cellHeight-t.offsetHeight+"px":t.style.top=e.top-t.offsetHeight+"px"},o.prototype.positionMenuOnRightOfCursor=function(e,t,n){n?t.style.left=1+e.left+e.cellWidth+"px":t.style.left=1+e.left+"px"},o.prototype.positionMenuOnLeftOfCursor=function(e,t,n){n?t.style.left=e.left-t.offsetWidth+"px":t.style.left=e.left-t.offsetWidth+"px"},o.utils={},o.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},o.utils.isSeparator=function(e){return v.hasClass(e,"htSeparator")},o.utils.hasSubMenu=function(e){return v.hasClass(e,"htSubmenu")},o.utils.isDisabled=function(e){return v.hasClass(e,"htDisabled")},o.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},o.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},o.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},o.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=document.querySelectorAll(".handsontable"),t=!1,n=0,o=e.length;o>n;n++){var r=this.htMenus[e[n].id];if(r&&r.getSettings().contextMenu){t=!0;break}}return t},o.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},o.prototype.align=function(e,t,n){c.call(this,e,t,n)},o.SEPARATOR={name:"---------"},Handsontable.hooks.add("afterInit",h),Handsontable.hooks.add("afterUpdateSettings",h),Handsontable.hooks.add("afterInit",s),Handsontable.hooks.register("afterContextMenuDefaultOptions"),Handsontable.hooks.register("afterContextMenuShow"),Handsontable.hooks.register("afterContextMenuHide"),Handsontable.ContextMenu=o},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],53:[function(e,t,n){"use strict";Object.defineProperties(n,{ContextMenuCopyPaste:{get:function(){return f}},__esModule:{value:!0}});var o,r,i,s,a,l=(o=e("./../../dom.js"),o&&o.__esModule&&o||{"default":o}),u=(r=e("./../../eventManager.js"),r&&r.__esModule&&r||{"default":r}).eventManager,d=(i=e("./../../plugins.js"),i&&i.__esModule&&i||{"default":i}).registerPlugin,c=(s=e("./../_base.js"),s&&s.__esModule&&s||{"default":s})["default"],h=(a=e("zeroclipboard"),a&&a.__esModule&&a||{"default":a})["default"],f=function(e){var t=this;$traceurRuntime.superConstructor(p).call(this,e),this.swfPath=null,this.hotContextMenu=null,this.outsideClickDeselectsCache=null,this.hot.addHook("afterContextMenuShow",function(e){return t.setupZeroClipboard(e)}),this.hot.addHook("afterInit",function(){return t.afterInit()}),this.hot.addHook("afterContextMenuDefaultOptions",function(e){return t.addToContextMenu(e)})},p=f;$traceurRuntime.createClass(f,{afterInit:function(){if(this.hot.getSettings().contextMenuCopyPaste){if("object"==typeof this.hot.getSettings().contextMenuCopyPaste&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof h)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}this.prepareZeroClipboard()}},prepareZeroClipboard:function(){this.swfPath&&h.config({swfPath:this.swfPath})},getCopyValue:function(){return this.hot.copyPaste.setCopyableText(),this.hot.copyPaste.copyPasteInstance.elTextarea.value},addToContextMenu:function(e){this.hot.getSettings().contextMenuCopyPaste&&e.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},Handsontable.ContextMenu.SEPARATOR)},setupZeroClipboard:function(e){var t,n,o=this;if(this.hot.getSettings().contextMenuCopyPaste){this.hotContextMenu=e,t=this.hotContextMenu.getData();for(var r=0,i=t.length;i>r;r++)if("copy"===t[r].key){n=new h(this.hotContextMenu.getCell(r,0)),n.off(),n.on("copy",function(e){var t=e.clipboardData;t.setData("text/plain",o.getCopyValue()),o.hot.getSettings().outsideClickDeselects=o.outsideClickDeselectsCache}),this.bindEvents();break}}},removeCurrentClass:function(){if(this.hotContextMenu.rootElement){var e=this.hotContextMenu.rootElement.querySelector("td.current");e&&l.removeClass(e,"current")}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1},removeZeroClipboardClass:function(){if(this.hotContextMenu.rootElement){var e=this.hotContextMenu.rootElement.querySelector("td.zeroclipboard-is-hover");e&&l.removeClass(e,"zeroclipboard-is-hover")}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache},bindEvents:function(){var e=this,t=u(this.hotContextMenu);t.addEventListener(document,"mouseenter",function(){return e.removeCurrentClass()}),t.addEventListener(document,"mouseleave",function(){return e.removeZeroClipboardClass()})}},{},c),d("contextMenuCopyPaste",f)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,zeroclipboard:"zeroclipboard"}],54:[function(e,t,n){"use strict";function o(e){function t(){e.isListening()&&e.selection.empty()}function n(t){var n,o,r,i,s,a,l,u,d,c;e.isListening()&&e.selection.isSelected()&&(n=t,o=f.parse(n),r=e.getSelected(),i=new p(r[0],r[1]),s=new p(r[2],r[3]),a=new g(i,i,s),l=a.getTopLeftCorner(),u=a.getBottomRightCorner(),d=l,c=new p(Math.max(u.row,o.length-1+l.row),Math.max(u.col,o[0].length-1+l.col)),e.addHookOnce("afterChange",function(e,t){e&&e.length&&this.selectCell(d.row,d.col,c.row,c.col)}),e.populateFromArray(d.row,d.col,o,c.row,c.col,"paste",e.getSettings().pasteMode))}function o(t){if(e.getSelected()&&(!e.getActiveEditor()||!e.getActiveEditor().isOpened())){if(c.isCtrlKey(t.keyCode))return r.setCopyableText(),void t.stopImmediatePropagation();var n=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==c.keyCode.A&&n&&e._registerTimeout(setTimeout(c.proxy(r.setCopyableText,r),0))}}var r=this;this.copyPasteInstance=h(),this.copyPasteInstance.onCut(t),this.copyPasteInstance.onPaste(n),e.addHook("beforeKeyDown",o),this.destroy=function(){this.copyPasteInstance.removeCallback(t),this.copyPasteInstance.removeCallback(n),this.copyPasteInstance.destroy(),e.removeHook("beforeKeyDown",o)},e.addHook("afterDestroy",c.proxy(this.destroy,this)),this.triggerPaste=c.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=c.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=e.getSettings(),n=t.copyRowsLimit,o=t.copyColsLimit,r=e.getSelectedRange(),i=r.getTopLeftCorner(),s=r.getBottomRightCorner(),a=i.row,l=i.col,u=s.row,d=s.col,c=Math.min(u,a+n-1),h=Math.min(d,l+o-1);e.copyPaste.copyPasteInstance.copyable(e.getCopyableData(a,l,c,h)),(u!==c||d!==h)&&Handsontable.hooks.run(e,"afterCopyLimit",u-a+1,d-l+1,n,o)}}function r(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new o(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}Object.defineProperties(n,{CopyPaste:{get:function(){return CopyPaste}},__esModule:{value:!0}});var i,s,a,l,u,d,c=(i=e("./../../helpers.js"),i&&i.__esModule&&i||{"default":i}),h=(s=e("copyPaste"),s&&s.__esModule&&s||{"default":s})["default"],f=(a=e("SheetClip"),a&&a.__esModule&&a||{"default":a})["default"],p=((l=e("./../../plugins.js"),l&&l.__esModule&&l||{"default":l}).registerPlugin,(u=e("./../../3rdparty/walkontable/src/cell/coords.js"),u&&u.__esModule&&u||{"default":u}).WalkontableCellCoords),g=(d=e("./../../3rdparty/walkontable/src/cell/range.js"),d&&d.__esModule&&d||{"default":d}).WalkontableCellRange;Handsontable.hooks.add("afterInit",r),Handsontable.hooks.add("afterUpdateSettings",r),Handsontable.hooks.register("afterCopyLimit")},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../helpers.js":42,"./../../plugins.js":45,SheetClip:"SheetClip",copyPaste:"copyPaste"}],55:[function(e,t,n){"use strict";function o(){}var r,i,s,a,l=((r=e("./../../plugins.js"),r&&r.__esModule&&r||{"default":r}).registerPlugin,(i=e("./../../3rdparty/walkontable/src/cell/range.js"),i&&i.__esModule&&i||{"default":i}).WalkontableCellRange),u=(s=e("./../../3rdparty/walkontable/src/selection.js"),s&&s.__esModule&&s||{"default":s}).WalkontableSelection,d=function(e){return"boolean"==typeof e&&e===!0?!0:"object"==typeof e&&e.length>0?!0:!1},c=function(){d(this.getSettings().customBorders)&&(this.customBorders||(a=this,this.customBorders=new o))},h=function(e){for(var t=0;t<a.view.wt.selections.length;t++)if(a.view.wt.selections[t].settings.className==e)return t;return-1},f=function(e){var t={row:e.row,col:e.col},n=new u(e,new l(t,t,t)),o=h(e.className);o>=0?a.view.wt.selections[o]=n:a.view.wt.selections.push(n)},p=function(e,t,n){var o=b(e,t);o=C(o,n),this.setCellMeta(e,t,"borders",o),f(o)},g=function(e){for(var t=e.range,n=t.from.row;n<=t.to.row;n++)for(var o=t.from.col;o<=t.to.col;o++){var r=b(n,o),i=0;n==t.from.row&&(i++,e.hasOwnProperty("top")&&(r.top=e.top)),n==t.to.row&&(i++,e.hasOwnProperty("bottom")&&(r.bottom=e.bottom)),o==t.from.col&&(i++,e.hasOwnProperty("left")&&(r.left=e.left)),o==t.to.col&&(i++,e.hasOwnProperty("right")&&(r.right=e.right)),i>0&&(this.setCellMeta(n,o,"borders",r),f(r))}},m=function(e,t){return"border_row"+e+"col"+t},w=function(){return{width:1,color:"#000"}},v=function(){return{hide:!0}},y=function(){return{width:1,color:"#000",cornerVisible:!1}},b=function(e,t){return{className:m(e,t),border:y(),row:e,col:t,top:v(),right:v(),bottom:v(),left:v()}},C=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},R=function(e){for(var t=document.querySelectorAll("."+e),n=0;n<t.length;n++)if(t[n]&&"TD"!=t[n].nodeName){var o=t[n].parentNode;o.parentNode&&o.parentNode.removeChild(o)}},S=function(e,t){var n=m(e,t);R(n),this.removeCellMeta(e,t,"borders")},E=function(e,t,n,o){var r=this.getCellMeta(e,t).borders;r&&void 0!=r.border||(r=b(e,t)),o?r[n]=v():r[n]=w(),this.setCellMeta(e,t,"borders",r);var i=m(e,t);R(i),f(r),this.render()},T=function(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?S.call(this,e.from.row,e.from.col):E.call(this,e.from.row,e.from.col,t,n);else switch(t){case"noBorders":for(var o=e.from.col;o<=e.to.col;o++)for(var r=e.from.row;r<=e.to.row;r++)S.call(this,r,o);break;case"top":for(var i=e.from.col;i<=e.to.col;i++)E.call(this,e.from.row,i,t,n);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)E.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)E.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)E.call(this,l,e.from.col,t)}},_=function(e,t){var n=!1;return e.getSelectedRange().forAll(function(o,r){var i=e.getCellMeta(o,r).borders;if(i){if(!t)return n=!0,!1;if(!i[t].hasOwnProperty("hide"))return n=!0,!1}}),n},k=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},H=function(e){this.getSettings().customBorders&&(e.items.push(Handsontable.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top",t=_(this,"top");return t&&(e=k(e)),e},callback:function(){var e=_(this,"top");T.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right",t=_(this,"right");return t&&(e=k(e)),e},callback:function(){var e=_(this,"right");T.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom",t=_(this,"bottom");return t&&(e=k(e)),e},callback:function(){var e=_(this,"bottom");T.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left",t=_(this,"left");return t&&(e=k(e)),e},callback:function(){var e=_(this,"left");T.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){T.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!_(this)}}}}}))};Handsontable.hooks.add("beforeInit",c),Handsontable.hooks.add("afterContextMenuDefaultOptions",H),Handsontable.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?g.call(this,e[t]):p.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),Handsontable.CustomBorders=o},{"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/selection.js":18,"./../../plugins.js":45}],56:[function(e,t,n){"use strict";function o(){this.boundaries=null,this.callback=null}Object.defineProperties(n,{DragToScroll:{get:function(){return o}},__esModule:{value:!0}});var r,i,s=(r=e("./../../eventManager.js"),r&&r.__esModule&&r||{"default":r}).eventManager;(i=e("./../../plugins.js"),i&&i.__esModule&&i||{"default":i}).registerPlugin;Handsontable.plugins.DragToScroll=o,o.prototype.setBoundaries=function(e){this.boundaries=e},o.prototype.setCallback=function(e){this.callback=e},o.prototype.check=function(e,t){var n=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,o)};var a;if("undefined"!=typeof Handsontable)var l=function(e){e.dragToScrollListening=!1;var t=e.view.wt.wtTable.holder;a=new o,t!==window&&(a.setBoundaries(t.getBoundingClientRect()),a.setCallback(function(e,n){0>e?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),0>n?t.scrollTop-=20:n>0&&(t.scrollTop+=20)}),e.dragToScrollListening=!0)};Handsontable.hooks.add("afterInit",function(){var e=this,t=s(this);t.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),t.addEventListener(document,"mousemove",function(t){e.dragToScrollListening&&a.check(t.clientX,t.clientY)})}),Handsontable.hooks.add("afterDestroy",function(){s(this).clear()}),Handsontable.hooks.add("afterOnCellMouseDown",function(){l(this)}),Handsontable.hooks.add("afterOnCellCornerMouseDown",function(){l(this)}),Handsontable.plugins.DragToScroll=o},{"./../../eventManager.js":41,"./../../plugins.js":45}],57:[function(e,t,n){"use strict";function o(e){var t=[],n={rows:0,cols:0},o={rows:0,cols:0},r=[],i=[],a={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},u=function(e,t){return function(n,o){return"undefined"==typeof t||"asc"===t?n[e]-o[e]:o[e]-n[e]}},d=function(e,t){for(var n=[];t>=e;)n.push(e++);return n},c=function(e,t,n){var o=[],r={row:null,col:null};if("cols"==e)for(;n>=t;)r={row:-1,col:t++},o.push(r);else for(;n>=t;)r={row:t++,col:-1},o.push(r);for(var i=h(o),s=0,a=0,l=0;l<i.length;l++)s+=i[l].filter(function(e){return e.rows}).length,a+=i[l].filter(function(e){return e.cols}).length;return{total:{rows:s,cols:a},groups:i}},h=function(e){for(var t=[],n=0;n<e.length;n++)t.push(f(e[n]));return t},f=function(e,n,o){for(var r=e.row,i=e.col,s=-1===r?0:r,a=-1===i?0:i,l=[],u=0;u<t.length;u++){var d=t[u],c=d.id,h=(d.level,d.rows||[]),f=d.cols||[];-1===l.indexOf(c)&&(-1!==h.indexOf(s)||-1!==f.indexOf(a))&&l.push(d)}-1===i?l=l.concat(w()):-1===r&&(l=l.concat(y())),n&&(l=l.filter(function(e){return e.level===n})),o&&("cols"===o?l=l.filter(function(e){return e.cols}):"rows"===o&&(l=l.filter(function(e){return e.rows})));var p=[];return l.filter(function(e){return-1===p.indexOf(e.id)?(p.push(e.id),e):void 0})},p=function(e){for(var n=0,o=t.length;o>n;n++)if(t[n].id==e)return t[n];return!1},g=function(e,n){for(var o=0,r=t.length;r>o;o++)if(t[o].level==n&&t[o].rows&&t[o].rows.indexOf(e)>-1)return t[o];return!1},m=function(e,n){for(var o=0,r=t.length;r>o;o++)if(t[o].level==n&&t[o].cols&&t[o].cols.indexOf(e)>-1)return t[o];return!1},w=function(){for(var e=[],n=0,o=t.length;o>n;n++)Array.isArray(t[n].cols)&&e.push(t[n]);return e},v=function(e){for(var n=[],o=0,r=t.length;r>o;o++)t[o].cols&&t[o].level===e&&n.push(t[o]);return n},y=function(){for(var e=[],n=0,o=t.length;o>n;n++)Array.isArray(t[n].rows)&&e.push(t[n]);return e},b=function(e){for(var n=[],o=0,r=t.length;r>o;o++)t[o].rows&&t[o].level===e&&n.push(t[o]);return n},C=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.cols}),e.length){var n=e.sort(u("level","desc")),o=n[0].level;o>t&&(t=o)}}),t},R=function(e){var t=0;return e.length&&e.forEach(function(e){if(e=e.filter(function(e){return e.rows}),e.length){var n=e.sort(u("level","desc")),o=n[0].level;o>t&&(t=o)}}),t},S=function(e,r){var i=c("cols",e,r),s=C(i.groups);s===o.cols?o.cols++:s>o.cols&&(o.cols=s+1),n.cols||(n.cols=w().length),n.cols++,t.push({id:"c"+n.cols,level:s+1,cols:d(e,r),hidden:0})},E=function(e,r){var i=c("rows",e,r),s=R(i.groups);o.rows=Math.max(o.rows,s+1),n.rows||(n.rows=y().length),n.rows++,t.push({id:"r"+n.rows,level:s+1,rows:d(e,r),hidden:0})},T=function(e,t){for(var n,o=0,s=t.length;s>o;o++)if(t[o].hidden=e,n=t[o].level,r[n]||(r[n]=[]),i[n]||(i[n]=[]),t[o].rows)for(var a=0,l=t[o].rows.length;l>a;a++)e>0?r[n][t[o].rows[a]]=!0:r[n][t[o].rows[a]]=void 0;else if(t[o].cols)for(var a=0,u=t[o].cols.length;u>a;a++)e>0?i[n][t[o].cols[a]]=!0:i[n][t[o].cols[a]]=void 0},_=function(e,t,n,o){var r,i;switch(e){case"rows":r=g(t+1,n).id,i=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":r=m(t+1,n).id,i=Handsontable.Grouping.getGroupLevelsByCols()}return!!(i[t+1]&&i[t+1].indexOf(n)>-1&&o==r)},k=function(e,t,n,o){var r,i;switch(e){case"rows":r=g(t-1,n).id,i=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":r=m(t-1,n).id,i=Handsontable.Grouping.getGroupLevelsByCols()}return!!(i[t-1]&&i[t-1].indexOf(n)>-1&&o==r)},H=function(t,n,s,a){if(0===n)return!1;var l,u,d=k(t,n,s,a),c=_(t,n,s,a),h=!1;switch(t){case"rows":l=Handsontable.Grouping.getGroupLevelsByRows(),u=e.countRows();for(var f=0;f<=o.rows;f++)if(r[f]&&r[f][n+1]){h=!0;break}break;case"cols":l=Handsontable.Grouping.getGroupLevelsByCols(),u=e.countCols();for(var f=0;f<=o.cols;f++)if(i[f]&&i[f][n+1]){h=!0;break}}if(d){if(n==u-1)return!0;if(!c||c&&h)return!0;if(!l[n+1])return!0}return!1},M=function(t){var n;switch(t){case"rows":n=o.rows;for(var s=0;n>=s;s++)if(r[s]&&r[s][e.countRows()-1])return!0;break;case"cols":n=o.cols;for(var s=0;n>=s;s++)if(i[s]&&i[s][e.countCols()-1])return!0}return!1},O=function(t,n,s,a){var l,u,d,c=p(a),h=!1,f=function(e){for(var t=!1,s="rows"==e?r:i,a=0;a<=o[e];a++){for(d=n;c[e].indexOf(d)>-1;)t=!(!s[a]||!s[a][d]),d--;if(t)break}return t},g=k(t,n,s,a),m=_(t,n,s,a);switch(t){case"rows":l=Handsontable.Grouping.getGroupLevelsByRows(),u=e.countRows(),h=f(t);break;case"cols":l=Handsontable.Grouping.getGroupLevelsByCols(),u=e.countCols(),h=f(t)}if(n==u-1)return!1;if(0===n){if(m)return!0}else if(!g||g&&h){if(m)return!0}else if(!l[n-1]&&m)return!0;return!1},D=function(e,t,n,o,r){var i;switch(e){case"rows":i=g(t-1,n).id;break;case"cols":i=m(t-1,n).id}if(!i)return null;if(t>0&&k(e,t-1,n,i)&&i!=o){var l=document.createElement("DIV");return s.addClass(l,a.expandButton),l.id="htExpand-"+i,l.appendChild(document.createTextNode("+")),l.setAttribute("data-level",n),l.setAttribute("data-type",e),l.setAttribute("data-hidden","1"),r.appendChild(l),l}return null},x=function(e){for(var t=y(),n=w(),o=0,r=t.length;r>o;o++)if(t[o].rows.indexOf(e.row)>-1&&t[o].hidden)return!0;if(null===e.col)return!1;for(var o=0,i=n.length;i>o;o++)if(n[o].cols.indexOf(e.col)>-1&&n[o].hidden)return!0;return!1};return{getGroups:function(){return t},getLevels:function(){return o},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:y,getColGroups:w,init:function(){var t=e.getSettings().groups;t&&Array.isArray(t)&&Handsontable.Grouping.initGroups(t)},initGroups:function(e){t=[],e.forEach(function(e){var t=[],n=!1,o=!1;Array.isArray(e.rows)?(t=e.rows,n=!0):Array.isArray(e.cols)&&(t=e.cols,o=!0);var r=t[0],i=t[t.length-1];n?E(r,i):o&&S(r,i)})},resetGroups:function(){t=[],n={rows:0,cols:0},o={rows:0,cols:0};var e;for(var r in a)if("function"!=typeof a[r]){e=document.querySelectorAll("."+a[r]);for(var i=0,l=e.length;l>i;i++)s.removeClass(e[i],a[r])}for(var u=["htGroupColClosest","htGroupCol"],r=0,d=u.length;d>r;r++){e=document.querySelectorAll("."+u[r]);for(var i=0,l=e.length;l>i;i++)s.removeClass(e[i],u[r])}},updateGroups:function(){var e=this.getSettings().groups;Handsontable.Grouping.resetGroups(),Handsontable.Grouping.initGroups(e)},afterGetRowHeader:function(e,t){for(var n=!1,o=0,i=r.length;i>o;o++)r[o]&&r[o][e]===!0&&(n=!0);n?s.addClass(t.parentNode,"hidden"):!n&&s.hasClass(t.parentNode,"hidden")&&s.removeClass(t.parentNode,"hidden")},afterGetColHeader:function(t,n){var o=this.view.wt.wtSettings.getSetting("rowHeaders").length,r=e.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(t+o+1,10)+")");if(0!==r.length){for(var a=!1,l=0,u=i.length;u>l;l++)i[l]&&i[l][t]===!0&&(a=!0);if(a)for(var l=0,d=r.length;d>l;l++)s.addClass(r[l],"hidden");else if(!a&&s.hasClass(r[0],"hidden"))for(var l=0,d=r.length;d>l;l++)s.removeClass(r[l],"hidden")}},groupIndicatorsFactory:function(e,t){var r,i,u,d,c,h,f,p;switch(t){case"horizontal":r=Handsontable.Grouping.getGroupLevelsByCols(),i=function(e){return Array.prototype.indexOf.call(e.parentNode.parentNode.childNodes,e.parentNode)+1},u=function(e,t){return m(e,t).id},d="cols",c=function(e,t){return m(e-1,t)},h="columnHeaders",f=function(e){if(1===e.length){var t=e[0];e[0]=function(e,n,o){-1>e?v()(e,n,o):(s.removeClass(n,a.groupIndicatorContainer),t(e,n,o))}}return function(){return e}},p=!0;break;case"vertical":r=Handsontable.Grouping.getGroupLevelsByRows(),i=function(e){return s.index(e)+1},u=function(e,t){return g(e,t).id},d="rows",c=function(e,t){return g(e-1,t)},h="rowHeaders",f=function(e){return e}}var w=function(e){var t=document.createElement("div");return e.appendChild(t),{button:t,addClass:function(e){s.addClass(t,e)}}},v=function(){var e=t.charAt(0).toUpperCase()+t.slice(1);return function(t,n,o){o++;for(var i,h;i=n.lastChild;)n.removeChild(i);s.addClass(n,a.groupIndicatorContainer);var f=u(t,o);if(t>-1&&r[t]&&r[t].indexOf(o)>-1&&(h=w(n),h.addClass(a.groupIndicator(e)),O(d,t,o,f)&&h.addClass(a.groupStart),H(d,t,o,f)&&(h.button.appendChild(document.createTextNode("-")),h.addClass(a.collapseButton),h.button.id=a.collapseGroupId(f),h.button.setAttribute("data-level",o),h.button.setAttribute("data-type",d))),p){var g=s.index(n.parentNode);if(-1===t||-1>t&&g===Handsontable.Grouping.getLevels().cols+1||0===g&&0===Handsontable.Grouping.getLevels().cols)if(h=w(n),h.addClass(a.levelTrigger),-1===t)h.button.id=a.collapseFromLevel("Cols",o),h.button.appendChild(document.createTextNode(o));else if(-1>t&&g===Handsontable.Grouping.getLevels().cols+1||0===g&&0===Handsontable.Grouping.getLevels().cols){var m=s.index(n)+1;h.button.id=a.collapseFromLevel("Rows",m),h.button.appendChild(document.createTextNode(m))}}var v=D(d,t,o,f,n);if(t>0){var y=c(t-1,o);v&&y.hidden&&s.addClass(v,a.clickable)}l()}};if(e=f(e),n[d]>0)for(var y=0;y<o[d]+1;y++)Array.isArray(e)||(e="function"==typeof e?e():new Array(e)),e.unshift(v())},getGroupLevelsByRows:function(){for(var e=y(),t=[],n=0,o=e.length;o>n;n++)if(e[n].rows)for(var r=0,i=e[n].rows.length;i>r;r++)t[e[n].rows[r]]||(t[e[n].rows[r]]=[]),t[e[n].rows[r]].push(e[n].level);return t},getGroupLevelsByCols:function(){for(var e=w(),t=[],n=0,o=e.length;o>n;n++)if(e[n].cols)for(var r=0,i=e[n].cols.length;i>r;r++)t[e[n].cols[r]]||(t[e[n].cols[r]]=[]),t[e[n].cols[r]].push(e[n].level);return t},toggleGroupVisibility:function(t,n,r){if(s.hasClass(t.target,a.expandButton)||s.hasClass(t.target,a.collapseButton)||s.hasClass(t.target,a.levelTrigger)){var i,l,u,d,c=t.target,h=c.id.split("-"),f=[],g=function(e){e&&(c=e),h=c.id.split("-"),i=h[1],l=parseInt(c.getAttribute("data-level"),10),u=c.getAttribute("data-type"),d=parseInt(c.getAttribute("data-hidden")),d=isNaN(d)?1:d?0:1,c.setAttribute("data-hidden",d.toString()),f.push(p(i))};if(c.className.indexOf(a.levelTrigger)>-1){for(var m,w=[],y=[],C=c.id.indexOf("Rows")>-1?"rows":"cols",R=1,S=o[C];S>=R;R++)if(m="rows"==C?b(R):v(R),R>=parseInt(h[1],10))for(var E=0,_=m.length;_>E;E++)y.push(m[E]);else for(var E=0,_=m.length;_>E;E++)w.push(m[E]);T(!0,y),T(!1,w)}else g(),T(d,f);u=u||C;var k=M(u),H=u.charAt(0).toUpperCase()+u.slice(1),O=Handsontable.Grouping["baseSpare"+H];k?0==O&&(e.alter("insert_"+u.slice(0,-1),e["count"+H]()),Handsontable.Grouping["dummy"+u.slice(0,-1)]=!0):0==O&&Handsontable.Grouping["dummy"+u.slice(0,-1)]&&(e.alter("remove_"+u.slice(0,-1),e["count"+H]()-1),Handsontable.Grouping["dummy"+u.slice(0,-1)]=!1),e.render(),t.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t,n=this.instance,o=new WalkontableCellCoords(0,0),r=function(e,t){var n=0;switch(e){case"down":for(;x(t);)n++,t.row+=1;break;case"up":for(;x(t);)n--,t.row-=1;break;case"right":for(;x(t);)n++,t.col+=1;break;case"left":for(;x(t);)n--,t.col-=1}return n},i=function(e,t){e.row>0?x(t)&&(e.row+=r("down",t)):e.row<0&&x(t)&&(e.row+=r("up",t)),e.col>0?x(t)&&(e.col+=r("right",t)):e.col<0&&x(t)&&(e.col+=r("left",t))};switch(e){case"start":return function(e){t=n.getSelected(),o.row=t[0]+e.row,o.col=t[1]+e.col,i(e,o)};case"end":return function(e){t=n.getSelected(),o.row=t[2]+e.row,o.col=t[3]+e.col,i(e,o)}}},modifyRowHeight:function(t,n){return e.view.wt.wtTable.rowFilter&&x({row:n,col:null})?0:void 0},validateGroups:function(){for(var t=function(e,t){return e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1]?!0:void 0},n=e.getSettings().groups,o=[],r=[],i=0,s=n.length;s>i;i++)if(n[i].rows){if(1===n[i].rows.length)throw new Error("Grouping error:  Group {"+n[i].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===n[i].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");r.push(n[i].rows);for(var a=0,l=r.length;l>a;a++)if(t(n[i].rows,r[a]))throw new Error("Grouping error:  ranges {"+n[i].rows[0]+", "+n[i].rows[1]+"} and {"+r[a][0]+", "+r[a][1]+"} are overlapping.")}else if(n[i].cols){if(1===n[i].cols.length)throw new Error("Grouping error:  Group {"+n[i].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===n[i].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");o.push(n[i].cols);for(var a=0,u=o.length;u>a;a++)if(t(n[i].cols,o[a]))throw new Error("Grouping error:  ranges {"+n[i].cols[0]+", "+n[i].cols[1]+"} and {"+o[a][0]+", "+o[a][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){Handsontable.Grouping.groupIndicatorsFactory(e,"vertical");
},afterGetColumnHeaderRenderers:function(e){Handsontable.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(t,n){return function(){return e.getSettings().groups?n?Handsontable.Grouping[t](n).apply(this,arguments):Handsontable.Grouping[t].apply(this,arguments):void 0}}}}var r,i,s=(r=e("./../../dom.js"),r&&r.__esModule&&r||{"default":r});(i=e("./../../plugins.js"),i&&i.__esModule&&i||{"default":i}).registerPlugin;o.prototype.beforeInit=function(){};var a=function(){var e=this,t=!!e.getSettings().groups;if(t){var n={};Handsontable.Grouping=new o(e),e.getSettings().rowHeaders||(n.rowHeaders=!0),e.getSettings().colHeaders||(n.colHeaders=!0),(n.colHeaders||n.rowHeaders)&&e.updateSettings(n);var r=Handsontable.Grouping.validateGroups();if(!r)return;e.addHook("beforeInit",Handsontable.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",Handsontable.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",Handsontable.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",Handsontable.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",Handsontable.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",Handsontable.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",Handsontable.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",Handsontable.Grouping.hookProxy("modifyRowHeight"))}},l=function(){for(var e=document.querySelectorAll("colgroup"),t=0,n=e.length;n>t;t++){var o=e[t].querySelectorAll("col.rowHeader");if(0===o.length)return;for(var r=0,i=o.length+1;i>r;r++){if(2==i)return;r<Handsontable.Grouping.getLevels().rows+1&&(r==Handsontable.Grouping.getLevels().rows?s.addClass(o[r],"htGroupColClosest"):s.addClass(o[r],"htGroupCol"))}}};Handsontable.hooks.add("beforeInit",a),Handsontable.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!Handsontable.Grouping?a.call(this,arguments):!this.getSettings().groups&&Handsontable.Grouping&&(Handsontable.Grouping.resetGroups(),Handsontable.Grouping=void 0)}),Handsontable.plugins.Grouping=o},{"./../../dom.js":27,"./../../plugins.js":45}],58:[function(e,t,n){"use strict";function o(e){function t(t){t.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var t=e.getSelected()[1];return t>f-1?"Freeze this column":"Unfreeze this column"},disabled:function(){var t=e.getSelected();return t[1]!==t[3]},callback:function(){var t=e.getSelected()[1];t>f-1?l(t):u(t)}})}function n(){e.updateSettings({fixedColumnsLeft:f+1}),f++}function o(){e.updateSettings({fixedColumnsLeft:f-1}),f--}function r(t){e.manualColumnPositions&&0!==e.manualColumnPositions.length||e.manualColumnPositions||(e.manualColumnPositions=[]),t?e.manualColumnPositions[t]||i(t+1):i(e.countCols())}function i(t){if(e.manualColumnPositions.length<t)for(var n=e.manualColumnPositions.length;t>n;n++)e.manualColumnPositions[n]=n}function s(t,n,o,r){null==o&&(o=t),"freeze"===r?e.manualColumnPositions.splice(f,0,e.manualColumnPositions.splice(n,1)[0]):"unfreeze"===r&&e.manualColumnPositions.splice(o,0,e.manualColumnPositions.splice(n,1)[0])}function a(e){for(var t=f,n=d(t),o=d(e);o>n;)t++,n=d(t);return t-1}function l(t){if(!(f-1>=t)){var o=d(t)||t;r(o),s(o,t,null,"freeze"),n(),e.view.wt.wtOverlays.leftOverlay.refresh(),e.view.wt.wtOverlays.adjustElementsSize()}}function u(t){if(!(t>f-1)){var n=a(t),i=d(t)||t;r(i),s(i,t,n,"unfreeze"),o(),e.view.wt.wtOverlays.leftOverlay.refresh()}}function d(t){return e.manualColumnPositions[t]}function c(e){return this.manualColumnPositionsPluginUsages.length>1?e:d(e)}function h(){e.addHook("modifyCol",c),e.addHook("afterContextMenuDefaultOptions",t)}var f=e.getSettings().fixedColumnsLeft,p=function(){"undefined"!=typeof e.manualColumnPositionsPluginUsages?e.manualColumnPositionsPluginUsages.push("manualColumnFreeze"):e.manualColumnPositionsPluginUsages=["manualColumnFreeze"],h()};return{init:p,freezeColumn:l,unfreezeColumn:u,helpers:{addFixedColumn:n,removeFixedColumn:o,checkPositionData:r,modifyColumnOrder:s,getBestColumnReturnPosition:a}}}Object.defineProperties(n,{ManualColumnFreeze:{get:function(){return o}},__esModule:{value:!0}});var r,i=((r=e("./../../plugins.js"),r&&r.__esModule&&r||{"default":r}).registerPlugin,function(){if(this.getSettings().manualColumnFreeze){var e;Handsontable.plugins.manualColumnFreeze=o,this.manualColumnFreeze=new o(this),e=this.manualColumnFreeze,e.init.call(this)}});Handsontable.hooks.add("beforeInit",i)},{"./../../plugins.js":45}],59:[function(e,t,n){"use strict";function o(){function e(e){f=this,p=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){h=t;var n=p.getBoundingClientRect();c=n.left,g.style.top=n.top+"px",g.style.left=c+"px",f.rootElement.appendChild(g)}}function t(e,t){var n=e.getBoundingClientRect(),o=6;t>0?g.style.left=n.left+n.width-o+"px":g.style.left=n.left+"px"}function n(){var e=this;u.addClass(g,"active"),u.addClass(m,"active");var t=p.getBoundingClientRect();m.style.width=t.width+"px",m.style.height=e.view.maximumVisibleElementHeight(0)+"px",m.style.top=g.style.top,m.style.left=c+"px",e.rootElement.appendChild(m)}function o(e){m.style.left=c+e+"px"}function r(){u.removeClass(g,"active"),u.removeClass(m,"active")}var i,s,a,c,h,f,p,g=document.createElement("DIV"),m=document.createElement("DIV"),w=d(this);g.className="manualColumnMover",m.className="manualColumnMoverGuide";var v=function(){var e=this;Handsontable.hooks.run(e,"persistentStateSave","manualColumnPositions",e.manualColumnPositions)},y=function(){var e=this,t={};return Handsontable.hooks.run(e,"persistentStateLoad","manualColumnPositions",t),t.value},b=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,b(e)):!1},C=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:C(e.parentNode):null},R=function(){var d,c=this;w.addEventListener(c.rootElement,"mouseover",function(n){if(b(n.target)){var o=C(n.target);if(o)if(d){var r=c.view.wt.wtTable.getCoords(o).col;r>=0&&(s=r,t(n.target,s-i))}else e.call(c,o)}}),w.addEventListener(c.rootElement,"mousedown",function(e){u.hasClass(e.target,"manualColumnMover")&&(a=l.pageX(e),n.call(c),d=c,i=h,s=h)}),w.addEventListener(window,"mousemove",function(e){d&&o(l.pageX(e)-a)}),w.addEventListener(window,"mouseup",function(t){d&&(r(),d=!1,E(c.manualColumnPositions,c.countCols()),c.manualColumnPositions.splice(s,0,c.manualColumnPositions.splice(i,1)[0]),c.forceFullRender=!0,c.view.render(),v.call(c),Handsontable.hooks.run(c,"afterColumnMove",i,s),e.call(c,p))}),c.addHook("afterDestroy",S)},S=function(){w.clear()},E=function(e,t){if(e.length<t)for(var n=e.length;t>n;n++)e[n]=n};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this,n=!!this.getSettings().manualColumnMove;if(n){var o=this.getSettings().manualColumnMove,r=y.call(t);"undefined"!=typeof r?this.manualColumnPositions=r:Array.isArray(o)?this.manualColumnPositions=o:this.manualColumnPositions=[],"afterInit"==e&&("undefined"!=typeof t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.push("manualColumnMove"):t.manualColumnPositionsPluginUsages=["manualColumnMove"],R.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else{var i=t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1;i>-1&&(S.call(this),this.manualColumnPositions=[],t.manualColumnPositionsPluginUsages[i]=void 0)}},this.modifyCol=function(e){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[e]&&E(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e},this.afterRemoveCol=function(e,t){if(this.getSettings().manualColumnMove){var n,o=this.manualColumnPositions;n=o.splice(e,t),o=o.map(function(e){var t,o=e;for(t=0;t<n.length;t++)e>n[t]&&o--;return o}),this.manualColumnPositions=o}},this.afterCreateCol=function(e,t){if(this.getSettings().manualColumnMove){var n=this.manualColumnPositions;if(n.length){for(var o=[],r=0;t>r;r++)o.push(e+r);e>=n.length?n.concat(o):(n=n.map(function(n){return n>=e?n+t:n}),n.splice.apply(n,[e,0].concat(o))),this.manualColumnPositions=n}}}}Object.defineProperties(n,{ManualColumnMove:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l=(r=e("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../../dom.js"),i&&i.__esModule&&i||{"default":i}),d=(s=e("./../../eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager,c=((a=e("./../../plugins.js"),a&&a.__esModule&&a||{"default":a}).registerPlugin,new o);Handsontable.hooks.add("beforeInit",c.beforeInit),Handsontable.hooks.add("afterInit",function(){c.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){c.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyCol",c.modifyCol),Handsontable.hooks.add("afterRemoveCol",c.afterRemoveCol),Handsontable.hooks.add("afterCreateCol",c.afterCreateCol),Handsontable.hooks.register("afterColumnMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],60:[function(e,t,n){"use strict";function o(){function e(e){c=this,i=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){s=t;var n=i.getBoundingClientRect();g=n.left-6,p=parseInt(n.width,10),m.style.top=n.top+"px",m.style.left=g+p+"px",c.rootElement.appendChild(m)}}function t(){m.style.left=g+a+"px"}function n(){var e=this;u.addClass(m,"active"),u.addClass(w,"active"),w.style.top=m.style.top,w.style.left=m.style.left,w.style.height=e.view.maximumVisibleElementHeight(0)+"px",e.rootElement.appendChild(w)}function o(){w.style.left=m.style.left}function r(){u.removeClass(m,"active"),u.removeClass(w,"active")}var i,s,a,c,h,f,p,g,m=document.createElement("DIV"),w=document.createElement("DIV"),v=d(this);m.className="manualColumnResizer",w.className="manualColumnResizerGuide";var y=function(){var e=this;Handsontable.hooks.run(e,"persistentStateSave","manualColumnWidths",e.manualColumnWidths)},b=function(){var e=this,t={};return Handsontable.hooks.run(e,"persistentStateLoad","manualColumnWidths",t),t.value},C=function(e){return"BODY"!=e.tagName?"THEAD"==e.parentNode.tagName?!0:(e=e.parentNode,C(e)):!1},R=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:R(e.parentNode):null},S=function(){var d,c=this,g=0,m=null;v.addEventListener(c.rootElement,"mouseover",function(t){if(C(t.target)){var n=R(t.target);n&&(d||e.call(c,n))}}),v.addEventListener(c.rootElement,"mousedown",function(e){u.hasClass(e.target,"manualColumnResizer")&&(n.call(c),d=c,null==m&&(m=setTimeout(function(){g>=2&&(h=c.determineColumnWidth.call(c,s),T(s,h),c.forceFullRender=!0,c.view.render(),Handsontable.hooks.run(c,"afterColumnResize",s,h)),g=0,m=null},500),c._registerTimeout(m)),g++,f=l.pageX(e),h=p)}),v.addEventListener(window,"mousemove",function(e){d&&(a=p+(l.pageX(e)-f),h=T(s,a),t(),o())}),v.addEventListener(window,"mouseup",function(){d&&(r(),d=!1,h!=p&&(c.forceFullRender=!0,c.view.render(),c.view.wt.wtOverlays.adjustElementsSize(),y.call(c),Handsontable.hooks.run(c,"afterColumnResize",s,h)),e.call(c,i))}),c.addHook("afterDestroy",E)},E=function(){v.clear()};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this,n=!!this.getSettings().manualColumnResize;if(n){var o=this.getSettings().manualColumnResize,r=b.call(t);"undefined"!=typeof t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.push("manualColumnResize"):t.manualColumnWidthsPluginUsages=["manualColumnResize"],"undefined"!=typeof r?this.manualColumnWidths=r:Array.isArray(o)?this.manualColumnWidths=o:this.manualColumnWidths=[],"afterInit"==e&&(S.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else{var i=t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1;i>-1&&(E.call(this),this.manualColumnWidths=[])}};var T=function(e,t){return t=Math.max(t,20),e=Handsontable.hooks.run(c,"modifyCol",e),c.manualColumnWidths[e]=t,t};this.modifyColWidth=function(e,t){return t=this.runHooks("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}}Object.defineProperties(n,{ManualColumnResize:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l=(r=e("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../../dom.js"),i&&i.__esModule&&i||{"default":i}),d=(s=e("./../../eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager,c=((a=e("./../../plugins.js"),a&&a.__esModule&&a||{"default":a}).registerPlugin,new o);Handsontable.hooks.add("beforeInit",c.beforeInit),Handsontable.hooks.add("afterInit",function(){c.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){c.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyColWidth",c.modifyColWidth),Handsontable.hooks.register("afterColumnResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],61:[function(e,t,n){"use strict";function o(){function e(e){var t=this;f=e;var n=this.view.wt.wtTable.getCoords(e).row;if(n>=0){h=n;var o=f.getBoundingClientRect();c=o.top,p.style.top=c+"px",p.style.left=o.left+"px",t.rootElement.appendChild(p)}}function t(e,t){var n=e.getBoundingClientRect(),o=6;t>0?p.style.top=n.top+n.height-o+"px":p.style.top=n.top+"px"}function n(){var e=this;u.addClass(p,"active"),u.addClass(g,"active");var t=f.getBoundingClientRect();g.style.width=e.view.maximumVisibleElementWidth(0)+"px",g.style.height=t.height+"px",g.style.top=c+"px",g.style.left=p.style.left,e.rootElement.appendChild(g)}function o(e){g.style.top=c+e+"px"}function r(){u.removeClass(p,"active"),u.removeClass(g,"active")}var i,s,a,c,h,f,p=document.createElement("DIV"),g=document.createElement("DIV"),m=d(this);p.className="manualRowMover",g.className="manualRowMoverGuide";var w=function(){var e=this;Handsontable.hooks.run(e,"persistentStateSave","manualRowPositions",e.manualRowPositions)},v=function(){var e=this,t={};return Handsontable.hooks.run(e,"persistentStateLoad","manualRowPositions",t),t.value},y=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,y(e)):!1},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},C=function(){var d,c=this;m.addEventListener(c.rootElement,"mouseover",function(n){if(y(n.target)){var o=b(n.target);o&&(d?(s=c.view.wt.wtTable.getCoords(o).row,t(o,s-i)):e.call(c,o))}}),m.addEventListener(c.rootElement,"mousedown",function(e){u.hasClass(e.target,"manualRowMover")&&(a=l.pageY(e),n.call(c),d=c,i=h,s=h)}),m.addEventListener(window,"mousemove",function(e){d&&o(l.pageY(e)-a)}),m.addEventListener(window,"mouseup",function(t){d&&(r(),d=!1,S(c.manualRowPositions,c.countRows()),c.manualRowPositions.splice(s,0,c.manualRowPositions.splice(i,1)[0]),c.forceFullRender=!0,c.view.render(),w.call(c),Handsontable.hooks.run(c,"afterRowMove",i,s),e.call(c,f))}),c.addHook("afterDestroy",R)},R=function(){m.clear()},S=function(e,t){if(e.length<t)for(var n=e.length;t>n;n++)e[n]=n};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this,n=!!t.getSettings().manualRowMove;if(n){var o=t.getSettings().manualRowMove,r=v.call(t);"undefined"!=typeof t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.push("manualColumnMove"):t.manualRowPositionsPluginUsages=["manualColumnMove"],"undefined"!=typeof r?this.manualRowPositions=r:Array.isArray(o)?this.manualRowPositions=o:this.manualRowPositions=[],"afterInit"===e&&(C.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else{var i=t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1;i>-1&&(R.call(this),t.manualRowPositions=[],t.manualRowPositionsPluginUsages[i]=void 0)}},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?("undefined"==typeof t.manualRowPositions[e]&&S(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}}Object.defineProperties(n,{ManualRowMove:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l=(r=e("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../../dom.js"),i&&i.__esModule&&i||{"default":i}),d=(s=e("./../../eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager,c=((a=e("./../../plugins.js"),a&&a.__esModule&&a||{"default":a}).registerPlugin,new o);Handsontable.hooks.add("beforeInit",c.beforeInit),Handsontable.hooks.add("afterInit",function(){c.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){c.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyRow",c.modifyRow),Handsontable.hooks.register("afterRowMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],62:[function(e,t,n){"use strict";function o(){function e(e){c=this,i=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){s=t;var n=i.getBoundingClientRect();g=n.top-6,p=parseInt(n.height,10),m.style.left=n.left+"px",m.style.top=g+p+"px",c.rootElement.appendChild(m)}}function t(){m.style.top=g+a+"px"}function n(){var e=this;u.addClass(m,"active"),u.addClass(w,"active"),w.style.top=m.style.top,w.style.left=m.style.left,w.style.width=e.view.maximumVisibleElementWidth(0)+"px",e.rootElement.appendChild(w)}function o(){w.style.top=m.style.top}function r(){u.removeClass(m,"active"),u.removeClass(w,"active")}var i,s,a,c,h,f,p,g,m=document.createElement("DIV"),w=document.createElement("DIV"),v=d(this);m.className="manualRowResizer",w.className="manualRowResizerGuide";var y=function(){var e=this;Handsontable.hooks.run(e,"persistentStateSave","manualRowHeights",e.manualRowHeights)},b=function(){var e=this,t={};return Handsontable.hooks.run(e,"persistentStateLoad","manualRowHeights",t),t.value},C=function(e){return"BODY"!=e.tagName?"TBODY"==e.parentNode.tagName?!0:(e=e.parentNode,C(e)):!1},R=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:R(e.parentNode):null},S=function(){var d,c=this,g=0,m=null;v.addEventListener(c.rootElement,"mouseover",function(t){if(C(t.target)){var n=R(t.target);n&&(d||e.call(c,n))}}),v.addEventListener(c.rootElement,"mousedown",function(e){u.hasClass(e.target,"manualRowResizer")&&(n.call(c),d=c,null==m&&(m=setTimeout(function(){g>=2&&(T(s,null),c.forceFullRender=!0,c.view.render(),Handsontable.hooks.run(c,"afterRowResize",s,h)),g=0,m=null},500),c._registerTimeout(m)),g++,f=l.pageY(e),h=p)}),v.addEventListener(window,"mousemove",function(e){d&&(a=p+(l.pageY(e)-f),h=T(s,a),t(),o())}),v.addEventListener(window,"mouseup",function(t){d&&(r(),d=!1,h!=p&&(c.forceFullRender=!0,c.view.render(),y.call(c),Handsontable.hooks.run(c,"afterRowResize",s,h)),e.call(c,i))}),c.addHook("afterDestroy",E)},E=function(){v.clear()};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t=this,n=!!this.getSettings().manualRowResize;if(n){var o=this.getSettings().manualRowResize,r=b.call(t);"undefined"!=typeof t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.push("manualRowResize"):t.manualRowHeightsPluginUsages=["manualRowResize"],"undefined"!=typeof r?this.manualRowHeights=r:Array.isArray(o)?this.manualRowHeights=o:this.manualRowHeights=[],"afterInit"===e?(S.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else{var i=t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1;i>-1&&(E.call(this),this.manualRowHeights=[],t.manualRowHeightsPluginUsages[i]=void 0)}};var T=function(e,t){return e=Handsontable.hooks.run(c,"modifyRow",e),c.manualRowHeights[e]=t,t};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooks("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}}Object.defineProperties(n,{ManualRowResize:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l=(r=e("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../../dom.js"),i&&i.__esModule&&i||{"default":i}),d=(s=e("./../../eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager,c=((a=e("./../../plugins.js"),a&&a.__esModule&&a||{"default":a}).registerPlugin,new o);Handsontable.hooks.add("beforeInit",c.beforeInit),Handsontable.hooks.add("afterInit",function(){c.init.call(this,"afterInit")}),Handsontable.hooks.add("afterUpdateSettings",function(){c.init.call(this,"afterUpdateSettings")}),Handsontable.hooks.add("modifyRowHeight",c.modifyRowHeight),Handsontable.hooks.register("afterRowResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],63:[function(e,t,n){"use strict";function o(){var e=[];return e.getInfo=function(e,t){for(var n=0,o=this.length;o>n;n++)if(this[n].row<=e&&this[n].row+this[n].rowspan-1>=e&&this[n].col<=t&&this[n].col+this[n].colspan-1>=t)return this[n]},e.setInfo=function(e){for(var t=0,n=this.length;n>t;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var n=0,o=this.length;o>n;n++)if(this[n].row===e&&this[n].col===t){this.splice(n,1);break}},e}function r(e){if(this.mergedCellInfoCollection=new o,Array.isArray(e))for(var t=0,n=e.length;n>t;t++)this.mergedCellInfoCollection.setInfo(e[t])}function i(e,t){var n=this.getSettings().mergeCells;if(n&&!this.selection.isMultiple()){var o=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);o&&(e[0]=o.row,e[1]=o.col,e[2]=o.row+o.rowspan-1,e[3]=o.col+o.colspan-1)}}Object.defineProperties(n,{MergeCells:{get:function(){return r}},__esModule:{value:!0}});var s,a,l,u,d=((s=e("./../../plugins.js"),s&&s.__esModule&&s||{"default":s}).registerPlugin,(a=e("./../../3rdparty/walkontable/src/cell/coords.js"),a&&a.__esModule&&a||{"default":a}).WalkontableCellCoords),c=(l=e("./../../3rdparty/walkontable/src/cell/range.js"),l&&l.__esModule&&l||{"default":l}).WalkontableCellRange,h=(u=e("./../../3rdparty/walkontable/src/table.js"),u&&u.__esModule&&u||{"default":u}).WalkontableTable;r.prototype.canMergeRange=function(e){return!e.isSingle()},r.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),o={};o.row=t.row,o.col=t.col,o.rowspan=n.row-t.row+1,o.colspan=n.col-t.col+1,this.mergedCellInfoCollection.setInfo(o)}},r.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);t?this.unmergeSelection(e.from):this.mergeSelection(e)},r.prototype.mergeSelection=function(e){this.mergeRange(e)},r.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},r.prototype.applySpanProperties=function(e,t,n){var o=this.mergedCellInfoCollection.getInfo(t,n);o?o.row===t&&o.col===n?(e.setAttribute("rowspan",o.rowspan),e.setAttribute("colspan",o.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},r.prototype.modifyTransform=function(e,t,n){var o=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1?!0:!1},r=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1?!0:!1},i=function(e){return new d(t.to.row+e.row,t.to.col+e.col)},s={row:n.row,col:n.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new d(null,null));for(var a,l=new d(t.highlight.row,t.highlight.col),u=this.mergedCellInfoCollection.getInfo(l.row,l.col),h=0,f=this.mergedCellInfoCollection.length;f>h;h++){var p=this.mergedCellInfoCollection[h];if(p=new d(p.row+p.rowspan-1,p.col+p.colspan-1),t.includes(p)){a=!0;break}}if(u){var g=new d(u.row,u.col),m=new d(u.row+u.rowspan-1,u.col+u.colspan-1),w=new c(g,g,m);w.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new d(null,null)),s.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-l.row:s.row,s.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-l.col:s.col,n.row>0?s.row=u.row+u.rowspan-1-l.row+n.row:n.row<0&&(s.row=l.row-u.row+n.row),n.col>0?s.col=u.col+u.colspan-1-l.col+n.col:n.col<0&&(s.col=l.col-u.col+n.col)}var v=new d(t.highlight.row+s.row,t.highlight.col+s.col),y=this.mergedCellInfoCollection.getInfo(v.row,v.col);y&&(this.lastDesiredCoords=v,s={row:y.row-l.row,col:y.col-l.col})}else if("modifyTransformEnd"==e)for(var h=0,f=this.mergedCellInfoCollection.length;f>h;h++){var b=this.mergedCellInfoCollection[h],g=new d(b.row,b.col),m=new d(b.row+b.rowspan-1,b.col+b.colspan-1),C=new c(g,g,m),R=t.getBordersSharedWith(C);if(C.isEqual(t))t.setDirection("NW-SE");else if(R.length>0){var S=t.highlight.isEqual(C.from);R.indexOf("top")>-1?t.to.isSouthEastOf(C.from)&&S?t.setDirection("NW-SE"):t.to.isSouthWestOf(C.from)&&S&&t.setDirection("NE-SW"):R.indexOf("bottom")>-1&&(t.to.isNorthEastOf(C.from)&&S?t.setDirection("SW-NE"):t.to.isNorthWestOf(C.from)&&S&&t.setDirection("SE-NW"))}var v=i(s),E=o(b,v),T=r(b,v);t.includesRange(C)&&(C.includes(v)||E||T)&&(E&&(s.row<0?s.row-=b.rowspan-1:s.row>0&&(s.row+=b.rowspan-1)),T&&(s.col<0?s.col-=b.colspan-1:s.col>0&&(s.col+=b.colspan-1)))}0!==s.row&&(n.row=s.row),0!==s.col&&(n.col=s.col)};var f=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new r(t)))},p=function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var n=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);n&&(t=n)}return h.prototype.getCell.call(this,t)})},g=function(e){if(this.mergeCells){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}},m=function(e){this.getSettings().mergeCells&&(e.items.push(Handsontable.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))},w=function(e,t,n,o,r,i){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,n)},v=function(e){return function(t){var n=this.getSettings().mergeCells;if(n){var o=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,o,t),"modifyTransformEnd"===e){var r=this.countRows(),i=this.countCols();o.from.row<0?o.from.row=0:o.from.row>0&&o.from.row>=r&&(o.from.row=o.from-1),o.from.col<0?o.from.col=0:o.from.col>0&&o.from.col>=i&&(o.from.col=i-1)}}}},y=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var n=this.getSelectedRange();n.highlight=new d(n.highlight.row,n.highlight.col),n.to=e;var o=!1;do{o=!1;for(var r=0,i=this.mergeCells.mergedCellInfoCollection.length;i>r;r++){var s=this.mergeCells.mergedCellInfoCollection[r],a=new d(s.row,s.col),l=new d(s.row+s.rowspan-1,s.col+s.colspan-1),u=new c(a,a,l);n.expandByRange(u)&&(e.row=n.to.row,e.col=n.to.col,o=!0)}}while(o)}},b=function(e,t){if(t&&"area"==t){var n=this.getSettings().mergeCells;if(n)for(var o=this.getSelectedRange(),r=new c(o.from,o.from,o.from),i=new c(o.to,o.to,o.to),s=0,a=this.mergeCells.mergedCellInfoCollection.length;a>s;s++){var l=this.mergeCells.mergedCellInfoCollection[s],u=new d(l.row,l.col),h=new d(l.row+l.rowspan-1,l.col+l.colspan-1),f=new c(u,u,h);r.expandByRange(f)&&(e[0]=r.from.row,e[1]=r.from.col),i.expandByRange(f)&&(e[2]=i.from.row,e[3]=i.from.col)}}},C=function(e,t,n){var o=this.getSettings().mergeCells;if(o){var r=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!r||r.row==e&&r.col==t||(n.copyable=!1)}},R=function(e){var t=this.getSettings().mergeCells;if(t)for(var n,o=this.countCols(),r=0;o>r;r++){if(n=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,r),n&&n.row<e.startRow)return e.startRow=n.row,R.call(this,e);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,r)){var i=n.row+n.rowspan-1;if(i>e.endRow)return e.endRow=i,R.call(this,e)}}},S=function(e){var t=this.getSettings().mergeCells;if(t)for(var n,o=this.countRows(),r=0;o>r;r++){if(n=this.mergeCells.mergedCellInfoCollection.getInfo(r,e.startColumn),n&&n.col<e.startColumn)return e.startColumn=n.col,S.call(this,e);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(r,e.endColumn)){var i=n.col+n.colspan-1;if(i>e.endColumn)return e.endColumn=i,S.call(this,e)}}},E=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,n=this.getSelectedRange();for(var o in t)if(n.highlight.row==t[o].row&&n.highlight.col==t[o].col&&n.to.row==t[o].row+t[o].rowspan-1&&n.to.col==t[o].col+t[o].colspan-1)return!1}return e};Handsontable.hooks.add("beforeInit",f),Handsontable.hooks.add("afterInit",p),Handsontable.hooks.add("beforeKeyDown",g),Handsontable.hooks.add("modifyTransformStart",v("modifyTransformStart")),Handsontable.hooks.add("modifyTransformEnd",v("modifyTransformEnd")),Handsontable.hooks.add("beforeSetRangeEnd",y),Handsontable.hooks.add("beforeDrawBorders",b),Handsontable.hooks.add("afterIsMultipleSelection",E),Handsontable.hooks.add("afterRenderer",w),Handsontable.hooks.add("afterContextMenuDefaultOptions",m),Handsontable.hooks.add("afterGetCellMeta",C),Handsontable.hooks.add("afterViewportRowCalculatorOverride",R),Handsontable.hooks.add("afterViewportColumnCalculatorOverride",S),Handsontable.hooks.add("afterAutofillApplyValues",i),Handsontable.MergeCells=r},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/table.js":20,"./../../plugins.js":45}],64:[function(e,t,n){"use strict";Object.defineProperties(n,{"default":{get:function(){return f}},__esModule:{value:!0}});var o,r,i,s,a=(o=e("./../../dom.js"),o&&o.__esModule&&o||{"default":o}),l=(r=e("./../_base.js"),r&&r.__esModule&&r||{"default":r})["default"],u=(i=e("./../../eventManager.js"),i&&i.__esModule&&i||{"default":i}).eventManager,d=(s=e("./../../plugins.js"),s&&s.__esModule&&s||{"default":s}).registerPlugin,c=function(e){var t=this;$traceurRuntime.superConstructor(h).call(this,e),this.dragged=[],this.eventManager=u(this.hot),this.bindTouchEvents(),this.hot.addHook("afterInit",function(){return t.init()})},h=c;$traceurRuntime.createClass(c,{init:function(){this.lastSetCell=null,Handsontable.plugins.multipleSelectionHandles=new h(this.hot)},bindTouchEvents:function(){function e(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);return-1==n?!1:void(0===n?t.dragged=t.dragged.slice(0,1):1==n&&(t.dragged=t.dragged.slice(-1)))}var t=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(e){var n;return a.hasClass(e.target,"topLeftSelectionHandle-HitArea")?(n=t.hot.getSelectedRange(),t.dragged.push("topLeft"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):a.hasClass(e.target,"bottomRightSelectionHandle-HitArea")?(n=t.hot.getSelectedRange(),t.dragged.push("bottomRight"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(n){return a.hasClass(n.target,"topLeftSelectionHandle-HitArea")?(e.call(t,"topLeft"),t.touchStartRange=void 0,n.preventDefault(),!1):a.hasClass(n.target,"bottomRightSelectionHandle-HitArea")?(e.call(t,"bottomRight"),t.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(e){var n,o,r,i,s,l,u,d=a.getWindowScrollTop(),c=a.getWindowScrollLeft();0!==t.dragged.length&&(n=document.elementFromPoint(e.touches[0].screenX-c,e.touches[0].screenY-d),
n&&n!==t.lastSetCell&&(("TD"==n.nodeName||"TH"==n.nodeName)&&(o=t.hot.getCoords(n),-1==o.col&&(o.col=0),r=t.hot.getSelectedRange(),i=r.getWidth(),s=r.getHeight(),l=r.getDirection(),1==i&&1==s&&t.hot.selection.setRangeEnd(o),u=t.getCurrentRangeCoords(r,o,t.touchStartRange.direction,l,t.dragged[0]),null!==u.start&&t.hot.selection.setRangeStart(u.start),t.hot.selection.setRangeEnd(u.end),t.lastSetCell=n),e.preventDefault()))})},getCurrentRangeCoords:function(e,t,n,o,r){var i=e.getTopLeftCorner(),s=e.getBottomRightCorner(),a=e.getBottomLeftCorner(),l=e.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":u="topLeft"==r?{start:new WalkontableCellCoords(t.row,e.highlight.col),end:new WalkontableCellCoords(a.row,t.col)}:{start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,i.col)};break;case"SE-NW":"bottomRight"==r&&(u={start:new WalkontableCellCoords(s.row,t.col),end:new WalkontableCellCoords(t.row,i.col)})}break;case"NW-SE":switch(o){case"NE-SW":"topLeft"==r?u={start:t,end:a}:u.end=t;break;case"NW-SE":"topLeft"==r?u={start:t,end:s}:u.end=t;break;case"SE-NW":"topLeft"==r?u={start:t,end:i}:u.end=t;break;case"SW-NE":"topLeft"==r?u={start:t,end:l}:u.end=t}break;case"SW-NE":switch(o){case"NW-SE":u="bottomRight"==r?{start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(a.row,t.col)}:{start:new WalkontableCellCoords(i.row,t.col),end:new WalkontableCellCoords(t.row,s.col)};break;case"SW-NE":u="topLeft"==r?{start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,s.col)}:{start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(i.row,t.col)};break;case"SE-NW":"bottomRight"==r?u={start:new WalkontableCellCoords(t.row,l.col),end:new WalkontableCellCoords(i.row,t.col)}:"topLeft"==r&&(u={start:a,end:t})}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==r&&(u.end=t);break;case"SE-NW":"topLeft"==r?u.end=t:u={start:t,end:i}}}return u},isDragged:function(){return this.dragged.length>0}},{},l);var f=c;d("multipleSelectionHandles",c)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],65:[function(e,t,n){"use strict";function o(){}function r(){var e=this,t=e.getSettings().observeChanges;t?(e.observer&&a.call(e),i.call(e),u.call(e)):t||a.call(e)}function i(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=p.observe(e.observedData,function(t){e.observeChangesActive&&(s.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function s(e){function t(e){var t;return t=o(e),t=n(t)}function n(e){var t=[];return e.filter(function(e){var n=r(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(n.col)){if(-1!=t.indexOf(n.col))return!1;t.push(n.col)}return!0})}function o(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function r(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var i=this,s=t(e),a=0,l=s.length;l>a;a++){var u=s[a],d=r(u.path);switch(u.op){case"add":isNaN(d.col)?i.runHooks("afterCreateRow",d.row):i.runHooks("afterCreateCol",d.col);break;case"remove":isNaN(d.col)?i.runHooks("afterRemoveRow",d.row,1):i.runHooks("afterRemoveCol",d.col,1);break;case"replace":i.runHooks("afterChange",[d.row,d.col,null,u.value],"external")}}}function a(){var e=this;e.observer&&(l.call(e),d.call(e))}function l(){var e=this;p.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function u(){var e=this;e.addHook("afterDestroy",a),e.addHook("afterCreateRow",c),e.addHook("afterRemoveRow",c),e.addHook("afterCreateCol",c),e.addHook("afterRemoveCol",c),e.addHook("afterChange",function(e,t){"loadData"!=t&&c.call(this)})}function d(){var e=this;e.removeHook("afterDestroy",a),e.removeHook("afterCreateRow",c),e.removeHook("afterRemoveRow",c),e.removeHook("afterCreateCol",c),e.removeHook("afterRemoveCol",c),e.removeHook("afterChange",c)}function c(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}Object.defineProperties(n,{ObserveChanges:{get:function(){return o}},__esModule:{value:!0}});var h,f,p=((h=e("./../../plugins.js"),h&&h.__esModule&&h||{"default":h}).registerPlugin,(f=e("jsonpatch"),f&&f.__esModule&&f||{"default":f})["default"]);Handsontable.hooks.add("afterLoadData",r),Handsontable.hooks.add("afterUpdateSettings",r),Handsontable.hooks.register("afterChangesObserved")},{"./../../plugins.js":45,jsonpatch:"jsonpatch"}],66:[function(e,t,n){"use strict";function o(e){var t,n=function(){window.localStorage[e+"__persistentStateKeys"]=JSON.stringify(t)},o=function(){var n=window.localStorage[e+"__persistentStateKeys"],o="string"==typeof n?JSON.parse(n):void 0;t=o?o:[]},r=function(){t=[],n()};o(),this.saveValue=function(o,r){window.localStorage[e+"_"+o]=JSON.stringify(r),-1==t.indexOf(o)&&(t.push(o),n())},this.loadValue=function(t,n){t="undefined"!=typeof t?t:n;var o=window.localStorage[e+"_"+t];return"undefined"==typeof o?void 0:JSON.parse(o)},this.reset=function(t){window.localStorage.removeItem(e+"_"+t)},this.resetAll=function(){for(var n=0;n<t.length;n++)window.localStorage.removeItem(e+"_"+t[n]);r()}}function r(){function e(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.addHook(t,r[t])}function t(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.removeHook(t,r[t])}var n=this;this.init=function(){var r=this,i=r.getSettings().persistentState;return n.enabled=!!i,n.enabled?(r.storage||(r.storage=new o(r.rootElement.id)),r.resetState=n.resetValue,void e.call(r)):void t.call(r)},this.saveValue=function(e,t){var n=this;n.storage.saveValue(e,t)},this.loadValue=function(e,t){var n=this;t.value=n.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"!=typeof e?t.storage.reset(e):t.storage.resetAll()};var r={persistentStateSave:n.saveValue,persistentStateLoad:n.loadValue,persistentStateReset:n.resetValue};for(var i in r)r.hasOwnProperty(i)&&Handsontable.hooks.register(i)}Object.defineProperties(n,{HandsontablePersistentState:{get:function(){return r}},__esModule:{value:!0}});var i,s=((i=e("./../../plugins.js"),i&&i.__esModule&&i||{"default":i}).registerPlugin,new r);Handsontable.hooks.add("beforeInit",s.init),Handsontable.hooks.add("afterUpdateSettings",s.init)},{"./../../plugins.js":45}],67:[function(e,t,n){"use strict";function o(){var e=this,t=!!e.getSettings().search;t?e.search=new Handsontable.Search(e):delete e.search}var r,i,s=(r=e("./../../dom.js"),r&&r.__esModule&&r||{"default":r}),a=(i=e("./../../renderers.js"),i&&i.__esModule&&i||{"default":i}),l=a.registerRenderer,u=a.getRenderer;Handsontable.Search=function(e){this.query=function(t,n,o){var r=e.countRows(),i=e.countCols(),s=[];n||(n=Handsontable.Search.global.getDefaultCallback()),o||(o=Handsontable.Search.global.getDefaultQueryMethod());for(var a=0;r>a;a++)for(var l=0;i>l;l++){var u=e.getDataAtCell(a,l),d=e.getCellMeta(a,l),c=d.search.callback||n,h=d.search.queryMethod||o,f=h(t,u);if(f){var p={row:a,col:l,data:u};s.push(p)}c&&c(e,a,l,u,f)}return s}},Handsontable.Search.DEFAULT_CALLBACK=function(e,t,n,o,r){e.getCellMeta(t,n).isSearchResult=r},Handsontable.Search.DEFAULT_QUERY_METHOD=function(e,t){return"undefined"!=typeof e&&null!=e&&e.toLowerCase&&0!==e.length?"undefined"==typeof t||null==t?!1:-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()):!1},Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",Handsontable.Search.global=function(){var e=Handsontable.Search.DEFAULT_CALLBACK,t=Handsontable.Search.DEFAULT_QUERY_METHOD,n=Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return e},setDefaultCallback:function(t){e=t},getDefaultQueryMethod:function(){return t},setDefaultQueryMethod:function(e){t=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}(),Handsontable.SearchCellDecorator=function(e,t,n,o,r,i,a){var l=null!==a.search&&"object"==typeof a.search&&a.search.searchResultClass||Handsontable.Search.global.getDefaultSearchResultClass();a.isSearchResult?s.addClass(t,l):s.removeClass(t,l)};var d=u("base");l("base",function(e,t,n,o,r,i,s){d.apply(this,arguments),Handsontable.SearchCellDecorator.apply(this,arguments)}),Handsontable.hooks.add("afterInit",o),Handsontable.hooks.add("afterUpdateSettings",o)},{"./../../dom.js":27,"./../../renderers.js":70}],68:[function(e,t,n){"use strict";Object.defineProperties(n,{TouchScroll:{get:function(){return u}},__esModule:{value:!0}});var o,r,i,s=(o=e("./../../dom.js"),o&&o.__esModule&&o||{"default":o}),a=(r=e("./../_base.js"),r&&r.__esModule&&r||{"default":r})["default"],l=(i=e("./../../plugins.js"),i&&i.__esModule&&i||{"default":i}).registerPlugin,u=function(e){var t=this;$traceurRuntime.superConstructor(d).call(this,e),this.hot.addHook("afterInit",function(){return t.init()}),this.hot.addHook("afterUpdateSettings",function(){return t.onAfterUpdateSettings()}),this.scrollbars=[],this.clones=[]},d=u;$traceurRuntime.createClass(u,{init:function(){this.registerEvents(),this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var e=this;this.hot.addHookOnce("afterRender",function(){var t=e.hot.view.wt.wtOverlays;e.scrollbars=[],e.scrollbars.push(t.topOverlay),e.scrollbars.push(t.leftOverlay),t.topLeftCornerOverlay&&e.scrollbars.push(t.topLeftCornerOverlay),e.clones=[],t.topOverlay.needFullRender&&e.clones.push(t.topOverlay.clone.wtTable.holder.parentNode),t.leftOverlay.needFullRender&&e.clones.push(t.leftOverlay.clone.wtTable.holder.parentNode),t.topLeftCornerOverlay&&e.clones.push(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode)})},registerEvents:function(){var e=this;this.hot.addHook("beforeTouchScroll",function(){return e.onBeforeTouchScroll()}),this.hot.addHook("afterMomentumScroll",function(){return e.onAfterMomentumScroll()})},onBeforeTouchScroll:function(){Handsontable.freezeOverlays=!0;for(var e=0,t=this.clones.length;t>e;e++)s.addClass(this.clones[e],"hide-tween")},onAfterMomentumScroll:function(){Handsontable.freezeOverlays=!1;for(var e=this,t=0,n=this.clones.length;n>t;t++)s.removeClass(this.clones[t],"hide-tween");for(var o=0,r=this.clones.length;r>o;o++)s.addClass(this.clones[o],"show-tween");setTimeout(function(){for(var t=0,n=e.clones.length;n>t;t++)s.removeClass(e.clones[t],"show-tween")},400);for(var i=0,a=this.scrollbars.length;a>i;i++)this.scrollbars[i].refresh(),this.scrollbars[i].resetFixedPosition();this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},a),l("touchScroll",u)},{"./../../dom.js":27,"./../../plugins.js":45,"./../_base.js":46}],69:[function(e,t,n){"use strict";function o(){var e=this,t="undefined"==typeof e.getSettings().undo||e.getSettings().undo;t?e.undoRedo||(e.undoRedo=new Handsontable.UndoRedo(e),s(e),e.addHook("beforeKeyDown",r),e.addHook("afterChange",i)):e.undoRedo&&(delete e.undoRedo,a(e),e.removeHook("beforeKeyDown",r),e.removeHook("afterChange",i))}function r(e){var t=this,n=(e.ctrlKey||e.metaKey)&&!e.altKey;n&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function i(e,t){var n=this;return"loadData"==t?n.undoRedo.clear():void 0}function s(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function a(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var l,u=(l=e("./../../helpers.js"),l&&l.__esModule&&l||{"default":l});Handsontable.UndoRedo=function(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",function(e,n){if(e){var o=new Handsontable.UndoRedo.ChangeAction(e);t.done(o)}}),e.addHook("afterCreateRow",function(e,n,o){if(!o){var r=new Handsontable.UndoRedo.CreateRowAction(e,n);t.done(r)}}),e.addHook("beforeRemoveRow",function(e,n){var o=t.instance.getData();e=(o.length+e)%o.length;var r=o.slice(e,e+n),i=new Handsontable.UndoRedo.RemoveRowAction(e,r);t.done(i)}),e.addHook("afterCreateCol",function(e,n,o){if(!o){var r=new Handsontable.UndoRedo.CreateColumnAction(e,n);t.done(r)}}),e.addHook("beforeRemoveCol",function(n,o){var r=t.instance.getData();n=(t.instance.countCols()+n)%t.instance.countCols();for(var i=[],s=0,a=r.length;a>s;s++)i[s]=r[s].slice(n,n+o);var l;Array.isArray(e.getSettings().colHeaders)&&(l=e.getSettings().colHeaders.slice(n,n+i.length));var u=new Handsontable.UndoRedo.RemoveColumnAction(n,i,l);t.done(u)}),e.addHook("beforeCellAlignment",function(e,n,o,r){var i=new Handsontable.UndoRedo.CellAlignmentAction(e,n,o,r);t.done(i)})},Handsontable.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},Handsontable.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},Handsontable.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},Handsontable.UndoRedo.Action=function(){},Handsontable.UndoRedo.Action.prototype.undo=function(){},Handsontable.UndoRedo.Action.prototype.redo=function(){},Handsontable.UndoRedo.ChangeAction=function(e){this.changes=e},u.inherit(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.ChangeAction.prototype.undo=function(e,t){for(var n=u.deepClone(this.changes),o=e.countEmptyRows(!0),r=e.countEmptyCols(!0),i=0,s=n.length;s>i;i++)n[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"undo");for(var i=0,s=n.length;s>i;i++)e.getSettings().minSpareRows&&n[i][0]+1+e.getSettings().minSpareRows===e.countRows()&&o==e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(n[i][0]+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&n[i][1]+1+e.getSettings().minSpareCols===e.countCols()&&r==e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(n[i][1]+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())},Handsontable.UndoRedo.ChangeAction.prototype.redo=function(e,t){for(var n=u.deepClone(this.changes),o=0,r=n.length;r>o;o++)n[o].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"redo")},Handsontable.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},u.inherit(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),o=e.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},Handsontable.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},u.inherit(Handsontable.UndoRedo.RemoveRowAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var n=[this.index,0];Array.prototype.push.apply(n,this.data),Array.prototype.splice.apply(e.getData(),n),e.addHookOnce("afterRender",t),e.render()},Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},Handsontable.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},u.inherit(Handsontable.UndoRedo.CreateColumnAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},Handsontable.UndoRedo.CellAlignmentAction=function(e,t,n,o){this.stateBefore=e,this.range=t,this.type=n,this.alignment=o},Handsontable.UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){if(e.contextMenu){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var o=this.range.from.col;o<=this.range.to.col;o++)e.setCellMeta(n,o,"className",this.stateBefore[n][o]||" htLeft");e.addHookOnce("afterRender",t),e.render()}},Handsontable.UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){if(e.contextMenu){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var o=this.range.from.col;o<=this.range.to.col;o++)e.contextMenu.align.call(e,this.range,this.type,this.alignment);e.addHookOnce("afterRender",t),e.render()}},Handsontable.UndoRedo.RemoveColumnAction=function(e,t,n){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=n},u.inherit(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action),Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var n,o,r=0,i=e.getData().length;i>r;r++)n=e.getSourceDataAtRow(r),o=[this.index,0],Array.prototype.push.apply(o,this.data[r]),Array.prototype.splice.apply(n,o);"undefined"!=typeof this.headers&&(o=[this.index,0],Array.prototype.push.apply(o,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,o)),e.addHookOnce("afterRender",t),e.render()},Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},Handsontable.hooks.add("afterInit",o),Handsontable.hooks.add("afterUpdateSettings",o)},{"./../../helpers.js":42}],70:[function(e,t,n){"use strict";function o(e,t){var n;l[e]=t,n=a.toUpperCaseFirst(e)+"Renderer",Handsontable.renderers[n]=t,Handsontable[n]=t}function r(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter');if(!(e in l))throw Error('No editor registered under name "'+e+'"');return l[e]}function i(e){return e in l}Object.defineProperties(n,{registerRenderer:{get:function(){return o}},getRenderer:{get:function(){return r}},hasRenderer:{get:function(){return i}},__esModule:{value:!0}});var s,a=(s=e("./helpers.js"),s&&s.__esModule&&s||{"default":s}),l={};Handsontable.renderers=Handsontable.renderers||{},Handsontable.renderers.registerRenderer=o,Handsontable.renderers.getRenderer=r},{"./helpers.js":42}],71:[function(e,t,n){"use strict";function o(e,t,n,o,r,i,a){a.className&&(t.className?t.className=t.className+" "+a.className:t.className=a.className),a.readOnly&&s.addClass(t,a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.addClass(t,a.invalidCellClassName):s.removeClass(t,a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.addClass(t,a.noWordWrapClassName),!i&&a.placeholder&&s.addClass(t,a.placeholderCellClassName)}Object.defineProperties(n,{cellDecorator:{get:function(){return o}},__esModule:{value:!0}});var r,i,s=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),a=(i=e("./../renderers.js"),i&&i.__esModule&&i||{"default":i}).registerRenderer;a("base",o),Handsontable.renderers.cellDecorator=o},{"./../dom.js":27,"./../renderers.js":70}],72:[function(e,t,n){"use strict";function o(e,t,n,o,r,i,s){var a=(p.cloneNode(!0),g.cloneNode(!0));if(c("text")(e,t,n,o,r,i,s),t.appendChild(a),l.addClass(t,"htAutocomplete"),t.firstChild||t.appendChild(document.createTextNode(String.fromCharCode(160))),!e.acArrowListener){var d=u(e);e.acArrowListener=function(r){l.hasClass(r.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new f(n,o),t)},d.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){d.clear()})}}Object.defineProperties(n,{autocompleteRenderer:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../eventManager.js"),i&&i.__esModule&&i||{"default":i}).eventManager,d=(s=e("./../renderers.js"),s&&s.__esModule&&s||{"default":s}),c=d.getRenderer,h=d.registerRenderer,f=(a=e("./../3rdparty/walkontable/src/cell/coords.js"),a&&a.__esModule&&a||{"default":a}).WalkontableCellCoords,p=document.createElement("DIV");p.className="htAutocompleteWrapper";var g=document.createElement("DIV");g.className="htAutocompleteArrow",g.appendChild(document.createTextNode(String.fromCharCode(9660)));h("autocomplete",o)},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../dom.js":27,"./../eventManager.js":41,"./../renderers.js":70}],73:[function(e,t,n){"use strict";function o(e,t,n,o,a,l,u){function d(e){var t=[h.keyCode.SPACE,h.keyCode.ENTER,h.keyCode.DELETE,h.keyCode.BACKSPACE];c.enableImmediatePropagation(e),-1===t.indexOf(e.keyCode)||e.isImmediatePropagationStopped()||v(function(){e.stopImmediatePropagation(),e.preventDefault()}),(e.keyCode==h.keyCode.SPACE||e.keyCode==h.keyCode.ENTER)&&p(),(e.keyCode==h.keyCode.DELETE||e.keyCode==h.keyCode.BACKSPACE)&&p(!1)}function p(){var e=void 0!==arguments[0]?arguments[0]:null;v(function(t){for(var n=0,o=t.length;o>n;n++){if(c.hasClass(t[n],w)&&null===e)return;g(t[n],e)}})}function g(e){var t=void 0!==arguments[1]?arguments[1]:null;null===t?e.checked=!e.checked:e.checked=t,y.fireEvent(e,"change")}function v(t){for(var n=e.getSelectedRange(),o=n.getTopLeftCorner(),r=n.getBottomRightCorner(),i=o.row;i<=r.row;i++)for(var s=o.col;s<=r.col;s++){var a=e.getCell(i,s),l=e.getCellMeta(i,s),u=a.querySelectorAll("input[type=checkbox]");u.length>0&&!l.readOnly&&t(u)}}var y=new f(e),b=r();"undefined"==typeof u.checkedTemplate&&(u.checkedTemplate=!0),"undefined"==typeof u.uncheckedTemplate&&(u.uncheckedTemplate=!1),c.empty(t),l===u.checkedTemplate||h.equalsIgnoreCase(l,u.checkedTemplate)?(b.checked=!0,t.appendChild(b)):l===u.uncheckedTemplate||h.equalsIgnoreCase(l,u.uncheckedTemplate)?t.appendChild(b):null===l?(c.addClass(b,"noValue"),t.appendChild(b)):(b.style.display="none",c.addClass(b,w),t.appendChild(b),t.appendChild(document.createTextNode("#bad-value#"))),u.readOnly?y.addEventListener(b,"click",i):(y.addEventListener(b,"mousedown",s),y.addEventListener(b,"mouseup",s),y.addEventListener(b,"change",function(t){e.setDataAtRowProp(n,a,t.target.checked?u.checkedTemplate:u.uncheckedTemplate)})),m.has(e)||(m.set(e,!0),e.addHook("beforeKeyDown",d))}function r(){var e=document.createElement("INPUT");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.cloneNode(!1)}function i(e){e.preventDefault()}function s(e){h.stopPropagation(e)}Object.defineProperties(n,{checkboxRenderer:{get:function(){return o}},__esModule:{value:!0}});var a,l,u,d,c=(a=e("./../dom.js"),a&&a.__esModule&&a||{"default":a}),h=(l=e("./../helpers.js"),l&&l.__esModule&&l||{"default":l}),f=(u=e("./../eventManager.js"),u&&u.__esModule&&u||{"default":u}).EventManager,p=(d=e("./../renderers.js"),d&&d.__esModule&&d||{"default":d}),g=(p.getRenderer,p.registerRenderer),m=new WeakMap,w="htBadValue";g("checkbox",o)},{"./../dom.js":27,"./../eventManager.js":41,"./../helpers.js":42,"./../renderers.js":70}],74:[function(e,t,n){"use strict";function o(e,t,n,o,r,i,a){l("base").apply(this,arguments),s.fastInnerHTML(t,i)}Object.defineProperties(n,{htmlRenderer:{get:function(){return o}},__esModule:{value:!0}});var r,i,s=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),a=(i=e("./../renderers.js"),i&&i.__esModule&&i||{"default":i}),l=a.getRenderer,u=a.registerRenderer;u("html",o)},{"./../dom.js":27,"./../renderers.js":70}],75:[function(e,t,n){"use strict";function o(e,t,n,o,r,i,s){u.isNumeric(i)&&("undefined"!=typeof s.language&&d.language(s.language),i=d(i).format(s.format||"0"),l.addClass(t,"htNumeric")),h("text")(e,t,n,o,r,i,s)}Object.defineProperties(n,{numericRenderer:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),u=(i=e("./../helpers.js"),i&&i.__esModule&&i||{"default":i}),d=(s=e("numeral"),s&&s.__esModule&&s||{"default":s})["default"],c=(a=e("./../renderers.js"),a&&a.__esModule&&a||{"default":a}),h=c.getRenderer,f=c.registerRenderer;f("numeric",o)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70,numeral:"numeral"}],76:[function(e,t,n){"use strict";function o(e,t,n,o,r,i,a){l("text").apply(this,arguments),i=t.innerHTML;var u,d=a.hashLength||i.length,c=a.hashSymbol||"*";for(u="";u.split(c).length-1<d;u+=c);s.fastInnerHTML(t,u)}Object.defineProperties(n,{passwordRenderer:{get:function(){return o}},__esModule:{value:!0}});var r,i,s=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),a=(i=e("./../renderers.js"),i&&i.__esModule&&i||{"default":i}),l=a.getRenderer,u=a.registerRenderer;u("password",o)},{"./../dom.js":27,"./../renderers.js":70}],77:[function(e,t,n){"use strict";function o(e,t,n,o,r,i,s){d("base").apply(this,arguments),!i&&s.placeholder&&(i=s.placeholder);var u=l.stringify(i);if(e.getSettings().trimWhitespace||(u=u.replace(/ /g,String.fromCharCode(160))),s.rendererTemplate){a.empty(t);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=e.getSourceDataAtRow(n),t.appendChild(c)}else a.fastInnerText(t,u)}Object.defineProperties(n,{textRenderer:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a=(r=e("./../dom.js"),r&&r.__esModule&&r||{"default":r}),l=(i=e("./../helpers.js"),i&&i.__esModule&&i||{"default":i}),u=(s=e("./../renderers.js"),s&&s.__esModule&&s||{"default":s}),d=u.getRenderer,c=u.registerRenderer;c("text",o)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70}],78:[function(e,t,n){"use strict";Array.prototype.filter||(Array.prototype.filter=function(e,t){function n(e){return/NodeList/i.test(e.item)}function o(e){for(var t=[],n=0,o=e.length;o>n;n++)t[n]=e[n];return t}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;t=t||this,n(t)&&(t=o(t));var r,i,s=t.length,a=[];for(r=0;s>r;r+=1)t.hasOwnProperty(r)&&(i=t[r],e.call(t,i,r,t)&&a.push(i));return a})},{}],79:[function(e,t,n){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1})},{}],80:[function(e,t,n){"use strict";Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)})},{}],81:[function(e,t,n){"use strict";!function(e){function t(e){return{configurable:!0,enumerable:!1,value:e,writable:!0}}function n(){return"__$"+Math.floor(1e9*Math.random())+"$"+ ++G+"$__"}function o(e){return K[e]}function r(){var e=n();return K[e]=!0,e}function i(e){return"object"==typeof e&&e instanceof l}function s(e){return i(e)?"symbol":typeof e}function a(e){var t=new l(e);if(!(this instanceof a))return t;throw new TypeError("Symbol cannot be new'ed")}function l(e){var t=n();j(this,$,{value:this}),j(this,z,{value:t}),j(this,U,{value:e}),d(this),X[t]=this}function u(e){var t=e[q];return t&&t.self===e?t:F(e)?(J.hash.value=Q++,J.self.value=e,Z.value=x(null,J),j(e,q,Z),Z.value):void 0}function d(e){return u(e),P.apply(this,arguments)}function c(e){return u(e),B.apply(this,arguments)}function h(e){return u(e),V.apply(this,arguments)}function f(e){return X[e]||K[e]}function p(e){return i(e)?e[z]:e}function g(e){for(var t=[],n=0;n<e.length;n++)f(e[n])||t.push(e[n]);return t}function m(e){return g(L(e))}function w(e){return g(W(e))}function v(e){for(var t=[],n=L(e),o=0;o<n.length;o++){var r=X[n[o]];r&&t.push(r)}return t}function y(e,t){return N(e,p(t))}function b(e){return I.call(this,p(e))}function C(t){return e.traceur&&e.traceur.options[t]}function R(e,t,n){return i(t)&&(t=t[z]),j(e,t,n),e}function S(e){j(e,"defineProperty",{value:R}),j(e,"getOwnPropertyNames",{value:m}),j(e,"getOwnPropertyDescriptor",{value:y}),j(e.prototype,"hasOwnProperty",{value:b}),j(e,"freeze",{value:d}),j(e,"preventExtensions",{value:c}),j(e,"seal",{value:h}),j(e,"keys",{value:w})}function E(e){for(var t=1;t<arguments.length;t++)for(var n=L(arguments[t]),o=0;o<n.length;o++){var r=n[o];f(r)||!function(t,n){j(e,n,{get:function(){return t[n]},enumerable:!0})}(arguments[t],n[o])}return e}function T(e){return null!=e&&("object"==typeof e||"function"==typeof e)}function _(e){if(null==e)throw D();return O(e)}function k(e){if(null==e)throw new TypeError("Value cannot be converted to an Object");return e}function H(e,t){e.Symbol||(e.Symbol=t,Object.getOwnPropertySymbols=v),e.Symbol.iterator||(e.Symbol.iterator=t("Symbol.iterator"))}function M(e){H(e,a),e.Reflect=e.Reflect||{},e.Reflect.global=e.Reflect.global||e,S(e.Object)}if(!e.$traceurRuntime){var O=Object,D=TypeError,x=O.create,A=O.defineProperties,j=O.defineProperty,P=O.freeze,N=O.getOwnPropertyDescriptor,L=O.getOwnPropertyNames,W=O.keys,I=O.prototype.hasOwnProperty,B=(O.prototype.toString,Object.preventExtensions),V=Object.seal,F=Object.isExtensible,Y=t,G=0,z=n(),U=n(),$=n(),X=x(null),K=x(null);j(a.prototype,"constructor",t(a)),j(a.prototype,"toString",Y(function(){var e=this[$];if(!C("symbols"))return e[z];if(!e)throw TypeError("Conversion from symbol to string");var t=e[U];return void 0===t&&(t=""),"Symbol("+t+")"})),j(a.prototype,"valueOf",Y(function(){var e=this[$];if(!e)throw TypeError("Conversion from symbol to string");return C("symbols")?e:e[z]})),j(l.prototype,"constructor",t(a)),j(l.prototype,"toString",{value:a.prototype.toString,enumerable:!1}),j(l.prototype,"valueOf",{value:a.prototype.valueOf,enumerable:!1});var q=r(),Z={value:void 0},J={hash:{value:void 0},self:{value:void 0}},Q=0;d(l.prototype),M(e),e.$traceurRuntime={checkObjectCoercible:k,createPrivateName:r,defineProperties:A,defineProperty:j,exportStar:E,getOwnHashObject:u,getOwnPropertyDescriptor:N,getOwnPropertyNames:L,isObject:T,isPrivateName:o,isSymbolString:f,keys:W,setupGlobals:M,toObject:_,toProperty:p,"typeof":s}}}(window),function(){function t(t,o){function r(e){return"/"===e.slice(-1)}function i(e){return"/"===e[0]}function s(e){return"."===e[0]}return n=n||"undefined"!=typeof e&&e("path"),r(o)||i(o)?void 0:e(s(o)?n.resolve(n.dirname(t),o):o)}var n;$traceurRuntime.require=t}(),function(){function e(){for(var e,t=[],n=0,o=0;o<arguments.length;o++){var r=$traceurRuntime.checkObjectCoercible(arguments[o]);if("function"!=typeof r[$traceurRuntime.toProperty(Symbol.iterator)])throw new TypeError("Cannot spread non-iterable object.");for(var i=r[$traceurRuntime.toProperty(Symbol.iterator)]();!(e=i.next()).done;)t[n++]=e.value}return t}$traceurRuntime.spread=e}(),function(){function e(e,t){var n=g(e);do{var o=p(n,t);if(o)return o;n=g(n)}while(n);return void 0}function t(e){return e.__proto__}function n(e,t,n,r){return o(e,t,n).apply(e,r)}function o(t,n,o){var r=e(n,o);return r?r.get?r.get.call(t):r.value:void 0}function r(t,n,o,r){var i=e(n,o);if(i&&i.set)return i.set.call(t,r),r;throw d("super has no setter '"+o+"'.")}function i(e){for(var t={},n=w(e),o=0;o<n.length;o++){var r=n[o];t[r]=p(e,r)}for(var i=v(e),o=0;o<i.length;o++){var s=i[o];t[$traceurRuntime.toProperty(s)]=p(e,$traceurRuntime.toProperty(s))}return t}function s(e,t,n,o){return f(t,"constructor",{value:e,configurable:!0,enumerable:!1,writable:!0}),arguments.length>3?("function"==typeof o&&(e.__proto__=o),
e.prototype=c(a(o),i(t))):e.prototype=t,f(e,"prototype",{configurable:!1,writable:!1}),h(e,i(n))}function a(e){if("function"==typeof e){var t=e.prototype;if(u(t)===t||null===t)return e.prototype;throw new d("super prototype must be an Object or null")}if(null===e)return null;throw new d("Super expression must either be null or a function, not "+typeof e+".")}function l(e,t,o){null!==g(t)&&n(e,t,"constructor",o)}var u=Object,d=TypeError,c=u.create,h=$traceurRuntime.defineProperties,f=$traceurRuntime.defineProperty,p=$traceurRuntime.getOwnPropertyDescriptor,g=($traceurRuntime.getOwnPropertyNames,Object.getPrototypeOf),m=Object,w=m.getOwnPropertyNames,v=m.getOwnPropertySymbols;$traceurRuntime.createClass=s,$traceurRuntime.defaultSuperCall=l,$traceurRuntime.superCall=n,$traceurRuntime.superConstructor=t,$traceurRuntime.superGet=o,$traceurRuntime.superSet=r}()},{path:void 0}],82:[function(e,t,n){"use strict";Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=n.length;return function(r){if("object"!=typeof r&&("function"!=typeof r||null===r))throw new TypeError("Object.keys called on non-object");var i,s,a=[];for(i in r)e.call(r,i)&&a.push(i);if(t)for(s=0;o>s;s++)e.call(r,n[s])&&a.push(n[s]);return a}}())},{}],83:[function(e,t,n){"use strict";if(!String.prototype.trim){var o=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(o,"")}}},{}],84:[function(e,t,n){"use strict";"undefined"==typeof WeakMap&&!function(){var e=Object.defineProperty;try{var t=!0;e(function(){},"foo",{})}catch(n){t=!1}var o=+new Date%1e9,r=function(){this.name="__st"+(1e9*Math.random()>>>0)+(o++ +"__"),t||(this._wmCache=[])};t?r.prototype={set:function(t,n){var o=t[this.name];o&&o[0]===t?o[1]=n:e(t,this.name,{value:[t,n],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},has:function(e){return this.get(e)?!0:!1},"delete":function(e){this.set(e,void 0)}}:r.prototype={set:function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof t){for(var n=0,o=this._wmCache.length;o>n;n++)if(this._wmCache[n].key==e)return void(this._wmCache[n].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if("undefined"!=typeof e){for(var t=0,n=this._wmCache.length;n>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value;return void 0}},has:function(e){return this.get(e)?!0:!1},"delete":function(e){if("undefined"!=typeof e)for(var t=0,n=this._wmCache.length;n>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},window.WeakMap=r}()},{}],85:[function(e,t,n){"use strict";function o(e){var t=this;this.eventManager=h(e),this.instance=e,this.settings=e.getSettings();var n=e.rootElement.getAttribute("style");n&&e.rootElement.setAttribute("data-originalstyle",n),d.addClass(e.rootElement,"handsontable");var o=document.createElement("TABLE");o.className="htCore",this.THEAD=document.createElement("THEAD"),o.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),o.appendChild(this.TBODY),e.table=o,e.container.insertBefore(o,e.container.firstChild),this.eventManager.addEventListener(e.rootElement,"mousedown",function(e){t.isTextSelectionAllowed(e.target)||(i(),e.preventDefault(),window.focus())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(t){e.selection.isInProgress()&&!t.shiftKey&&e.selection.finish()});var r;this.isMouseDown=function(){return r},this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){e.selection.isInProgress()&&1===t.which&&e.selection.finish(),r=!1,c.isOutsideInput(document.activeElement)&&e.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(n){var o=n.target,i=n.x||n.clientX,s=n.y||n.clientY;if(!r){if(o!==e.view.wt.wtTable.holder)for(;o!==document.documentElement;){if(null===o){if(n.isTargetWebComponent)break;return}if(o===e.rootElement)return;o=o.parentNode}else{var a=Handsontable.Dom.getScrollbarWidth();if(document.elementFromPoint(i+a,s)!==e.view.wt.wtTable.holder||document.elementFromPoint(i,s+a)!==e.view.wt.wtTable.holder)return}t.settings.outsideClickDeselects?e.deselectCell():e.destroyEditor()}}),this.eventManager.addEventListener(o,"selectstart",function(e){t.settings.fragmentSelection||e.preventDefault()});var i=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},s=[new p({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&!e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!t.isCellEdited()&&!e.selection.isMultiple()}}}),new p({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!t.isCellEdited()&&e.selection.isMultiple()}}}),new p({className:"highlight",highlightRowClassName:t.settings.currentRowClassName,highlightColumnClassName:t.settings.currentColClassName}),new p({className:"fill",border:{width:1,color:"red"}})];s.current=s[0],s.area=s[1],s.highlight=s[2],s.fill=s[3];var a={debug:function(){return t.settings.debug},table:o,stretchH:this.settings.stretchH,data:e.getDataAtCell,totalRows:e.countRows,totalColumns:e.countCols,fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},renderAllRows:t.settings.renderAllRows,rowHeaders:function(){var n=[];return e.hasRowHeaders()&&n.push(function(e,n){t.appendRowHeader(e,n)}),Handsontable.hooks.run(e,"afterGetRowHeaderRenderers",n),n},columnHeaders:function(){var n=[];return e.hasColHeaders()&&n.push(function(e,n){t.appendColHeader(e,n)}),Handsontable.hooks.run(e,"afterGetColumnHeaderRenderers",n),n},columnWidth:e.getColWidth,rowHeight:e.getRowHeight,cellRenderer:function(e,n,o){var r=t.instance.colToProp(n),i=t.instance.getCellMeta(e,n),s=t.instance.getCellRenderer(i),a=t.instance.getDataAtRowProp(e,r);s(t.instance,o,e,n,r,a,i),Handsontable.hooks.run(t.instance,"afterRenderer",o,e,n,r,a,i)},selections:s,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(n,o,i,s){e.listen(),t.activeWt=s,r=!0,d.enableImmediatePropagation(n),Handsontable.hooks.run(e,"beforeOnCellMouseDown",n,o,i),n.isImmediatePropagationStopped()||(2===n.button&&e.selection.inInSelection(o)||(n.shiftKey?o.row>=0&&o.col>=0&&e.selection.setRangeEnd(o):(o.row<0||o.col<0)&&(o.row>=0||o.col>=0)?(o.row<0&&(e.selectCell(0,o.col,e.countRows()-1,o.col),e.selection.setSelectedHeaders(!1,!0)),o.col<0&&(e.selectCell(o.row,0,o.row,e.countCols()-1),e.selection.setSelectedHeaders(!0,!1))):(o.row=o.row<0?0:o.row,o.col=o.col<0?0:o.col,e.selection.setRangeStart(o))),Handsontable.hooks.run(e,"afterOnCellMouseDown",n,o,i),t.activeWt=t.wt)},onCellMouseOver:function(n,o,i,s){t.activeWt=s,o.row>=0&&o.col>=0?r&&e.selection.setRangeEnd(o):r&&(o.row<0&&(e.selection.setRangeEnd(new f(e.countRows()-1,o.col)),e.selection.setSelectedHeaders(!1,!0)),o.col<0&&(e.selection.setRangeEnd(new f(o.row,e.countCols()-1)),e.selection.setSelectedHeaders(!0,!1))),Handsontable.hooks.run(e,"afterOnCellMouseOver",n,o,i),t.activeWt=t.wt},onCellCornerMouseDown:function(t){t.preventDefault(),Handsontable.hooks.run(e,"afterOnCellCornerMouseDown",t)},beforeDraw:function(e){t.beforeRender(e)},onDraw:function(e){t.onDraw(e)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,n){e.runHooks("beforeDrawBorders",t,n)},onBeforeTouchScroll:function(){e.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){e.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(n){t.settings.viewportRowRenderingOffset&&(n.startRow=Math.max(n.startRow-t.settings.viewportRowRenderingOffset,0),n.endRow=Math.min(n.endRow+t.settings.viewportRowRenderingOffset,e.countRows()-1)),e.runHooks("afterViewportRowCalculatorOverride",n)},viewportColumnCalculatorOverride:function(n){t.settings.viewportColumnRenderingOffset&&(n.startColumn=Math.max(n.startColumn-t.settings.viewportColumnRenderingOffset,0),n.endColumn=Math.min(n.endColumn+t.settings.viewportColumnRenderingOffset,e.countCols()-1)),e.runHooks("afterViewportColumnCalculatorOverride",n)}};Handsontable.hooks.run(e,"beforeInitWalkontable",a),this.wt=new g(a),this.activeWt=this.wt,this.eventManager.addEventListener(t.wt.wtTable.spreader,"mousedown",function(e){e.target===t.wt.wtTable.spreader&&3===e.which&&c.stopPropagation(e)}),this.eventManager.addEventListener(t.wt.wtTable.spreader,"contextmenu",function(e){e.target===t.wt.wtTable.spreader&&3===e.which&&c.stopPropagation(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}Object.defineProperties(n,{TableView:{get:function(){return o}},__esModule:{value:!0}});var r,i,s,a,l,u,d=(r=e("./dom.js"),r&&r.__esModule&&r||{"default":r}),c=(i=e("./helpers.js"),i&&i.__esModule&&i||{"default":i}),h=(s=e("./eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager,f=(a=e("./3rdparty/walkontable/src/cell/coords.js"),a&&a.__esModule&&a||{"default":a}).WalkontableCellCoords,p=(l=e("./3rdparty/walkontable/src/selection.js"),l&&l.__esModule&&l||{"default":l}).WalkontableSelection,g=(u=e("./3rdparty/walkontable/src/core.js"),u&&u.__esModule&&u||{"default":u}).Walkontable;Handsontable.TableView=o,o.prototype.isTextSelectionAllowed=function(e){return c.isInput(e)?!0:this.settings.fragmentSelection&&d.isChildOf(e,this.TBODY)?!0:!1},o.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},o.prototype.beforeRender=function(e){e&&Handsontable.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},o.prototype.onDraw=function(e){e&&Handsontable.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},o.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1},o.prototype.getCellAtCoords=function(e,t){var n=this.wt.getCell(e,t);return 0>n?null:n},o.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},o.prototype.appendRowHeader=function(e,t){if(t.firstChild){var n=t.firstChild;if(!d.hasClass(n,"relative"))return d.empty(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.firstChild,e,this.instance.getRowHeader)}else{var o=document.createElement("div"),r=document.createElement("span");o.className="relative",r.className="colHeader",this.updateCellHeader(r,e,this.instance.getRowHeader),o.appendChild(r),t.appendChild(o)}Handsontable.hooks.run(this.instance,"afterGetRowHeader",e,t)},o.prototype.appendColHeader=function(e,t){if(t.firstChild){var n=t.firstChild;if(!d.hasClass(n,"relative"))return d.empty(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.firstChild,e,this.instance.getColHeader)}else{var o=document.createElement("div"),r=document.createElement("span");o.className="relative",r.className="colHeader",this.updateCellHeader(r,e,this.instance.getColHeader),o.appendChild(r),t.appendChild(o)}Handsontable.hooks.run(this.instance,"afterGetColHeader",e,t)},o.prototype.updateCellHeader=function(e,t,n){t>-1?d.fastInnerHTML(e,n(t)):(d.fastInnerText(e,String.fromCharCode(160)),d.addClass(e,"cornerHeader"))},o.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),n=t-e;return n>0?n:0},o.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),n=t-e;return n>0?n:0},o.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},o.prototype.destroy=function(){this.wt.destroy(),this.eventManager.clear()}},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/core.js":7,"./3rdparty/walkontable/src/selection.js":18,"./dom.js":27,"./eventManager.js":41,"./helpers.js":42}],86:[function(e,t,n){"use strict";var o=function(e,t){var n=e,o="string"==typeof n?n.toLowerCase():null;return function(e){for(var r=!1,i=0,s=e.length;s>i;i++){if(n===e[i]){r=!0;break}if(o===Handsontable.helper.stringify(e[i]).toLowerCase()){r=!0;break}}t(r)}};Handsontable.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,o(e,t)):o(e,t)(this.source):t(!0)}},{}],87:[function(e,t,n){"use strict";var o,r,i=(o=e("moment"),o&&o.__esModule&&o||{"default":o})["default"],s=(r=e("./../editors.js"),r&&r.__esModule&&r||{"default":r}).getEditor;Handsontable.DateValidator=function(e,t){var n=!0,o=s("date",this.instance);null===e&&(e="");var r=i(new Date(e)).isValid(),l=i(e,this.dateFormat||o.defaultDateFormat,!0).isValid();if(r||(n=!1),!r&&l&&(n=!0),r&&!l)if(this.correctFormat===!0){var u=a(e,this.dateFormat);this.instance.setDataAtCell(this.row,this.col,u,"dateValidator"),n=!0}else n=!1;t(n)};var a=function(e,t){var n=i(new Date(e));return n.format("YYYY").length>4&&n.year((n.year()+"").substr(0,4)),n.format(t)}},{"./../editors.js":29,moment:"moment"}],88:[function(e,t,n){"use strict";Handsontable.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))}},{}],SheetClip:[function(e,t,n){"use strict";!function(e){function t(e){return e.split('"').length-1}var o={parse:function(e){var n,o,r,i,s,a,l,u=[],d=0;for(r=e.split("\n"),r.length>1&&""===r[r.length-1]&&r.pop(),n=0,o=r.length;o>n;n+=1){for(r[n]=r[n].split("	"),i=0,s=r[n].length;s>i;i+=1)u[d]||(u[d]=[]),a&&0===i?(l=u[d].length-1,u[d][l]=u[d][l]+"\n"+r[n][0],a&&1&t(r[n][0])&&(a=!1,u[d][l]=u[d][l].substring(0,u[d][l].length-1).replace(/""/g,'"'))):i===s-1&&0===r[n][i].indexOf('"')&&1&t(r[n][i])?(u[d].push(r[n][i].substring(1).replace(/""/g,'"')),a=!0):(u[d].push(r[n][i].replace(/""/g,'"')),a=!1);a||(d+=1)}return u},stringify:function(e){var t,n,o,r,i,s="";for(t=0,n=e.length;n>t;t+=1){for(r=e[t].length,o=0;r>o;o+=1)o>0&&(s+="	"),i=e[t][o],s+="string"==typeof i?i.indexOf("\n")>-1?'"'+i.replace(/"/g,'""')+'"':i:null===i||void 0===i?"":i;s+="\n"}return s}};"undefined"!=typeof n?(n.parse=o.parse,n.stringify=o.stringify):e.SheetClip=o}(window)},{}],autoResize:[function(e,t,n){"use strict";function o(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,o=document.createTextNode(""),r=document.createElement("SPAN"),i=function(e,t,n){window.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},s=function(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},a=function(i){var s,a;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==o.textContent?o.textContent=e.value+i:o.data=e.value+i,r.style.fontSize=Handsontable.Dom.getComputedStyle(e).fontSize,r.style.fontFamily=Handsontable.Dom.getComputedStyle(e).fontFamily,r.style.whiteSpace="pre",n.appendChild(r),s=r.clientWidth+2,n.removeChild(r),e.style.height=t.minHeight+"px",t.minWidth>s?e.style.width=t.minWidth+"px":s>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=s+"px",a=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>a?e.style.height=t.minHeight+"px":t.maxHeight<a?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=a+"px"},l=function(){window.setTimeout(a,0)},u=function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(t.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var s=parseInt(n.maxHeight);isNaN(s)||(t.maxHeight=s)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var a=parseInt(n.minWidth);isNaN(a)||(t.minWidth=a)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var l=parseInt(n.maxWidth);isNaN(l)||(t.maxWidth=l)}r.firstChild||(r.className="autoResize",r.style.display="inline-block",r.appendChild(o))},d=function(n,o,r){e=n,u(o),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),r&&(i(e,"change",a),i(e,"cut",l),i(e,"paste",l),i(e,"drop",l),i(e,"keydown",l)),a()};return{init:function(e,t,n){d(e,t,n)},unObserve:function(){s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l)},resize:a}}"undefined"!=typeof n&&(t.exports=o)},{}],copyPaste:[function(e,t,n){"use strict";function o(){return i?i.hasBeenDestroyed()&&i.init():i=new r,i.refCounter++,i}function r(){this.refCounter=0,this.init()}var i;"undefined"!=typeof n&&(t.exports=o),r.prototype.init=function(){var e,t;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],t=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){var t,n;return"WebkitAppearance"in document.documentElement.style?(t=e.clipboardData.getData("Text"),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(n=t.split("\n"),n.pop(),t=n.join("\n")),this.value=t,!1):void 0},e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.onKeyDownRef=this.onKeyDown.bind(this),document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)},r.prototype.onKeyDown=function(e){function t(){var e=document.activeElement;return e.shadowRoot&&e.shadowRoot.activeElement&&(e=e.shadowRoot.activeElement),["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable}var n=this,o=!1;if(e.metaKey?o=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(o=!0),o){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||t()))return;this.selectNodeText(this.elTextarea),setTimeout(function(){document.activeElement!==n.elTextarea&&n.selectNodeText(n.elTextarea)},0)}!o||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){n.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){n.triggerPaste(e)},0))},r.prototype.selectNodeText=function(e){e&&e.select()},r.prototype.getSelectionText=function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e},r.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e,this.selectNodeText(this.elTextarea)},r.prototype.onCut=function(e){this.cutCallbacks.push(e)},r.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},r.prototype.removeCallback=function(e){var t,n;for(t=0,n=this.copyCallbacks.length;n>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,n=this.cutCallbacks.length;n>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,n=this.pasteCallbacks.length;n>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},r.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var n=0,o=t.cutCallbacks.length;o>n;n++)t.cutCallbacks[n](e)},50)},r.prototype.triggerPaste=function(e,t){var n=this;n.pasteCallbacks&&setTimeout(function(){for(var o=t||n.elTextarea.value,r=0,i=n.pasteCallbacks.length;i>r;r++)n.pasteCallbacks[r](o,e)},50)},r.prototype.destroy=function(){this.hasBeenDestroyed()||0!==--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef))},r.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],jsonpatch:[function(e,t,n){"use strict";var o;!function(e){function t(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function n(e,o){var r;for(var i in e)if(e.hasOwnProperty(i)){if(e[i]===o)return t(i)+"/";if("object"==typeof e[i]&&(r=n(e[i],o),""!=r))return t(i)+"/"+r}return""}function o(e,t){if(e===t)return"/";var o=n(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}function r(e){for(var t=0,n=w.length;n>t;t++)if(w[t].obj===e)return w[t]}function i(e,t){for(var n=0,o=e.observers.length;o>n;n++)if(e.observers[n].callback===t)return e.observers[n].observer}function s(e,t){for(var n=0,o=e.observers.length;o>n;n++)if(e.observers[n].observer===t)return void e.observers.splice(n,1)}function a(e,t){c(t),Object.observe?d(t,e):clearTimeout(t.next);var n=r(e);s(n,t)}function l(e,t){var n,s=[],a=e,l=r(e);if(l?n=i(l,t):(l=new v(e),w.push(l)),n)return n;if(Object.observe)n=function(r){d(n,e),u(n,e);for(var i=0,l=r.length;l>i;){if(("length"!==r[i].name||!C(r[i].object))&&"__Jasmine_been_here_before__"!==r[i].name){var c=r[i].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}m[c].call(r[i],s,o(a,r[i].object))}i++}s&&t&&t(s),n.patches=s,s=[]};else if(n={},l.value=JSON.parse(JSON.stringify(e)),t){n.callback=t,n.next=null;var h=this.intervals||[100,1e3,1e4,6e4],f=0,p=function(){c(n)},g=function(){clearTimeout(n.next),n.next=setTimeout(function(){p(),f=0,n.next=setTimeout(b,h[f++])},0)},b=function(){p(),f==h.length&&(f=h.length-1),n.next=setTimeout(b,h[f++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",g),window.addEventListener("mouseup",g),window.addEventListener("keydown",g)):(window.attachEvent("onmousedown",g),window.attachEvent("onmouseup",g),window.attachEvent("onkeydown",g))),n.next=setTimeout(b,h[f++])}return n.patches=s,n.object=e,l.observers.push(new y(t,n)),u(n,e)}function u(e,t){if(Object.observe){Object.observe(t,e);for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];o&&"object"==typeof o&&u(e,o)}}return e}function d(e,t){if(Object.observe){Object.unobserve(t,e);for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];o&&"object"==typeof o&&d(e,o)}}return e}function c(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,n=0,o=w.length;o>n;n++)if(w[n].obj===e.object){t=w[n];break}h(t.value,e.object,e.patches,"")}var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function h(e,n,o,r){for(var i=b(n),s=b(e),a=!1,l=!1,u=s.length-1;u>=0;u--){var d=s[u],c=e[d];if(n.hasOwnProperty(d)){var f=n[d];c instanceof Object?h(c,f,o,r+"/"+t(d)):c!=f&&(a=!0,o.push({op:"replace",path:r+"/"+t(d),value:f}),e[d]=f)}else o.push({op:"remove",path:r+"/"+t(d)}),delete e[d],l=!0}if(l||i.length!=s.length)for(var u=0;u<i.length;u++){var d=i[u];e.hasOwnProperty(d)||(o.push({op:"add",path:r+"/"+t(d),value:n[d]}),e[d]=JSON.parse(JSON.stringify(n[d])))}}function f(e,t){for(var n,o=!1,r=0,i=t.length;i>r;){n=t[r];for(var s=n.path.split("/"),a=e,l=1,u=s.length;;)if(C(a)){var d=parseInt(s[l],10);if(l++,l>=u){o=g[n.op].call(n,a,d,e);break}a=a[d]}else{var c=s[l];if(-1!=c.indexOf("~")&&(c=c.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=u){o=p[n.op].call(n,a,c,e);break}a=a[c]}r++}return o}var p={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,n){var o={op:"_get",path:this.from};return f(n,[o]),f(n,[{op:"remove",path:this.from}]),f(n,[{op:"add",path:this.path,value:o.value}]),!0},copy:function(e,t,n){var o={op:"_get",path:this.from};return f(n,[o]),f(n,[{op:"add",path:this.path,value:o.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},g={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:p.move,copy:p.copy,test:p.test,_get:p._get},m={add:function(e,n){var o={op:"add",path:n+t(this.name),value:this.object[this.name]};e.push(o)},"delete":function(e,n){var o={op:"remove",path:n+t(this.name)};e.push(o)},update:function(e,n){var o={op:"replace",path:n+t(this.name),value:this.object[this.name]};e.push(o)}},w=[];e.intervals;var v=function(){function e(e){this.observers=[],this.obj=e}return e}(),y=function(){function e(e,t){this.callback=e,this.observer=t}return e}();e.unobserve=a,e.observe=l,e.generate=c;var b;b=Object.keys?Object.keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};var C;C=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=f}(o||(o={})),"undefined"!=typeof n&&(n.apply=o.apply,n.observe=o.observe,n.unobserve=o.unobserve,n.generate=o.generate)},{}],moment:[function(t,n,o){
>>>>>>> upstream/master
//! moment.js
//! version : 2.10.3
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
<<<<<<< HEAD
(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.moment=factory()})(this,function(){"use strict";var hookCallback;function utils_hooks__hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function create_utc__createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}function valid__isValid(m){if(m._isValid==null){var flags=getParsingFlags(m);m._isValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated;if(m._strict){m._isValid=m._isValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}}return m._isValid}function valid__createInvalid(flags){var m=create_utc__createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=utils_hooks__hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(typeof from._isAMomentObject!=="undefined"){to._isAMomentObject=from._isAMomentObject}if(typeof from._i!=="undefined"){to._i=from._i}if(typeof from._f!=="undefined"){to._f=from._f}if(typeof from._l!=="undefined"){to._l=from._l}if(typeof from._strict!=="undefined"){to._strict=from._strict}if(typeof from._tzm!=="undefined"){to._tzm=from._tzm}if(typeof from._isUTC!=="undefined"){to._isUTC=from._isUTC}if(typeof from._offset!=="undefined"){to._offset=from._offset}if(typeof from._pf!=="undefined"){to._pf=getParsingFlags(from)}if(typeof from._locale!=="undefined"){to._locale=from._locale}if(momentProperties.length>0){for(i in momentProperties){prop=momentProperties[i];val=from[prop];if(typeof val!=="undefined"){to[prop]=val}}}return to}var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(+config._d);if(updateInProgress===false){updateInProgress=true;utils_hooks__hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){if(coercedNumber>=0){value=Math.floor(coercedNumber)}else{value=Math.ceil(coercedNumber)}}return value}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function Locale(){}var locales={};var globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&typeof module!=="undefined"&&module&&module.exports){try{oldLocale=globalLocale._abbr;require("./locale/"+name);locale_locales__getSetGlobalLocale(oldLocale)}catch(e){}}return locales[name]}function locale_locales__getSetGlobalLocale(key,values){var data;if(key){if(typeof values==="undefined"){data=locale_locales__getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}}return globalLocale._abbr}function defineLocale(name,values){if(values!==null){values.abbr=name;if(!locales[name]){locales[name]=new Locale}locales[name].set(values);locale_locales__getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function locale_locales__getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}function makeGetSet(unit,keepTime){return function(value){if(value!=null){get_set__set(this,unit,value);utils_hooks__hooks.updateOffset(this,keepTime);return this}else{return get_set__get(this,unit)}}}function get_set__get(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function get_set__set(mom,unit,value){return mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function getSet(units,value){var unit;if(typeof units==="object"){for(unit in units){this.set(unit,units[unit])}}else{units=normalizeUnits(units);if(typeof this[units]==="function"){return this[units](value)}}return this}function zeroFill(number,targetLength,forceSign){var output=""+Math.abs(number),sign=number>=0;while(output.length<targetLength){output="0"+output}return(sign?forceSign?"+":"":"-")+output}var formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var formatFunctions={};var formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i]instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var match1=/\d/;var match2=/\d\d/;var match3=/\d{3}/;var match4=/\d{4}/;var match6=/[+-]?\d{6}/;var match1to2=/\d\d?/;var match1to3=/\d{1,3}/;var match1to4=/\d{1,4}/;var match1to6=/[+-]?\d{1,6}/;var matchUnsigned=/\d+/;var matchSigned=/[+-]?\d+/;var matchOffset=/Z|[+-]\d\d:?\d\d/gi;var matchTimestamp=/[+-]?\d+(\.\d{1,3})?/;var matchWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;var regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=typeof regex==="function"?regex:function(isStrict){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==="string"){token=[token]}if(typeof callback==="number"){func=function(input,array){array[callback]=toInt(input)}}for(i=0;i<token.length;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0;var MONTH=1;var DATE=2;var HOUR=3;var MINUTE=4;var SECOND=5;var MILLISECOND=6;function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)});addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)});addUnitAlias("month","M");addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",matchWord);addRegexToken("MMMM",matchWord);addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1});addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function localeMonths(m){return this._months[m.month()]}var defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function localeMonthsShort(m){return this._monthsShort[m.month()]}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=create_utc__createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(typeof value==="string"){value=mom.localeData().monthsParse(value);if(typeof value!=="number"){return mom}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);utils_hooks__hooks.updateOffset(this,true);return this}else{return get_set__get(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}getParsingFlags(m).overflow=overflow}return m}function warn(msg){if(utils_hooks__hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true,msgWithStack=msg+"\n"+(new Error).stack;return extend(function(){if(firstTime){warn(msgWithStack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={};function deprecateSimple(name,msg){if(!deprecations[name]){warn(msg);deprecations[name]=true}}utils_hooks__hooks.suppressDeprecationWarnings=false;var from_string__isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]];var isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]];var aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=from_string__isoRegex.exec(string);if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}}for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}}if(string.match(matchOffset)){config._f+="Z"}configFromStringAndFormat(config)}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid;utils_hooks__hooks.createFromInputFallback(config)}}utils_hooks__hooks.createFromInputFallback=deprecate("moment construction falls back to js Date. This is "+"discouraged and will be removed in upcoming major "+"release. Please refer to "+"https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y)}return date}function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y)}return date}addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,true],0,"year");addUnitAlias("year","y");addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYY","YYYYY","YYYYYY"],YEAR);addParseToken("YY",function(input,array){array[YEAR]=utils_hooks__hooks.parseTwoDigitYear(input)});function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}utils_hooks__hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",false);function getIsLeapYear(){return isLeapYear(this.year())}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=local__createLocal(mom).add(daysToDayOfWeek,"d");return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)});function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=createUTCDate(year,0,1).getUTCDay();var daysToAdd;var dayOfYear;d=d===0?7:d;weekday=weekday!=null?weekday:firstDayOfWeek;daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0);dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}function defaults(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var now=new Date;if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]}return[now.getFullYear(),now.getMonth(),now.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(local__createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1)}else{dow=config._locale._week.dow;doy=config._locale._week.doy;weekYear=defaults(w.gg,config._a[YEAR],weekOfYear(local__createLocal(),dow,doy).year);week=defaults(w.w,1);if(w.d!=null){weekday=w.d;if(weekday<dow){++week}}else if(w.e!=null){weekday=w.e+dow}else{weekday=dow}}temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}utils_hooks__hooks.ISO_8601=function(){};function configFromStringAndFormat(config){if(config._f===utils_hooks__hooks.ISO_8601){configFromISO(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(getParsingFlags(config).bigHour===true&&config._a[HOUR]<=12&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!valid__isValid(tempConfig)){continue}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i);config._a=[i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond];configFromArray(config)}function createFromConfig(config){var input=config._i,format=config._f,res;config._locale=config._locale||locale_locales__getLocale(config._l);if(input===null||format===undefined&&input===""){return valid__createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isArray(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else if(isDate(input)){config._d=input}else{configFromInput(config)}res=new Moment(checkOverflow(config));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function configFromInput(config){var input=config._i;if(input===undefined){config._d=new Date}else if(isDate(input)){config._d=new Date(+input)}else if(typeof input==="string"){configFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(typeof input==="object"){configFromObject(config)}else if(typeof input==="number"){config._d=new Date(input)}else{utils_hooks__hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(typeof locale==="boolean"){strict=locale;locale=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function local__createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}var prototypeMin=deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return other<this?this:other});var prototypeMax=deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var other=local__createLocal.apply(null,arguments);return other>this?this:other});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return local__createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(moments[i][fn](res)){res=moments[i]}}return res}function min(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*36e5;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=locale_locales__getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":");offset("ZZ","");addRegexToken("Z",matchOffset);addRegexToken("ZZ",matchOffset);addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(string){var matches=(string||"").match(matchOffset)||[];var chunk=matches[matches.length-1]||[];var parts=(chunk+"").match(chunkOffset)||["-",0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?+input:+local__createLocal(input))-+res;res._d.setTime(+res._d+diff);utils_hooks__hooks.updateOffset(res,false);return res}else{return local__createLocal(input).local()}return model._isUTC?local__createLocal(input).zone(model._offset||0):local__createLocal(input).local()}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15}utils_hooks__hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime){var offset=this._offset||0,localAdjust;if(input!=null){if(typeof input==="string"){input=offsetFromString(input)}if(Math.abs(input)<16){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){add_subtract__addSubtract(this,create__createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;utils_hooks__hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm){this.utcOffset(this._tzm)}else if(typeof this._i==="string"){this.utcOffset(offsetFromString(this._i))}return this}function hasAlignedHourOffset(input){if(!input){input=0}else{input=local__createLocal(input).utcOffset()}return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(this._a){var other=this._isUTC?create_utc__createUTC(this._a):local__createLocal(this._a);return this.isValid()&&compareArrays(this._a,other.toArray())>0}return false}function isLocal(){return!this._isUTC}function isUtcOffset(){return this._isUTC}function isUtc(){return this._isUTC&&this._offset===0}var aspNetRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/;var create__isoRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;function create__createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(typeof input==="number"){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else if(!!(match=aspNetRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}}else if(!!(match=create__isoRegex.exec(input))){sign=match[1]==="-"?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),d:parseIso(match[4],sign),h:parseIso(match[5],sign),m:parseIso(match[6],sign),s:parseIso(match[7],sign),w:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(local__createLocal(duration.from),local__createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}return ret}create__createDuration.fn=Duration.prototype;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period).");tmp=val;val=period;period=tmp}val=typeof val==="string"?+val:val;dur=create__createDuration(val,period);add_subtract__addSubtract(this,dur,direction);return this}}function add_subtract__addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days){get_set__set(mom,"Date",get_set__get(mom,"Date")+days*isAdding)}if(months){setMonth(mom,get_set__get(mom,"Month")+months*isAdding)}if(updateOffset){utils_hooks__hooks.updateOffset(mom,days||months)}}var add_subtract__add=createAdder(1,"add");var add_subtract__subtract=createAdder(-1,"subtract");function moment_calendar__calendar(time){var now=time||local__createLocal(),sod=cloneWithOffset(now,this).startOf("day"),diff=this.diff(sod,"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";
return this.format(this.localeData().calendar(format,this,local__createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var inputMs;units=normalizeUnits(typeof units!=="undefined"?units:"millisecond");if(units==="millisecond"){input=isMoment(input)?input:local__createLocal(input);return+this>+input}else{inputMs=isMoment(input)?+input:+local__createLocal(input);return inputMs<+this.clone().startOf(units)}}function isBefore(input,units){var inputMs;units=normalizeUnits(typeof units!=="undefined"?units:"millisecond");if(units==="millisecond"){input=isMoment(input)?input:local__createLocal(input);return+this<+input}else{inputMs=isMoment(input)?+input:+local__createLocal(input);return+this.clone().endOf(units)<inputMs}}function isBetween(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)}function isSame(input,units){var inputMs;units=normalizeUnits(units||"millisecond");if(units==="millisecond"){input=isMoment(input)?input:local__createLocal(input);return+this===+input}else{inputMs=+local__createLocal(input);return+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units)}}function absFloor(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function diff(input,units,asFloat){var that=cloneWithOffset(input,this),zoneDelta=(that.utcOffset()-this.utcOffset())*6e4,delta,output;units=normalizeUnits(units);if(units==="year"||units==="month"||units==="quarter"){output=monthDiff(this,that);if(units==="quarter"){output=output/3}else if(units==="year"){output=output/12}}else{delta=this-that;output=units==="second"?delta/1e3:units==="minute"?delta/6e4:units==="hour"?delta/36e5:units==="day"?(delta-zoneDelta)/864e5:units==="week"?(delta-zoneDelta)/6048e5:delta}return asFloat?output:absFloor(output)}function monthDiff(a,b){var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)}utils_hooks__hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function moment_format__toISOString(){var m=this.clone().utc();if(0<m.year()&&m.year()<=9999){if("function"===typeof Date.prototype.toISOString){return this.toDate().toISOString()}else{return formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}}else{return formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}}function format(inputString){var output=formatMoment(this,inputString||utils_hooks__hooks.defaultFormat);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(!this.isValid()){return this.localeData().invalidDate()}return create__createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}function fromNow(withoutSuffix){return this.from(local__createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(!this.isValid()){return this.localeData().invalidDate()}return create__createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}function toNow(withoutSuffix){return this.to(local__createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=locale_locales__getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}function startOf(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}if(units==="isoWeek"){this.isoWeekday(1)}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this}function endOf(units){units=normalizeUnits(units);if(units===undefined||units==="millisecond"){return this}return this.startOf(units).add(1,units==="isoWeek"?"week":units).subtract(1,"ms")}function to_type__valueOf(){return+this._d-(this._offset||0)*6e4}function unix(){return Math.floor(+this/1e3)}function toDate(){return this._offset?new Date(+this):this._d}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function moment_valid__isValid(){return valid__isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)});addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=utils_hooks__hooks.parseTwoDigitYear(input)});function weeksInYear(year,dow,doy){return weekOfYear(local__createLocal([year,11,31+dow-doy]),dow,doy).week}function getSetWeekYear(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return input==null?year:this.add(input-year,"y")}function getSetISOWeekYear(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add(input-year,"y")}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}addFormatToken("Q",0,0,"quarter");addUnitAlias("quarter","Q");addRegexToken("Q",match1);addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(isStrict,locale){return isStrict?locale._ordinalParse:locale._ordinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0],10)});var getSetDayOfMonth=makeGetSet("Date",true);addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)});addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)});addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",matchWord);addRegexToken("ddd",matchWord);addRegexToken("dddd",matchWord);addWeekParseToken(["dd","ddd","dddd"],function(input,week,config){var weekday=config._locale.weekdaysParse(input);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}});addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});function parseWeekday(input,locale){if(typeof input==="string"){if(!isNaN(input)){input=parseInt(input,10)}else{input=locale.weekdaysParse(input);if(typeof input!=="number"){return null}}}return input}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function localeWeekdays(m){return this._weekdays[m.day()]}var defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function localeWeekdaysShort(m){return this._weekdaysShort[m.day()]}var defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function localeWeekdaysMin(m){return this._weekdaysMin[m.day()]}function localeWeekdaysParse(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[]}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=local__createLocal([2e3,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,function(){return this.hours()%12||12});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}meridiem("a",true);meridiem("A",false);addUnitAlias("hour","h");function matchMeridiem(isStrict,locale){return locale._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addParseToken(["H","HH"],HOUR);addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input});addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true});function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var getSetHour=makeGetSet("Hours",true);addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});function millisecond__milliseconds(token){addFormatToken(0,[token,3],0,"millisecond")}millisecond__milliseconds("SSS");millisecond__milliseconds("SSSS");addUnitAlias("millisecond","ms");addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);addRegexToken("SSSS",matchUnsigned);addParseToken(["S","SS","SSS","SSSS"],function(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)});var getSetMillisecond=makeGetSet("Milliseconds",false);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var momentPrototype__proto=Moment.prototype;momentPrototype__proto.add=add_subtract__add;momentPrototype__proto.calendar=moment_calendar__calendar;momentPrototype__proto.clone=clone;momentPrototype__proto.diff=diff;momentPrototype__proto.endOf=endOf;momentPrototype__proto.format=format;momentPrototype__proto.from=from;momentPrototype__proto.fromNow=fromNow;momentPrototype__proto.to=to;momentPrototype__proto.toNow=toNow;momentPrototype__proto.get=getSet;momentPrototype__proto.invalidAt=invalidAt;momentPrototype__proto.isAfter=isAfter;momentPrototype__proto.isBefore=isBefore;momentPrototype__proto.isBetween=isBetween;momentPrototype__proto.isSame=isSame;momentPrototype__proto.isValid=moment_valid__isValid;momentPrototype__proto.lang=lang;momentPrototype__proto.locale=locale;momentPrototype__proto.localeData=localeData;momentPrototype__proto.max=prototypeMax;momentPrototype__proto.min=prototypeMin;momentPrototype__proto.parsingFlags=parsingFlags;momentPrototype__proto.set=getSet;momentPrototype__proto.startOf=startOf;momentPrototype__proto.subtract=add_subtract__subtract;momentPrototype__proto.toArray=toArray;momentPrototype__proto.toDate=toDate;momentPrototype__proto.toISOString=moment_format__toISOString;momentPrototype__proto.toJSON=moment_format__toISOString;momentPrototype__proto.toString=toString;momentPrototype__proto.unix=unix;momentPrototype__proto.valueOf=to_type__valueOf;momentPrototype__proto.year=getSetYear;momentPrototype__proto.isLeapYear=getIsLeapYear;momentPrototype__proto.weekYear=getSetWeekYear;momentPrototype__proto.isoWeekYear=getSetISOWeekYear;momentPrototype__proto.quarter=momentPrototype__proto.quarters=getSetQuarter;momentPrototype__proto.month=getSetMonth;momentPrototype__proto.daysInMonth=getDaysInMonth;momentPrototype__proto.week=momentPrototype__proto.weeks=getSetWeek;momentPrototype__proto.isoWeek=momentPrototype__proto.isoWeeks=getSetISOWeek;momentPrototype__proto.weeksInYear=getWeeksInYear;momentPrototype__proto.isoWeeksInYear=getISOWeeksInYear;momentPrototype__proto.date=getSetDayOfMonth;momentPrototype__proto.day=momentPrototype__proto.days=getSetDayOfWeek;momentPrototype__proto.weekday=getSetLocaleDayOfWeek;momentPrototype__proto.isoWeekday=getSetISODayOfWeek;momentPrototype__proto.dayOfYear=getSetDayOfYear;momentPrototype__proto.hour=momentPrototype__proto.hours=getSetHour;momentPrototype__proto.minute=momentPrototype__proto.minutes=getSetMinute;momentPrototype__proto.second=momentPrototype__proto.seconds=getSetSecond;momentPrototype__proto.millisecond=momentPrototype__proto.milliseconds=getSetMillisecond;momentPrototype__proto.utcOffset=getSetOffset;momentPrototype__proto.utc=setOffsetToUTC;momentPrototype__proto.local=setOffsetToLocal;momentPrototype__proto.parseZone=setOffsetToParsedOffset;momentPrototype__proto.hasAlignedHourOffset=hasAlignedHourOffset;momentPrototype__proto.isDST=isDaylightSavingTime;momentPrototype__proto.isDSTShifted=isDaylightSavingTimeShifted;momentPrototype__proto.isLocal=isLocal;momentPrototype__proto.isUtcOffset=isUtcOffset;momentPrototype__proto.isUtc=isUtc;momentPrototype__proto.isUTC=isUtc;momentPrototype__proto.zoneAbbr=getZoneAbbr;momentPrototype__proto.zoneName=getZoneName;momentPrototype__proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);momentPrototype__proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);momentPrototype__proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);momentPrototype__proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",getSetZone);var momentPrototype=momentPrototype__proto;function moment__createUnix(input){return local__createLocal(input*1e3)}function moment__createInZone(){return local__createLocal.apply(null,arguments).parseZone()}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function locale_calendar__calendar(key,mom,now){var output=this._calendar[key];return typeof output==="function"?output.call(mom,now):output}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"};function longDateFormat(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});this._longDateFormat[key]=output}return output}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d";var defaultOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}function preParsePostFormat(string){return string}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relative__relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return typeof output==="function"?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)}function locale_set__set(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}var prototype__proto=Locale.prototype;prototype__proto._calendar=defaultCalendar;prototype__proto.calendar=locale_calendar__calendar;prototype__proto._longDateFormat=defaultLongDateFormat;prototype__proto.longDateFormat=longDateFormat;prototype__proto._invalidDate=defaultInvalidDate;prototype__proto.invalidDate=invalidDate;prototype__proto._ordinal=defaultOrdinal;prototype__proto.ordinal=ordinal;prototype__proto._ordinalParse=defaultOrdinalParse;prototype__proto.preparse=preParsePostFormat;prototype__proto.postformat=preParsePostFormat;prototype__proto._relativeTime=defaultRelativeTime;prototype__proto.relativeTime=relative__relativeTime;prototype__proto.pastFuture=pastFuture;prototype__proto.set=locale_set__set;prototype__proto.months=localeMonths;prototype__proto._months=defaultLocaleMonths;prototype__proto.monthsShort=localeMonthsShort;prototype__proto._monthsShort=defaultLocaleMonthsShort;prototype__proto.monthsParse=localeMonthsParse;prototype__proto.week=localeWeek;prototype__proto._week=defaultLocaleWeek;prototype__proto.firstDayOfYear=localeFirstDayOfYear;prototype__proto.firstDayOfWeek=localeFirstDayOfWeek;prototype__proto.weekdays=localeWeekdays;prototype__proto._weekdays=defaultLocaleWeekdays;prototype__proto.weekdaysMin=localeWeekdaysMin;prototype__proto._weekdaysMin=defaultLocaleWeekdaysMin;prototype__proto.weekdaysShort=localeWeekdaysShort;prototype__proto._weekdaysShort=defaultLocaleWeekdaysShort;prototype__proto.weekdaysParse=localeWeekdaysParse;prototype__proto.isPM=localeIsPM;prototype__proto._meridiemParse=defaultLocaleMeridiemParse;prototype__proto.meridiem=localeMeridiem;function lists__get(format,index,field,setter){var locale=locale_locales__getLocale();var utc=create_utc__createUTC().set(setter,index);return locale[field](utc,format)}function list(format,index,field,count,setter){if(typeof format==="number"){index=format;format=undefined}format=format||"";if(index!=null){return lists__get(format,index,field,setter)}var i;var out=[];for(i=0;i<count;i++){out[i]=lists__get(format,i,field,setter)}return out}function lists__listMonths(format,index){return list(format,index,"months",12,"month")}function lists__listMonthsShort(format,index){return list(format,index,"monthsShort",12,"month")}function lists__listWeekdays(format,index){return list(format,index,"weekdays",7,"day")}function lists__listWeekdaysShort(format,index){return list(format,index,"weekdaysShort",7,"day")}function lists__listWeekdaysMin(format,index){return list(format,index,"weekdaysMin",7,"day")}locale_locales__getSetGlobalLocale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});utils_hooks__hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",locale_locales__getSetGlobalLocale);utils_hooks__hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",locale_locales__getLocale);var mathAbs=Math.abs;function duration_abs__abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this}function duration_add_subtract__addSubtract(duration,input,value,direction){var other=create__createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function duration_add_subtract__add(input,value){return duration_add_subtract__addSubtract(this,input,value,1)}function duration_add_subtract__subtract(input,value){return duration_add_subtract__addSubtract(this,input,value,-1)}function bubble(){var milliseconds=this._milliseconds;var days=this._days;var months=this._months;var data=this._data;var seconds,minutes,hours,years=0;data.milliseconds=milliseconds%1e3;seconds=absFloor(milliseconds/1e3);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);years=absFloor(daysToYears(days));days-=absFloor(yearsToDays(years));months+=absFloor(days/30);days%=30;years+=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this}function daysToYears(days){return days*400/146097}function yearsToDays(years){return years*146097/400}function as(units){var days;var months;var milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==="month"||units==="year"){days=this._days+milliseconds/864e5;months=this._months+daysToYears(days)*12;return units==="month"?months:months/12}else{days=this._days+Math.round(yearsToDays(this._months/12));switch(units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return days*24+milliseconds/36e5;case"minute":return days*1440+milliseconds/6e4;case"second":return days*86400+milliseconds/1e3;case"millisecond":return Math.floor(days*864e5)+milliseconds;default:throw new Error("Unknown unit "+units)}}}function duration_as__valueOf(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms");var asSeconds=makeAs("s");var asMinutes=makeAs("m");var asHours=makeAs("h");var asDays=makeAs("d");var asWeeks=makeAs("w");var asMonths=makeAs("M");var asYears=makeAs("y");function duration_get__get(units){units=normalizeUnits(units);return this[units+"s"]()}function makeGetter(name){return function(){return this._data[name]}}var duration_get__milliseconds=makeGetter("milliseconds");var seconds=makeGetter("seconds");var minutes=makeGetter("minutes");var hours=makeGetter("hours");var days=makeGetter("days");var months=makeGetter("months");var years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round;var thresholds={s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function duration_humanize__relativeTime(posNegDuration,withoutSuffix,locale){var duration=create__createDuration(posNegDuration).abs();var seconds=round(duration.as("s"));var minutes=round(duration.as("m"));var hours=round(duration.as("h"));var days=round(duration.as("d"));var months=round(duration.as("M"));var years=round(duration.as("y"));var a=seconds<thresholds.s&&["s",seconds]||minutes===1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours===1&&["h"]||hours<thresholds.h&&["hh",hours]||days===1&&["d"]||days<thresholds.d&&["dd",days]||months===1&&["M"]||months<thresholds.M&&["MM",months]||years===1&&["y"]||["yy",years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a)}function duration_humanize__getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false}if(limit===undefined){return thresholds[threshold]}thresholds[threshold]=limit;return true}function humanize(withSuffix){var locale=this.localeData();var output=duration_humanize__relativeTime(this,!withSuffix,locale);if(withSuffix){output=locale.pastFuture(+this,output)}return locale.postformat(output)}var iso_string__abs=Math.abs;function iso_string__toISOString(){var Y=iso_string__abs(this.years());var M=iso_string__abs(this.months());var D=iso_string__abs(this.days());var h=iso_string__abs(this.hours());var m=iso_string__abs(this.minutes());var s=iso_string__abs(this.seconds()+this.milliseconds()/1e3);var total=this.asSeconds();if(!total){return"P0D"}return(total<0?"-":"")+"P"+(Y?Y+"Y":"")+(M?M+"M":"")+(D?D+"D":"")+(h||m||s?"T":"")+(h?h+"H":"")+(m?m+"M":"")+(s?s+"S":"")}var duration_prototype__proto=Duration.prototype;duration_prototype__proto.abs=duration_abs__abs;duration_prototype__proto.add=duration_add_subtract__add;duration_prototype__proto.subtract=duration_add_subtract__subtract;duration_prototype__proto.as=as;duration_prototype__proto.asMilliseconds=asMilliseconds;duration_prototype__proto.asSeconds=asSeconds;duration_prototype__proto.asMinutes=asMinutes;duration_prototype__proto.asHours=asHours;duration_prototype__proto.asDays=asDays;duration_prototype__proto.asWeeks=asWeeks;duration_prototype__proto.asMonths=asMonths;duration_prototype__proto.asYears=asYears;duration_prototype__proto.valueOf=duration_as__valueOf;duration_prototype__proto._bubble=bubble;duration_prototype__proto.get=duration_get__get;duration_prototype__proto.milliseconds=duration_get__milliseconds;duration_prototype__proto.seconds=seconds;duration_prototype__proto.minutes=minutes;duration_prototype__proto.hours=hours;duration_prototype__proto.days=days;duration_prototype__proto.weeks=weeks;duration_prototype__proto.months=months;duration_prototype__proto.years=years;duration_prototype__proto.humanize=humanize;duration_prototype__proto.toISOString=iso_string__toISOString;duration_prototype__proto.toString=iso_string__toISOString;duration_prototype__proto.toJSON=iso_string__toISOString;duration_prototype__proto.locale=locale;duration_prototype__proto.localeData=localeData;duration_prototype__proto.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",iso_string__toISOString);duration_prototype__proto.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(input,array,config){config._d=new Date(parseFloat(input,10)*1e3)});addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))});utils_hooks__hooks.version="2.10.3";setHookCallback(local__createLocal);utils_hooks__hooks.fn=momentPrototype;utils_hooks__hooks.min=min;utils_hooks__hooks.max=max;utils_hooks__hooks.utc=create_utc__createUTC;utils_hooks__hooks.unix=moment__createUnix;utils_hooks__hooks.months=lists__listMonths;utils_hooks__hooks.isDate=isDate;utils_hooks__hooks.locale=locale_locales__getSetGlobalLocale;utils_hooks__hooks.invalid=valid__createInvalid;utils_hooks__hooks.duration=create__createDuration;utils_hooks__hooks.isMoment=isMoment;utils_hooks__hooks.weekdays=lists__listWeekdays;utils_hooks__hooks.parseZone=moment__createInZone;utils_hooks__hooks.localeData=locale_locales__getLocale;utils_hooks__hooks.isDuration=isDuration;utils_hooks__hooks.monthsShort=lists__listMonthsShort;utils_hooks__hooks.weekdaysMin=lists__listWeekdaysMin;utils_hooks__hooks.defineLocale=defineLocale;utils_hooks__hooks.weekdaysShort=lists__listWeekdaysShort;utils_hooks__hooks.normalizeUnits=normalizeUnits;utils_hooks__hooks.relativeTimeThreshold=duration_humanize__getSetRelativeTimeThreshold;var _moment=utils_hooks__hooks;return _moment})},{}],numeral:[function(require,module,exports){"use strict";(function(){var numeral,VERSION="1.5.3",languages={},currentLanguage="en",zeroFormat=null,defaultFormat="0,0",hasModule=typeof module!=="undefined"&&module.exports;function Numeral(number){this._value=number}function toFixed(value,precision,roundingFunction,optionals){var power=Math.pow(10,precision),optionalsRegExp,output;output=(roundingFunction(value*power)/power).toFixed(precision);if(optionals){optionalsRegExp=new RegExp("0{1,"+optionals+"}$");output=output.replace(optionalsRegExp,"")}return output}function formatNumeral(n,format,roundingFunction){var output;if(format.indexOf("$")>-1){output=formatCurrency(n,format,roundingFunction)}else if(format.indexOf("%")>-1){output=formatPercentage(n,format,roundingFunction)}else if(format.indexOf(":")>-1){output=formatTime(n,format)}else{output=formatNumber(n._value,format,roundingFunction)}return output}function unformatNumeral(n,string){var stringOriginal=string,thousandRegExp,millionRegExp,billionRegExp,trillionRegExp,suffixes=["KB","MB","GB","TB","PB","EB","ZB","YB"],bytesMultiplier=false,power;if(string.indexOf(":")>-1){n._value=unformatTime(string)}else{if(string===zeroFormat){n._value=0}else{if(languages[currentLanguage].delimiters.decimal!=="."){string=string.replace(/\./g,"").replace(languages[currentLanguage].delimiters.decimal,".")}thousandRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.thousand+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$");millionRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.million+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$");billionRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.billion+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$");trillionRegExp=new RegExp("[^a-zA-Z]"+languages[currentLanguage].abbreviations.trillion+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$");for(power=0;power<=suffixes.length;power++){bytesMultiplier=string.indexOf(suffixes[power])>-1?Math.pow(1024,power+1):false;if(bytesMultiplier){break}}n._value=(bytesMultiplier?bytesMultiplier:1)*(stringOriginal.match(thousandRegExp)?Math.pow(10,3):1)*(stringOriginal.match(millionRegExp)?Math.pow(10,6):1)*(stringOriginal.match(billionRegExp)?Math.pow(10,9):1)*(stringOriginal.match(trillionRegExp)?Math.pow(10,12):1)*(string.indexOf("%")>-1?.01:1)*((string.split("-").length+Math.min(string.split("(").length-1,string.split(")").length-1))%2?1:-1)*Number(string.replace(/[^0-9\.]+/g,""));n._value=bytesMultiplier?Math.ceil(n._value):n._value}}return n._value}function formatCurrency(n,format,roundingFunction){var symbolIndex=format.indexOf("$"),openParenIndex=format.indexOf("("),minusSignIndex=format.indexOf("-"),space="",spliceIndex,output;if(format.indexOf(" $")>-1){space=" ";format=format.replace(" $","")}else if(format.indexOf("$ ")>-1){space=" ";format=format.replace("$ ","")}else{format=format.replace("$","")}output=formatNumber(n._value,format,roundingFunction);if(symbolIndex<=1){if(output.indexOf("(")>-1||output.indexOf("-")>-1){output=output.split("");spliceIndex=1;if(symbolIndex<openParenIndex||symbolIndex<minusSignIndex){spliceIndex=0}output.splice(spliceIndex,0,languages[currentLanguage].currency.symbol+space);output=output.join("")}else{output=languages[currentLanguage].currency.symbol+space+output;
}}else{if(output.indexOf(")")>-1){output=output.split("");output.splice(-1,0,space+languages[currentLanguage].currency.symbol);output=output.join("")}else{output=output+space+languages[currentLanguage].currency.symbol}}return output}function formatPercentage(n,format,roundingFunction){var space="",output,value=n._value*100;if(format.indexOf(" %")>-1){space=" ";format=format.replace(" %","")}else{format=format.replace("%","")}output=formatNumber(value,format,roundingFunction);if(output.indexOf(")")>-1){output=output.split("");output.splice(-1,0,space+"%");output=output.join("")}else{output=output+space+"%"}return output}function formatTime(n){var hours=Math.floor(n._value/60/60),minutes=Math.floor((n._value-hours*60*60)/60),seconds=Math.round(n._value-hours*60*60-minutes*60);return hours+":"+(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds)}function unformatTime(string){var timeArray=string.split(":"),seconds=0;if(timeArray.length===3){seconds=seconds+Number(timeArray[0])*60*60;seconds=seconds+Number(timeArray[1])*60;seconds=seconds+Number(timeArray[2])}else if(timeArray.length===2){seconds=seconds+Number(timeArray[0])*60;seconds=seconds+Number(timeArray[1])}return Number(seconds)}function formatNumber(value,format,roundingFunction){var negP=false,signed=false,optDec=false,abbr="",abbrK=false,abbrM=false,abbrB=false,abbrT=false,abbrForce=false,bytes="",ord="",abs=Math.abs(value),suffixes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],min,max,power,w,precision,thousands,d="",neg=false;if(value===0&&zeroFormat!==null){return zeroFormat}else{if(format.indexOf("(")>-1){negP=true;format=format.slice(1,-1)}else if(format.indexOf("+")>-1){signed=true;format=format.replace(/\+/g,"")}if(format.indexOf("a")>-1){abbrK=format.indexOf("aK")>=0;abbrM=format.indexOf("aM")>=0;abbrB=format.indexOf("aB")>=0;abbrT=format.indexOf("aT")>=0;abbrForce=abbrK||abbrM||abbrB||abbrT;if(format.indexOf(" a")>-1){abbr=" ";format=format.replace(" a","")}else{format=format.replace("a","")}if(abs>=Math.pow(10,12)&&!abbrForce||abbrT){abbr=abbr+languages[currentLanguage].abbreviations.trillion;value=value/Math.pow(10,12)}else if(abs<Math.pow(10,12)&&abs>=Math.pow(10,9)&&!abbrForce||abbrB){abbr=abbr+languages[currentLanguage].abbreviations.billion;value=value/Math.pow(10,9)}else if(abs<Math.pow(10,9)&&abs>=Math.pow(10,6)&&!abbrForce||abbrM){abbr=abbr+languages[currentLanguage].abbreviations.million;value=value/Math.pow(10,6)}else if(abs<Math.pow(10,6)&&abs>=Math.pow(10,3)&&!abbrForce||abbrK){abbr=abbr+languages[currentLanguage].abbreviations.thousand;value=value/Math.pow(10,3)}}if(format.indexOf("b")>-1){if(format.indexOf(" b")>-1){bytes=" ";format=format.replace(" b","")}else{format=format.replace("b","")}for(power=0;power<=suffixes.length;power++){min=Math.pow(1024,power);max=Math.pow(1024,power+1);if(value>=min&&value<max){bytes=bytes+suffixes[power];if(min>0){value=value/min}break}}}if(format.indexOf("o")>-1){if(format.indexOf(" o")>-1){ord=" ";format=format.replace(" o","")}else{format=format.replace("o","")}ord=ord+languages[currentLanguage].ordinal(value)}if(format.indexOf("[.]")>-1){optDec=true;format=format.replace("[.]",".")}w=value.toString().split(".")[0];precision=format.split(".")[1];thousands=format.indexOf(",");if(precision){if(precision.indexOf("[")>-1){precision=precision.replace("]","");precision=precision.split("[");d=toFixed(value,precision[0].length+precision[1].length,roundingFunction,precision[1].length)}else{d=toFixed(value,precision.length,roundingFunction)}w=d.split(".")[0];if(d.split(".")[1].length){d=languages[currentLanguage].delimiters.decimal+d.split(".")[1]}else{d=""}if(optDec&&Number(d.slice(1))===0){d=""}}else{w=toFixed(value,null,roundingFunction)}if(w.indexOf("-")>-1){w=w.slice(1);neg=true}if(thousands>-1){w=w.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+languages[currentLanguage].delimiters.thousands)}if(format.indexOf(".")===0){w=""}return(negP&&neg?"(":"")+(!negP&&neg?"-":"")+(!neg&&signed?"+":"")+w+d+(ord?ord:"")+(abbr?abbr:"")+(bytes?bytes:"")+(negP&&neg?")":"")}}numeral=function(input){if(numeral.isNumeral(input)){input=input.value()}else if(input===0||typeof input==="undefined"){input=0}else if(!Number(input)){input=numeral.fn.unformat(input)}return new Numeral(Number(input))};numeral.version=VERSION;numeral.isNumeral=function(obj){return obj instanceof Numeral};numeral.language=function(key,values){if(!key){return currentLanguage}if(key&&!values){if(!languages[key]){throw new Error("Unknown language : "+key)}currentLanguage=key}if(values||!languages[key]){loadLanguage(key,values)}return numeral};numeral.languageData=function(key){if(!key){return languages[currentLanguage]}if(!languages[key]){throw new Error("Unknown language : "+key)}return languages[key]};numeral.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(number){var b=number%10;return~~(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th"},currency:{symbol:"$"}});numeral.zeroFormat=function(format){zeroFormat=typeof format==="string"?format:null};numeral.defaultFormat=function(format){defaultFormat=typeof format==="string"?format:"0.0"};numeral.validate=function(val,culture){var _decimalSep,_thousandSep,_currSymbol,_valArray,_abbrObj,_thousandRegEx,languageData,temp;if(typeof val!=="string"){val+="";if(console.warn){console.warn("Numeral.js: Value is not string. It has been co-erced to: ",val)}}val=val.trim();if(val===""){return false}val=val.replace(/^[+-]?/,"");try{languageData=numeral.languageData(culture)}catch(e){languageData=numeral.languageData(numeral.language())}_currSymbol=languageData.currency.symbol;_abbrObj=languageData.abbreviations;_decimalSep=languageData.delimiters.decimal;if(languageData.delimiters.thousands==="."){_thousandSep="\\."}else{_thousandSep=languageData.delimiters.thousands}temp=val.match(/^[^\d]+/);if(temp!==null){val=val.substr(1);if(temp[0]!==_currSymbol){return false}}temp=val.match(/[^\d]+$/);if(temp!==null){val=val.slice(0,-1);if(temp[0]!==_abbrObj.thousand&&temp[0]!==_abbrObj.million&&temp[0]!==_abbrObj.billion&&temp[0]!==_abbrObj.trillion){return false}}if(!!val.match(/^\d+$/)){return true}_thousandRegEx=new RegExp(_thousandSep+"{2}");if(!val.match(/[^\d.,]/g)){_valArray=val.split(_decimalSep);if(_valArray.length>2){return false}else{if(_valArray.length<2){return!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)}else{if(_valArray[0].length===1){return!!_valArray[0].match(/^\d+$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/)}else{return!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/)}}}}return false};function loadLanguage(key,values){languages[key]=values}if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(callback,opt_initialValue){"use strict";if(null===this||"undefined"===typeof this){throw new TypeError("Array.prototype.reduce called on null or undefined")}if("function"!==typeof callback){throw new TypeError(callback+" is not a function")}var index,value,length=this.length>>>0,isValueSet=false;if(1<arguments.length){value=opt_initialValue;isValueSet=true}for(index=0;length>index;++index){if(this.hasOwnProperty(index)){if(isValueSet){value=callback(value,this[index],index,this)}else{value=this[index];isValueSet=true}}}if(!isValueSet){throw new TypeError("Reduce of empty array with no initial value")}return value}}function multiplier(x){var parts=x.toString().split(".");if(parts.length<2){return 1}return Math.pow(10,parts[1].length)}function correctionFactor(){var args=Array.prototype.slice.call(arguments);return args.reduce(function(prev,next){var mp=multiplier(prev),mn=multiplier(next);return mp>mn?mp:mn},-Infinity)}numeral.fn=Numeral.prototype={clone:function(){return numeral(this)},format:function(inputString,roundingFunction){return formatNumeral(this,inputString?inputString:defaultFormat,roundingFunction!==undefined?roundingFunction:Math.round)},unformat:function(inputString){if(Object.prototype.toString.call(inputString)==="[object Number]"){return inputString}return unformatNumeral(this,inputString?inputString:defaultFormat)},value:function(){return this._value},valueOf:function(){return this._value},set:function(value){this._value=Number(value);return this},add:function(value){var corrFactor=correctionFactor.call(null,this._value,value);function cback(accum,curr,currI,O){return accum+corrFactor*curr}this._value=[this._value,value].reduce(cback,0)/corrFactor;return this},subtract:function(value){var corrFactor=correctionFactor.call(null,this._value,value);function cback(accum,curr,currI,O){return accum-corrFactor*curr}this._value=[value].reduce(cback,this._value*corrFactor)/corrFactor;return this},multiply:function(value){function cback(accum,curr,currI,O){var corrFactor=correctionFactor(accum,curr);return accum*corrFactor*(curr*corrFactor)/(corrFactor*corrFactor)}this._value=[this._value,value].reduce(cback,1);return this},divide:function(value){function cback(accum,curr,currI,O){var corrFactor=correctionFactor(accum,curr);return accum*corrFactor/(curr*corrFactor)}this._value=[this._value,value].reduce(cback);return this},difference:function(value){return Math.abs(numeral(this._value).subtract(value).value())}};if(hasModule){module.exports=numeral}if(typeof ender==="undefined"){this["numeral"]=numeral}if(typeof define==="function"&&define.amd){define([],function(){return numeral})}}).call(window)},{}],pikaday:[function(require,module,exports){/*!
=======
!function(t,r){"object"==typeof o&&"undefined"!=typeof n?n.exports=r():"function"==typeof e&&e.amd?e(r):t.moment=r()}(this,function(){"use strict";function e(){return xn.apply(null,arguments)}function o(e){xn=e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function s(e,t){var n,o=[];for(n=0;n<e.length;++n)o.push(t(e[n],n));return o}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e,t){for(var n in t)a(t,n)&&(e[n]=t[n]);return a(t,"toString")&&(e.toString=t.toString),a(t,"valueOf")&&(e.valueOf=t.valueOf),e}function u(e,t,n,o){return ke(e,t,n,o,!0).utc()}function d(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function c(e){return null==e._pf&&(e._pf=d()),e._pf}function h(e){if(null==e._isValid){var t=c(e);e._isValid=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function f(e){var t=u(NaN);return null!=e?l(c(t),e):c(t).userInvalidated=!0,t}function p(e,t){var n,o,r;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=c(t)),"undefined"!=typeof t._locale&&(e._locale=t._locale),jn.length>0)for(n in jn)o=jn[n],r=t[o],"undefined"!=typeof r&&(e[o]=r);return e}function g(t){p(this,t),this._d=new Date(+t._d),Pn===!1&&(Pn=!0,e.updateOffset(this),Pn=!1)}function m(e){return e instanceof g||null!=e&&null!=e._isAMomentObject}function w(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function v(e,t,n){var o,r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0;for(o=0;r>o;o++)(n&&e[o]!==t[o]||!n&&w(e[o])!==w(t[o]))&&s++;return s+i}function y(){}function b(e){return e?e.toLowerCase().replace("_","-"):e}function C(e){for(var t,n,o,r,i=0;i<e.length;){for(r=b(e[i]).split("-"),t=r.length,n=b(e[i+1]),n=n?n.split("-"):null;t>0;){if(o=R(r.slice(0,t).join("-")))return o;if(n&&n.length>=t&&v(r,n,!0)>=t-1)break;t--}i++}return null}function R(e){var o=null;if(!Nn[e]&&"undefined"!=typeof n&&n&&n.exports)try{o=An._abbr,t("./locale/"+e),S(o)}catch(r){}return Nn[e]}function S(e,t){var n;return e&&(n="undefined"==typeof t?T(e):E(e,t),n&&(An=n)),An._abbr}function E(e,t){return null!==t?(t.abbr=e,Nn[e]||(Nn[e]=new y),Nn[e].set(t),S(e),Nn[e]):(delete Nn[e],null)}function T(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return An;if(!r(e)){if(t=R(e))return t;e=[e]}return C(e)}function _(e,t){var n=e.toLowerCase();Ln[n]=Ln[n+"s"]=Ln[t]=e}function k(e){return"string"==typeof e?Ln[e]||Ln[e.toLowerCase()]:void 0}function H(e){var t,n,o={};for(n in e)a(e,n)&&(t=k(n),t&&(o[t]=e[n]));return o}function M(t,n){return function(o){return null!=o?(D(this,t,o),e.updateOffset(this,n),this):O(this,t)}}function O(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function D(e,t,n){return e._d["set"+(e._isUTC?"UTC":"")+t](n)}function x(e,t){var n;if("object"==typeof e)for(n in e)this.set(n,e[n]);else if(e=k(e),"function"==typeof this[e])return this[e](t);return this}function A(e,t,n){for(var o=""+Math.abs(e),r=e>=0;o.length<t;)o="0"+o;return(r?n?"+":"":"-")+o}function j(e,t,n,o){var r=o;"string"==typeof o&&(r=function(){return this[o]()}),e&&(Vn[e]=r),t&&(Vn[t[0]]=function(){return A(r.apply(this,arguments),t[1],t[2])}),n&&(Vn[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function P(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function N(e){var t,n,o=e.match(Wn);for(t=0,n=o.length;n>t;t++)Vn[o[t]]?o[t]=Vn[o[t]]:o[t]=P(o[t]);return function(r){var i="";for(t=0;n>t;t++)i+=o[t]instanceof Function?o[t].call(r,e):o[t];return i}}function L(e,t){return e.isValid()?(t=W(t,e.localeData()),Bn[t]||(Bn[t]=N(t)),Bn[t](e)):e.localeData().invalidDate()}function W(e,t){function n(e){return t.longDateFormat(e)||e}var o=5;for(In.lastIndex=0;o>=0&&In.test(e);)e=e.replace(In,n),In.lastIndex=0,o-=1;return e}function I(e,t,n){no[e]="function"==typeof t?t:function(e){return e&&n?n:t}}function B(e,t){return a(no,e)?no[e](t._strict,t._locale):new RegExp(V(e))}function V(e){return e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,o,r){return t||n||o||r}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function F(e,t){var n,o=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(o=function(e,n){n[t]=w(e)}),n=0;n<e.length;n++)oo[e[n]]=o}function Y(e,t){F(e,function(e,n,o,r){o._w=o._w||{},t(e,o._w,o,r)})}function G(e,t,n){null!=t&&a(oo,e)&&oo[e](t,n._a,n,e)}function z(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function U(e){return this._months[e.month()]}function $(e){return this._monthsShort[e.month()]}function X(e,t,n){var o,r,i;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;12>o;o++){if(r=u([2e3,o]),n&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[o]||(i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[o]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[o].test(e))return o;if(n&&"MMM"===t&&this._shortMonthsParse[o].test(e))return o;if(!n&&this._monthsParse[o].test(e))return o}}function K(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),z(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function q(t){return null!=t?(K(this,t),e.updateOffset(this,!0),this):O(this,"Month")}function Z(){return z(this.year(),this.month())}function J(e){var t,n=e._a;return n&&-2===c(e).overflow&&(t=n[io]<0||n[io]>11?io:n[so]<1||n[so]>z(n[ro],n[io])?so:n[ao]<0||n[ao]>24||24===n[ao]&&(0!==n[lo]||0!==n[uo]||0!==n[co])?ao:n[lo]<0||n[lo]>59?lo:n[uo]<0||n[uo]>59?uo:n[co]<0||n[co]>999?co:-1,c(e)._overflowDayOfYear&&(ro>t||t>so)&&(t=so),c(e).overflow=t),e}function Q(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function ee(e,t){var n=!0,o=e+"\n"+(new Error).stack;return l(function(){return n&&(Q(o),n=!1),t.apply(this,arguments)},t)}function te(e,t){po[e]||(Q(t),po[e]=!0)}function ne(e){var t,n,o=e._i,r=go.exec(o);if(r){for(c(e).iso=!0,t=0,n=mo.length;n>t;t++)if(mo[t][1].exec(o)){e._f=mo[t][0]+(r[6]||" ");break}for(t=0,n=wo.length;n>t;t++)if(wo[t][1].exec(o)){e._f+=wo[t][0];break}o.match(Qn)&&(e._f+="Z"),Ce(e)}else e._isValid=!1}function oe(t){var n=vo.exec(t._i);return null!==n?void(t._d=new Date(+n[1])):(ne(t),void(t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))))}function re(e,t,n,o,r,i,s){var a=new Date(e,t,n,o,r,i,s);return 1970>e&&a.setFullYear(e),a}function ie(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function se(e){return ae(e)?366:365}function ae(e){return e%4===0&&e%100!==0||e%400===0}function le(){return ae(this.year())}function ue(e,t,n){var o,r=n-t,i=n-e.day();return i>r&&(i-=7),r-7>i&&(i+=7),o=He(e).add(i,"d"),{week:Math.ceil(o.dayOfYear()/7),year:o.year()}}function de(e){return ue(e,this._week.dow,this._week.doy).week}function ce(){return this._week.dow}function he(){return this._week.doy}function fe(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function pe(e){var t=ue(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function ge(e,t,n,o,r){var i,s,a=ie(e,0,1).getUTCDay();return a=0===a?7:a,n=null!=n?n:r,i=r-a+(a>o?7:0)-(r>a?7:0),s=7*(t-1)+(n-r)+i+1,{year:s>0?e:e-1,dayOfYear:s>0?s:se(e-1)+s}}function me(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function we(e,t,n){return null!=e?e:null!=t?t:n}function ve(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function ye(e){var t,n,o,r,i=[];if(!e._d){for(o=ve(e),e._w&&null==e._a[so]&&null==e._a[io]&&be(e),e._dayOfYear&&(r=we(e._a[ro],o[ro]),e._dayOfYear>se(r)&&(c(e)._overflowDayOfYear=!0),n=ie(r,0,e._dayOfYear),e._a[io]=n.getUTCMonth(),e._a[so]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=i[t]=o[t];for(;7>t;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ao]&&0===e._a[lo]&&0===e._a[uo]&&0===e._a[co]&&(e._nextDay=!0,e._a[ao]=0),e._d=(e._useUTC?ie:re).apply(null,i),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ao]=24)}}function be(e){var t,n,o,r,i,s,a;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(i=1,s=4,n=we(t.GG,e._a[ro],ue(He(),1,4).year),o=we(t.W,1),r=we(t.E,1)):(i=e._locale._week.dow,s=e._locale._week.doy,n=we(t.gg,e._a[ro],ue(He(),i,s).year),o=we(t.w,1),null!=t.d?(r=t.d,i>r&&++o):r=null!=t.e?t.e+i:i),a=ge(n,o,r,s,i),e._a[ro]=a.year,e._dayOfYear=a.dayOfYear}function Ce(t){if(t._f===e.ISO_8601)return void ne(t);t._a=[],c(t).empty=!0;var n,o,r,i,s,a=""+t._i,l=a.length,u=0;for(r=W(t._f,t._locale).match(Wn)||[],n=0;n<r.length;n++)i=r[n],o=(a.match(B(i,t))||[])[0],o&&(s=a.substr(0,a.indexOf(o)),s.length>0&&c(t).unusedInput.push(s),a=a.slice(a.indexOf(o)+o.length),u+=o.length),Vn[i]?(o?c(t).empty=!1:c(t).unusedTokens.push(i),G(i,o,t)):t._strict&&!o&&c(t).unusedTokens.push(i);c(t).charsLeftOver=l-u,a.length>0&&c(t).unusedInput.push(a),c(t).bigHour===!0&&t._a[ao]<=12&&t._a[ao]>0&&(c(t).bigHour=void 0),t._a[ao]=Re(t._locale,t._a[ao],t._meridiem),ye(t),J(t)}function Re(e,t,n){var o;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(o=e.isPM(n),o&&12>t&&(t+=12),o||12!==t||(t=0),t):t}function Se(e){var t,n,o,r,i;if(0===e._f.length)return c(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)i=0,t=p({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],Ce(t),h(t)&&(i+=c(t).charsLeftOver,i+=10*c(t).unusedTokens.length,c(t).score=i,(null==o||o>i)&&(o=i,n=t));l(e,n||t)}function Ee(e){if(!e._d){var t=H(e._i);e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],ye(e)}}function Te(e){var t,n=e._i,o=e._f;return e._locale=e._locale||T(e._l),null===n||void 0===o&&""===n?f({nullInput:!0}):("string"==typeof n&&(e._i=n=e._locale.preparse(n)),m(n)?new g(J(n)):(r(o)?Se(e):o?Ce(e):i(n)?e._d=n:_e(e),t=new g(J(e)),t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t))}function _e(t){var n=t._i;void 0===n?t._d=new Date:i(n)?t._d=new Date(+n):"string"==typeof n?oe(t):r(n)?(t._a=s(n.slice(0),function(e){return parseInt(e,10)}),ye(t)):"object"==typeof n?Ee(t):"number"==typeof n?t._d=new Date(n):e.createFromInputFallback(t)}function ke(e,t,n,o,r){var i={};return"boolean"==typeof n&&(o=n,n=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=r,i._l=n,i._i=e,i._f=t,i._strict=o,Te(i)}function He(e,t,n,o){return ke(e,t,n,o,!1)}function Me(e,t){var n,o;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return He();for(n=t[0],o=1;o<t.length;++o)t[o][e](n)&&(n=t[o]);return n}function Oe(){var e=[].slice.call(arguments,0);return Me("isBefore",e)}function De(){var e=[].slice.call(arguments,0);return Me("isAfter",e)}function xe(e){var t=H(e),n=t.year||0,o=t.quarter||0,r=t.month||0,i=t.week||0,s=t.day||0,a=t.hour||0,l=t.minute||0,u=t.second||0,d=t.millisecond||0;this._milliseconds=+d+1e3*u+6e4*l+36e5*a,this._days=+s+7*i,this._months=+r+3*o+12*n,this._data={},this._locale=T(),this._bubble()}function Ae(e){return e instanceof xe}function je(e,t){j(e,0,0,function(){var e=this.utcOffset(),n="+";return 0>e&&(e=-e,n="-"),n+A(~~(e/60),2)+t+A(~~e%60,2)})}function Pe(e){var t=(e||"").match(Qn)||[],n=t[t.length-1]||[],o=(n+"").match(So)||["-",0,0],r=+(60*o[1])+w(o[2]);return"+"===o[0]?r:-r}function Ne(t,n){var o,r;return n._isUTC?(o=n.clone(),r=(m(t)||i(t)?+t:+He(t))-+o,o._d.setTime(+o._d+r),e.updateOffset(o,!1),o):He(t).local()}function Le(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function We(t,n){var o,r=this._offset||0;return null!=t?("string"==typeof t&&(t=Pe(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&n&&(o=Le(this)),this._offset=t,this._isUTC=!0,null!=o&&this.add(o,"m"),r!==t&&(!n||this._changeInProgress?et(this,Ke(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:Le(this)}function Ie(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Be(e){return this.utcOffset(0,e)}function Ve(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Le(this),"m")),this}function Fe(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Pe(this._i)),this}function Ye(e){return e=e?He(e).utcOffset():0,(this.utcOffset()-e)%60===0}function Ge(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function ze(){if(this._a){var e=this._isUTC?u(this._a):He(this._a);return this.isValid()&&v(this._a,e.toArray())>0}return!1}function Ue(){return!this._isUTC}function $e(){return this._isUTC}function Xe(){return this._isUTC&&0===this._offset}function Ke(e,t){var n,o,r,i=e,s=null;return Ae(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(i={},t?i[t]=e:i.milliseconds=e):(s=Eo.exec(e))?(n="-"===s[1]?-1:1,i={y:0,d:w(s[so])*n,h:w(s[ao])*n,m:w(s[lo])*n,s:w(s[uo])*n,ms:w(s[co])*n}):(s=To.exec(e))?(n="-"===s[1]?-1:1,i={y:qe(s[2],n),M:qe(s[3],n),d:qe(s[4],n),h:qe(s[5],n),m:qe(s[6],n),s:qe(s[7],n),w:qe(s[8],n)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(r=Je(He(i.from),He(i.to)),i={},i.ms=r.milliseconds,i.M=r.months),o=new xe(i),Ae(e)&&a(e,"_locale")&&(o._locale=e._locale),o}function qe(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Ze(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Je(e,t){var n;return t=Ne(t,e),e.isBefore(t)?n=Ze(e,t):(n=Ze(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function Qe(e,t){return function(n,o){var r,i;return null===o||isNaN(+o)||(te(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),i=n,n=o,o=i),n="string"==typeof n?+n:n,r=Ke(n,o),et(this,r,e),this}}function et(t,n,o,r){var i=n._milliseconds,s=n._days,a=n._months;r=null==r?!0:r,i&&t._d.setTime(+t._d+i*o),s&&D(t,"Date",O(t,"Date")+s*o),a&&K(t,O(t,"Month")+a*o),r&&e.updateOffset(t,s||a)}function tt(e){var t=e||He(),n=Ne(t,this).startOf("day"),o=this.diff(n,"days",!0),r=-6>o?"sameElse":-1>o?"lastWeek":0>o?"lastDay":1>o?"sameDay":2>o?"nextDay":7>o?"nextWeek":"sameElse";return this.format(this.localeData().calendar(r,this,He(t)))}function nt(){return new g(this)}function ot(e,t){var n;return t=k("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=m(e)?e:He(e),+this>+e):(n=m(e)?+e:+He(e),n<+this.clone().startOf(t))}function rt(e,t){var n;return t=k("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=m(e)?e:He(e),+e>+this):(n=m(e)?+e:+He(e),+this.clone().endOf(t)<n)}function it(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)}function st(e,t){var n;return t=k(t||"millisecond"),"millisecond"===t?(e=m(e)?e:He(e),+this===+e):(n=+He(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))}function at(e){return 0>e?Math.ceil(e):Math.floor(e)}function lt(e,t,n){var o,r,i=Ne(e,this),s=6e4*(i.utcOffset()-this.utcOffset());return t=k(t),"year"===t||"month"===t||"quarter"===t?(r=ut(this,i),"quarter"===t?r/=3:"year"===t&&(r/=12)):(o=this-i,r="second"===t?o/1e3:"minute"===t?o/6e4:"hour"===t?o/36e5:"day"===t?(o-s)/864e5:"week"===t?(o-s)/6048e5:o),n?r:at(r)}function ut(e,t){var n,o,r=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(r,"months");return 0>t-i?(n=e.clone().add(r-1,"months"),o=(t-i)/(i-n)):(n=e.clone().add(r+1,"months"),o=(t-i)/(n-i)),-(r+o)}function dt(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ct(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():L(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):L(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function ht(t){var n=L(this,t||e.defaultFormat);return this.localeData().postformat(n)}function ft(e,t){return this.isValid()?Ke({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function pt(e){return this.from(He(),e)}function gt(e,t){return this.isValid()?Ke({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function mt(e){return this.to(He(),e)}function wt(e){var t;return void 0===e?this._locale._abbr:(t=T(e),null!=t&&(this._locale=t),this)}function vt(){return this._locale}function yt(e){switch(e=k(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function bt(e){return e=k(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function Ct(){return+this._d-6e4*(this._offset||0)}function Rt(){return Math.floor(+this/1e3)}function St(){return this._offset?new Date(+this):this._d}function Et(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Tt(){return h(this)}function _t(){return l({},c(this))}function kt(){return c(this).overflow}function Ht(e,t){j(0,[e,e.length],0,t)}function Mt(e,t,n){return ue(He([e,11,31+t-n]),t,n).week}function Ot(e){var t=ue(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")}function Dt(e){var t=ue(this,1,4).year;return null==e?t:this.add(e-t,"y")}function xt(){return Mt(this.year(),1,4)}function At(){var e=this.localeData()._week;return Mt(this.year(),e.dow,e.doy)}function jt(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Pt(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function Nt(e){return this._weekdays[e.day()]}function Lt(e){return this._weekdaysShort[e.day()]}function Wt(e){return this._weekdaysMin[e.day()]}function It(e){var t,n,o;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=He([2e3,1]).day(t),o="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(o.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t}function Bt(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Pt(e,this.localeData()),this.add(e-t,"d")):t}function Vt(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ft(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)}function Yt(e,t){j(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Gt(e,t){return t._meridiemParse}function zt(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ut(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function $t(e){j(0,[e,3],0,"millisecond")}function Xt(){return this._isUTC?"UTC":""}function Kt(){return this._isUTC?"Coordinated Universal Time":""}function qt(e){return He(1e3*e)}function Zt(){return He.apply(null,arguments).parseZone()}function Jt(e,t,n){var o=this._calendar[e];return"function"==typeof o?o.call(t,n):o}function Qt(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t}function en(){return this._invalidDate}function tn(e){return this._ordinal.replace("%d",e)}function nn(e){return e}function on(e,t,n,o){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,o):r.replace(/%d/i,e)}function rn(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)}function sn(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function an(e,t,n,o){var r=T(),i=u().set(o,t);return r[n](i,e)}function ln(e,t,n,o,r){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return an(e,t,n,r);var i,s=[];for(i=0;o>i;i++)s[i]=an(e,i,n,r);return s}function un(e,t){return ln(e,t,"months",12,"month")}function dn(e,t){return ln(e,t,"monthsShort",12,"month")}function cn(e,t){return ln(e,t,"weekdays",7,"day")}function hn(e,t){return ln(e,t,"weekdaysShort",7,"day")}function fn(e,t){return ln(e,t,"weekdaysMin",7,"day")}function pn(){var e=this._data;return this._milliseconds=$o(this._milliseconds),this._days=$o(this._days),this._months=$o(this._months),e.milliseconds=$o(e.milliseconds),e.seconds=$o(e.seconds),e.minutes=$o(e.minutes),e.hours=$o(e.hours),e.months=$o(e.months),e.years=$o(e.years),this}function gn(e,t,n,o){var r=Ke(t,n);return e._milliseconds+=o*r._milliseconds,e._days+=o*r._days,e._months+=o*r._months,e._bubble()}function mn(e,t){return gn(this,e,t,1)}function wn(e,t){return gn(this,e,t,-1)}function vn(){var e,t,n,o=this._milliseconds,r=this._days,i=this._months,s=this._data,a=0;return s.milliseconds=o%1e3,e=at(o/1e3),s.seconds=e%60,t=at(e/60),s.minutes=t%60,n=at(t/60),s.hours=n%24,r+=at(n/24),a=at(yn(r)),r-=at(bn(a)),i+=at(r/30),r%=30,a+=at(i/12),i%=12,s.days=r,s.months=i,s.years=a,this}function yn(e){return 400*e/146097}function bn(e){return 146097*e/400}function Cn(e){var t,n,o=this._milliseconds;if(e=k(e),"month"===e||"year"===e)return t=this._days+o/864e5,n=this._months+12*yn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(bn(this._months/12)),e){case"week":return t/7+o/6048e5;case"day":return t+o/864e5;case"hour":return 24*t+o/36e5;case"minute":return 1440*t+o/6e4;case"second":return 86400*t+o/1e3;case"millisecond":return Math.floor(864e5*t)+o;default:throw new Error("Unknown unit "+e)}}function Rn(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12)}function Sn(e){return function(){return this.as(e)}}function En(e){return e=k(e),this[e+"s"]()}function Tn(e){return function(){return this._data[e]}}function _n(){return at(this.days()/7)}function kn(e,t,n,o,r){return r.relativeTime(t||1,!!n,e,o)}function Hn(e,t,n){var o=Ke(e).abs(),r=ur(o.as("s")),i=ur(o.as("m")),s=ur(o.as("h")),a=ur(o.as("d")),l=ur(o.as("M")),u=ur(o.as("y")),d=r<dr.s&&["s",r]||1===i&&["m"]||i<dr.m&&["mm",i]||1===s&&["h"]||s<dr.h&&["hh",s]||1===a&&["d"]||a<dr.d&&["dd",a]||1===l&&["M"]||l<dr.M&&["MM",l]||1===u&&["y"]||["yy",u];return d[2]=t,d[3]=+e>0,d[4]=n,kn.apply(null,d)}function Mn(e,t){return void 0===dr[e]?!1:void 0===t?dr[e]:(dr[e]=t,!0)}function On(e){var t=this.localeData(),n=Hn(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function Dn(){var e=cr(this.years()),t=cr(this.months()),n=cr(this.days()),o=cr(this.hours()),r=cr(this.minutes()),i=cr(this.seconds()+this.milliseconds()/1e3),s=this.asSeconds();return s?(0>s?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(o||r||i?"T":"")+(o?o+"H":"")+(r?r+"M":"")+(i?i+"S":""):"P0D"}var xn,An,jn=e.momentProperties=[],Pn=!1,Nn={},Ln={},Wn=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,In=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Bn={},Vn={},Fn=/\d/,Yn=/\d\d/,Gn=/\d{3}/,zn=/\d{4}/,Un=/[+-]?\d{6}/,$n=/\d\d?/,Xn=/\d{1,3}/,Kn=/\d{1,4}/,qn=/[+-]?\d{1,6}/,Zn=/\d+/,Jn=/[+-]?\d+/,Qn=/Z|[+-]\d\d:?\d\d/gi,eo=/[+-]?\d+(\.\d{1,3})?/,to=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,no={},oo={},ro=0,io=1,so=2,ao=3,lo=4,uo=5,co=6;j("M",["MM",2],"Mo",function(){return this.month()+1}),j("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),j("MMMM",0,0,function(e){return this.localeData().months(this,e)}),_("month","M"),I("M",$n),I("MM",$n,Yn),I("MMM",to),I("MMMM",to),F(["M","MM"],function(e,t){t[io]=w(e)-1}),F(["MMM","MMMM"],function(e,t,n,o){var r=n._locale.monthsParse(e,o,n._strict);null!=r?t[io]=r:c(n).invalidMonth=e});var ho="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),fo="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),po={};e.suppressDeprecationWarnings=!1;var go=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mo=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],wo=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],vo=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=ee("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),j(0,["YY",2],0,function(){return this.year()%100}),j(0,["YYYY",4],0,"year"),j(0,["YYYYY",5],0,"year"),j(0,["YYYYYY",6,!0],0,"year"),_("year","y"),I("Y",Jn),I("YY",$n,Yn),I("YYYY",Kn,zn),I("YYYYY",qn,Un),I("YYYYYY",qn,Un),F(["YYYY","YYYYY","YYYYYY"],ro),F("YY",function(t,n){n[ro]=e.parseTwoDigitYear(t)}),e.parseTwoDigitYear=function(e){return w(e)+(w(e)>68?1900:2e3)};var yo=M("FullYear",!1);j("w",["ww",2],"wo","week"),j("W",["WW",2],"Wo","isoWeek"),_("week","w"),_("isoWeek","W"),I("w",$n),I("ww",$n,Yn),I("W",$n),I("WW",$n,Yn),Y(["w","ww","W","WW"],function(e,t,n,o){t[o.substr(0,1)]=w(e)});var bo={dow:0,doy:6};j("DDD",["DDDD",3],"DDDo","dayOfYear"),_("dayOfYear","DDD"),I("DDD",Xn),I("DDDD",Gn),F(["DDD","DDDD"],function(e,t,n){n._dayOfYear=w(e)}),e.ISO_8601=function(){};var Co=ee("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=He.apply(null,arguments);return this>e?this:e}),Ro=ee("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=He.apply(null,arguments);return e>this?this:e});je("Z",":"),je("ZZ",""),I("Z",Qn),I("ZZ",Qn),F(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Pe(e)});var So=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Eo=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,To=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Ke.fn=xe.prototype;var _o=Qe(1,"add"),ko=Qe(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Ho=ee("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});j(0,["gg",2],0,function(){return this.weekYear()%100}),j(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ht("gggg","weekYear"),Ht("ggggg","weekYear"),Ht("GGGG","isoWeekYear"),Ht("GGGGG","isoWeekYear"),_("weekYear","gg"),_("isoWeekYear","GG"),I("G",Jn),I("g",Jn),I("GG",$n,Yn),I("gg",$n,Yn),I("GGGG",Kn,zn),I("gggg",Kn,zn),I("GGGGG",qn,Un),I("ggggg",qn,Un),Y(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,o){t[o.substr(0,2)]=w(e)}),Y(["gg","GG"],function(t,n,o,r){n[r]=e.parseTwoDigitYear(t)}),j("Q",0,0,"quarter"),_("quarter","Q"),I("Q",Fn),F("Q",function(e,t){t[io]=3*(w(e)-1)}),j("D",["DD",2],"Do","date"),_("date","D"),I("D",$n),I("DD",$n,Yn),I("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),F(["D","DD"],so),F("Do",function(e,t){t[so]=w(e.match($n)[0],10)});var Mo=M("Date",!0);j("d",0,"do","day"),j("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),j("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),j("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),j("e",0,0,"weekday"),j("E",0,0,"isoWeekday"),_("day","d"),_("weekday","e"),_("isoWeekday","E"),I("d",$n),I("e",$n),I("E",$n),I("dd",to),I("ddd",to),I("dddd",to),Y(["dd","ddd","dddd"],function(e,t,n){var o=n._locale.weekdaysParse(e);null!=o?t.d=o:c(n).invalidWeekday=e}),Y(["d","e","E"],function(e,t,n,o){t[o]=w(e)});var Oo="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Do="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),xo="Su_Mo_Tu_We_Th_Fr_Sa".split("_");j("H",["HH",2],0,"hour"),j("h",["hh",2],0,function(){return this.hours()%12||12}),Yt("a",!0),Yt("A",!1),_("hour","h"),I("a",Gt),I("A",Gt),I("H",$n),I("h",$n),I("HH",$n,Yn),I("hh",$n,Yn),F(["H","HH"],ao),F(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),F(["h","hh"],function(e,t,n){t[ao]=w(e),c(n).bigHour=!0});var Ao=/[ap]\.?m?\.?/i,jo=M("Hours",!0);j("m",["mm",2],0,"minute"),_("minute","m"),I("m",$n),I("mm",$n,Yn),F(["m","mm"],lo);var Po=M("Minutes",!1);j("s",["ss",2],0,"second"),_("second","s"),I("s",$n),I("ss",$n,Yn),F(["s","ss"],uo);var No=M("Seconds",!1);j("S",0,0,function(){return~~(this.millisecond()/100)}),j(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),$t("SSS"),$t("SSSS"),_("millisecond","ms"),I("S",Xn,Fn),I("SS",Xn,Yn),I("SSS",Xn,Gn),I("SSSS",Zn),F(["S","SS","SSS","SSSS"],function(e,t){t[co]=w(1e3*("0."+e))});var Lo=M("Milliseconds",!1);j("z",0,0,"zoneAbbr"),j("zz",0,0,"zoneName");var Wo=g.prototype;Wo.add=_o,Wo.calendar=tt,Wo.clone=nt,Wo.diff=lt,Wo.endOf=bt,Wo.format=ht,Wo.from=ft,Wo.fromNow=pt,Wo.to=gt,Wo.toNow=mt,Wo.get=x,Wo.invalidAt=kt,Wo.isAfter=ot,Wo.isBefore=rt,Wo.isBetween=it,Wo.isSame=st,Wo.isValid=Tt,Wo.lang=Ho,Wo.locale=wt,Wo.localeData=vt,Wo.max=Ro,Wo.min=Co,Wo.parsingFlags=_t,Wo.set=x,Wo.startOf=yt,Wo.subtract=ko,Wo.toArray=Et,Wo.toDate=St,Wo.toISOString=ct,Wo.toJSON=ct,Wo.toString=dt,Wo.unix=Rt,Wo.valueOf=Ct,Wo.year=yo,Wo.isLeapYear=le,Wo.weekYear=Ot,Wo.isoWeekYear=Dt,Wo.quarter=Wo.quarters=jt,Wo.month=q,Wo.daysInMonth=Z,Wo.week=Wo.weeks=fe,Wo.isoWeek=Wo.isoWeeks=pe,Wo.weeksInYear=At,Wo.isoWeeksInYear=xt,Wo.date=Mo,Wo.day=Wo.days=Bt,Wo.weekday=Vt,Wo.isoWeekday=Ft,Wo.dayOfYear=me,Wo.hour=Wo.hours=jo,Wo.minute=Wo.minutes=Po,Wo.second=Wo.seconds=No,Wo.millisecond=Wo.milliseconds=Lo,Wo.utcOffset=We,Wo.utc=Be,Wo.local=Ve,Wo.parseZone=Fe,Wo.hasAlignedHourOffset=Ye,Wo.isDST=Ge,Wo.isDSTShifted=ze,Wo.isLocal=Ue,Wo.isUtcOffset=$e,Wo.isUtc=Xe,Wo.isUTC=Xe,Wo.zoneAbbr=Xt,Wo.zoneName=Kt,Wo.dates=ee("dates accessor is deprecated. Use date instead.",Mo),Wo.months=ee("months accessor is deprecated. Use month instead",q),Wo.years=ee("years accessor is deprecated. Use year instead",yo),Wo.zone=ee("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Ie);var Io=Wo,Bo={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Vo={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},Fo="Invalid date",Yo="%d",Go=/\d{1,2}/,zo={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Uo=y.prototype;
Uo._calendar=Bo,Uo.calendar=Jt,Uo._longDateFormat=Vo,Uo.longDateFormat=Qt,Uo._invalidDate=Fo,Uo.invalidDate=en,Uo._ordinal=Yo,Uo.ordinal=tn,Uo._ordinalParse=Go,Uo.preparse=nn,Uo.postformat=nn,Uo._relativeTime=zo,Uo.relativeTime=on,Uo.pastFuture=rn,Uo.set=sn,Uo.months=U,Uo._months=ho,Uo.monthsShort=$,Uo._monthsShort=fo,Uo.monthsParse=X,Uo.week=de,Uo._week=bo,Uo.firstDayOfYear=he,Uo.firstDayOfWeek=ce,Uo.weekdays=Nt,Uo._weekdays=Oo,Uo.weekdaysMin=Wt,Uo._weekdaysMin=xo,Uo.weekdaysShort=Lt,Uo._weekdaysShort=Do,Uo.weekdaysParse=It,Uo.isPM=zt,Uo._meridiemParse=Ao,Uo.meridiem=Ut,S("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===w(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),e.lang=ee("moment.lang is deprecated. Use moment.locale instead.",S),e.langData=ee("moment.langData is deprecated. Use moment.localeData instead.",T);var $o=Math.abs,Xo=Sn("ms"),Ko=Sn("s"),qo=Sn("m"),Zo=Sn("h"),Jo=Sn("d"),Qo=Sn("w"),er=Sn("M"),tr=Sn("y"),nr=Tn("milliseconds"),or=Tn("seconds"),rr=Tn("minutes"),ir=Tn("hours"),sr=Tn("days"),ar=Tn("months"),lr=Tn("years"),ur=Math.round,dr={s:45,m:45,h:22,d:26,M:11},cr=Math.abs,hr=xe.prototype;hr.abs=pn,hr.add=mn,hr.subtract=wn,hr.as=Cn,hr.asMilliseconds=Xo,hr.asSeconds=Ko,hr.asMinutes=qo,hr.asHours=Zo,hr.asDays=Jo,hr.asWeeks=Qo,hr.asMonths=er,hr.asYears=tr,hr.valueOf=Rn,hr._bubble=vn,hr.get=En,hr.milliseconds=nr,hr.seconds=or,hr.minutes=rr,hr.hours=ir,hr.days=sr,hr.weeks=_n,hr.months=ar,hr.years=lr,hr.humanize=On,hr.toISOString=Dn,hr.toString=Dn,hr.toJSON=Dn,hr.locale=wt,hr.localeData=vt,hr.toIsoString=ee("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Dn),hr.lang=Ho,j("X",0,0,"unix"),j("x",0,0,"valueOf"),I("x",Jn),I("X",eo),F("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),F("x",function(e,t,n){n._d=new Date(w(e))}),e.version="2.10.3",o(He),e.fn=Io,e.min=Oe,e.max=De,e.utc=u,e.unix=qt,e.months=un,e.isDate=i,e.locale=S,e.invalid=f,e.duration=Ke,e.isMoment=m,e.weekdays=cn,e.parseZone=Zt,e.localeData=T,e.isDuration=Ae,e.monthsShort=dn,e.weekdaysMin=fn,e.defineLocale=E,e.weekdaysShort=hn,e.normalizeUnits=k,e.relativeTimeThreshold=Mn;var fr=e;return fr})},{}],numeral:[function(t,n,o){"use strict";(function(){function t(e){this._value=e}function o(e,t,n,o){var r,i,s=Math.pow(10,t);return i=(n(e*s)/s).toFixed(t),o&&(r=new RegExp("0{1,"+o+"}$"),i=i.replace(r,"")),i}function r(e,t,n){var o;return o=t.indexOf("$")>-1?s(e,t,n):t.indexOf("%")>-1?a(e,t,n):t.indexOf(":")>-1?l(e,t):d(e._value,t,n)}function i(e,t){var n,o,r,i,s,a=t,l=["KB","MB","GB","TB","PB","EB","ZB","YB"],d=!1;if(t.indexOf(":")>-1)e._value=u(t);else if(t===v)e._value=0;else{for("."!==m[w].delimiters.decimal&&(t=t.replace(/\./g,"").replace(m[w].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+m[w].abbreviations.thousand+"(?:\\)|(\\"+m[w].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+m[w].abbreviations.million+"(?:\\)|(\\"+m[w].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+m[w].abbreviations.billion+"(?:\\)|(\\"+m[w].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+m[w].abbreviations.trillion+"(?:\\)|(\\"+m[w].currency.symbol+")?(?:\\))?)?$"),s=0;s<=l.length&&!(d=t.indexOf(l[s])>-1?Math.pow(1024,s+1):!1);s++);e._value=(d?d:1)*(a.match(n)?Math.pow(10,3):1)*(a.match(o)?Math.pow(10,6):1)*(a.match(r)?Math.pow(10,9):1)*(a.match(i)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=d?Math.ceil(e._value):e._value}return e._value}function s(e,t,n){var o,r,i=t.indexOf("$"),s=t.indexOf("("),a=t.indexOf("-"),l="";return t.indexOf(" $")>-1?(l=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(l=" ",t=t.replace("$ ","")):t=t.replace("$",""),r=d(e._value,t,n),1>=i?r.indexOf("(")>-1||r.indexOf("-")>-1?(r=r.split(""),o=1,(s>i||a>i)&&(o=0),r.splice(o,0,m[w].currency.symbol+l),r=r.join("")):r=m[w].currency.symbol+l+r:r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,l+m[w].currency.symbol),r=r.join("")):r=r+l+m[w].currency.symbol,r}function a(e,t,n){var o,r="",i=100*e._value;return t.indexOf(" %")>-1?(r=" ",t=t.replace(" %","")):t=t.replace("%",""),o=d(i,t,n),o.indexOf(")")>-1?(o=o.split(""),o.splice(-1,0,r+"%"),o=o.join("")):o=o+r+"%",o}function l(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),o=Math.round(e._value-60*t*60-60*n);return t+":"+(10>n?"0"+n:n)+":"+(10>o?"0"+o:o)}function u(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function d(e,t,n){var r,i,s,a,l,u,d=!1,c=!1,h=!1,f="",p=!1,g=!1,y=!1,b=!1,C=!1,R="",S="",E=Math.abs(e),T=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],_="",k=!1;if(0===e&&null!==v)return v;if(t.indexOf("(")>-1?(d=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(c=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(p=t.indexOf("aK")>=0,g=t.indexOf("aM")>=0,y=t.indexOf("aB")>=0,b=t.indexOf("aT")>=0,C=p||g||y||b,t.indexOf(" a")>-1?(f=" ",t=t.replace(" a","")):t=t.replace("a",""),E>=Math.pow(10,12)&&!C||b?(f+=m[w].abbreviations.trillion,e/=Math.pow(10,12)):E<Math.pow(10,12)&&E>=Math.pow(10,9)&&!C||y?(f+=m[w].abbreviations.billion,e/=Math.pow(10,9)):E<Math.pow(10,9)&&E>=Math.pow(10,6)&&!C||g?(f+=m[w].abbreviations.million,e/=Math.pow(10,6)):(E<Math.pow(10,6)&&E>=Math.pow(10,3)&&!C||p)&&(f+=m[w].abbreviations.thousand,e/=Math.pow(10,3))),t.indexOf("b")>-1)for(t.indexOf(" b")>-1?(R=" ",t=t.replace(" b","")):t=t.replace("b",""),s=0;s<=T.length;s++)if(r=Math.pow(1024,s),i=Math.pow(1024,s+1),e>=r&&i>e){R+=T[s],r>0&&(e/=r);break}return t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(S=" ",t=t.replace(" o","")):t=t.replace("o",""),S+=m[w].ordinal(e)),t.indexOf("[.]")>-1&&(h=!0,t=t.replace("[.]",".")),a=e.toString().split(".")[0],l=t.split(".")[1],u=t.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),_=o(e,l[0].length+l[1].length,n,l[1].length)):_=o(e,l.length,n),a=_.split(".")[0],_=_.split(".")[1].length?m[w].delimiters.decimal+_.split(".")[1]:"",h&&0===Number(_.slice(1))&&(_="")):a=o(e,null,n),a.indexOf("-")>-1&&(a=a.slice(1),k=!0),u>-1&&(a=a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+m[w].delimiters.thousands)),0===t.indexOf(".")&&(a=""),(d&&k?"(":"")+(!d&&k?"-":"")+(!k&&c?"+":"")+a+_+(S?S:"")+(f?f:"")+(R?R:"")+(d&&k?")":"")}function c(e,t){m[e]=t}function h(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function f(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var n=h(e),o=h(t);return n>o?n:o},-(1/0))}var p,g="1.5.3",m={},w="en",v=null,y="0,0",b="undefined"!=typeof n&&n.exports;p=function(e){return p.isNumeral(e)?e=e.value():0===e||"undefined"==typeof e?e=0:Number(e)||(e=p.fn.unformat(e)),new t(Number(e))},p.version=g,p.isNumeral=function(e){return e instanceof t},p.language=function(e,t){if(!e)return w;if(e&&!t){if(!m[e])throw new Error("Unknown language : "+e);w=e}return(t||!m[e])&&c(e,t),p},p.languageData=function(e){if(!e)return m[w];if(!m[e])throw new Error("Unknown language : "+e);return m[e]},p.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),p.zeroFormat=function(e){v="string"==typeof e?e:null},p.defaultFormat=function(e){y="string"==typeof e?e:"0.0"},p.validate=function(e,t){var n,o,r,i,s,a,l,u;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),""===e)return!1;e=e.replace(/^[+-]?/,"");try{l=p.languageData(t)}catch(d){l=p.languageData(p.language())}return r=l.currency.symbol,s=l.abbreviations,n=l.delimiters.decimal,o="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,u=e.match(/^[^\d\.\,]+/),null!==u&&(e=e.substr(1),u[0]!==r)?!1:(u=e.match(/[^\d]+$/),null!==u&&(e=e.slice(0,-1),u[0]!==s.thousand&&u[0]!==s.million&&u[0]!==s.billion&&u[0]!==s.trillion)?!1:e.match(/^\d+$/)?!0:(a=new RegExp(o+"{2}"),e.match(/[^\d.,]/g)?!1:(i=e.split(n),i.length>2?!1:i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a):""===i[0]?!i[0].match(a)&&!!i[1].match(/^\d+$/):1===i[0].length?!!i[0].match(/^\d+$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,o,r=this.length>>>0,i=!1;for(1<arguments.length&&(o=t,i=!0),n=0;r>n;++n)this.hasOwnProperty(n)&&(i?o=e(o,this[n],n,this):(o=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return o}),p.fn=t.prototype={clone:function(){return p(this)},format:function(e,t){return r(this,e?e:y,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:i(this,e?e:y)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t,o,r){return e+n*t}var n=f.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/n,this},subtract:function(e){function t(e,t,o,r){return e-n*t}var n=f.call(null,this._value,e);return this._value=[e].reduce(t,this._value*n)/n,this},multiply:function(e){function t(e,t,n,o){var r=f(e,t);return e*r*t*r/(r*r)}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t,n,o){var r=f(e,t);return e*r/(t*r)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(p(this._value).subtract(e).value())}},b&&(n.exports=p),"undefined"==typeof ender&&(this.numeral=p),"function"==typeof e&&e.amd&&e([],function(){return p})}).call(window)},{}],pikaday:[function(t,n,o){/*!
>>>>>>> upstream/master
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
!function(r,i){"use strict";var s;if("object"==typeof o){try{s=t("moment")}catch(a){}n.exports=i(s)}else"function"==typeof e&&e.amd?e(function(e){var t="moment";try{s=e(t)}catch(n){}return i(s)}):r.Pikaday=i(r.moment)}(this,function(e){"use strict";var t="function"==typeof e,n=!!window.addEventListener,o=window.document,r=window.setTimeout,i=function(e,t,o,r){n?e.addEventListener(t,o,!!r):e.attachEvent("on"+t,o)},s=function(e,t,o,r){n?e.removeEventListener(t,o,!!r):e.detachEvent("on"+t,o)},a=function(e,t,n){var r;o.createEvent?(r=o.createEvent("HTMLEvents"),r.initEvent(t,!0,!1),r=y(r,n),e.dispatchEvent(r)):o.createEventObject&&(r=o.createEventObject(),r=y(r,n),e.fireEvent("on"+t,r))},l=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},u=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},d=function(e,t){u(e,t)||(e.className=""===e.className?t:e.className+" "+t)},c=function(e,t){e.className=l((" "+e.className+" ").replace(" "+t+" "," "))},h=function(e){return/Array/.test(Object.prototype.toString.call(e))},f=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},p=function(e){var t=e.getDay();return 0===t||6===t},g=function(e){return e%4===0&&e%100!==0||e%400===0},m=function(e,t){return[31,g(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},w=function(e){f(e)&&e.setHours(0,0,0,0)},v=function(e,t){return e.getTime()===t.getTime()},y=function(e,t,n){var o,r;for(o in t)r=void 0!==e[o],r&&"object"==typeof t[o]&&null!==t[o]&&void 0===t[o].nodeName?f(t[o])?n&&(e[o]=new Date(t[o].getTime())):h(t[o])?n&&(e[o]=t[o].slice(0)):e[o]=y({},t[o],n):(n||!r)&&(e[o]=t[o]);return e},b=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},C={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null,onDraw:null},R=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},S=function(e,t,n,o,r,i,s){if(s)return'<td class="is-empty"></td>';var a=[];return i&&a.push("is-disabled"),r&&a.push("is-today"),o&&a.push("is-selected"),'<td data-day="'+e+'" class="'+a.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n+'" data-pika-month="'+t+'" data-pika-day="'+e+'">'+e+"</button></td>"},E=function(e,t,n){var o=new Date(n,0,1),r=Math.ceil(((new Date(n,t,e)-o)/864e5+o.getDay()+1)/7);return'<td class="pika-week">'+r+"</td>"},T=function(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},_=function(e){return"<tbody>"+e.join("")+"</tbody>"},k=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;7>t;t++)n.push('<th scope="col"><abbr title="'+R(e,t)+'">'+R(e,t,!0)+"</abbr></th>");return"<thead>"+(e.isRTL?n.reverse():n).join("")+"</thead>"},H=function(e,t,n,o,r){var i,s,a,l,u,d=e._o,c=n===d.minYear,f=n===d.maxYear,p='<div class="pika-title">',g=!0,m=!0;for(a=[],i=0;12>i;i++)a.push('<option value="'+(n===r?i-t:12+i-t)+'"'+(i===o?" selected":"")+(c&&i<d.minMonth||f&&i>d.maxMonth?"disabled":"")+">"+d.i18n.months[i]+"</option>");for(l='<div class="pika-label">'+d.i18n.months[o]+'<select class="pika-select pika-select-month">'+a.join("")+"</select></div>",h(d.yearRange)?(i=d.yearRange[0],s=d.yearRange[1]+1):(i=n-d.yearRange,s=1+n+d.yearRange),a=[];s>i&&i<=d.maxYear;i++)i>=d.minYear&&a.push('<option value="'+i+'"'+(i===n?" selected":"")+">"+i+"</option>");return u='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year">'+a.join("")+"</select></div>",p+=d.showMonthAfterYear?u+l:l+u,c&&(0===o||d.minMonth>=o)&&(g=!1),f&&(11===o||d.maxMonth<=o)&&(m=!1),0===t&&(p+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(p+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),p+="</div>"},M=function(e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+k(e)+_(t)+"</table>"},O=function(s){var a=this,l=a.config(s);a._onMouseDown=function(e){if(a._v){e=e||window.event;var t=e.target||e.srcElement;if(t){if(!u(t,"is-disabled")){if(u(t,"pika-button")&&!u(t,"is-empty"))return a.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),void(l.bound&&r(function(){a.hide(),l.field&&l.field.blur()},100));u(t,"pika-prev")?a.prevMonth():u(t,"pika-next")&&a.nextMonth()}if(u(t,"pika-select"))a._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}}},a._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;t&&(u(t,"pika-select-month")?a.gotoMonth(t.value):u(t,"pika-select-year")&&a.gotoYear(t.value))},a._onInputChange=function(n){var o;n.firedBy!==a&&(t?(o=e(l.field.value,l.format),o=o&&o.isValid()?o.toDate():null):o=new Date(Date.parse(l.field.value)),a.setDate(f(o)?o:null),a._v||a.show())},a._onInputFocus=function(){a.show()},a._onInputClick=function(){a.show()},a._onInputBlur=function(){var e=o.activeElement;do if(u(e,"pika-single"))return;while(e=e.parentNode);a._c||(a._b=r(function(){a.hide()},50)),a._c=!1},a._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,o=t;if(t){!n&&u(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),i(t,"change",a._onChange)));do if(u(o,"pika-single")||o===l.trigger)return;while(o=o.parentNode);a._v&&t!==l.trigger&&o!==l.trigger&&a.hide()}},a.el=o.createElement("div"),a.el.className="pika-single"+(l.isRTL?" is-rtl":""),i(a.el,"mousedown",a._onMouseDown,!0),i(a.el,"change",a._onChange),l.field&&(l.container?l.container.appendChild(a.el):l.bound?o.body.appendChild(a.el):l.field.parentNode.insertBefore(a.el,l.field.nextSibling),i(l.field,"change",a._onInputChange),l.defaultDate||(t&&l.field.value?l.defaultDate=e(l.field.value,l.format).toDate():l.defaultDate=new Date(Date.parse(l.field.value)),l.setDefaultDate=!0));var d=l.defaultDate;f(d)?l.setDefaultDate?a.setDate(d,!0):a.gotoDate(d):a.gotoDate(new Date),l.bound?(this.hide(),a.el.className+=" is-bound",i(l.trigger,"click",a._onInputClick),i(l.trigger,"focus",a._onInputFocus),i(l.trigger,"blur",a._onInputBlur)):this.show()};return O.prototype={config:function(e){this._o||(this._o=y({},C,!0));var t=y(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,f(t.minDate)||(t.minDate=!1),f(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&(w(t.minDate),t.minYear=t.minDate.getFullYear(),t.minMonth=t.minDate.getMonth()),t.maxDate&&(w(t.maxDate),t.maxYear=t.maxDate.getFullYear(),t.maxMonth=t.maxDate.getMonth()),h(t.yearRange)){var o=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||o,t.yearRange[1]=parseInt(t.yearRange[1],10)||o}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||C.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return f(this._d)?t?e(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,o){t&&e.isMoment(n)&&this.setDate(n.toDate(),o)},getDate:function(){return f(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",a(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),f(e)){var n=this._o.minDate,o=this._o.maxDate;f(n)&&n>e?e=n:f(o)&&e>o&&(e=o),this._d=new Date(e.getTime()),w(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),a(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(f(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=e.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),t=r<n.getTime()||o.getTime()<r}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=b(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=b({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){this._o.minDate=e},setMaxDate:function(e){this._o.maxDate=e},draw:function(e){if(this._v||e){var t=this._o,n=t.minYear,o=t.maxYear,i=t.minMonth,s=t.maxMonth,a="";this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=o&&(this._y=o,!isNaN(s)&&this._m>s&&(this._m=s));for(var l=0;l<t.numberOfMonths;l++)a+='<div class="pika-lendar">'+H(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year)+this.render(this.calendars[l].year,this.calendars[l].month)+"</div>";if(this.el.innerHTML=a,t.bound&&"hidden"!==t.field.type&&r(function(){t.trigger.focus()},1),"function"==typeof this._o.onDraw){var u=this;r(function(){u._o.onDraw.call(u)},0)}}},adjustPosition:function(){if(!this._o.container){var e,t,n,r=this._o.trigger,i=r,s=this.el.offsetWidth,a=this.el.offsetHeight,l=window.innerWidth||o.documentElement.clientWidth,u=window.innerHeight||o.documentElement.clientHeight,d=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop;if("function"==typeof r.getBoundingClientRect)n=r.getBoundingClientRect(),e=n.left+window.pageXOffset,t=n.bottom+window.pageYOffset;else for(e=i.offsetLeft,t=i.offsetTop+i.offsetHeight;i=i.offsetParent;)e+=i.offsetLeft,t+=i.offsetTop;(this._o.reposition&&e+s>l||this._o.position.indexOf("right")>-1&&e-s+r.offsetWidth>0)&&(e=e-s+r.offsetWidth),(this._o.reposition&&t+a>u+d||this._o.position.indexOf("top")>-1&&t-a-r.offsetHeight>0)&&(t=t-a-r.offsetHeight),this.el.style.cssText=["position: absolute","left: "+e+"px","top: "+t+"px"].join(";")}},render:function(e,t){var n=this._o,o=new Date,r=m(e,t),i=new Date(e,t,1).getDay(),s=[],a=[];w(o),n.firstDay>0&&(i-=n.firstDay,0>i&&(i+=7));for(var l=r+i,u=l;u>7;)u-=7;l+=7-u;for(var d=0,c=0;l>d;d++){var h=new Date(e,t,1+(d-i)),g=f(this._d)?v(h,this._d):!1,y=v(h,o),b=i>d||d>=r+i,C=n.minDate&&h<n.minDate||n.maxDate&&h>n.maxDate||n.disableWeekends&&p(h)||n.disableDayFn&&n.disableDayFn(h);a.push(S(1+(d-i),t,e,g,y,C,b)),7===++c&&(n.showWeekNumber&&a.unshift(E(d-i,t,e)),s.push(T(a,n.isRTL)),a=[],c=0)}return M(n,s)},isVisible:function(){return this._v},show:function(){this._v||(c(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(i(o,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;e!==!1&&(this._o.bound&&s(o,"click",this._onClick),this.el.style.cssText="",d(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"change",this._onChange),this._o.field&&(s(this._o.field,"change",this._onInputChange),this._o.bound&&(s(this._o.trigger,"click",this._onInputClick),s(this._o.trigger,"focus",this._onInputFocus),s(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},O})},{moment:"moment"}],zeroclipboard:[function(t,n,o){/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
!function(t,o){"use strict";var r,i,s,a=t,l=a.document,u=a.navigator,d=a.setTimeout,c=a.clearTimeout,h=a.setInterval,f=a.clearInterval,p=a.getComputedStyle,g=a.encodeURIComponent,m=a.ActiveXObject,w=a.Error,v=a.Number.parseInt||a.parseInt,y=a.Number.parseFloat||a.parseFloat,b=a.Number.isNaN||a.isNaN,C=a.Date.now,R=a.Object.keys,S=a.Object.defineProperty,E=a.Object.prototype.hasOwnProperty,T=a.Array.prototype.slice,_=function(){var e=function(e){return e};if("function"==typeof a.wrap&&"function"==typeof a.unwrap)try{var t=l.createElement("div"),n=a.unwrap(t);1===t.nodeType&&n&&1===n.nodeType&&(e=a.unwrap)}catch(o){}return e}(),k=function(e){return T.call(e,0)},H=function(){var e,t,n,r,i,s,a=k(arguments),l=a[0]||{};for(e=1,t=a.length;t>e;e++)if(null!=(n=a[e]))for(r in n)E.call(n,r)&&(i=l[r],s=n[r],l!==s&&s!==o&&(l[r]=s));return l},M=function(e){var t,n,o,r;if("object"!=typeof e||null==e||"number"==typeof e.nodeType)t=e;else if("number"==typeof e.length)for(t=[],n=0,o=e.length;o>n;n++)E.call(e,n)&&(t[n]=M(e[n]));else{t={};for(r in e)E.call(e,r)&&(t[r]=M(e[r]))}return t},O=function(e,t){for(var n={},o=0,r=t.length;r>o;o++)t[o]in e&&(n[t[o]]=e[t[o]]);return n},D=function(e,t){var n={};for(var o in e)-1===t.indexOf(o)&&(n[o]=e[o]);return n},x=function(e){if(e)for(var t in e)E.call(e,t)&&delete e[t];return e},A=function(e,t){if(e&&1===e.nodeType&&e.ownerDocument&&t&&(1===t.nodeType&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||9===t.nodeType&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return!0;e=e.parentNode}while(e);return!1},j=function(e){var t;return"string"==typeof e&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t},P=function(e){var t,n;return"string"==typeof e&&e&&(n=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]?t=n[1]:(n=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]&&(t=n[1]))),t},N=function(){var e,t;try{throw new w}catch(n){t=n}return t&&(e=t.sourceURL||t.fileName||P(t.stack)),e},L=function(){var e,t,n;if(l.currentScript&&(e=l.currentScript.src))return e;if(t=l.getElementsByTagName("script"),1===t.length)return t[0].src||o;if("readyState"in t[0])for(n=t.length;n--;)if("interactive"===t[n].readyState&&(e=t[n].src))return e;return"loading"===l.readyState&&(e=t[t.length-1].src)?e:(e=N())?e:o},W=function(){var e,t,n,r=l.getElementsByTagName("script");for(e=r.length;e--;){if(!(n=r[e].src)){t=null;break}if(n=j(n),null==t)t=n;else if(t!==n){t=null;break}}return t||o},I=function(){var e=j(L())||W()||"";return e+"ZeroClipboard.swf"},B=function(){return null==t.opener&&(!!t.top&&t!=t.top||!!t.parent&&t!=t.parent)}(),V={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},F="11.0.0",Y={},G={},z=null,U=0,$=0,X={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},K=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],q=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],Z=new RegExp("^flash-("+q.map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),J=new RegExp("^flash-("+q.slice(1).map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),Q={swfPath:I(),trustedDomains:t.location.host?[t.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},ee=function(e){if("object"==typeof e&&null!==e)for(var t in e)if(E.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))Q[t]=e[t];else if(null==V.bridge)if("containerId"===t||"swfObjectId"===t){if(!ge(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");Q[t]=e[t]}else Q[t]=e[t];{if("string"!=typeof e||!e)return M(Q);if(E.call(Q,e))return Q[e]}},te=function(){return $e(),{browser:O(u,["userAgent","platform","appName"]),flash:D(V,["bridge"]),zeroclipboard:{version:Ke.version,config:Ke.config()}}},ne=function(){return!!(V.disabled||V.outdated||V.sandboxed||V.unavailable||V.degraded||V.deactivated)},oe=function(e,t){var n,i,s,a={};if("string"==typeof e&&e)s=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)E.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Ke.on(n,e[n]);if(s&&s.length){for(n=0,i=s.length;i>n;n++)e=s[n].replace(/^on/,""),a[e]=!0,Y[e]||(Y[e]=[]),Y[e].push(t);if(a.ready&&V.ready&&Ke.emit({type:"ready"}),a.error){for(n=0,i=q.length;i>n;n++)if(V[q[n].replace(/^flash-/,"")]===!0){Ke.emit({type:"error",name:q[n]});break}r!==o&&Ke.version!==r&&Ke.emit({type:"error",name:"version-mismatch",jsVersion:Ke.version,swfVersion:r})}}return Ke},re=function(e,t){var n,o,r,i,s;if(0===arguments.length)i=R(Y);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)E.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Ke.off(n,e[n]);if(i&&i.length)for(n=0,o=i.length;o>n;n++)if(e=i[n].toLowerCase().replace(/^on/,""),s=Y[e],s&&s.length)if(t)for(r=s.indexOf(t);-1!==r;)s.splice(r,1),r=s.indexOf(t,r);else s.length=0;return Ke},ie=function(e){var t;return t="string"==typeof e&&e?M(Y[e])||null:M(Y)},se=function(e){var t,n,o;return e=me(e),e&&!Se(e)?"ready"===e.type&&V.overdue===!0?Ke.emit({type:"error",name:"flash-overdue"}):(t=H({},e),Ce.call(this,t),"copy"===e.type&&(o=De(G),n=o.data,z=o.formatMap),n):void 0},ae=function(){var e=V.sandboxed;if($e(),"boolean"!=typeof V.ready&&(V.ready=!1),V.sandboxed!==e&&V.sandboxed===!0)V.ready=!1,Ke.emit({type:"error",name:"flash-sandboxed"});else if(!Ke.isFlashUnusable()&&null===V.bridge){var t=Q.flashLoadTimeout;"number"==typeof t&&t>=0&&(U=d(function(){"boolean"!=typeof V.deactivated&&(V.deactivated=!0),V.deactivated===!0&&Ke.emit({type:"error",name:"flash-deactivated"})},t)),V.overdue=!1,Me()}},le=function(){Ke.clearData(),Ke.blur(),Ke.emit("destroy"),Oe(),Ke.off()},ue=function(e,t){var n;if("object"==typeof e&&e&&"undefined"==typeof t)n=e,Ke.clearData();else{if("string"!=typeof e||!e)return;n={},n[e]=t}for(var o in n)"string"==typeof o&&o&&E.call(n,o)&&"string"==typeof n[o]&&n[o]&&(G[o]=n[o])},de=function(e){"undefined"==typeof e?(x(G),z=null):"string"==typeof e&&E.call(G,e)&&delete G[e]},ce=function(e){return"undefined"==typeof e?M(G):"string"==typeof e&&E.call(G,e)?G[e]:void 0},he=function(e){if(e&&1===e.nodeType){i&&(Ie(i,Q.activeClass),i!==e&&Ie(i,Q.hoverClass)),i=e,We(e,Q.hoverClass);var t=e.getAttribute("title")||Q.title;if("string"==typeof t&&t){var n=He(V.bridge);n&&n.setAttribute("title",t)}var o=Q.forceHandCursor===!0||"pointer"===Be(e,"cursor");ze(o),Ge()}},fe=function(){var e=He(V.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px"),i&&(Ie(i,Q.hoverClass),Ie(i,Q.activeClass),i=null)},pe=function(){return i||null},ge=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},me=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){t=t.toLowerCase(),!e.target&&(/^(copy|aftercopy|_click)$/.test(t)||"error"===t&&"clipboard-error"===e.name)&&(e.target=s),H(e,{type:t,target:e.target||i||null,relatedTarget:e.relatedTarget||null,currentTarget:V&&V.bridge||null,timeStamp:e.timeStamp||C()||null});var n=X[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&H(e,{target:null,version:V.version}),"error"===e.type&&(Z.test(e.name)&&H(e,{target:null,minimumVersion:F}),J.test(e.name)&&H(e,{version:V.version})),"copy"===e.type&&(e.clipboardData={setData:Ke.setData,clearData:Ke.clearData}),"aftercopy"===e.type&&(e=xe(e,z)),e.target&&!e.relatedTarget&&(e.relatedTarget=we(e.target)),ve(e)}},we=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?l.getElementById(t):null},ve=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target,n="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:o,r="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:o,i=Ve(t),s=a.screenLeft||a.screenX||0,u=a.screenTop||a.screenY||0,d=l.body.scrollLeft+l.documentElement.scrollLeft,c=l.body.scrollTop+l.documentElement.scrollTop,h=i.left+("number"==typeof e._stageX?e._stageX:0),f=i.top+("number"==typeof e._stageY?e._stageY:0),p=h-d,g=f-c,m=s+p,w=u+g,v="number"==typeof e.movementX?e.movementX:0,y="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,H(e,{srcElement:t,fromElement:n,toElement:r,screenX:m,screenY:w,pageX:h,pageY:f,clientX:p,clientY:g,x:p,y:g,movementX:v,movementY:y,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},ye=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},be=function(e,t,n,o){o?d(function(){e.apply(t,n)},0):e.apply(t,n)},Ce=function(e){if("object"==typeof e&&e&&e.type){var t=ye(e),n=Y["*"]||[],o=Y[e.type]||[],r=n.concat(o);if(r&&r.length){var i,s,l,u,d,c=this;for(i=0,s=r.length;s>i;i++)l=r[i],u=c,"string"==typeof l&&"function"==typeof a[l]&&(l=a[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(u=l,l=l.handleEvent),"function"==typeof l&&(d=H({},e),be(l,u,[d],t))}return this}},Re=function(e){var t=null;return(B===!1||e&&"error"===e.type&&e.name&&-1!==K.indexOf(e.name))&&(t=!1),t},Se=function(e){var t=e.target||i||null,n="swf"===e._source;switch(delete e._source,e.type){case"error":var o="flash-sandboxed"===e.name||Re(e);"boolean"==typeof o&&(V.sandboxed=o),-1!==q.indexOf(e.name)?H(V,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,unavailable:"flash-unavailable"===e.name,degraded:"flash-degraded"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1}):"version-mismatch"===e.name&&(r=e.swfVersion,H(V,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Ye();break;case"ready":r=e.swfVersion;var a=V.deactivated===!0;H(V,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:a,ready:!a}),Ye();break;case"beforecopy":s=t;break;case"copy":var l,u,d=e.relatedTarget;!G["text/html"]&&!G["text/plain"]&&d&&(u=d.value||d.outerHTML||d.innerHTML)&&(l=d.value||d.textContent||d.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",l),u!==l&&e.clipboardData.setData("text/html",u)):!G["text/plain"]&&e.target&&(l=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",l));break;case"aftercopy":Ee(e),Ke.clearData(),t&&t!==Le()&&t.focus&&t.focus();break;case"_mouseover":Ke.focus(t),Q.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!A(e.relatedTarget,t)&&Te(H({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),Te(H({},e,{type:"mouseover"})));break;case"_mouseout":Ke.blur(),Q.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!A(e.relatedTarget,t)&&Te(H({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),Te(H({},e,{type:"mouseout"})));break;case"_mousedown":We(t,Q.activeClass),Q.bubbleEvents===!0&&n&&Te(H({},e,{type:e.type.slice(1)}));break;case"_mouseup":Ie(t,Q.activeClass),Q.bubbleEvents===!0&&n&&Te(H({},e,{type:e.type.slice(1)}));break;case"_click":s=null,Q.bubbleEvents===!0&&n&&Te(H({},e,{type:e.type.slice(1)}));break;case"_mousemove":Q.bubbleEvents===!0&&n&&Te(H({},e,{type:e.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)?!0:void 0},Ee=function(e){if(e.errors&&e.errors.length>0){var t=M(e);H(t,{type:"error",name:"clipboard-error"}),delete t.success,d(function(){Ke.emit(t)},0)}},Te=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||null,o=n&&n.ownerDocument||l,r={view:o.defaultView||a,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:o.createEvent?0:1},i=H(r,e);n&&o.createEvent&&n.dispatchEvent&&(i=[i.type,i.canBubble,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget],t=o.createEvent("MouseEvents"),t.initMouseEvent&&(t.initMouseEvent.apply(t,i),t._source="js",n.dispatchEvent(t)))}},_e=function(){var e=Q.flashLoadTimeout;if("number"==typeof e&&e>=0){var t=Math.min(1e3,e/10),n=Q.swfObjectId+"_fallbackContent";$=h(function(){var e=l.getElementById(n);Fe(e)&&(Ye(),V.deactivated=null,Ke.emit({type:"error",name:"swf-not-found"}))},t)}},ke=function(){var e=l.createElement("div");return e.id=Q.containerId,e.className=Q.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+Ue(Q.zIndex),e},He=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},Me=function(){var e,t=V.bridge,n=He(t);if(!t){var o=Ne(a.location.host,Q),r="never"===o?"none":"all",i=je(H({jsVersion:Ke.version},Q)),s=Q.swfPath+Ae(Q.swfPath,Q);n=ke();var u=l.createElement("div");n.appendChild(u),l.body.appendChild(n);var d=l.createElement("div"),c="activex"===V.pluginType;d.innerHTML='<object id="'+Q.swfObjectId+'" name="'+Q.swfObjectId+'" width="100%" height="100%" '+(c?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+s+'"')+">"+(c?'<param name="movie" value="'+s+'"/>':"")+'<param name="allowScriptAccess" value="'+o+'"/><param name="allowNetworking" value="'+r+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+i+'"/><div id="'+Q.swfObjectId+'_fallbackContent">&nbsp;</div></object>',t=d.firstChild,d=null,_(t).ZeroClipboard=Ke,n.replaceChild(t,u),_e()}return t||(t=l[Q.swfObjectId],t&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),V.bridge=t||null,t},Oe=function(){var e=V.bridge;if(e){var t=He(e);t&&("activex"===V.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var o in e)"function"==typeof e[o]&&(e[o]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else d(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),Ye(),V.ready=null,V.bridge=null,V.deactivated=null,r=o}},De=function(e){var t={},n={};if("object"==typeof e&&e){for(var o in e)if(o&&E.call(e,o)&&"string"==typeof e[o]&&e[o])switch(o.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[o],n.text=o;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[o],n.html=o;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[o],n.rtf=o}return{data:t,formatMap:n}}},xe=function(e,t){if("object"!=typeof e||!e||"object"!=typeof t||!t)return e;var n={};for(var o in e)if(E.call(e,o))if("errors"===o){n[o]=e[o]?e[o].slice():[];for(var r=0,i=n[o].length;i>r;r++)n[o][r].format=t[n[o][r].format]}else if("success"!==o&&"data"!==o)n[o]=e[o];else{n[o]={};var s=e[o];for(var a in s)a&&E.call(s,a)&&E.call(t,a)&&(n[o][t[a]]=s[a])}return n},Ae=function(e,t){var n=null==t||t&&t.cacheBust===!0;return n?(-1===e.indexOf("?")?"?":"&")+"noCache="+C():""},je=function(e){var t,n,o,r,i="",s=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?r=[e.trustedDomains]:"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(r=e.trustedDomains)),r&&r.length)for(t=0,n=r.length;n>t;t++)if(E.call(r,t)&&r[t]&&"string"==typeof r[t]){if(o=Pe(r[t]),!o)continue;if("*"===o){s.length=0,s.push(o);break}s.push.apply(s,[o,"//"+o,a.location.protocol+"//"+o])}return s.length&&(i+="trustedOrigins="+g(s.join(","))),e.forceEnhancedClipboard===!0&&(i+=(i?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(i+=(i?"&":"")+"swfObjectId="+g(e.swfObjectId)),"string"==typeof e.jsVersion&&e.jsVersion&&(i+=(i?"&":"")+"jsVersion="+g(e.jsVersion)),i},Pe=function(e){if(null==e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=-1===t?e:e.slice(t+2);var n=e.indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},Ne=function(){var e=function(e){var t,n,o,r=[];if("string"==typeof e&&(e=[e]),"object"!=typeof e||!e||"number"!=typeof e.length)return r;for(t=0,n=e.length;n>t;t++)if(E.call(e,t)&&(o=Pe(e[t]))){if("*"===o){r.length=0,r.push("*");break}-1===r.indexOf(o)&&r.push(o)}return r};return function(t,n){var o=Pe(n.swfPath);null===o&&(o=t);var r=e(n.trustedDomains),i=r.length;if(i>0){if(1===i&&"*"===r[0])return"always";if(-1!==r.indexOf(t))return 1===i&&t===o?"sameDomain":"always"}return"never"}}(),Le=function(){try{return l.activeElement}catch(e){return null}},We=function(e,t){var n,o,r,i=[];if("string"==typeof t&&t&&(i=t.split(/\s+/)),e&&1===e.nodeType&&i.length>0)if(e.classList)for(n=0,o=i.length;o>n;n++)e.classList.add(i[n]);else if(e.hasOwnProperty("className")){for(r=" "+e.className+" ",n=0,o=i.length;o>n;n++)-1===r.indexOf(" "+i[n]+" ")&&(r+=i[n]+" ");e.className=r.replace(/^\s+|\s+$/g,"")}return e},Ie=function(e,t){var n,o,r,i=[];if("string"==typeof t&&t&&(i=t.split(/\s+/)),e&&1===e.nodeType&&i.length>0)if(e.classList&&e.classList.length>0)for(n=0,o=i.length;o>n;n++)e.classList.remove(i[n]);else if(e.className){for(r=(" "+e.className+" ").replace(/[\r\n\t]/g," "),n=0,o=i.length;o>n;n++)r=r.replace(" "+i[n]+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}return e},Be=function(e,t){var n=p(e,null).getPropertyValue(t);return"cursor"!==t||n&&"auto"!==n||"A"!==e.nodeName?n:"pointer"},Ve=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n=e.getBoundingClientRect(),o=a.pageXOffset,r=a.pageYOffset,i=l.documentElement.clientLeft||0,s=l.documentElement.clientTop||0,u=0,d=0;if("relative"===Be(l.body,"position")){var c=l.body.getBoundingClientRect(),h=l.documentElement.getBoundingClientRect();u=c.left-h.left||0,d=c.top-h.top||0}t.left=n.left+o-i-u,t.top=n.top+r-s-d,t.width="width"in n?n.width:n.right-n.left,t.height="height"in n?n.height:n.bottom-n.top}return t},Fe=function(e){if(!e)return!1;var t=p(e,null),n=y(t.height)>0,o=y(t.width)>0,r=y(t.top)>=0,i=y(t.left)>=0,s=n&&o&&r&&i,a=s?null:Ve(e),l="none"!==t.display&&"collapse"!==t.visibility&&(s||!!a&&(n||a.height>0)&&(o||a.width>0)&&(r||a.top>=0)&&(i||a.left>=0));return l},Ye=function(){c(U),U=0,f($),$=0},Ge=function(){var e;if(i&&(e=He(V.bridge))){var t=Ve(i);H(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+Ue(Q.zIndex)})}},ze=function(e){V.ready===!0&&(V.bridge&&"function"==typeof V.bridge.setHandCursor?V.bridge.setHandCursor(e):V.ready=!1)},Ue=function(e){if(/^(?:auto|inherit)$/.test(e))return e;var t;return"number"!=typeof e||b(e)?"string"==typeof e&&(t=Ue(v(e,10))):t=e,"number"==typeof t?t:"auto"},$e=function(e){var n,o,r,i=V.sandboxed,s=null;if(e=e===!0,B===!1)s=!1;else{try{o=t.frameElement||null}catch(a){r={name:a.name,message:a.message}}if(o&&1===o.nodeType&&"IFRAME"===o.nodeName)try{s=o.hasAttribute("sandbox")}catch(a){s=null}else{try{n=document.domain||null}catch(a){n=null}(null===n||r&&"SecurityError"===r.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(r.message.toLowerCase()))&&(s=!0)}}return V.sandboxed=s,i===s||e||Xe(m),s},Xe=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function o(e){e&&(a=!0,e.version&&(c=t(e.version)),!c&&e.description&&(c=t(e.description)),e.filename&&(d=n(e.filename)))}var r,i,s,a=!1,l=!1,d=!1,c="";if(u.plugins&&u.plugins.length)r=u.plugins["Shockwave Flash"],o(r),u.plugins["Shockwave Flash 2.0"]&&(a=!0,c="2.0.0.11");else if(u.mimeTypes&&u.mimeTypes.length)s=u.mimeTypes["application/x-shockwave-flash"],r=s&&s.enabledPlugin,o(r);else if("undefined"!=typeof e){l=!0;try{i=new e("ShockwaveFlash.ShockwaveFlash.7"),a=!0,c=t(i.GetVariable("$version"))}catch(h){try{i=new e("ShockwaveFlash.ShockwaveFlash.6"),a=!0,c="6.0.21"}catch(f){try{i=new e("ShockwaveFlash.ShockwaveFlash"),a=!0,c=t(i.GetVariable("$version"))}catch(p){l=!1}}}}V.disabled=a!==!0,V.outdated=c&&y(c)<y(F),V.version=c||"0.0.0",V.pluginType=d?"pepper":l?"activex":a?"netscape":"unknown"};Xe(m),$e(!0);var Ke=function(){return this instanceof Ke?void("function"==typeof Ke._createClient&&Ke._createClient.apply(this,k(arguments))):new Ke};S(Ke,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0}),Ke.config=function(){return ee.apply(this,k(arguments))},Ke.state=function(){return te.apply(this,k(arguments))},Ke.isFlashUnusable=function(){return ne.apply(this,k(arguments))},Ke.on=function(){return oe.apply(this,k(arguments))},Ke.off=function(){return re.apply(this,k(arguments))},Ke.handlers=function(){return ie.apply(this,k(arguments))},Ke.emit=function(){return se.apply(this,k(arguments))},Ke.create=function(){return ae.apply(this,k(arguments))},Ke.destroy=function(){return le.apply(this,k(arguments))},Ke.setData=function(){return ue.apply(this,k(arguments))},Ke.clearData=function(){return de.apply(this,k(arguments))},Ke.getData=function(){return ce.apply(this,k(arguments))},Ke.focus=Ke.activate=function(){return he.apply(this,k(arguments))},Ke.blur=Ke.deactivate=function(){return fe.apply(this,k(arguments))},Ke.activeElement=function(){return pe.apply(this,k(arguments))};var qe=0,Ze={},Je=0,Qe={},et={};H(Q,{autoActivate:!0});var tt=function(e){var t=this;t.id=""+qe++,Ze[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),Ke.on("*",function(e){return t.emit(e)}),Ke.on("destroy",function(){t.destroy()}),Ke.create()},nt=function(e,t){var n,i,s,a={},l=Ze[this.id],u=l&&l.handlers;if(!l)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof e&&e)s=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)E.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(s&&s.length){for(n=0,i=s.length;i>n;n++)e=s[n].replace(/^on/,""),a[e]=!0,u[e]||(u[e]=[]),u[e].push(t);if(a.ready&&V.ready&&this.emit({type:"ready",client:this}),a.error){for(n=0,i=q.length;i>n;n++)if(V[q[n].replace(/^flash-/,"")]){this.emit({type:"error",name:q[n],client:this});break}r!==o&&Ke.version!==r&&this.emit({type:"error",name:"version-mismatch",jsVersion:Ke.version,swfVersion:r})}}return this},ot=function(e,t){var n,o,r,i,s,a=Ze[this.id],l=a&&a.handlers;if(!l)return this;if(0===arguments.length)i=R(l);else if("string"==typeof e&&e)i=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)E.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(i&&i.length)for(n=0,o=i.length;o>n;n++)if(e=i[n].toLowerCase().replace(/^on/,""),s=l[e],s&&s.length)if(t)for(r=s.indexOf(t);-1!==r;)s.splice(r,1),r=s.indexOf(t,r);else s.length=0;return this},rt=function(e){var t=null,n=Ze[this.id]&&Ze[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:M(n)),t},it=function(e){if(dt.call(this,e)){"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(e=H({},e));var t=H({},me(e),{client:this});ct.call(this,t)}return this},st=function(e){if(!Ze[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");e=ht(e);for(var t=0;t<e.length;t++)if(E.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===Qe[e[t].zcClippingId].indexOf(this.id)&&Qe[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+Je++,Qe[e[t].zcClippingId]=[this.id],Q.autoActivate===!0&&ft(e[t]));var n=Ze[this.id]&&Ze[this.id].elements;-1===n.indexOf(e[t])&&n.push(e[t])}return this},at=function(e){var t=Ze[this.id];if(!t)return this;var n,o=t.elements;e="undefined"==typeof e?o.slice(0):ht(e);for(var r=e.length;r--;)if(E.call(e,r)&&e[r]&&1===e[r].nodeType){for(n=0;-1!==(n=o.indexOf(e[r],n));)o.splice(n,1);var i=Qe[e[r].zcClippingId];if(i){for(n=0;-1!==(n=i.indexOf(this.id,n));)i.splice(n,1);0===i.length&&(Q.autoActivate===!0&&pt(e[r]),delete e[r].zcClippingId)}}return this},lt=function(){var e=Ze[this.id];return e&&e.elements?e.elements.slice(0):[]},ut=function(){Ze[this.id]&&(this.unclip(),this.off(),delete Ze[this.id])},dt=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=Ze[this.id],n=t&&t.elements,o=!!n&&n.length>0,r=!e.target||o&&-1!==n.indexOf(e.target),i=e.relatedTarget&&o&&-1!==n.indexOf(e.relatedTarget),s=e.client&&e.client===this;return t&&(r||i||s)?!0:!1},ct=function(e){var t=Ze[this.id];if("object"==typeof e&&e&&e.type&&t){var n=ye(e),o=t&&t.handlers["*"]||[],r=t&&t.handlers[e.type]||[],i=o.concat(r);if(i&&i.length){var s,l,u,d,c,h=this;for(s=0,l=i.length;l>s;s++)u=i[s],d=h,"string"==typeof u&&"function"==typeof a[u]&&(u=a[u]),"object"==typeof u&&u&&"function"==typeof u.handleEvent&&(d=u,u=u.handleEvent),"function"==typeof u&&(c=H({},e),be(u,d,[c],n))}}},ht=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},ft=function(e){if(e&&1===e.nodeType){var t=function(e){(e||(e=a.event))&&("js"!==e._source&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source)},n=function(n){(n||(n=a.event))&&(t(n),Ke.focus(e))};e.addEventListener("mouseover",n,!1),e.addEventListener("mouseout",t,!1),e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",t,!1),e.addEventListener("mousemove",t,!1),et[e.zcClippingId]={mouseover:n,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}}},pt=function(e){if(e&&1===e.nodeType){var t=et[e.zcClippingId];if("object"==typeof t&&t){for(var n,o,r=["move","leave","enter","out","over"],i=0,s=r.length;s>i;i++)n="mouse"+r[i],o=t[n],"function"==typeof o&&e.removeEventListener(n,o,!1);delete et[e.zcClippingId]}}};Ke._createClient=function(){tt.apply(this,k(arguments))},Ke.prototype.on=function(){return nt.apply(this,k(arguments))},Ke.prototype.off=function(){return ot.apply(this,k(arguments))},Ke.prototype.handlers=function(){return rt.apply(this,k(arguments))},Ke.prototype.emit=function(){return it.apply(this,k(arguments))},Ke.prototype.clip=function(){return st.apply(this,k(arguments))},Ke.prototype.unclip=function(){return at.apply(this,k(arguments))},Ke.prototype.elements=function(){return lt.apply(this,k(arguments))},Ke.prototype.destroy=function(){return ut.apply(this,k(arguments))},Ke.prototype.setText=function(e){if(!Ze[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ke.setData("text/plain",e),this},Ke.prototype.setHtml=function(e){if(!Ze[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ke.setData("text/html",e),this},Ke.prototype.setRichText=function(e){if(!Ze[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ke.setData("application/rtf",e),this},Ke.prototype.setData=function(){if(!Ze[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Ke.setData.apply(this,k(arguments)),this},Ke.prototype.clearData=function(){if(!Ze[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Ke.clearData.apply(this,k(arguments)),this},Ke.prototype.getData=function(){if(!Ze[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return Ke.getData.apply(this,k(arguments))},"function"==typeof e&&e.amd?e(function(){return Ke}):"object"==typeof n&&n&&"object"==typeof n.exports&&n.exports?n.exports=Ke:t.ZeroClipboard=Ke}(function(){return this||window}())},{}]},{},[23,47,48,49,65,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,66,67,68,69,86,87,88,72,73,74,75,76,77,31,35,32,33,40,34,36,37,38,39])("zeroclipboard")});